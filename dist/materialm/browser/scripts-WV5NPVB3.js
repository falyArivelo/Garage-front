(function(){"use strict";var Ur=function(t){if(t===null)return"null";if(t===void 0)return"undefined";var e=typeof t;return e==="object"&&(Array.prototype.isPrototypeOf(t)||t.constructor&&t.constructor.name==="Array")?"array":e==="object"&&(String.prototype.isPrototypeOf(t)||t.constructor&&t.constructor.name==="String")?"string":e},xo=function(t){return{eq:t}},$n=xo(function(t,e){return t===e}),uo=function(t){return xo(function(e,n){if(e.length!==n.length)return!1;for(var o=e.length,r=0;r<o;r++)if(!t.eq(e[r],n[r]))return!1;return!0})},yn=function(t){return xo(function(e,n){var o=Object.keys(e),r=Object.keys(n);if(!function(l,c){return function(d,u){return xo(function(m,h){return d.eq(u(m),u(h))})}(uo(l),function(d){return function(u,m){return Array.prototype.slice.call(u).sort(m)}(d,c)})}($n).eq(o,r))return!1;for(var s=o.length,a=0;a<s;a++){var i=o[a];if(!t.eq(e[i],n[i]))return!1}return!0})},mo=xo(function(t,e){if(t===e)return!0;var n=Ur(t);return n===Ur(e)&&(function(o){return["undefined","boolean","number","string","function","xml","null"].indexOf(o)!==-1}(n)?t===e:n==="array"?uo(mo).eq(t,e):n==="object"&&yn(mo).eq(t,e))});const Cn=Object.getPrototypeOf,br=(t,e,n)=>{var o;return!!n(t,e.prototype)||((o=t.constructor)===null||o===void 0?void 0:o.name)===e.name},Ae=t=>e=>(n=>{const o=typeof n;return n===null?"null":o==="object"&&Array.isArray(n)?"array":o==="object"&&br(n,String,(r,s)=>s.isPrototypeOf(r))?"string":o})(e)===t,Go=t=>e=>typeof e===t,Ve=t=>e=>t===e,wn=(t,e)=>Re(t)&&br(t,e,(n,o)=>Cn(n)===o),vt=Ae("string"),Re=Ae("object"),Hn=t=>wn(t,Object),Qt=Ae("array"),Le=Ve(null),Sn=Go("boolean"),tt=Ve(void 0),Ht=t=>t==null,q=t=>!Ht(t),jt=Go("function"),Ce=Go("number"),$e=(t,e)=>{if(Qt(t)){for(let n=0,o=t.length;n<o;++n)if(!e(t[n]))return!1;return!0}return!1},Dt=()=>{},qe=(t,e)=>(...n)=>t(e.apply(null,n)),Eo=(t,e)=>n=>t(e(n)),it=t=>()=>t,Zt=t=>t,On=(t,e)=>t===e;function ft(t,...e){return(...n)=>{const o=e.concat(n);return t.apply(null,o)}}const De=t=>e=>!t(e),He=t=>()=>{throw new Error(t)},go=t=>t(),Gn=t=>{t()},te=it(!1),ae=it(!0);class x{constructor(e,n){this.tag=e,this.value=n}static some(e){return new x(!0,e)}static none(){return x.singletonNone}fold(e,n){return this.tag?n(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?x.some(e(this.value)):x.none()}bind(e){return this.tag?e(this.value):x.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:x.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(e){return q(e)?x.some(e):x.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}x.singletonNone=new x(!1);const jn=Array.prototype.slice,vr=Array.prototype.indexOf,_o=Array.prototype.push,Xs=(t,e)=>vr.call(t,e),Xt=(t,e)=>Xs(t,e)>-1,de=(t,e)=>{for(let n=0,o=t.length;n<o;n++)if(e(t[n],n))return!0;return!1},qt=(t,e)=>{const n=t.length,o=new Array(n);for(let r=0;r<n;r++){const s=t[r];o[r]=e(s,r)}return o},J=(t,e)=>{for(let n=0,o=t.length;n<o;n++)e(t[n],n)},mn=(t,e)=>{for(let n=t.length-1;n>=0;n--)e(t[n],n)},Yo=(t,e)=>{const n=[],o=[];for(let r=0,s=t.length;r<s;r++){const a=t[r];(e(a,r)?n:o).push(a)}return{pass:n,fail:o}},Ot=(t,e)=>{const n=[];for(let o=0,r=t.length;o<r;o++){const s=t[o];e(s,o)&&n.push(s)}return n},yr=(t,e,n)=>(mn(t,(o,r)=>{n=e(n,o,r)}),n),en=(t,e,n)=>(J(t,(o,r)=>{n=e(n,o,r)}),n),Xo=(t,e,n)=>{for(let o=0,r=t.length;o<r;o++){const s=t[o];if(e(s,o))return x.some(s);if(n(s,o))break}return x.none()},Te=(t,e)=>Xo(t,e,te),oe=(t,e)=>{for(let n=0,o=t.length;n<o;n++)if(e(t[n],n))return x.some(n);return x.none()},zr=t=>{const e=[];for(let n=0,o=t.length;n<o;++n){if(!Qt(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);_o.apply(e,t[n])}return e},Qe=(t,e)=>zr(qt(t,e)),kn=(t,e)=>{for(let n=0,o=t.length;n<o;++n)if(e(t[n],n)!==!0)return!1;return!0},No=t=>{const e=jn.call(t,0);return e.reverse(),e},Qo=(t,e)=>Ot(t,n=>!Xt(e,n)),$r=(t,e)=>{const n={};for(let o=0,r=t.length;o<r;o++){const s=t[o];n[String(s)]=e(s,o)}return n},Yn=(t,e)=>{const n=jn.call(t,0);return n.sort(e),n},fo=(t,e)=>e>=0&&e<t.length?x.some(t[e]):x.none(),We=t=>fo(t,0),Bn=t=>fo(t,t.length-1),Oe=jt(Array.from)?Array.from:t=>jn.call(t),Xn=(t,e)=>{for(let n=0;n<t.length;n++){const o=e(t[n],n);if(o.isSome())return o}return x.none()},Qn=(t,e)=>{const n=[],o=jt(e)?r=>de(n,s=>e(s,r)):r=>Xt(n,r);for(let r=0,s=t.length;r<s;r++){const a=t[r];o(a)||n.push(a)}return n},je=Object.keys,Cr=Object.hasOwnProperty,re=(t,e)=>{const n=je(t);for(let o=0,r=n.length;o<r;o++){const s=n[o];e(t[s],s)}},Zo=(t,e)=>nn(t,(n,o)=>({k:o,v:e(n,o)})),nn=(t,e)=>{const n={};return re(t,(o,r)=>{const s=e(o,r);n[s.k]=s.v}),n},Jo=t=>(e,n)=>{t[n]=e},bs=(t,e,n,o)=>{re(t,(r,s)=>{(e(r,s)?n:o)(r,s)})},Ao=(t,e)=>{const n={};return bs(t,e,Jo(n),Dt),n},xn=(t,e)=>{const n=[];return re(t,(o,r)=>{n.push(e(o,r))}),n},Hr=t=>xn(t,Zt),ee=(t,e)=>Bt(t,e)?x.from(t[e]):x.none(),Bt=(t,e)=>Cr.call(t,e),Ro=(t,e)=>Bt(t,e)&&t[e]!==void 0&&t[e]!==null,wr=t=>{const e={};return J(t,n=>{e[n]={}}),je(e)},Sr=t=>t.length!==void 0,jr=Array.isArray,tr=(t,e,n)=>{if(!t)return!1;if(n=n||t,Sr(t)){for(let o=0,r=t.length;o<r;o++)if(e.call(n,t[o],o,t)===!1)return!1}else for(const o in t)if(Bt(t,o)&&e.call(n,t[o],o,t)===!1)return!1;return!0},To=(t,e)=>{const n=[];return tr(t,(o,r)=>{n.push(e(o,r,t))}),n},er=(t,e)=>{const n=[];return tr(t,(o,r)=>{e&&!e(o,r,t)||n.push(o)}),n},nr=(t,e,n,o)=>{let r=tt(n)?t[0]:n;for(let s=0;s<t.length;s++)r=e.call(o,r,t[s],s);return r},or=(t,e,n)=>{for(let o=0,r=t.length;o<r;o++)if(e.call(n,t[o],o,t))return o;return-1},Vn=t=>t[t.length-1],ln=t=>{let e,n=!1;return(...o)=>(n||(n=!0,e=t.apply(null,o)),e)},vs=()=>ys(0,0),ys=(t,e)=>({major:t,minor:e}),Vr={nu:ys,detect:(t,e)=>{const n=String(e).toLowerCase();return t.length===0?vs():((o,r)=>{const s=((i,l)=>{for(let c=0;c<i.length;c++){const d=i[c];if(d.test(l))return d}})(o,r);if(!s)return{major:0,minor:0};const a=i=>Number(r.replace(s,"$"+i));return ys(a(1),a(2))})(t,n)},unknown:vs},gn=(t,e)=>{const n=String(e).toLowerCase();return Te(t,o=>o.search(n))},Qs=(t,e,n)=>e===""||t.length>=e.length&&t.substr(n,n+e.length)===e,qr=(t,e)=>ie(t,e)?((n,o)=>n.substring(o))(t,e.length):t,Pe=(t,e,n=0,o)=>{const r=t.indexOf(e,n);return r!==-1&&(!!tt(o)||r+e.length<=o)},ie=(t,e)=>Qs(t,e,0),Zn=(t,e)=>Qs(t,e,t.length-e.length),Cs=t=>e=>e.replace(t,""),fn=Cs(/^\s+|\s+$/g),ws=Cs(/^\s+/g),po=Cs(/\s+$/g),cn=t=>t.length>0,rr=t=>!cn(t),Oo=(t,e=10)=>{const n=parseInt(t,e);return isNaN(n)?x.none():x.some(n)},Ss=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Jn=t=>e=>Pe(e,t),Zs=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>Pe(t,"edge/")&&Pe(t,"chrome")&&Pe(t,"safari")&&Pe(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ss],search:t=>Pe(t,"chrome")&&!Pe(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>Pe(t,"msie")||Pe(t,"trident")},{name:"Opera",versionRegexes:[Ss,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Jn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Jn("firefox")},{name:"Safari",versionRegexes:[Ss,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(Pe(t,"safari")||Pe(t,"mobile/"))&&Pe(t,"applewebkit")}],Aa=[{name:"Windows",search:Jn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>Pe(t,"iphone")||Pe(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Jn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Jn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Jn("linux"),versionRegexes:[]},{name:"Solaris",search:Jn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Jn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Jn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Js={browsers:it(Zs),oses:it(Aa)},Ra="Edge",Ta="Chromium",Wr="Opera",sr="Firefox",ks="Safari",ta=t=>{const e=t.current,n=t.version,o=r=>()=>e===r;return{current:e,version:n,isEdge:o(Ra),isChromium:o(Ta),isIE:o("IE"),isOpera:o(Wr),isFirefox:o(sr),isSafari:o(ks)}},ea=()=>ta({current:void 0,version:Vr.unknown()}),kr=ta,xr=(it(Ra),it(Ta),it("IE"),it(Wr),it(sr),it(ks),"Windows"),Ln="Android",xs="Linux",ar="macOS",En="Solaris",Er="FreeBSD",Fe="ChromeOS",Oa=t=>{const e=t.current,n=t.version,o=r=>()=>e===r;return{current:e,version:n,isWindows:o(xr),isiOS:o("iOS"),isAndroid:o(Ln),isMacOS:o(ar),isLinux:o(xs),isSolaris:o(En),isFreeBSD:o(Er),isChromeOS:o(Fe)}},na=()=>Oa({current:void 0,version:Vr.unknown()}),Kr=Oa,oa=(it(xr),it("iOS"),it(Ln),it(xs),it(ar),it(En),it(Er),it(Fe),t=>window.matchMedia(t).matches);let vi=ln(()=>((t,e,n)=>{const o=Js.browsers(),r=Js.oses(),s=e.bind(l=>((c,d)=>Xn(d.brands,u=>{const m=u.brand.toLowerCase();return Te(c,h=>{var f;return m===((f=h.brand)===null||f===void 0?void 0:f.toLowerCase())}).map(h=>({current:h.name,version:Vr.nu(parseInt(u.version,10),0)}))}))(o,l)).orThunk(()=>((l,c)=>gn(l,c).map(d=>{const u=Vr.detect(d.versionRegexes,c);return{current:d.name,version:u}}))(o,t)).fold(ea,kr),a=((l,c)=>gn(l,c).map(d=>{const u=Vr.detect(d.versionRegexes,c);return{current:d.name,version:u}}))(r,t).fold(na,Kr),i=((l,c,d,u)=>{const m=l.isiOS()&&/ipad/i.test(d)===!0,h=l.isiOS()&&!m,f=l.isiOS()||l.isAndroid(),b=f||u("(pointer:coarse)"),p=m||!h&&f&&u("(min-device-width:768px)"),y=h||f&&!p,w=c.isSafari()&&l.isiOS()&&/safari/i.test(d)===!1,S=!y&&!p&&!w;return{isiPad:it(m),isiPhone:it(h),isTablet:it(p),isPhone:it(y),isTouch:it(b),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:it(w),isDesktop:it(S)}})(a,s,t,n);return{browser:s,os:a,deviceType:i}})(window.navigator.userAgent,x.from(window.navigator.userAgentData),oa));const Ke=()=>vi(),yi=window.navigator.userAgent,_r=Ke(),_n=_r.browser,Dn=_r.os,ho=_r.deviceType,Bo=yi.indexOf("Windows Phone")!==-1,Kt={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:_n.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!_n.isIE(),windowsPhone:Bo,browser:{current:_n.current,version:_n.version,isChromium:_n.isChromium,isEdge:_n.isEdge,isFirefox:_n.isFirefox,isIE:_n.isIE,isOpera:_n.isOpera,isSafari:_n.isSafari},os:{current:Dn.current,version:Dn.version,isAndroid:Dn.isAndroid,isChromeOS:Dn.isChromeOS,isFreeBSD:Dn.isFreeBSD,isiOS:Dn.isiOS,isLinux:Dn.isLinux,isMacOS:Dn.isMacOS,isSolaris:Dn.isSolaris,isWindows:Dn.isWindows},deviceType:{isDesktop:ho.isDesktop,isiPad:ho.isiPad,isiPhone:ho.isiPhone,isPhone:ho.isPhone,isTablet:ho.isTablet,isTouch:ho.isTouch,isWebView:ho.isWebView}},Es=/^\s*|\s*$/g,Gr=t=>Ht(t)?"":(""+t).replace(Es,""),ra=function(t,e,n,o){o=o||this,t&&(n&&(t=t[n]),tr(t,(r,s)=>e.call(o,r,s,n)!==!1&&(ra(r,e,n,o),!0)))},st={trim:Gr,isArray:jr,is:(t,e)=>e?!(e!=="array"||!jr(t))||typeof t===e:t!==void 0,toArray:t=>{if(jr(t))return t;{const e=[];for(let n=0,o=t.length;n<o;n++)e[n]=t[n];return e}},makeMap:(t,e,n={})=>{const o=vt(t)?t.split(e||","):t||[];let r=o.length;for(;r--;)n[o[r]]={};return n},each:tr,map:To,grep:er,inArray:(t,e)=>{if(t){for(let n=0,o=t.length;n<o;n++)if(t[n]===e)return n}return-1},hasOwn:Bt,extend:(t,...e)=>{for(let n=0;n<e.length;n++){const o=e[n];for(const r in o)if(Bt(o,r)){const s=o[r];s!==void 0&&(t[r]=s)}}return t},walk:ra,resolve:(t,e=window)=>{const n=t.split(".");for(let o=0,r=n.length;o<r&&(e=e[n[o]]);o++);return e},explode:(t,e)=>Qt(t)?t:t===""?[]:To(t.split(e||","),Gr),_addCacheSuffix:t=>{const e=Kt.cacheSuffix;return e&&(t+=(t.indexOf("?")===-1?"?":"&")+e),t}},bo=(t,e,n=On)=>t.exists(o=>n(o,e)),Yr=(t,e,n=On)=>ke(t,e,n).getOr(t.isNone()&&e.isNone()),ke=(t,e,n)=>t.isSome()&&e.isSome()?x.some(n(t.getOrDie(),e.getOrDie())):x.none(),Lo=(t,e)=>t?x.some(e):x.none(),_s=typeof window<"u"?window:Function("return this;")(),Nr=(t,e)=>((n,o)=>{let r=o??_s;for(let s=0;s<n.length&&r!=null;++s)r=r[n[s]];return r})(t.split("."),e),Ba=Object.getPrototypeOf,Xr=t=>{const e=Nr("ownerDocument.defaultView",t);return Re(t)&&((n=>((o,r)=>{const s=((a,i)=>Nr(a,i))(o,r);if(s==null)throw new Error(o+" not available on this browser");return s})("HTMLElement",n))(e).prototype.isPrototypeOf(t)||/^HTML\w*Element$/.test(Ba(t).constructor.name))},Gt=t=>t.dom.nodeName.toLowerCase(),Ns=t=>t.dom.nodeType,Do=t=>e=>Ns(e)===t,ir=t=>on(t)&&Xr(t.dom),on=Do(1),Be=Do(3),_=Do(9),T=Do(11),j=t=>e=>on(e)&&Gt(e)===t,Z=(t,e,n)=>{if(!(vt(n)||Sn(n)||Ce(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},et=(t,e,n)=>{Z(t.dom,e,n)},mt=(t,e)=>{const n=t.dom;re(e,(o,r)=>{Z(n,r,o)})},Pt=(t,e)=>{const n=t.dom.getAttribute(e);return n===null?void 0:n},se=(t,e)=>x.from(Pt(t,e)),Yt=(t,e)=>{const n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},C=(t,e)=>{t.dom.removeAttribute(e)},A=t=>en(t.dom.attributes,(e,n)=>(e[n.name]=n.value,e),{}),L=(t,e)=>{const n=Pt(t,e);return n===void 0||n===""?[]:n.split(" ")},K=t=>t.dom.classList!==void 0,bt=t=>L(t,"class"),Wt=(t,e)=>((n,o,r)=>{const s=L(n,o).concat([r]);return et(n,o,s.join(" ")),!0})(t,"class",e),be=(t,e)=>((n,o,r)=>{const s=Ot(L(n,o),a=>a!==r);return s.length>0?et(n,o,s.join(" ")):C(n,o),!1})(t,"class",e),Ue=(t,e)=>{K(t)?t.dom.classList.add(e):Wt(t,e)},vo=t=>{(K(t)?t.dom.classList:bt(t)).length===0&&C(t,"class")},to=(t,e)=>{K(t)?t.dom.classList.remove(e):be(t,e),vo(t)},Ze=(t,e)=>K(t)&&t.dom.classList.contains(e),yo=t=>{if(t==null)throw new Error("Node cannot be null or undefined");return{dom:t}},As=(t,e)=>{const n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,t),new Error(o)}return yo(n.childNodes[0])},xe=(t,e)=>{const n=(e||document).createElement(t);return yo(n)},Rs=(t,e)=>{const n=(e||document).createTextNode(t);return yo(n)},F=yo,Po=(t,e,n)=>x.from(t.dom.elementFromPoint(e,n)).map(yo),Ci=(t,e)=>{const n=[],o=s=>(n.push(s),e(s));let r=e(t);do r=r.bind(o);while(r.isSome());return n},eo=(t,e)=>{const n=t.dom;if(n.nodeType!==1)return!1;{const o=n;if(o.matches!==void 0)return o.matches(e);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(e);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(e);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}},Kc=t=>t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11||t.childElementCount===0,ne=(t,e)=>t.dom===e.dom,Pn=(t,e)=>{const n=t.dom,o=e.dom;return n!==o&&n.contains(o)},Gc=t=>F(t.dom.ownerDocument),Ar=t=>_(t)?t:Gc(t),La=t=>F(Ar(t).dom.defaultView),pn=t=>x.from(t.dom.parentNode).map(F),Da=t=>x.from(t.dom.parentElement).map(F),Yc=(t,e)=>{const n=jt(e)?e:te;let o=t.dom;const r=[];for(;o.parentNode!==null&&o.parentNode!==void 0;){const s=o.parentNode,a=F(s);if(r.push(a),n(a)===!0)break;o=s}return r},Rr=t=>x.from(t.dom.previousSibling).map(F),Pa=t=>x.from(t.dom.nextSibling).map(F),Xc=t=>No(Ci(t,Rr)),Qc=t=>Ci(t,Pa),rn=t=>qt(t.dom.childNodes,F),sa=(t,e)=>{const n=t.dom.childNodes;return x.from(n[e]).map(F)},fl=t=>sa(t,0),pl=t=>sa(t,t.dom.childNodes.length-1),hl=t=>t.dom.childNodes.length,bl=t=>T(t)&&q(t.dom.host),Qr=t=>F(t.dom.getRootNode()),vl=t=>bl(t)?t:(e=>{const n=e.dom.head;if(n==null)throw new Error("Head is not available yet");return F(n)})(Ar(t)),am=t=>F(t.dom.host),yl=t=>{if(q(t.target)){const e=F(t.target);if(on(e)&&im(e)&&t.composed&&t.composedPath){const n=t.composedPath();if(n)return We(n)}}return x.from(t.target)},im=t=>q(t.dom.shadowRoot),aa=t=>{const e=Be(t)?t.dom.parentNode:t.dom;if(e==null||e.ownerDocument===null)return!1;const n=e.ownerDocument;return(o=>{const r=Qr(o);return bl(r)?x.some(r):x.none()})(F(e)).fold(()=>n.body.contains(e),Eo(aa,am))};var Zc=(t,e,n,o,r)=>t(n,o)?x.some(n):jt(r)&&r(n)?x.none():e(n,o,r);const Tr=(t,e,n)=>{let o=t.dom;const r=jt(n)?n:te;for(;o.parentNode;){o=o.parentNode;const s=F(o);if(e(s))return x.some(s);if(r(s))break}return x.none()},Zr=(t,e,n)=>Zc((o,r)=>r(o),Tr,t,e,n),Cl=(t,e)=>{const n=o=>{for(let r=0;r<o.childNodes.length;r++){const s=F(o.childNodes[r]);if(e(s))return x.some(s);const a=n(o.childNodes[r]);if(a.isSome())return a}return x.none()};return n(t.dom)},ia=(t,e,n)=>Tr(t,o=>eo(o,e),n),wi=(t,e)=>((n,o)=>{const r=o===void 0?document:o.dom;return Kc(r)?x.none():x.from(r.querySelector(n)).map(F)})(e,t),Ts=(t,e,n)=>Zc((o,r)=>eo(o,r),ia,t,e,n),Jr=(t,e=!1)=>{return aa(t)?t.dom.isContentEditable:(n=t,Ts(n,"[contenteditable]")).fold(it(e),o=>Si(o)==="true");var n},Si=t=>t.dom.contentEditable,ki=(t,e)=>{t.dom.contentEditable=e?"true":"false"},Ia=t=>t.style!==void 0&&jt(t.style.getPropertyValue),Jc=(t,e,n)=>{if(!vt(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);Ia(t)&&t.style.setProperty(e,n)},td=(t,e,n)=>{const o=t.dom;Jc(o,e,n)},xi=(t,e)=>{const n=t.dom;re(e,(o,r)=>{Jc(n,r,o)})},lr=(t,e)=>{const n=t.dom,o=window.getComputedStyle(n).getPropertyValue(e);return o!==""||aa(t)?o:ed(n,e)},ed=(t,e)=>Ia(t)?t.style.getPropertyValue(e):"",Ei=(t,e)=>{const n=t.dom,o=ed(n,e);return x.from(o).filter(r=>r.length>0)},Ma=t=>{const e={},n=t.dom;if(Ia(n))for(let o=0;o<n.style.length;o++){const r=n.style.item(o);e[r]=n.style[r]}return e},wl=(t,e)=>{((n,o)=>{Ia(n)&&n.style.removeProperty(o)})(t.dom,e),bo(se(t,"style").map(fn),"")&&C(t,"style")},hn=(t,e)=>{pn(t).each(n=>{n.dom.insertBefore(e.dom,t.dom)})},Co=(t,e)=>{Pa(t).fold(()=>{pn(t).each(n=>{Ie(n,e)})},n=>{hn(n,e)})},Sl=(t,e)=>{fl(t).fold(()=>{Ie(t,e)},n=>{t.dom.insertBefore(e.dom,n.dom)})},Ie=(t,e)=>{t.dom.appendChild(e.dom)},nd=(t,e)=>{hn(t,e),Ie(e,t)},Os=(t,e)=>{J(e,n=>{Ie(t,n)})},la=t=>{t.dom.textContent="",J(rn(t),e=>{le(e)})},le=t=>{const e=t.dom;e.parentNode!==null&&e.parentNode.removeChild(e)},no=t=>{const e=rn(t);var n,o;e.length>0&&(n=t,J(o=e,(r,s)=>{const a=s===0?n:o[s-1];Co(a,r)})),le(t)},ts=t=>qt(t,F),Bs=t=>t.dom.innerHTML,_i=(t,e)=>{const n=Gc(t).dom,o=F(n.createDocumentFragment()),r=((s,a)=>{const i=(a||document).createElement("div");return i.innerHTML=s,rn(F(i))})(e,n);Os(o,r),la(t),Ie(t,o)},od=(t,e,n,o)=>((r,s,a,i,l)=>{const c=((d,u)=>m=>{d(m)&&u((h=>{const f=F(yl(h).getOr(h.target)),b=()=>h.stopPropagation(),p=()=>h.preventDefault(),y=qe(p,b);return((w,S,N,E,R,I,D)=>({target:w,x:S,y:N,stop:E,prevent:R,kill:I,raw:D}))(f,h.clientX,h.clientY,b,p,y,h)})(m))})(a,i);return r.dom.addEventListener(s,c,l),{unbind:ft(lm,r,s,c,l)}})(t,e,n,o,!1),lm=(t,e,n,o)=>{t.dom.removeEventListener(e,n,o)},Ls=(t,e)=>({left:t,top:e,translate:(n,o)=>Ls(t+n,e+o)}),ca=Ls,Ds=(t,e)=>t!==void 0?t:e!==void 0?e:0,Fa=t=>{const e=t.dom,n=e.ownerDocument.body;return n===e?ca(n.offsetLeft,n.offsetTop):aa(t)?(o=>{const r=o.getBoundingClientRect();return ca(r.left,r.top)})(e):ca(0,0)},kl=t=>{const e=t!==void 0?t.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return ca(n,o)},rd=(t,e,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(t,e)},sd=(t,e)=>{Ke().browser.isSafari()&&jt(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(e)},Ni=(t,e,n,o)=>({x:t,y:e,width:n,height:o,right:t+n,bottom:e+o}),ad=t=>{const e=t===void 0?window:t,n=e.document,o=kl(F(n));return(r=>{const s=r===void 0?window:r;return Ke().browser.isFirefox()?x.none():x.from(s.visualViewport)})(e).fold(()=>{const r=e.document.documentElement,s=r.clientWidth,a=r.clientHeight;return Ni(o.left,o.top,s,a)},r=>Ni(Math.max(r.pageLeft,o.left),Math.max(r.pageTop,o.top),r.width,r.height))},id=(t,e)=>{let n=[];return J(rn(t),o=>{e(o)&&(n=n.concat([o])),n=n.concat(id(o,e))}),n},dn=(t,e)=>((n,o)=>{const r=o===void 0?document:o.dom;return Kc(r)?[]:qt(r.querySelectorAll(n),F)})(e,t),xl=(t,e,n)=>Tr(t,e,n).isSome(),El=(t,e)=>((n,o)=>{const r=n.dom;return r.parentNode?((s,a)=>Te(s.dom.childNodes,i=>a(F(i))).map(F))(F(r.parentNode),s=>!ne(n,s)&&o(s)):x.none()})(t,e).isSome(),_l=(t,e)=>Cl(t,e).isSome();class Ge{constructor(e,n){this.node=e,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,n,o,r){if(e){if(!r&&e[n])return e[n];if(e!==this.rootNode){let s=e[o];if(s)return s;for(let a=e.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(s=a[o],s)return s}}}findPreviousNode(e,n){if(e){const o=e.previousSibling;if(this.rootNode&&o===this.rootNode)return;if(o){if(!n){for(let s=o.lastChild;s;s=s.lastChild)if(!s.lastChild)return s}return o}const r=e.parentNode;if(r&&r!==this.rootNode)return r}}}const Ua="\uFEFF",ze="\xA0",Nl=t=>t===Ua,Al=/^[ \t\r\n]*$/,Ps=t=>Al.test(t),ld=t=>t===`
`||t==="\r",Rl=(t,e=4,n=!0,o=!0)=>{const r=((i,l)=>l<=0?"":new Array(l+1).join(" "))(0,e),s=t.replace(/\t/g,r);return en(s,(i,l)=>(c=>" \f	\v".indexOf(c)!==-1)(l)||l===ze?i.pcIsSpace||i.str===""&&n||i.str.length===s.length-1&&o||((c,d)=>d<c.length&&d>=0&&ld(c[d]))(s,i.str.length+1)?{pcIsSpace:!1,str:i.str+ze}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:ld(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},es=t=>e=>!!e&&e.nodeType===t,za=t=>!!t&&!Object.getPrototypeOf(t),wt=es(1),cr=t=>wt(t)&&ir(F(t)),da=t=>{const e=t.toLowerCase();return n=>q(n)&&n.nodeName.toLowerCase()===e},oo=t=>{const e=t.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const o=n.nodeName.toLowerCase();return Xt(e,o)}return!1}},Ai=(t,e)=>{const n=e.toLowerCase().split(" ");return o=>{if(wt(o)){const r=o.ownerDocument.defaultView;if(r)for(let s=0;s<n.length;s++){const a=r.getComputedStyle(o,null);if((a?a.getPropertyValue(t):null)===n[s])return!0}}return!1}},Is=t=>wt(t)&&t.hasAttribute("data-mce-bogus"),dr=t=>wt(t)&&t.tagName==="TABLE",cd=t=>e=>!!(cr(e)&&(e.contentEditable===t||e.getAttribute("data-mce-contenteditable")===t)),Tl=oo(["textarea","input"]),rt=es(3),cm=es(4),dd=es(7),ns=es(8),Ms=es(9),Ol=es(11),Ee=da("br"),ud=da("img"),ro=cd("true"),me=cd("false"),Bl=t=>cr(t)&&t.isContentEditable&&q(t.parentElement)&&!t.parentElement.isContentEditable,Ri=oo(["td","th"]),dm=oo(["td","th","caption"]),ur=oo(["video","audio","object","embed"]),um=da("li"),Ll=da("details"),mm=da("summary"),Ti={skipBogus:!0,includeZwsp:!1,checkRootAsContent:!1},md=t=>wt(t)&&t.hasAttribute("data-mce-bookmark"),gm=(t,e,n,o)=>rt(t)&&!((r,s,a)=>Ps(r.data)&&!((i,l,c)=>{const d=F(l),u=F(i),m=c.getWhitespaceElements();return xl(u,h=>Bt(m,Gt(h)),ft(ne,d))})(r,s,a))(t,e,n)&&(!o.includeZwsp||!(r=>{for(const s of r)if(!Nl(s))return!1;return!0})(t.data)),Dl=(t,e,n,o)=>jt(o.isContent)&&o.isContent(e)||((r,s)=>wt(r)&&Bt(s.getNonEmptyElements(),r.nodeName))(e,t)||md(e)||(r=>wt(r)&&r.nodeName==="A"&&!r.hasAttribute("href")&&(r.hasAttribute("name")||r.hasAttribute("id")))(e)||gm(e,n,t,o)||me(e)||ro(e)&&(r=>Da(F(r)).exists(s=>!Jr(s)))(e),mr=(t,e,n)=>{const o={...Ti,...n};if(o.checkRootAsContent&&Dl(t,e,e,o))return!1;let r=e.firstChild,s=0;if(!r)return!0;const a=new Ge(r,e);do{if(o.skipBogus&&wt(r)){const i=r.getAttribute("data-mce-bogus");if(i){r=a.next(i==="all");continue}}if(ns(r))r=a.next(!0);else if(Ee(r))s++,r=a.next();else{if(Dl(t,r,e,o))return!1;r=a.next()}}while(r);return s<=1},sn=(t,e,n)=>mr(t,e.dom,{checkRootAsContent:!0,...n}),gd=(t,e,n)=>Dl(t,e,e,{includeZwsp:Ti.includeZwsp,...n}),Ye=t=>{let e=t;return{get:()=>e,set:n=>{e=n}}},fm=t=>{const e=Ye(x.none()),n=()=>e.get().each(o=>clearInterval(o));return{clear:()=>{n(),e.set(x.none())},isSet:()=>e.get().isSome(),get:()=>e.get(),set:o=>{n(),e.set(x.some(setInterval(o,t)))}}},Or=()=>{const t=(e=>{const n=Ye(x.none()),o=()=>n.get().each(e);return{clear:()=>{o(),n.set(x.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:r=>{o(),n.set(x.some(r))}}})(Dt);return{...t,on:e=>t.get().each(e)}},Pl=t=>{const e=t.toLowerCase();return e==="svg"?"svg":e==="math"?"math":"html"},Fs=t=>Pl(t)!=="html",Il=t=>Fs(t.nodeName),fd=t=>Pl(t.nodeName),pm=["svg","math"],g="data-mce-block",v=t=>qt((e=>Ot(je(e),n=>!/[A-Z]/.test(n)))(t),e=>{const n=CSS.escape(e);return`${n}:`+qt(pm,o=>`not(${o} ${n})`).join(":")}).join(","),k=(t,e)=>q(e.querySelector(t))?(e.setAttribute(g,"true"),e.getAttribute("data-mce-selected")==="inline-boundary"&&e.removeAttribute("data-mce-selected"),!0):(e.removeAttribute(g),!1),O=(t,e)=>{const n=v(t.getTransparentElements()),o=v(t.getBlockElements());return Ot(e.querySelectorAll(n),r=>k(o,r))},M=(t,e,n)=>{var o;const r=n?"lastChild":"firstChild";for(let s=e[r];s;s=s[r])if(mr(t,s,{checkRootAsContent:!0}))return void((o=s.parentNode)===null||o===void 0||o.removeChild(s))},nt=(t,e,n)=>{const o=t.getBlockElements(),r=F(e),s=i=>Gt(i)in o,a=i=>ne(i,r);J(ts(n),i=>{Tr(i,s,a).each(l=>{const c=(d=>Ot(rn(d),u=>s(u)&&!t.isValidChild(Gt(l),Gt(u))))(i);if(c.length>0){const d=Da(l);J(c,u=>{Tr(u,s,a).each(m=>{((h,f,b)=>{const p=document.createRange(),y=f.parentNode;if(y){p.setStartBefore(f),p.setEndBefore(b);const w=p.extractContents();M(h,w,!0),p.setStartAfter(b),p.setEndAfter(f);const S=p.extractContents();M(h,S,!1),mr(h,w,{checkRootAsContent:!0})||y.insertBefore(w,f),mr(h,b,{checkRootAsContent:!0})||y.insertBefore(b,f),mr(h,S,{checkRootAsContent:!0})||y.insertBefore(S,f),y.removeChild(f)}})(t,m.dom,u.dom)})}),d.each(u=>O(t,u.dom))}})})},_t=(t,e)=>{const n=O(t,e);nt(t,e,n),((o,r,s)=>{J([...s,..._e(o,r)?[r]:[]],a=>J(dn(F(a),a.nodeName.toLowerCase()),i=>{os(o,i.dom)&&no(i)}))})(t,e,n)},$t=(t,e)=>{if(ve(t,e)){const n=v(t.getBlockElements());k(n,e)}},Mt=t=>t.hasAttribute(g),xt=(t,e)=>Bt(t.getTransparentElements(),e),ve=(t,e)=>wt(e)&&xt(t,e.nodeName),_e=(t,e)=>ve(t,e)&&Mt(e),os=(t,e)=>ve(t,e)&&!Mt(e),In=(t,e)=>e.type===1&&xt(t,e.name)&&vt(e.attr(g)),xE=Ke().browser,hh=t=>Te(t,on),bh=(t,e)=>t.children&&Xt(t.children,e),vh=(t,e={})=>{let n=0;const o={},r=F(t),s=Ar(r),a=u=>{Ie(vl(r),u)},i=u=>{const m=vl(r);wi(m,"#"+u).each(le)},l=u=>ee(o,u).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),c=u=>new Promise((m,h)=>{let f;const b=st._addCacheSuffix(u),p=l(b);o[b]=p,p.count++;const y=(E,R)=>{J(E,Gn),p.status=R,p.passed=[],p.failed=[],f&&(f.onload=null,f.onerror=null,f=null)},w=()=>y(p.passed,2),S=()=>y(p.failed,3);if(m&&p.passed.push(m),h&&p.failed.push(h),p.status===1)return;if(p.status===2)return void w();if(p.status===3)return void S();p.status=1;const N=xe("link",s.dom);mt(N,{rel:"stylesheet",type:"text/css",id:p.id}),e.contentCssCors&&et(N,"crossOrigin","anonymous"),e.referrerPolicy&&et(N,"referrerpolicy",e.referrerPolicy),f=N.dom,f.onload=w,f.onerror=S,a(N),et(N,"href",b)}),d=u=>{const m=st._addCacheSuffix(u);ee(o,m).each(h=>{--h.count==0&&(delete o[m],i(h.id))})};return{load:c,loadRawCss:(u,m)=>{const h=l(u);o[u]=h,h.count++;const f=xe("style",s.dom);mt(f,{rel:"stylesheet",type:"text/css",id:h.id,"data-mce-key":u}),f.dom.innerHTML=m,a(f)},loadAll:u=>Promise.allSettled(qt(u,m=>c(m).then(it(m)))).then(m=>{const h=Yo(m,f=>f.status==="fulfilled");return h.fail.length>0?Promise.reject(qt(h.fail,f=>f.reason)):qt(h.pass,f=>f.value)}),unload:d,unloadRawCss:u=>{ee(o,u).each(m=>{--m.count==0&&(delete o[u],i(m.id))})},unloadAll:u=>{J(u,m=>{d(m)})},_setReferrerPolicy:u=>{e.referrerPolicy=u},_setContentCssCors:u=>{e.contentCssCors=u}}},yh=(()=>{const t=new WeakMap;return{forElement:(e,n)=>{const o=Qr(e).dom;return x.from(t.get(o)).getOrThunk(()=>{const r=vh(o,n);return t.set(o,r),r})}}})(),Ch=(t,e)=>q(t)&&(gd(e,t)||e.isInline(t.nodeName.toLowerCase())),wh=t=>(e=>e.nodeName.toLowerCase()==="span")(t)&&t.getAttribute("data-mce-type")==="bookmark",hm=(t,e,n,o)=>{var r;const s=o||e;if(wt(e)&&wh(e))return e;const a=e.childNodes;for(let i=a.length-1;i>=0;i--)hm(t,a[i],n,s);if(wt(e)){const i=e.childNodes;i.length===1&&wh(i[0])&&((r=e.parentNode)===null||r===void 0||r.insertBefore(i[0],e))}return(i=>Ol(i)||Ms(i))(e)||gd(n,e)||(i=>!!wt(i)&&i.childNodes.length>0)(e)||((i,l,c)=>rt(i)&&i.data.length>0&&((d,u,m)=>{const h=new Ge(d,u).prev(!1),f=new Ge(d,u).next(!1),b=tt(h)||Ch(h,m),p=tt(f)||Ch(f,m);return b&&p})(i,l,c))(e,s,n)||t.remove(e),e},EE=st.makeMap,pd=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,hd=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_E=/[<>&\"\']/g,NE=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,AE={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"},$a={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},RE={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},Sh=(t,e)=>{const n={};if(t){const o=t.split(",");e=e||10;for(let r=0;r<o.length;r+=2){const s=String.fromCharCode(parseInt(o[r],e));if(!$a[s]){const a="&"+o[r+1]+";";n[s]=a,n[a]=s}}return n}},bm=Sh("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),kh=(t,e)=>t.replace(e?pd:hd,n=>$a[n]||n),xh=(t,e)=>t.replace(e?pd:hd,n=>n.length>1?"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";":$a[n]||"&#"+n.charCodeAt(0)+";"),vm=(t,e,n)=>{const o=n||bm;return t.replace(e?pd:hd,r=>$a[r]||o[r]||r)},Ha={encodeRaw:kh,encodeAllRaw:t=>(""+t).replace(_E,e=>$a[e]||e),encodeNumeric:xh,encodeNamed:vm,getEncodeFunc:(t,e)=>{const n=Sh(e)||bm,o=EE(t.replace(/\+/g,","));return o.named&&o.numeric?(r,s)=>r.replace(s?pd:hd,a=>$a[a]!==void 0?$a[a]:n[a]!==void 0?n[a]:a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":"&#"+a.charCodeAt(0)+";"):o.named?e?(r,s)=>vm(r,s,n):vm:o.numeric?xh:kh},decode:t=>t.replace(NE,(e,n)=>n?(n=n.charAt(0).toLowerCase()==="x"?parseInt(n.substr(1),16):parseInt(n,10))>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):AE[n]||String.fromCharCode(n):RE[e]||bm[e]||(o=>{const r=xe("div").dom;return r.innerHTML=o,r.textContent||r.innerText||o})(e))},bn=(t,e)=>(t=st.trim(t))?t.split(e||" "):[],Eh=t=>new RegExp("^"+t.replace(/([?+*])/g,".$1")+"$"),_h=t=>Object.freeze(["id","accesskey","class","dir","lang","style","tabindex","title","role",...t!=="html4"?["contenteditable","contextmenu","draggable","dropzone","hidden","spellcheck","translate","itemprop","itemscope","itemtype"]:[],...t!=="html5-strict"?["xml:lang"]:[]]),Nh=t=>{let e,n;e="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",t!=="html4"&&(e+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",n+=" audio canvas command data datalist mark meter output picture progress time wbr video ruby bdi keygen svg"),t!=="html5-strict"&&(n=[n,"acronym applet basefont big font strike tt"].join(" "),e=[e,"center dir isindex noframes"].join(" "));const o=[e,n].join(" ");return{blockContent:e,phrasingContent:n,flowContent:o}},ym=t=>{const{blockContent:e,phrasingContent:n,flowContent:o}=Nh(t),r=s=>Object.freeze(s.split(" "));return Object.freeze({blockContent:r(e),phrasingContent:r(n),flowContent:r(o)})},TE={html4:ln(()=>ym("html4")),html5:ln(()=>ym("html5")),"html5-strict":ln(()=>ym("html5-strict"))},Ah=(t,e)=>{const{blockContent:n,phrasingContent:o,flowContent:r}=TE[t]();return e==="blocks"?x.some(n):e==="phrasing"?x.some(o):e==="flow"?x.some(r):x.none()},Cm=t=>x.from(/^(@?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)$/.exec(t)).map(e=>({preset:e[1]==="@",name:e[2]})),bd={},Ml=st.makeMap,Br=st.each,Rh=st.extend,Th=st.explode,Oh=(t,e={})=>{const n=Ml(t," ",Ml(t.toUpperCase()," "));return Rh(n,e)},Bh=t=>Oh("td th li dt dd figcaption caption details summary",t.getTextBlockElements()),wm=(t,e)=>{if(t){const n={};return vt(t)&&(t={"*":t}),Br(t,(o,r)=>{n[r]=n[r.toUpperCase()]=e==="map"?Ml(o,/[, ]/):Th(o,/[, ]/)}),n}},ua=(t={})=>{var e;const n={},o={};let r=[];const s={},a={},i=(gt,Ut,Vt)=>{const It=t[gt];if(It)return Ml(It,/[, ]/,Ml(It.toUpperCase(),/[, ]/));{let Jt=bd[gt];return Jt||(Jt=Oh(Ut,Vt),bd[gt]=Jt),Jt}},l=(e=t.schema)!==null&&e!==void 0?e:"html5",c=(gt=>{const Ut=_h(gt),{phrasingContent:Vt,flowContent:It}=Nh(gt),Jt={},pe=(ge,fe,Me)=>{Jt[ge]={attributes:$r(fe,it({})),attributesOrder:fe,children:$r(Me,it({}))}},ut=(ge,fe="",Me="")=>{const un=bn(Me),Fr=bn(ge);let Rn=Fr.length;const Wo=[...Ut,...bn(fe)];for(;Rn--;)pe(Fr[Rn],Wo.slice(),un)},Tt=(ge,fe)=>{const Me=bn(ge),un=bn(fe);let Fr=Me.length;for(;Fr--;){const Rn=Jt[Me[Fr]];for(let Wo=0,tn=un.length;Wo<tn;Wo++)Rn.attributes[un[Wo]]={},Rn.attributesOrder.push(un[Wo])}};return gt!=="html5-strict"&&(J(bn("acronym applet basefont big font strike tt"),ge=>{ut(ge,"",Vt)}),J(bn("center dir isindex noframes"),ge=>{ut(ge,"",It)})),ut("html","manifest","head body"),ut("head","","base command link meta noscript script style title"),ut("title hr noscript br"),ut("base","href target"),ut("link","href rel media hreflang type sizes hreflang"),ut("meta","name http-equiv content charset"),ut("style","media type scoped"),ut("script","src async defer type charset"),ut("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",It),ut("dd div","",It),ut("address dt caption","",gt==="html4"?Vt:It),ut("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",Vt),ut("blockquote","cite",It),ut("ol","reversed start type","li"),ut("ul","","li"),ut("li","value",It),ut("dl","","dt dd"),ut("a","href target rel media hreflang type",gt==="html4"?Vt:It),ut("q","cite",Vt),ut("ins del","cite datetime",It),ut("img","src sizes srcset alt usemap ismap width height"),ut("iframe","src name width height",It),ut("embed","src type width height"),ut("object","data type typemustmatch name usemap form width height",[It,"param"].join(" ")),ut("param","name value"),ut("map","name",[It,"area"].join(" ")),ut("area","alt coords shape href target rel media hreflang type"),ut("table","border","caption colgroup thead tfoot tbody tr"+(gt==="html4"?" col":"")),ut("colgroup","span","col"),ut("col","span"),ut("tbody thead tfoot","","tr"),ut("tr","","td th"),ut("td","colspan rowspan headers",It),ut("th","colspan rowspan headers scope abbr",It),ut("form","accept-charset action autocomplete enctype method name novalidate target",It),ut("fieldset","disabled form name",[It,"legend"].join(" ")),ut("label","form for",Vt),ut("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),ut("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",gt==="html4"?It:Vt),ut("select","disabled form multiple name required size","option optgroup"),ut("optgroup","disabled label","option"),ut("option","disabled label selected value"),ut("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),ut("menu","type label",[It,"li"].join(" ")),ut("noscript","",It),gt!=="html4"&&(ut("wbr"),ut("ruby","",[Vt,"rt rp"].join(" ")),ut("figcaption","",It),ut("mark rt rp bdi","",Vt),ut("summary","",[Vt,"h1 h2 h3 h4 h5 h6"].join(" ")),ut("canvas","width height",It),ut("data","value",Vt),ut("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[It,"track source"].join(" ")),ut("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[It,"track source"].join(" ")),ut("picture","","img source"),ut("source","src srcset type media sizes"),ut("track","kind src srclang label default"),ut("datalist","",[Vt,"option"].join(" ")),ut("article section nav aside main header footer","",It),ut("hgroup","","h1 h2 h3 h4 h5 h6"),ut("figure","",[It,"figcaption"].join(" ")),ut("time","datetime",Vt),ut("dialog","open",It),ut("command","type label icon disabled checked radiogroup command"),ut("output","for form name",Vt),ut("progress","value max",Vt),ut("meter","value min max low high optimum",Vt),ut("details","open",[It,"summary"].join(" ")),ut("keygen","autofocus challenge disabled form keytype name"),pe("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),gt!=="html5-strict"&&(Tt("script","language xml:space"),Tt("style","xml:space"),Tt("object","declare classid code codebase codetype archive standby align border hspace vspace"),Tt("embed","align name hspace vspace"),Tt("param","valuetype type"),Tt("a","charset name rev shape coords"),Tt("br","clear"),Tt("applet","codebase archive code object alt name width height align hspace vspace"),Tt("img","name longdesc align border hspace vspace"),Tt("iframe","longdesc frameborder marginwidth marginheight scrolling align"),Tt("font basefont","size color face"),Tt("input","usemap align"),Tt("select"),Tt("textarea"),Tt("h1 h2 h3 h4 h5 h6 div p legend caption","align"),Tt("ul","type compact"),Tt("li","type"),Tt("ol dl menu dir","compact"),Tt("pre","width xml:space"),Tt("hr","align noshade size width"),Tt("isindex","prompt"),Tt("table","summary width frame rules cellspacing cellpadding align bgcolor"),Tt("col","width align char charoff valign"),Tt("colgroup","width align char charoff valign"),Tt("thead","align char charoff valign"),Tt("tr","align char charoff valign bgcolor"),Tt("th","axis align char charoff valign nowrap bgcolor width height"),Tt("form","accept"),Tt("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),Tt("tfoot","align char charoff valign"),Tt("tbody","align char charoff valign"),Tt("area","nohref"),Tt("body","background bgcolor text link vlink alink")),gt!=="html4"&&(Tt("input button select textarea","autofocus"),Tt("input textarea","placeholder"),Tt("a","download"),Tt("link script img","crossorigin"),Tt("img","loading"),Tt("iframe","sandbox seamless allow allowfullscreen loading referrerpolicy")),gt!=="html4"&&J([Jt.video,Jt.audio],ge=>{delete ge.children.audio,delete ge.children.video}),J(bn("a form meter progress dfn"),ge=>{Jt[ge]&&delete Jt[ge].children[ge]}),delete Jt.caption.children.table,delete Jt.script,Jt})(l);t.verify_html===!1&&(t.valid_elements="*[*]");const d=wm(t.valid_styles),u=wm(t.invalid_styles,"map"),m=wm(t.valid_classes,"map"),h=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),f=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),b=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),p=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",w=i("non_empty_elements",y+" pre svg textarea summary",b),S=i("move_caret_before_on_enter_elements",y+" table",b),N="h1 h2 h3 h4 h5 h6",E=i("text_block_elements",N+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),R=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",E),I=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),D=i("transparent_elements","a ins del canvas map"),$=i("wrap_block_elements","pre "+N);Br("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),gt=>{a[gt]=new RegExp("</"+gt+"[^>]*>","gi")});const W=gt=>{const Ut=x.from(n["@"]),Vt=/[*?+]/;J(((It,Jt)=>{const pe=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return Qe(bn(Jt,","),ut=>{const Tt=pe.exec(ut);if(Tt){const ge=Tt[1],fe=Tt[2],Me=Tt[3],un=Tt[4],Fr=Tt[5],Rn={attributes:{},attributesOrder:[]};if(It.each(Wo=>((tn,hi)=>{re(tn.attributes,(Ea,gs)=>{hi.attributes[gs]=Ea}),hi.attributesOrder.push(...tn.attributesOrder)})(Wo,Rn)),ge==="#"?Rn.paddEmpty=!0:ge==="-"&&(Rn.removeEmpty=!0),un==="!"&&(Rn.removeEmptyAttrs=!0),Fr&&((Wo,tn)=>{const hi=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,Ea=/[*?+]/,{attributes:gs,attributesOrder:Ko}=tn;J(bn(Wo,"|"),_a=>{const Ws=hi.exec(_a);if(Ws){const fs={},sm=Ws[1],co=Ws[2].replace(/[\\:]:/g,":"),Ks=Ws[3],bi=Ws[4];if(sm==="!"&&(tn.attributesRequired=tn.attributesRequired||[],tn.attributesRequired.push(co),fs.required=!0),sm==="-")return delete gs[co],void Ko.splice(st.inArray(Ko,co),1);if(Ks&&(Ks==="="?(tn.attributesDefault=tn.attributesDefault||[],tn.attributesDefault.push({name:co,value:bi}),fs.defaultValue=bi):Ks==="~"?(tn.attributesForced=tn.attributesForced||[],tn.attributesForced.push({name:co,value:bi}),fs.forcedValue=bi):Ks==="<"&&(fs.validValues=st.makeMap(bi,"?"))),Ea.test(co)){const Na=fs;tn.attributePatterns=tn.attributePatterns||[],Na.pattern=Eh(co),tn.attributePatterns.push(Na)}else gs[co]||Ko.push(co),gs[co]=fs}})})(Fr,Rn),Me&&(Rn.outputName=fe),fe==="@"){if(!It.isNone())return[];It=x.some(Rn)}return[Me?{name:fe,element:Rn,aliasName:Me}:{name:fe,element:Rn}]}return[]})})(Ut,gt??""),({name:It,element:Jt,aliasName:pe})=>{if(pe&&(n[pe]=Jt),Vt.test(It)){const ut=Jt;ut.pattern=Eh(It),r.push(ut)}else n[It]=Jt})},B=gt=>{r=[],J(je(n),Ut=>{delete n[Ut]}),W(gt)},P=(gt,Ut)=>{var Vt,It;delete bd.text_block_elements,delete bd.block_elements;const Jt=!!Ut.extends&&!we(Ut.extends),pe=Ut.extends;if(o[gt]=pe?o[pe]:{},s[gt]=pe??gt,w[gt.toUpperCase()]={},w[gt]={},Jt||(R[gt.toUpperCase()]={},R[gt]={}),pe&&!n[gt]&&n[pe]){const ut=(Tt=>{const ge=fe=>Qt(fe)?qt(fe,ge):(Me=>Re(Me)&&Me.source&&Object.prototype.toString.call(Me)==="[object RegExp]")(fe)?new RegExp(fe.source,fe.flags):Re(fe)?Zo(fe,ge):fe;return ge(Tt)})(n[pe]);delete ut.removeEmptyAttrs,delete ut.removeEmpty,n[gt]=ut}else n[gt]={attributesOrder:[],attributes:{}};if(Qt(Ut.attributes)){const ut=ge=>{Tt.attributesOrder.push(ge),Tt.attributes[ge]={}},Tt=(Vt=n[gt])!==null&&Vt!==void 0?Vt:{};delete Tt.attributesDefault,delete Tt.attributesForced,delete Tt.attributePatterns,delete Tt.attributesRequired,Tt.attributesOrder=[],Tt.attributes={},J(Ut.attributes,ge=>{const fe=_h(l);Cm(ge).each(({preset:Me,name:un})=>{Me?un==="global"&&J(fe,ut):ut(un)})}),n[gt]=Tt}if(Sn(Ut.padEmpty)){const ut=(It=n[gt])!==null&&It!==void 0?It:{};ut.paddEmpty=Ut.padEmpty,n[gt]=ut}if(Qt(Ut.children)){const ut={},Tt=fe=>{ut[fe]={}},ge=fe=>{Ah(l,fe).each(Me=>{J(Me,Tt)})};J(Ut.children,fe=>{Cm(fe).each(({preset:Me,name:un})=>{Me?ge(un):Tt(un)})}),o[gt]=ut}pe&&re(o,(ut,Tt)=>{ut[pe]&&(o[Tt]=ut=Rh({},o[Tt]),ut[gt]=ut[pe])})},z=gt=>{Re(gt)?re(gt,(Ut,Vt)=>P(Vt,Ut)):vt(gt)&&(Ut=>{J((Vt=>{const It=/^(~)?(.+)$/;return Qe(bn(Vt,","),Jt=>{const pe=It.exec(Jt);return pe?[{cloneName:pe[1]==="~"?"span":"div",name:pe[2]}]:[]})})(Ut??""),({name:Vt,cloneName:It})=>{P(Vt,{extends:It})})})(gt)},Q=gt=>{J((Ut=>{const Vt=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return Qe(bn(Ut,","),It=>{const Jt=Vt.exec(It);if(Jt){const pe=Jt[1];return[{operation:pe?(Tt=>Tt==="-"?"remove":"add")(pe):"replace",name:Jt[2],validChildren:Qe(bn(Jt[3],"|"),Tt=>Cm(Tt).toArray())}]}return[]})})(gt??""),({operation:Ut,name:Vt,validChildren:It})=>{const Jt=Ut==="replace"?{"#comment":{}}:o[Vt],pe=ut=>{Ut==="remove"?delete Jt[ut]:Jt[ut]={}};J(It,({preset:ut,name:Tt})=>{ut?(ge=>{Ah(l,ge).each(fe=>{J(fe,pe)})})(Tt):pe(Tt)}),o[Vt]=Jt})},at=gt=>{const Ut=n[gt];if(Ut)return Ut;let Vt=r.length;for(;Vt--;){const It=r[Vt];if(It.pattern.test(gt))return It}},ot=it(d),yt=it(u),St=it(m),kt=it(p),Nt=it(R),dt=it(E),Ct=it(I),U=it(Object.seal(b)),H=it(f),Y=it(w),G=it(S),ct=it(h),lt=it(D),Et=it($),At=it(Object.seal(a)),Ft=(gt,Ut)=>{const Vt=at(gt);if(Vt){if(!Ut)return!0;{if(Vt.attributes[Ut])return!0;const It=Vt.attributePatterns;if(It){let Jt=It.length;for(;Jt--;)if(It[Jt].pattern.test(Ut))return!0}}}return!1},we=gt=>Bt(Nt(),gt),Se=gt=>!ie(gt,"#")&&Ft(gt)&&!we(gt),ko=it(s);return t.valid_elements?(B(t.valid_elements),Br(c,(gt,Ut)=>{o[Ut]=gt.children})):(Br(c,(gt,Ut)=>{n[Ut]={attributes:gt.attributes,attributesOrder:gt.attributesOrder},o[Ut]=gt.children}),Br(bn("strong/b em/i"),gt=>{const Ut=bn(gt,"/");n[Ut[1]].outputName=Ut[0]}),Br(I,(gt,Ut)=>{n[Ut]&&(t.padd_empty_block_inline_children&&(n[Ut].paddInEmptyBlock=!0),n[Ut].removeEmpty=!0)}),Br(bn("ol ul blockquote a table tbody"),gt=>{n[gt]&&(n[gt].removeEmpty=!0)}),Br(bn("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),gt=>{n[gt]&&(n[gt].paddEmpty=!0)}),Br(bn("span"),gt=>{n[gt].removeEmptyAttrs=!0})),delete n.svg,z(t.custom_elements),Q(t.valid_children),W(t.extended_valid_elements),Q("+ol[ul|ol],+ul[ul|ol]"),Br({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(gt,Ut)=>{n[Ut]&&(n[Ut].parentsRequired=bn(gt))}),t.invalid_elements&&Br(Th(t.invalid_elements),gt=>{n[gt]&&delete n[gt]}),at("span")||W("span[!data-mce-type|*]"),{type:l,children:o,elements:n,getValidStyles:ot,getValidClasses:St,getBlockElements:Nt,getInvalidStyles:yt,getVoidElements:U,getTextBlockElements:dt,getTextInlineElements:Ct,getBoolAttrs:kt,getElementRule:at,getSelfClosingElements:H,getNonEmptyElements:Y,getMoveCaretBeforeOnEnterElements:G,getWhitespaceElements:ct,getTransparentElements:lt,getSpecialElements:At,isValidChild:(gt,Ut)=>{const Vt=o[gt.toLowerCase()];return!(!Vt||!Vt[Ut.toLowerCase()])},isValid:Ft,isBlock:we,isInline:Se,isWrapper:gt=>Bt(Et(),gt)||Se(gt),getCustomElements:ko,addValidElements:W,setValidElements:B,addCustomElements:z,addValidChildren:Q}},Sm=t=>{const e=t.toString(16);return(e.length===1?"0"+e:e).toUpperCase()},OE=t=>(e=>{return{value:(n=e,qr(n,"#").toUpperCase())};var n})(Sm(t.red)+Sm(t.green)+Sm(t.blue)),Lh=/^\s*rgb\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*\)\s*$/i,Dh=/^\s*rgba\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*((?:\d?\.\d+|\d+)%?)\s*\)\s*$/i,Ph=(t,e,n,o)=>((r,s,a,i)=>({red:r,green:s,blue:a,alpha:i}))(parseInt(t,10),parseInt(e,10),parseInt(n,10),parseFloat(o)),Ih=t=>{const e=Lh.exec(t);if(e!==null)return x.some(Ph(e[1],e[2],e[3],"1"));const n=Dh.exec(t);return n!==null?x.some(Ph(n[1],n[2],n[3],n[4])):x.none()},BE=t=>`rgba(${t.red},${t.green},${t.blue},${t.alpha})`,Fl=t=>Ih(t).map(OE).map(e=>"#"+e.value).getOr(t),km=(t={},e)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,o=/\s*([^:]+):\s*([^;]+);?/g,r=/\s+$/,s={};let a,i;const l=Ua;e&&(a=e.getValidStyles(),i=e.getInvalidStyles());const c=`\\" \\' \\; \\: ; : \uFEFF`.split(" ");for(let u=0;u<c.length;u++)s[c[u]]=l+u,s[l+u]=c[u];const d={parse:u=>{const m={};let h=!1;const f=t.url_converter,b=t.url_converter_scope||d,p=(B,P,z)=>{const Q=m[B+"-top"+P];if(!Q)return;const at=m[B+"-right"+P];if(!at)return;const ot=m[B+"-bottom"+P];if(!ot)return;const yt=m[B+"-left"+P];if(!yt)return;const St=[Q,at,ot,yt];let kt=St.length-1;for(;kt--&&St[kt]===St[kt+1];);kt>-1&&z||(m[B+P]=kt===-1?St[0]:St.join(" "),delete m[B+"-top"+P],delete m[B+"-right"+P],delete m[B+"-bottom"+P],delete m[B+"-left"+P])},y=B=>{const P=m[B];if(!P)return;const z=P.indexOf(",")>-1?[P]:P.split(" ");let Q=z.length;for(;Q--;)if(z[Q]!==z[0])return!1;return m[B]=z[0],!0},w=B=>(h=!0,s[B]),S=(B,P)=>(h&&(B=B.replace(/\uFEFF[0-9]/g,z=>s[z])),P||(B=B.replace(/\\([\'\";:])/g,"$1")),B),N=B=>String.fromCharCode(parseInt(B.slice(1),16)),E=B=>B.replace(/\\[0-9a-f]+/gi,N),R=(B,P,z,Q,at,ot)=>{if(at=at||ot)return"'"+(at=S(at)).replace(/\'/g,"\\'")+"'";if(P=S(P||z||Q||""),!t.allow_script_urls){const yt=P.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(yt)||!t.allow_svg_data_urls&&/^data:image\/svg/i.test(yt))return""}return f&&(P=f.call(b,P,"style")),"url('"+P.replace(/\'/g,"\\'")+"')"};if(u){let B;for(u=(u=u.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,w).replace(/\"[^\"]+\"|\'[^\']+\'/g,P=>P.replace(/[;:]/g,w));B=o.exec(u);){o.lastIndex=B.index+B[0].length;let P=B[1].replace(r,"").toLowerCase(),z=B[2].replace(r,"");if(P&&z){if(P=E(P),z=E(z),P.indexOf(l)!==-1||P.indexOf('"')!==-1||!t.allow_script_urls&&(P==="behavior"||/expression\s*\(|\/\*|\*\//.test(z)))continue;P==="font-weight"&&z==="700"?z="bold":P!=="color"&&P!=="background-color"||(z=z.toLowerCase()),W=z,(Lh.test(W)?"rgb":Dh.test(W)?"rgba":"other")=="rgb"&&Ih(z).each(Q=>{z=Fl(BE(Q)).toLowerCase()}),z=z.replace(n,R),m[P]=h?S(z,!0):z}}p("border","",!0),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),D="border-style",$="border-color",y(I="border-width")&&y(D)&&y($)&&(m.border=m[I]+" "+m[D]+" "+m[$],delete m[I],delete m[D],delete m[$]),m.border==="medium none"&&delete m.border,m["border-image"]==="none"&&delete m["border-image"]}var I,D,$,W;return m},serialize:(u,m)=>{let h="";const f=(b,p)=>{const y=p[b];if(y)for(let w=0,S=y.length;w<S;w++){const N=y[w],E=u[N];E&&(h+=(h.length>0?" ":"")+N+": "+E+";")}};return m&&a?(f("*",a),f(m,a)):re(u,(b,p)=>{b&&((y,w)=>{if(!i||!w)return!0;let S=i["*"];return!(S&&S[y]||(S=i[w],S&&S[y]))})(p,m)&&(h+=(h.length>0?" ":"")+p+": "+b+";")}),h}};return d},LE={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},Mh=(t,e)=>{const n=e??{};for(const o in t)Bt(LE,o)||(n[o]=t[o]);return q(t.composedPath)&&(n.composedPath=()=>t.composedPath()),q(t.getModifierState)&&(n.getModifierState=o=>t.getModifierState(o)),q(t.getTargetRanges)&&(n.getTargetRanges=()=>t.getTargetRanges()),n},xm=(t,e,n,o)=>{var r;const s=Mh(e,o);return s.type=t,Ht(s.target)&&(s.target=(r=s.srcElement)!==null&&r!==void 0?r:n),(a=>Ht(a.preventDefault)||(i=>i instanceof Event||jt(i.initEvent))(a))(e)&&(s.preventDefault=()=>{s.defaultPrevented=!0,s.isDefaultPrevented=ae,jt(e.preventDefault)&&e.preventDefault()},s.stopPropagation=()=>{s.cancelBubble=!0,s.isPropagationStopped=ae,jt(e.stopPropagation)&&e.stopPropagation()},s.stopImmediatePropagation=()=>{s.isImmediatePropagationStopped=ae,s.stopPropagation()},(a=>a.isDefaultPrevented===ae||a.isDefaultPrevented===te)(s)||(s.isDefaultPrevented=s.defaultPrevented===!0?ae:te,s.isPropagationStopped=s.cancelBubble===!0?ae:te,s.isImmediatePropagationStopped=te)),s},DE=/^(?:mouse|contextmenu)|click/,Em=(t,e,n,o)=>{t.addEventListener(e,n,o||!1)},vd=(t,e,n,o)=>{t.removeEventListener(e,n,o||!1)},Ul=(t,e)=>{const n=xm(t.type,t,document,e);if((o=>q(o)&&DE.test(o.type))(t)&&tt(t.pageX)&&!tt(t.clientX)){const o=n.target.ownerDocument||document,r=o.documentElement,s=o.body,a=n;a.pageX=t.clientX+(r&&r.scrollLeft||s&&s.scrollLeft||0)-(r&&r.clientLeft||s&&s.clientLeft||0),a.pageY=t.clientY+(r&&r.scrollTop||s&&s.scrollTop||0)-(r&&r.clientTop||s&&s.clientTop||0)}return n},PE=(t,e,n)=>{const o=t.document,r={type:"ready"};if(n.domLoaded)return void e(r);const s=()=>{vd(t,"DOMContentLoaded",s),vd(t,"load",s),n.domLoaded||(n.domLoaded=!0,e(r)),t=null};o.readyState==="complete"||o.readyState==="interactive"&&o.body?s():Em(t,"DOMContentLoaded",s),n.domLoaded||Em(t,"load",s)};class ja{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,n,o,r){const s=this;let a;const i=window,l=m=>{s.executeHandlers(Ul(m||i.event),c)};if(!e||rt(e)||ns(e))return o;let c;e[s.expando]?c=e[s.expando]:(c=s.count++,e[s.expando]=c,s.events[c]={}),r=r||e;const d=n.split(" ");let u=d.length;for(;u--;){let m=d[u],h=l,f=!1,b=!1;m==="DOMContentLoaded"&&(m="ready"),s.domLoaded&&m==="ready"&&e.readyState==="complete"?o.call(r,Ul({type:m})):(s.hasFocusIn||m!=="focusin"&&m!=="focusout"||(f=!0,b=m==="focusin"?"focus":"blur",h=p=>{const y=Ul(p||i.event);y.type=y.type==="focus"?"focusin":"focusout",s.executeHandlers(y,c)}),a=s.events[c][m],a?m==="ready"&&s.domLoaded?o(Ul({type:m})):a.push({func:o,scope:r}):(s.events[c][m]=a=[{func:o,scope:r}],a.fakeName=b,a.capture=f,a.nativeHandler=h,m==="ready"?PE(e,h,s):Em(e,b||m,h,f)))}return e=a=null,o}unbind(e,n,o){if(!e||rt(e)||ns(e))return this;const r=e[this.expando];if(r){let s=this.events[r];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=s[l];if(c){if(o){let d=c.length;for(;d--;)if(c[d].func===o){const u=c.nativeHandler,m=c.fakeName,h=c.capture,f=c.slice(0,d).concat(c.slice(d+1));f.nativeHandler=u,f.fakeName=m,f.capture=h,s[l]=f}}o&&c.length!==0||(delete s[l],vd(e,c.fakeName||l,c.nativeHandler,c.capture))}}}else re(s,(a,i)=>{vd(e,a.fakeName||i,a.nativeHandler,a.capture)}),s={};for(const a in s)if(Bt(s,a))return this;delete this.events[r];try{delete e[this.expando]}catch{e[this.expando]=null}}return this}fire(e,n,o){return this.dispatch(e,n,o)}dispatch(e,n,o){if(!e||rt(e)||ns(e))return this;const r=Ul({type:n,target:e},o);do{const s=e[this.expando];s&&this.executeHandlers(r,s),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!r.isPropagationStopped());return this}clean(e){if(!e||rt(e)||ns(e))return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName){this.unbind(e);const n=e.getElementsByTagName("*");let o=n.length;for(;o--;)(e=n[o])[this.expando]&&this.unbind(e)}return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,n){const o=this.events[n],r=o&&o[e.type];if(r)for(let s=0,a=r.length;s<a;s++){const i=r[s];if(i&&i.func.call(i.scope,e)===!1&&e.preventDefault(),e.isImmediatePropagationStopped())return}}}ja.Event=new ja;const _m=st.each,IE=st.grep,Nm="data-mce-style",ME=st.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),zl=(t,e,n)=>{Ht(n)||n===""?C(t,e):et(t,e,n)},Fh=t=>t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),Oi=(t,e)=>{let n=0;if(t)for(let o=t.nodeType,r=t.previousSibling;r;r=r.previousSibling){const s=r.nodeType;(!e||!rt(r)||s!==o&&r.data.length)&&(n++,o=s)}return n},Uh=(t,e)=>{const n=Pt(e,"style"),o=t.serialize(t.parse(n),Gt(e));zl(e,Nm,o)},zh=(t,e,n)=>{const o=Fh(e);Ht(n)||n===""?wl(t,o):td(t,o,((r,s)=>Ce(r)?Bt(ME,s)?r+"":r+"px":r)(n,o))},ye=(t,e={})=>{const n={},o=window,r={};let s=0;const a=yh.forElement(F(t),{contentCssCors:e.contentCssCors,referrerPolicy:e.referrerPolicy}),i=[],l=e.schema?e.schema:ua({}),c=km({url_converter:e.url_converter,url_converter_scope:e.url_converter_scope},e.schema),d=e.ownEvents?new ja:ja.Event,u=l.getBlockElements(),m=U=>U&&t&&vt(U)?t.getElementById(U):U,h=U=>{const H=m(U);return q(H)?F(H):null},f=(U,H,Y="")=>{let G;const ct=h(U);if(q(ct)&&on(ct)){const lt=Ct[H];G=lt&&lt.get?lt.get(ct.dom,H):Pt(ct,H)}return q(G)?G:Y},b=U=>{const H=m(U);return Ht(H)?[]:H.attributes},p=(U,H,Y)=>{D(U,G=>{if(wt(G)){const ct=F(G),lt=Y===""?null:Y,Et=Pt(ct,H),At=Ct[H];At&&At.set?At.set(ct.dom,lt,H):zl(ct,H,lt),Et!==lt&&e.onSetAttrib&&e.onSetAttrib({attrElm:ct.dom,attrName:H,attrValue:lt})}})},y=()=>e.root_element||t.body,w=(U,H)=>((Y,G,ct)=>{let lt=0,Et=0;const At=Y.ownerDocument;if(ct=ct||Y,G){if(ct===Y&&G.getBoundingClientRect&&lr(F(Y),"position")==="static"){const we=G.getBoundingClientRect();return lt=we.left+(At.documentElement.scrollLeft||Y.scrollLeft)-At.documentElement.clientLeft,Et=we.top+(At.documentElement.scrollTop||Y.scrollTop)-At.documentElement.clientTop,{x:lt,y:Et}}let Ft=G;for(;Ft&&Ft!==ct&&Ft.nodeType&&!bh(Ft,ct);){const we=Ft;lt+=we.offsetLeft||0,Et+=we.offsetTop||0,Ft=we.offsetParent}for(Ft=G.parentNode;Ft&&Ft!==ct&&Ft.nodeType&&!bh(Ft,ct);)lt-=Ft.scrollLeft||0,Et-=Ft.scrollTop||0,Ft=Ft.parentNode;Et+=(we=>xE.isFirefox()&&Gt(we)==="table"?hh(rn(we)).filter(Se=>Gt(Se)==="caption").bind(Se=>hh(Qc(Se)).map(ko=>{const gt=ko.dom.offsetTop,Ut=Se.dom.offsetTop,Vt=Se.dom.offsetHeight;return gt<=Ut?-Vt:0})).getOr(0):0)(F(G))}return{x:lt,y:Et}})(t.body,m(U),H),S=(U,H,Y)=>{const G=m(U);var ct;if(!Ht(G)&&(cr(G)||wt(ct=G)&&ct.namespaceURI==="http://www.w3.org/2000/svg"))return Y?lr(F(G),Fh(H)):((H=H.replace(/-(\D)/g,(lt,Et)=>Et.toUpperCase()))==="float"&&(H="cssFloat"),G.style?G.style[H]:void 0)},N=U=>{const H=m(U);if(!H)return{w:0,h:0};let Y=S(H,"width"),G=S(H,"height");return Y&&Y.indexOf("px")!==-1||(Y="0"),G&&G.indexOf("px")!==-1||(G="0"),{w:parseInt(Y,10)||H.offsetWidth||H.clientWidth,h:parseInt(G,10)||H.offsetHeight||H.clientHeight}},E=(U,H)=>{if(!U)return!1;const Y=Qt(U)?U:[U];return de(Y,G=>eo(F(G),H))},R=(U,H,Y,G)=>{const ct=[];let lt=m(U);G=G===void 0;const Et=Y||(y().nodeName!=="BODY"?y().parentNode:null);if(vt(H))if(H==="*")H=wt;else{const At=H;H=Ft=>E(Ft,At)}for(;lt&&!(lt===Et||Ht(lt.nodeType)||Ms(lt)||Ol(lt));){if(!H||H(lt)){if(!G)return[lt];ct.push(lt)}lt=lt.parentNode}return G?ct:null},I=(U,H,Y)=>{let G=H;if(U){vt(H)&&(G=ct=>E(ct,H));for(let ct=U[Y];ct;ct=ct[Y])if(jt(G)&&G(ct))return ct}return null},D=function(U,H,Y){const G=Y??this;if(Qt(U)){const ct=[];return _m(U,(lt,Et)=>{const At=m(lt);At&&ct.push(H.call(G,At,Et))}),ct}{const ct=m(U);return!!ct&&H.call(G,ct)}},$=(U,H)=>{D(U,Y=>{re(H,(G,ct)=>{p(Y,ct,G)})})},W=(U,H)=>{D(U,Y=>{const G=F(Y);_i(G,H)})},B=(U,H,Y,G,ct)=>D(U,lt=>{const Et=vt(H)?t.createElement(H):H;return q(Y)&&$(Et,Y),G&&(!vt(G)&&G.nodeType?Et.appendChild(G):vt(G)&&W(Et,G)),ct?Et:lt.appendChild(Et)}),P=(U,H,Y)=>B(t.createElement(U),U,H,Y,!0),z=Ha.encodeAllRaw,Q=(U,H)=>D(U,Y=>{const G=F(Y);return H&&J(rn(G),ct=>{Be(ct)&&ct.dom.length===0?le(ct):hn(G,ct)}),le(G),G.dom}),at=(U,H,Y)=>{D(U,G=>{if(wt(G)){const ct=F(G),lt=H.split(" ");J(lt,Et=>{q(Y)?(Y?Ue:to)(ct,Et):((At,Ft)=>{const we=K(At)?At.dom.classList.toggle(Ft):((Se,ko)=>Xt(bt(Se),ko)?be(Se,ko):Wt(Se,ko))(At,Ft);vo(At)})(ct,Et)})}})},ot=(U,H,Y)=>D(H,G=>{var ct;const lt=Qt(H)?U.cloneNode(!0):U;return Y&&_m(IE(G.childNodes),Et=>{lt.appendChild(Et)}),(ct=G.parentNode)===null||ct===void 0||ct.replaceChild(lt,G),G}),yt=()=>t.createRange(),St=(U,H,Y,G)=>{if(Qt(U)){let ct=U.length;const lt=[];for(;ct--;)lt[ct]=St(U[ct],H,Y,G);return lt}return!e.collect||U!==t&&U!==o||i.push([U,H,Y,G]),d.bind(U,H,Y,G||dt)},kt=(U,H,Y)=>{if(Qt(U)){let G=U.length;const ct=[];for(;G--;)ct[G]=kt(U[G],H,Y);return ct}if(i.length>0&&(U===t||U===o)){let G=i.length;for(;G--;){const[ct,lt,Et]=i[G];U!==ct||H&&H!==lt||Y&&Y!==Et||d.unbind(ct,lt,Et)}}return d.unbind(U,H,Y)},Nt=U=>{if(U&&cr(U)){const H=U.getAttribute("data-mce-contenteditable");return H&&H!=="inherit"?H:U.contentEditable!=="inherit"?U.contentEditable:null}return null},dt={doc:t,settings:e,win:o,files:r,stdMode:!0,boxModel:!0,styleSheetLoader:a,boundEvents:i,styles:c,schema:l,events:d,isBlock:U=>vt(U)?Bt(u,U):wt(U)&&(Bt(u,U.nodeName)||_e(l,U)),root:null,clone:(U,H)=>U.cloneNode(H),getRoot:y,getViewPort:U=>{const H=ad(U);return{x:H.x,y:H.y,w:H.width,h:H.height}},getRect:U=>{const H=m(U),Y=w(H),G=N(H);return{x:Y.x,y:Y.y,w:G.w,h:G.h}},getSize:N,getParent:(U,H,Y)=>{const G=R(U,H,Y,!1);return G&&G.length>0?G[0]:null},getParents:R,get:m,getNext:(U,H)=>I(U,H,"nextSibling"),getPrev:(U,H)=>I(U,H,"previousSibling"),select:(U,H)=>{var Y,G;const ct=(G=(Y=m(H))!==null&&Y!==void 0?Y:e.root_element)!==null&&G!==void 0?G:t;return jt(ct.querySelectorAll)?Oe(ct.querySelectorAll(U)):[]},is:E,add:B,create:P,createHTML:(U,H,Y="")=>{let G="<"+U;for(const ct in H)Ro(H,ct)&&(G+=" "+ct+'="'+z(H[ct])+'"');return rr(Y)&&Bt(l.getVoidElements(),U)?G+" />":G+">"+Y+"</"+U+">"},createFragment:U=>{const H=t.createElement("div"),Y=t.createDocumentFragment();let G;for(Y.appendChild(H),U&&(H.innerHTML=U);G=H.firstChild;)Y.appendChild(G);return Y.removeChild(H),Y},remove:Q,setStyle:(U,H,Y)=>{D(U,G=>{const ct=F(G);zh(ct,H,Y),e.update_styles&&Uh(c,ct)})},getStyle:S,setStyles:(U,H)=>{D(U,Y=>{const G=F(Y);re(H,(ct,lt)=>{zh(G,lt,ct)}),e.update_styles&&Uh(c,G)})},removeAllAttribs:U=>D(U,H=>{const Y=H.attributes;for(let G=Y.length-1;G>=0;G--)H.removeAttributeNode(Y.item(G))}),setAttrib:p,setAttribs:$,getAttrib:f,getPos:w,parseStyle:U=>c.parse(U),serializeStyle:(U,H)=>c.serialize(U,H),addStyle:U=>{if(dt!==ye.DOM&&t===document){if(n[U])return;n[U]=!0}let H=t.getElementById("mceDefaultStyles");if(!H){H=t.createElement("style"),H.id="mceDefaultStyles",H.type="text/css";const Y=t.head;Y.firstChild?Y.insertBefore(H,Y.firstChild):Y.appendChild(H)}H.styleSheet?H.styleSheet.cssText+=U:H.appendChild(t.createTextNode(U))},loadCSS:U=>{U||(U=""),J(U.split(","),H=>{r[H]=!0,a.load(H).catch(Dt)})},addClass:(U,H)=>{at(U,H,!0)},removeClass:(U,H)=>{at(U,H,!1)},hasClass:(U,H)=>{const Y=h(U),G=H.split(" ");return q(Y)&&kn(G,ct=>Ze(Y,ct))},toggleClass:at,show:U=>{D(U,H=>wl(F(H),"display"))},hide:U=>{D(U,H=>td(F(H),"display","none"))},isHidden:U=>{const H=h(U);return q(H)&&bo(Ei(H,"display"),"none")},uniqueId:U=>(U||"mce_")+s++,setHTML:W,getOuterHTML:U=>{const H=h(U);return q(H)?wt(H.dom)?H.dom.outerHTML:(Y=>{const G=xe("div"),ct=F(Y.dom.cloneNode(!0));return Ie(G,ct),Bs(G)})(H):""},setOuterHTML:(U,H)=>{D(U,Y=>{wt(Y)&&(Y.outerHTML=H)})},decode:Ha.decode,encode:z,insertAfter:(U,H)=>{const Y=m(H);return D(U,G=>{const ct=Y?.parentNode,lt=Y?.nextSibling;return ct&&(lt?ct.insertBefore(G,lt):ct.appendChild(G)),G})},replace:ot,rename:(U,H)=>{if(U.nodeName!==H.toUpperCase()){const Y=P(H);return _m(b(U),G=>{p(Y,G.nodeName,f(U,G.nodeName))}),ot(Y,U,!0),Y}return U},findCommonAncestor:(U,H)=>{let Y=U;for(;Y;){let G=H;for(;G&&Y!==G;)G=G.parentNode;if(Y===G)break;Y=Y.parentNode}return!Y&&U.ownerDocument?U.ownerDocument.documentElement:Y},run:D,getAttribs:b,isEmpty:(U,H,Y)=>Hn(H)?mr(l,U,{...Y,isContent:ct=>{const lt=ct.nodeName.toLowerCase();return!!H[lt]}}):mr(l,U,Y),createRng:yt,nodeIndex:Oi,split:(U,H,Y)=>{let G,ct,lt=yt();if(U&&H&&U.parentNode&&H.parentNode){const Et=U.parentNode;return lt.setStart(Et,Oi(U)),lt.setEnd(H.parentNode,Oi(H)),G=lt.extractContents(),lt=yt(),lt.setStart(H.parentNode,Oi(H)+1),lt.setEnd(Et,Oi(U)+1),ct=lt.extractContents(),Et.insertBefore(hm(dt,G,l),U),Y?Et.insertBefore(Y,U):Et.insertBefore(H,U),Et.insertBefore(hm(dt,ct,l),U),Q(U),Y||H}},bind:St,unbind:kt,fire:(U,H,Y)=>d.dispatch(U,H,Y),dispatch:(U,H,Y)=>d.dispatch(U,H,Y),getContentEditable:Nt,getContentEditableParent:U=>{const H=y();let Y=null;for(let G=U;G&&G!==H&&(Y=Nt(G),Y===null);G=G.parentNode);return Y},isEditable:U=>{if(q(U)){const H=wt(U)?U:U.parentElement;return q(H)&&cr(H)&&Jr(F(H))}return!1},destroy:()=>{if(i.length>0){let U=i.length;for(;U--;){const[H,Y,G]=i[U];d.unbind(H,Y,G)}}re(r,(U,H)=>{a.unload(H),delete r[H]})},isChildOf:(U,H)=>U===H||H.contains(U),dumpRng:U=>"startContainer: "+U.startContainer.nodeName+", startOffset: "+U.startOffset+", endContainer: "+U.endContainer.nodeName+", endOffset: "+U.endOffset},Ct=((U,H,Y)=>{const G=H.keep_values,ct={set:(Et,At,Ft)=>{const we=F(Et);jt(H.url_converter)&&q(At)&&(At=H.url_converter.call(H.url_converter_scope||Y(),String(At),Ft,Et)),zl(we,"data-mce-"+Ft,At),zl(we,Ft,At)},get:(Et,At)=>{const Ft=F(Et);return Pt(Ft,"data-mce-"+At)||Pt(Ft,At)}},lt={style:{set:(Et,At)=>{const Ft=F(Et);G&&zl(Ft,Nm,At),C(Ft,"style"),vt(At)&&xi(Ft,U.parse(At))},get:Et=>{const At=F(Et),Ft=Pt(At,Nm)||Pt(At,"style");return U.serialize(U.parse(Ft),Gt(At))}}};return G&&(lt.href=lt.src=ct),lt})(c,e,it(dt));return dt};ye.DOM=ye(document),ye.nodeIndex=Oi;const FE=ye.DOM;class Us{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise((n,o)=>{const r=FE;let s;const a=()=>{r.remove(i),s&&(s.onerror=s.onload=s=null)},i=r.uniqueId();s=document.createElement("script"),s.id=i,s.type="text/javascript",s.src=st._addCacheSuffix(e),this.settings.referrerPolicy&&r.setAttrib(s,"referrerpolicy",this.settings.referrerPolicy),s.onload=()=>{a(),n()},s.onerror=()=>{a(),o("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(s)})}isDone(e){return this.states[e]===2}markDone(e){this.states[e]=2}add(e){const n=this;return n.queue.push(e),n.states[e]===void 0&&(n.states[e]=0),new Promise((o,r)=>{n.scriptLoadedCallbacks[e]||(n.scriptLoadedCallbacks[e]=[]),n.scriptLoadedCallbacks[e].push({resolve:o,reject:r})})}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){const e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){const n=this,o=(l,c)=>{ee(n.scriptLoadedCallbacks,c).each(d=>{J(d,u=>u[l](c))}),delete n.scriptLoadedCallbacks[c]},r=l=>{const c=Ot(l,d=>d.status==="rejected");return c.length>0?Promise.reject(Qe(c,({reason:d})=>Qt(d)?d:[d])):Promise.resolve()},s=l=>Promise.allSettled(qt(l,c=>n.states[c]===2?(o("resolve",c),Promise.resolve()):n.states[c]===3?(o("reject",c),Promise.reject(c)):(n.states[c]=1,n.loadScript(c).then(()=>{n.states[c]=2,o("resolve",c);const d=n.queue;return d.length>0?(n.queue=[],s(d).then(r)):Promise.resolve()},()=>(n.states[c]=3,o("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,s(l).then(c=>{n.loading=!1;const d=n.queueLoadedCallbacks.shift();return x.from(d).each(Gn),r(c)})),i=wr(e);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}Us.ScriptLoader=new Us;const $l={},Am=Ye("en"),$h=()=>ee($l,Am.get()),Lr={getData:()=>Zo($l,t=>({...t})),setCode:t=>{t&&Am.set(t)},getCode:()=>Am.get(),add:(t,e)=>{let n=$l[t];n||($l[t]=n={});const o=qt(je(e),r=>r.toLowerCase());re(e,(r,s)=>{const a=s.toLowerCase();a!==s&&((i,l)=>{const c=i.indexOf(l);return c!==-1&&i.indexOf(l,c+1)>c})(o,a)?(Bt(e,a)||(n[a]=r),n[s]=r):n[a]=r})},translate:t=>{const e=$h().getOr({}),n=i=>jt(i)?Object.prototype.toString.call(i):o(i)?"":""+i,o=i=>i===""||i==null,r=i=>{const l=n(i);return Bt(e,l)?n(e[l]):ee(e,l.toLowerCase()).map(n).getOr(l)},s=i=>i.replace(/{context:\w+}$/,"");if(o(t))return"";if(Re(a=t)&&Bt(a,"raw"))return n(t.raw);var a;if((i=>Qt(i)&&i.length>1)(t)){const i=t.slice(1);return s(r(t[0]).replace(/\{([0-9]+)\}/g,(l,c)=>Bt(i,c)?n(i[c]):l))}return s(r(t))},isRtl:()=>$h().bind(t=>ee(t,"_dir")).exists(t=>t==="rtl"),hasCode:t=>Bt($l,t)},Mn=()=>{const t=[],e={},n={},o=[],r=(l,c)=>{const d=Ot(o,u=>u.name===l&&u.state===c);J(d,u=>u.resolve())},s=l=>Bt(e,l),a=(l,c)=>{const d=Lr.getCode();!d||c&&(","+(c||"")+",").indexOf(","+d+",")===-1||Us.ScriptLoader.add(e[l]+"/langs/"+d+".js")},i=(l,c="added")=>c==="added"&&(d=>Bt(n,d))(l)||c==="loaded"&&s(l)?Promise.resolve():new Promise(d=>{o.push({name:l,state:c,resolve:d})});return{items:t,urls:e,lookup:n,get:l=>{if(n[l])return n[l].instance},requireLangPack:(l,c)=>{Mn.languageLoad!==!1&&(s(l)?a(l,c):i(l,"loaded").then(()=>a(l,c)))},add:(l,c)=>(t.push(c),n[l]={instance:c},r(l,"added"),c),remove:l=>{delete e[l],delete n[l]},createUrl:(l,c)=>vt(c)?vt(l)?{prefix:"",resource:c,suffix:""}:{prefix:l.prefix,resource:c,suffix:l.suffix}:c,load:(l,c)=>{if(e[l])return Promise.resolve();let d=vt(c)?c:c.prefix+c.resource+c.suffix;d.indexOf("/")!==0&&d.indexOf("://")===-1&&(d=Mn.baseURL+"/"+d),e[l]=d.substring(0,d.lastIndexOf("/"));const u=()=>(r(l,"loaded"),Promise.resolve());return n[l]?u():Us.ScriptLoader.add(d).then(u)},waitFor:i}};Mn.languageLoad=!0,Mn.baseURL="",Mn.PluginManager=Mn(),Mn.ThemeManager=Mn(),Mn.ModelManager=Mn();const yd=(t,e)=>{let n=null;return{cancel:()=>{Le(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{Le(n)&&(n=setTimeout(()=>{n=null,t.apply(null,o)},e))}}},Rm=(t,e)=>{let n=null;const o=()=>{Le(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...r)=>{o(),n=setTimeout(()=>{n=null,t.apply(null,r)},e)}}},Hl=it("mce-annotation"),Va=it("data-mce-annotation"),Bi=it("data-mce-annotation-uid"),jl=it("data-mce-annotation-active"),Vl=it("data-mce-annotation-classes"),ql=it("data-mce-annotation-attrs"),Hh=t=>e=>ne(e,t),jh=(t,e)=>{const n=t.selection.getRng(),o=F(n.startContainer),r=F(t.getBody()),s=e.fold(()=>"."+Hl(),i=>`[${Va()}="${i}"]`),a=sa(o,n.startOffset).getOr(o);return Ts(a,s,Hh(r)).bind(i=>se(i,`${Bi()}`).bind(l=>se(i,`${Va()}`).map(c=>{const d=qh(t,l);return{uid:l,name:c,elements:d}})))},Vh=(t,e)=>Yt(t,"data-mce-bogus")||((n,o,r)=>ia(n,'[data-mce-bogus="all"]',r).isSome())(t,0,Hh(e)),qh=(t,e)=>{const n=F(t.getBody()),o=dn(n,`[${Bi()}="${e}"]`);return Ot(o,r=>!Vh(r,n))},Wh=(t,e)=>{const n=F(t.getBody()),o=dn(n,`[${Va()}="${e}"]`),r={};return J(o,s=>{if(!Vh(s,n)){const a=Pt(s,Bi()),i=ee(r,a).getOr([]);r[a]=i.concat([s])}}),r},Kh=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295;let Gh=0;const Wl=t=>{const e=new Date().getTime(),n=Math.floor(1e9*Kh());return Gh++,t+"_"+n+Gh+String(e)},Yh=(t,e)=>F(t.dom.cloneNode(e)),qa=t=>Yh(t,!1),Xh=t=>Yh(t,!0),Qh=(t,e,n=te)=>{const o=new Ge(t,e),r=s=>{let a;do a=o[s]();while(a&&!rt(a)&&!n(a));return x.from(a).filter(rt)};return{current:()=>x.from(o.current()).filter(rt),next:()=>r("next"),prev:()=>r("prev"),prev2:()=>r("prev2")}},Wa=(t,e)=>{const n=e||(r=>t.isBlock(r)||Ee(r)||me(r)),o=(r,s,a,i)=>{if(rt(r)){const l=i(r,s,r.data);if(l!==-1)return x.some({container:r,offset:l})}return a().bind(l=>o(l.container,l.offset,a,i))};return{backwards:(r,s,a,i)=>{const l=Qh(r,i??t.getRoot(),n);return o(r,s,()=>l.prev().map(c=>({container:c,offset:c.length})),a).getOrNull()},forwards:(r,s,a,i)=>{const l=Qh(r,i??t.getRoot(),n);return o(r,s,()=>l.next().map(c=>({container:c,offset:0})),a).getOrNull()}}},Tm=(t=>{const e=n=>t(n)?x.from(n.dom.nodeValue):x.none();return{get:n=>{if(!t(n))throw new Error("Can only get text value of a text node");return e(n).getOr("")},getOption:e,set:(n,o)=>{if(!t(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=o}}})(Be),Kl=t=>Tm.get(t),Zh=(t,e)=>Tm.set(t,e),Li=t=>{let e;return n=>(e=e||$r(t,ae),Bt(e,Gt(n)))},Ka=t=>on(t)&&Gt(t)==="br",Jh=Li(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Om=Li(["ul","ol","dl"]),Di=Li(["li","dd","dt"]),UE=Li(["thead","tbody","tfoot"]),Gl=Li(["td","th"]),Cd=Li(["pre","script","textarea","style"]),Pi=()=>{const t=xe("br");return et(t,"data-mce-bogus","1"),t},ma=t=>{la(t),Ie(t,Pi())},an=Ua,wd=Nl,wo=t=>t.replace(/\uFEFF/g,""),zE=wt,Ii=rt,Mi=t=>(Ii(t)&&(t=t.parentNode),zE(t)&&t.hasAttribute("data-mce-caret")),ga=t=>Ii(t)&&wd(t.data),Io=t=>Mi(t)||ga(t),tb=t=>t.firstChild!==t.lastChild||!Ee(t.firstChild),Bm=t=>{const e=t.container();return!!rt(e)&&(e.data.charAt(t.offset())===an||t.isAtStart()&&ga(e.previousSibling))},Lm=t=>{const e=t.container();return!!rt(e)&&(e.data.charAt(t.offset()-1)===an||t.isAtEnd()&&ga(e.nextSibling))},Sd=t=>Ii(t)&&t.data[0]===an,kd=t=>Ii(t)&&t.data[t.data.length-1]===an,Dm=t=>t&&t.hasAttribute("data-mce-caret")?((e=>{var n;const o=e.getElementsByTagName("br"),r=o[o.length-1];Is(r)&&((n=r.parentNode)===null||n===void 0||n.removeChild(r))})(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("data-mce-style"),t.removeAttribute("_moz_abspos"),t):null,eb=t=>Mi(t.startContainer),Fi=Math.round,Ga=t=>t?{left:Fi(t.left),top:Fi(t.top),bottom:Fi(t.bottom),right:Fi(t.right),width:Fi(t.width),height:Fi(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},nb=(t,e)=>(t=Ga(t),e||(t.left=t.left+t.width),t.right=t.left,t.width=0,t),ob=(t,e,n)=>t>=0&&t<=Math.min(e.height,n.height)/2,Yl=(t,e)=>{const n=Math.min(e.height/2,t.height/2);return t.bottom-n<e.top||!(t.top>e.bottom)&&ob(e.top-t.bottom,t,e)},Xl=(t,e)=>t.top>e.bottom||!(t.bottom<e.top)&&ob(e.bottom-t.top,t,e),rb=(t,e,n)=>{const o=Math.max(Math.min(e,t.left+t.width),t.left),r=Math.max(Math.min(n,t.top+t.height),t.top);return Math.sqrt((e-o)*(e-o)+(n-r)*(n-r))},xd=t=>{const e=t.startContainer,n=t.startOffset;return e===t.endContainer&&e.hasChildNodes()&&t.endOffset===n+1?e.childNodes[n]:null},fa=(t,e)=>{if(wt(t)&&t.hasChildNodes()){const n=t.childNodes,o=((r,s,a)=>Math.min(Math.max(r,0),a))(e,0,n.length-1);return n[o]}return t},$E=new RegExp("[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B57\u0B62-\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0D01\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62-\u0D63\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u20D0-\u20DC\u20DD-\u20E0\u20E1\u20E2-\u20E4\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u302E-\u302F\u3099-\u309A\uA66F\uA670-\uA672\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E-\uFF9F]"),sb=t=>vt(t)&&t.charCodeAt(0)>=768&&$E.test(t),ab=ro,HE=me,jE=Ee,VE=rt,qE=oo(["script","style","textarea"]),ib=oo(["img","input","textarea","hr","iframe","video","audio","object","embed"]),WE=oo(["table"]),KE=Io,Dr=t=>!KE(t)&&(VE(t)?!qE(t.parentNode):ib(t)||jE(t)||WE(t)||Pm(t)),Pm=t=>!(e=>wt(e)&&e.getAttribute("unselectable")==="true")(t)&&HE(t),lb=(t,e)=>Dr(t)&&((n,o)=>{for(let r=n.parentNode;r&&r!==o;r=r.parentNode){if(Pm(r))return!1;if(ab(r))return!0}return!0})(t,e),cb=wt,GE=Dr,db=Ai("display","block table"),YE=Ai("float","left right"),Ql=((...t)=>e=>{for(let n=0;n<t.length;n++)if(!t[n](e))return!1;return!0})(cb,GE,De(YE)),XE=De(Ai("white-space","pre pre-line pre-wrap")),Zl=rt,Im=Ee,ub=ye.nodeIndex,Ed=(t,e)=>e<0&&wt(t)&&t.hasChildNodes()?void 0:fa(t,e),Mm=t=>t?t.createRange():ye.DOM.createRng(),Fm=t=>vt(t)&&/[\r\n\t ]/.test(t),mb=t=>!!t.setStart&&!!t.setEnd,Um=t=>{const e=t.startContainer,n=t.startOffset;if(Fm(t.toString())&&XE(e.parentNode)&&rt(e)){const o=e.data;if(Fm(o[n-1])||Fm(o[n+1]))return!0}return!1},gb=t=>t.left===0&&t.right===0&&t.top===0&&t.bottom===0,pa=t=>{var e;let n;const o=t.getClientRects();return n=o.length>0?Ga(o[0]):Ga(t.getBoundingClientRect()),!mb(t)&&Im(t)&&gb(n)?(r=>{const s=r.ownerDocument,a=Mm(s),i=s.createTextNode(ze),l=r.parentNode;l.insertBefore(i,r),a.setStart(i,0),a.setEnd(i,1);const c=Ga(a.getBoundingClientRect());return l.removeChild(i),c})(t):gb(n)&&mb(t)&&(e=(r=>{const s=r.startContainer,a=r.endContainer,i=r.startOffset,l=r.endOffset;if(s===a&&rt(a)&&i===0&&l===1){const c=r.cloneRange();return c.setEndAfter(a),pa(c)}return null})(t))!==null&&e!==void 0?e:n},Ya=(t,e)=>{const n=nb(t,e);return n.width=1,n.right=n.left+1,n},X=(t,e,n)=>{const o=()=>(n||(n=(r=>{const s=[],a=d=>{var u,m;d.height!==0&&(s.length>0&&(u=d,m=s[s.length-1],u.left===m.left&&u.top===m.top&&u.bottom===m.bottom&&u.right===m.right)||s.push(d))},i=(d,u)=>{const m=Mm(d.ownerDocument);if(u<d.data.length){if(sb(d.data[u]))return;if(sb(d.data[u-1])&&(m.setStart(d,u),m.setEnd(d,u+1),!Um(m)))return void a(Ya(pa(m),!1))}u>0&&(m.setStart(d,u-1),m.setEnd(d,u),Um(m)||a(Ya(pa(m),!1))),u<d.data.length&&(m.setStart(d,u),m.setEnd(d,u+1),Um(m)||a(Ya(pa(m),!0)))},l=r.container(),c=r.offset();if(Zl(l))return i(l,c),s;if(cb(l))if(r.isAtEnd()){const d=Ed(l,c);Zl(d)&&i(d,d.data.length),Ql(d)&&!Im(d)&&a(Ya(pa(d),!1))}else{const d=Ed(l,c);if(Zl(d)&&i(d,0),Ql(d)&&r.isAtEnd())return a(Ya(pa(d),!1)),s;const u=Ed(r.container(),r.offset()-1);Ql(u)&&!Im(u)&&(db(u)||db(d)||!Ql(d))&&a(Ya(pa(u),!1)),Ql(d)&&a(Ya(pa(d),!0))}return s})(X(t,e))),n);return{container:it(t),offset:it(e),toRange:()=>{const r=Mm(t.ownerDocument);return r.setStart(t,e),r.setEnd(t,e),r},getClientRects:o,isVisible:()=>o().length>0,isAtStart:()=>(Zl(t),e===0),isAtEnd:()=>Zl(t)?e>=t.data.length:e>=t.childNodes.length,isEqual:r=>r&&t===r.container()&&e===r.offset(),getNode:r=>Ed(t,r?e-1:e)}};X.fromRangeStart=t=>X(t.startContainer,t.startOffset),X.fromRangeEnd=t=>X(t.endContainer,t.endOffset),X.after=t=>X(t.parentNode,ub(t)+1),X.before=t=>X(t.parentNode,ub(t)),X.isAbove=(t,e)=>ke(We(e.getClientRects()),Bn(t.getClientRects()),Yl).getOr(!1),X.isBelow=(t,e)=>ke(Bn(e.getClientRects()),We(t.getClientRects()),Xl).getOr(!1),X.isAtStart=t=>!!t&&t.isAtStart(),X.isAtEnd=t=>!!t&&t.isAtEnd(),X.isTextPosition=t=>!!t&&rt(t.container()),X.isElementPosition=t=>!X.isTextPosition(t);const _d=(t,e)=>{rt(e)&&e.data.length===0&&t.remove(e)},zm=(t,e,n)=>{Ol(n)?((o,r,s)=>{const a=x.from(s.firstChild),i=x.from(s.lastChild);r.insertNode(s),a.each(l=>_d(o,l.previousSibling)),i.each(l=>_d(o,l.nextSibling))})(t,e,n):((o,r,s)=>{r.insertNode(s),_d(o,s.previousSibling),_d(o,s.nextSibling)})(t,e,n)},Pr=rt,fb=Is,pb=ye.nodeIndex,hb=t=>{const e=t.parentNode;return fb(e)?hb(e):e},$m=t=>t?nr(t.childNodes,(e,n)=>(fb(n)&&n.nodeName!=="BR"?e=e.concat($m(n)):e.push(n),e),[]):[],bb=t=>e=>t===e,vb=t=>(Pr(t)?"text()":t.nodeName.toLowerCase())+"["+(e=>{let n,o;n=$m(hb(e)),o=or(n,bb(e),e),n=n.slice(0,o+1);const r=nr(n,(s,a,i)=>(Pr(a)&&Pr(n[i-1])&&s++,s),0);return n=er(n,oo([e.nodeName])),o=or(n,bb(e),e),o-r})(t)+"]",yb=(t,e)=>{let n,o=[],r=e.container(),s=e.offset();if(Pr(r))n=((i,l)=>{let c=i;for(;(c=c.previousSibling)&&Pr(c);)l+=c.data.length;return l})(r,s);else{const i=r.childNodes;s>=i.length?(n="after",s=i.length-1):n="before",r=i[s]}o.push(vb(r));let a=((i,l)=>{const c=[];for(let d=l.parentNode;d&&d!==i;d=d.parentNode)c.push(d);return c})(t,r);return a=er(a,De(Is)),o=o.concat(To(a,i=>vb(i))),o.reverse().join("/")+","+n},Cb=(t,e)=>{if(!e)return null;const n=e.split(","),o=n[0].split("/"),r=n.length>1?n[1]:"before",s=nr(o,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),((c,d,u)=>{let m=$m(c);return m=er(m,(h,f)=>!Pr(h)||!Pr(m[f-1])),m=er(m,oo([d])),m[u]})(a,l[1],parseInt(l[2],10))):null},t);if(!s)return null;if(!Pr(s)&&s.parentNode){let a;return a=r==="after"?pb(s)+1:pb(s),X(s.parentNode,a)}return((a,i)=>{let l=a,c=0;for(;Pr(l);){const d=l.data.length;if(i>=c&&i<=c+d){a=l,i-=c;break}if(!Pr(l.nextSibling)){a=l,i=d;break}c+=d,l=l.nextSibling}return Pr(a)&&i>a.data.length&&(i=a.data.length),X(a,i)})(s,parseInt(r,10))},Nd=me,wb=(t,e,n,o,r)=>{const s=r?o.startContainer:o.endContainer;let a=r?o.startOffset:o.endOffset;const i=[],l=t.getRoot();if(rt(s))i.push(n?((c,d,u)=>{let m=c(d.data.slice(0,u)).length;for(let h=d.previousSibling;h&&rt(h);h=h.previousSibling)m+=c(h.data).length;return m})(e,s,a):a);else{let c=0;const d=s.childNodes;a>=d.length&&d.length&&(c=1,a=Math.max(0,d.length-1)),i.push(t.nodeIndex(d[a],n)+c)}for(let c=s;c&&c!==l;c=c.parentNode)i.push(t.nodeIndex(c,n));return i},Hm=(t,e,n)=>{let o=0;return st.each(t.select(e),r=>r.getAttribute("data-mce-bogus")==="all"?void 0:r!==n&&void o++),o},Sb=(t,e)=>{let n=e?t.startContainer:t.endContainer,o=e?t.startOffset:t.endOffset;if(wt(n)&&n.nodeName==="TR"){const r=n.childNodes;n=r[Math.min(e?o:o-1,r.length-1)],n&&(o=e?0:n.childNodes.length,e?t.setStart(n,o):t.setEnd(n,o))}},kb=t=>(Sb(t,!0),Sb(t,!1),t),xb=(t,e)=>{if(wt(t)&&(t=fa(t,e),Nd(t)))return t;if(Io(t)){rt(t)&&Mi(t)&&(t=t.parentNode);let n=t.previousSibling;if(Nd(n)||(n=t.nextSibling,Nd(n)))return n}},Eb=(t,e,n)=>{const o=n.getNode(),r=n.getRng();if(o.nodeName==="IMG"||Nd(o)){const a=o.nodeName;return{name:a,index:Hm(n.dom,a,o)}}const s=(a=>xb(a.startContainer,a.startOffset)||xb(a.endContainer,a.endOffset))(r);if(s){const a=s.tagName;return{name:a,index:Hm(n.dom,a,s)}}return((a,i,l,c)=>{const d=i.dom,u=wb(d,a,l,c,!0),m=i.isForward(),h=eb(c)?{isFakeCaret:!0}:{};return i.isCollapsed()?{start:u,forward:m,...h}:{start:u,end:wb(d,a,l,c,!1),forward:m,...h}})(t,n,e,r)},_b=(t,e,n)=>{const o={"data-mce-type":"bookmark",id:e,style:"overflow:hidden;line-height:0px"};return n?t.create("span",o,"&#xFEFF;"):t.create("span",o)},Nb=(t,e)=>{const n=t.dom;let o=t.getRng();const r=n.uniqueId(),s=t.isCollapsed(),a=t.getNode(),i=a.nodeName,l=t.isForward();if(i==="IMG")return{name:i,index:Hm(n,i,a)};const c=kb(o.cloneRange());if(!s){c.collapse(!1);const u=_b(n,r+"_end",e);zm(n,c,u)}o=kb(o),o.collapse(!0);const d=_b(n,r+"_start",e);return zm(n,o,d),t.moveToBookmark({id:r,keep:!0,forward:l}),{id:r,forward:l}},jm=ft(Eb,Zt,!0),Ab=t=>{const e=s=>s(t),n=it(t),o=()=>r,r={tag:!0,inner:t,fold:(s,a)=>a(t),isValue:ae,isError:te,map:s=>qn.value(s(t)),mapError:o,bind:e,exists:e,forall:e,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:s=>{s(t)},toOptional:()=>x.some(t)};return r},Rb=t=>{const e=()=>n,n={tag:!1,inner:t,fold:(o,r)=>o(t),isValue:te,isError:ae,map:e,mapError:o=>qn.error(o(t)),bind:e,exists:te,forall:ae,getOr:Zt,or:Zt,getOrThunk:go,orThunk:go,getOrDie:He(String(t)),each:Dt,toOptional:x.none};return n},qn={value:Ab,error:Rb,fromOption:(t,e)=>t.fold(()=>Rb(e),Ab)},rs=t=>{if(!Qt(t))throw new Error("cases must be an array");if(t.length===0)throw new Error("there must be at least one case");const e=[],n={};return J(t,(o,r)=>{const s=je(o);if(s.length!==1)throw new Error("one and only one name per case");const a=s[0],i=o[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Qt(i))throw new Error("case arguments must be an array");e.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...d)=>{if(d.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+d.length);return d[r].apply(null,l)},match:d=>{const u=je(d);if(e.length!==u.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+`
Actual: `+u.join(","));if(!kn(e,m=>Xt(u,m)))throw new Error("Not all branches were specified when using match. Specified: "+u.join(", ")+`
Required: `+e.join(", "));return d[a].apply(null,l)},log:d=>{console.log(d,{constructors:e,constructor:a,params:l})}}}}),n};rs([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const QE=t=>t.type==="inline-command"||t.type==="inline-format",ZE=t=>t.type==="block-command"||t.type==="block-format",JE=t=>{var e;const n=r=>qn.error({message:r,pattern:t}),o=(r,s,a)=>{if(t.format!==void 0){let i;if(Qt(t.format)){if(!kn(t.format,vt))return n(r+" pattern has non-string items in the `format` array");i=t.format}else{if(!vt(t.format))return n(r+" pattern has non-string `format` parameter");i=[t.format]}return qn.value(s(i))}return t.cmd!==void 0?vt(t.cmd)?qn.value(a(t.cmd,t.value)):n(r+" pattern has non-string `cmd` parameter"):n(r+" pattern is missing both `format` and `cmd` parameters")};if(!Re(t))return n("Raw pattern is not an object");if(!vt(t.start))return n("Raw pattern is missing `start` parameter");if(t.end!==void 0){if(!vt(t.end))return n("Inline pattern has non-string `end` parameter");if(t.start.length===0&&t.end.length===0)return n("Inline pattern has empty `start` and `end` parameters");let r=t.start,s=t.end;return s.length===0&&(s=r,r=""),o("Inline",a=>({type:"inline-format",start:r,end:s,format:a}),(a,i)=>({type:"inline-command",start:r,end:s,cmd:a,value:i}))}if(t.replacement!==void 0)return vt(t.replacement)?t.start.length===0?n("Replacement pattern has empty `start` parameter"):qn.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):n("Replacement pattern has non-string `replacement` parameter");{const r=(e=t.trigger)!==null&&e!==void 0?e:"space";return t.start.length===0?n("Block pattern has empty `start` parameter"):o("Block",s=>({type:"block-format",start:t.start,format:s[0],trigger:r}),(s,a)=>({type:"block-command",start:t.start,cmd:s,value:a,trigger:r}))}},Tb=t=>Ot(t,ZE),Ob=t=>Ot(t,QE),Vm=(t,e)=>({...t,blockPatterns:Ot(t.blockPatterns,n=>((o,r)=>(o.type==="block-command"||o.type==="block-format")&&o.trigger===r)(n,e))}),Bb=t=>{const e=(n=>{const o=[],r=[];return J(n,s=>{s.fold(a=>{o.push(a)},a=>{r.push(a)})}),{errors:o,values:r}})(qt(t,JE));return J(e.errors,n=>console.error(n.message,n.pattern)),e.values},Lb=(t,e,n)=>{t.dispatch(e,n)},Db=(t,e,n,o)=>{t.dispatch("FormatApply",{format:e,node:n,vars:o})},Pb=(t,e,n,o)=>{t.dispatch("FormatRemove",{format:e,node:n,vars:o})},Ib=(t,e)=>t.dispatch("SetContent",e),Mb=(t,e)=>t.dispatch("GetContent",e),qm=(t,e)=>{t.dispatch("AutocompleterUpdateActiveRange",e)},Fb=(t,e)=>t.dispatch("PastePlainTextToggle",{state:e}),Wm=Ke().deviceType,t_=Wm.isTouch(),e_=ye.DOM,Ub=t=>wn(t,RegExp),pt=t=>e=>e.options.get(t),Ad=t=>vt(t)||Re(t),zb=(t,e="")=>n=>{const o=vt(n);if(o){if(n.indexOf("=")!==-1){const r=(s=>{const a=s.indexOf("=")>0?s.split(/[;,](?![^=;,]*(?:[;,]|$))/):s.split(",");return en(a,(i,l)=>{const c=l.split("="),d=c[0],u=c.length>1?c[1]:d;return i[fn(d)]=fn(u),i},{})})(n);return{value:ee(r,t.id).getOr(e),valid:o}}return{value:n,valid:o}}return{valid:!1,message:"Must be a string."}},n_=pt("iframe_attrs"),o_=pt("doctype"),$b=pt("document_base_url"),r_=pt("body_id"),s_=pt("body_class"),Hb=pt("content_security_policy"),a_=pt("br_in_pre"),Nn=pt("forced_root_block"),Jl=pt("forced_root_block_attrs"),i_=pt("newline_behavior"),l_=pt("br_newline_selector"),c_=pt("no_newline_selector"),d_=pt("keep_styles"),u_=pt("end_container_on_empty_block"),jb=pt("automatic_uploads"),Vb=pt("images_reuse_filename"),m_=pt("images_replace_blob_uris"),qb=pt("icons"),g_=pt("icons_url"),f_=pt("images_upload_url"),p_=pt("images_upload_base_path"),h_=pt("images_upload_credentials"),b_=pt("images_upload_handler"),v_=pt("content_css_cors"),Km=pt("referrer_policy"),Wb=pt("language"),y_=pt("language_url"),Kb=pt("indent_use_margin"),C_=pt("indentation"),w_=pt("content_css"),S_=pt("content_style"),Gb=pt("font_css"),k_=pt("directionality"),x_=pt("inline_boundaries_selector"),Yb=pt("object_resizing"),E_=pt("resize_img_proportional"),__=pt("placeholder"),Xb=pt("event_root"),N_=pt("service_message"),Ui=pt("theme"),A_=pt("theme_url"),Gm=pt("model"),R_=pt("model_url"),tc=pt("inline_boundaries"),T_=pt("formats"),O_=pt("preview_styles"),B_=pt("format_empty_lines"),L_=pt("format_noneditable_selector"),D_=pt("custom_ui_selector"),Ym=pt("inline"),P_=pt("hidden_input"),I_=pt("submit_patch"),M_=pt("add_form_submit_trigger"),F_=pt("add_unload_trigger"),U_=pt("custom_undo_redo_levels"),z_=pt("disable_nodechange"),Qb=pt("readonly"),$_=pt("editable_root"),Zb=pt("content_css_cors"),Rd=pt("plugins"),H_=pt("external_plugins"),j_=pt("block_unsupported_drop"),V_=pt("visual"),q_=pt("visual_table_class"),Jb=pt("visual_anchor_class"),tv=pt("iframe_aria_text"),W_=pt("setup"),K_=pt("init_instance_callback"),G_=pt("urlconverter_callback"),Y_=pt("auto_focus"),X_=pt("browser_spellcheck"),Q_=pt("protect"),Z_=pt("paste_block_drop"),Td=pt("paste_data_images"),J_=pt("paste_preprocess"),tN=pt("paste_postprocess"),eN=pt("newdocument_content"),nN=pt("paste_webkit_styles"),oN=pt("paste_remove_styles_if_webkit"),rN=pt("paste_merge_formats"),sN=pt("smart_paste"),aN=pt("paste_as_text"),iN=pt("paste_tab_spaces"),lN=pt("allow_html_data_urls"),cN=pt("text_patterns"),dN=pt("text_patterns_lookup"),ev=pt("noneditable_class"),uN=pt("editable_class"),mN=pt("noneditable_regexp"),gN=pt("preserve_cdata"),fN=pt("highlight_on_focus"),nv=pt("xss_sanitization"),pN=pt("init_content_sync"),ov=t=>st.explode(t.options.get("images_file_types")),hN=pt("table_tab_navigation"),bN=pt("details_initial_state"),vN=pt("details_serialized_state"),rv=pt("sandbox_iframes"),Xm=t=>t.options.get("sandbox_iframes_exclusions"),yN=pt("convert_unsafe_embeds"),CN=pt("license_key"),wN=pt("api_key"),Od=pt("disabled"),SN=wt,sv=rt,av=t=>{const e=t.parentNode;e&&e.removeChild(t)},iv=t=>{const e=wo(t);return{count:t.length-e.length,text:e}},lv=t=>{let e;for(;(e=t.data.lastIndexOf(an))!==-1;)t.deleteData(e,1)},cv=(t,e)=>(Xa(t),e),kN=(t,e)=>X.isTextPosition(e)?((n,o)=>sv(n)&&o.container()===n?((r,s)=>{const a=iv(r.data.substr(0,s.offset())),i=iv(r.data.substr(s.offset()));return(a.text+i.text).length>0?(lv(r),X(r,s.offset()-a.count)):s})(n,o):cv(n,o))(t,e):((n,o)=>o.container()===n.parentNode?((r,s)=>{const a=s.container(),i=((l,c)=>{const d=Xs(l,c);return d===-1?x.none():x.some(d)})(Oe(a.childNodes),r).map(l=>l<s.offset()?X(a,s.offset()-1):s).getOr(s);return Xa(r),i})(n,o):cv(n,o))(t,e),Xa=t=>{SN(t)&&Io(t)&&(tb(t)?t.removeAttribute("data-mce-caret"):av(t)),sv(t)&&(lv(t),t.data.length===0&&av(t))},xN=me,EN=ur,_N=Ri,dv=(t,e,n)=>{const o=nb(e.getBoundingClientRect(),n);let r,s;if(t.tagName==="BODY"){const i=t.ownerDocument.documentElement;r=t.scrollLeft||i.scrollLeft,s=t.scrollTop||i.scrollTop}else{const i=t.getBoundingClientRect();r=t.scrollLeft-i.left,s=t.scrollTop-i.top}o.left+=r,o.right+=r,o.top+=s,o.bottom+=s,o.width=1;let a=e.offsetWidth-e.clientWidth;return a>0&&(n&&(a*=-1),o.left+=a,o.right+=a),o},NN=(t,e,n,o)=>{const r=Or();let s,a;const i=Nn(t),l=t.dom,c=()=>{(d=>{var u,m;const h=dn(F(d),"*[contentEditable=false],video,audio,embed,object");for(let f=0;f<h.length;f++){const b=h[f].dom;let p=b.previousSibling;if(kd(p)){const y=p.data;y.length===1?(u=p.parentNode)===null||u===void 0||u.removeChild(p):p.deleteData(y.length-1,1)}p=b.nextSibling,Sd(p)&&(p.data.length===1?(m=p.parentNode)===null||m===void 0||m.removeChild(p):p.deleteData(0,1))}})(e),a&&(Xa(a),a=null),r.on(d=>{l.remove(d.caret),r.clear()}),s&&(clearInterval(s),s=void 0)};return{show:(d,u)=>{let m;if(c(),_N(u))return null;if(!n(u))return a=((h,f)=>{var b;const p=((b=h.ownerDocument)!==null&&b!==void 0?b:document).createTextNode(an),y=h.parentNode;if(f){const w=h.previousSibling;if(Ii(w)){if(Io(w))return w;if(kd(w))return w.splitText(w.data.length-1)}y?.insertBefore(p,h)}else{const w=h.nextSibling;if(Ii(w)){if(Io(w))return w;if(Sd(w))return w.splitText(1),w}h.nextSibling?y?.insertBefore(p,h.nextSibling):y?.appendChild(p)}return p})(u,d),m=u.ownerDocument.createRange(),ec(a.nextSibling)?(m.setStart(a,0),m.setEnd(a,0)):(m.setStart(a,1),m.setEnd(a,1)),m;{const h=((p,y,w)=>{var S;const N=((S=y.ownerDocument)!==null&&S!==void 0?S:document).createElement(p);N.setAttribute("data-mce-caret",w?"before":"after"),N.setAttribute("data-mce-bogus","all"),N.appendChild(Pi().dom);const E=y.parentNode;return w?E?.insertBefore(N,y):y.nextSibling?E?.insertBefore(N,y.nextSibling):E?.appendChild(N),N})(i,u,d),f=dv(e,u,d);l.setStyle(h,"top",f.top),l.setStyle(h,"caret-color","transparent"),a=h;const b=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(b,{...f}),l.add(e,b),r.set({caret:b,element:u,before:d}),d&&l.addClass(b,"mce-visual-caret-before"),s=setInterval(()=>{r.on(p=>{o()?l.toggleClass(p.caret,"mce-visual-caret-hidden"):l.addClass(p.caret,"mce-visual-caret-hidden")})},500),m=u.ownerDocument.createRange(),m.setStart(h,0),m.setEnd(h,0)}return m},hide:c,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{r.on(d=>{const u=dv(e,d.element,d.before);l.setStyles(d.caret,{...u})})},destroy:()=>clearInterval(s)}},uv=()=>Kt.browser.isFirefox(),ec=t=>xN(t)||EN(t),nc=t=>(ec(t)||dr(t)&&uv())&&Da(F(t)).exists(Jr),AN=ro,Qm=me,RN=ur,mv=Ai("display","block table table-cell table-row table-caption list-item"),gv=Io,fv=Mi,TN=wt,ON=rt,BN=Dr,zi=t=>t===1,Qa=t=>t===-1,Bd=(t,e)=>{let n;for(;n=t(e);)if(!fv(n))return n;return null},oc=(t,e,n,o,r)=>{const s=new Ge(t,o),a=Qm(t)||fv(t);let i;if(Qa(e)){if(a&&(i=Bd(s.prev.bind(s),!0),n(i)))return i;for(;i=Bd(s.prev.bind(s),r);)if(n(i))return i}if(zi(e)){if(a&&(i=Bd(s.next.bind(s),!0),n(i)))return i;for(;i=Bd(s.next.bind(s),r);)if(n(i))return i}return null},ha=(t,e)=>{for(;t&&t!==e;){if(mv(t))return t;t=t.parentNode}return null},ss=(t,e,n)=>ha(t.container(),n)===ha(e.container(),n),Zm=(t,e)=>{if(!e)return x.none();const n=e.container(),o=e.offset();return TN(n)?x.from(n.childNodes[o+t]):x.none()},pv=(t,e)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createRange();return t?(o.setStartBefore(e),o.setEndBefore(e)):(o.setStartAfter(e),o.setEndAfter(e)),o},LN=(t,e,n)=>ha(e,t)===ha(n,t),hv=(t,e,n)=>{const o=t?"previousSibling":"nextSibling";let r=n;for(;r&&r!==e;){let s=r[o];if(s&&gv(s)&&(s=s[o]),Qm(s)||RN(s)){if(LN(e,s,r))return s;break}if(BN(s))break;r=r.parentNode}return null},rc=ft(pv,!0),sc=ft(pv,!1),Jm=(t,e,n)=>{let o;const r=ft(hv,!0,e),s=ft(hv,!1,e),a=n.startContainer,i=n.startOffset;if(Mi(a)){const l=ON(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(o=l.nextSibling,nc(o)))return rc(o);if(c==="after"&&(o=l.previousSibling,nc(o)))return sc(o)}if(!n.collapsed)return n;if(rt(a)){if(gv(a)){if(t===1){if(o=s(a),o)return rc(o);if(o=r(a),o)return sc(o)}if(t===-1){if(o=r(a),o)return sc(o);if(o=s(a),o)return rc(o)}return n}if(kd(a)&&i>=a.data.length-1)return t===1&&(o=s(a),o)?rc(o):n;if(Sd(a)&&i<=1)return t===-1&&(o=r(a),o)?sc(o):n;if(i===a.data.length)return o=s(a),o?rc(o):n;if(i===0)return o=r(a),o?sc(o):n}return n},bv=(t,e)=>Zm(t?0:-1,e).filter(Qm),ac=(t,e,n)=>{const o=Jm(t,e,n);return t===-1?X.fromRangeStart(o):X.fromRangeEnd(o)},Ld=t=>x.from(t.getNode()).map(F),tg=(t,e)=>{let n=e;for(;n=t(n);)if(n.isVisible())return n;return n},Dd=(t,e)=>{const n=ss(t,e);return!(n||!Ee(t.getNode()))||n},DN=me,as=rt,vv=wt,eg=Ee,$i=Dr,yv=t=>ib(t)||(e=>!!Pm(e)&&!en(Oe(e.getElementsByTagName("*")),(n,o)=>n||ab(o),!1))(t),Pd=lb,Cv=(t,e)=>t.hasChildNodes()&&e<t.childNodes.length?t.childNodes[e]:null,wv=(t,e)=>{if(zi(t)){if($i(e.previousSibling)&&!as(e.previousSibling))return X.before(e);if(as(e))return X(e,0)}if(Qa(t)){if($i(e.nextSibling)&&!as(e.nextSibling))return X.after(e);if(as(e))return X(e,e.data.length)}return Qa(t)?eg(e)?X.before(e):X.after(e):X.before(e)},ng=(t,e,n)=>{let o,r,s,a;if(!vv(n)||!e)return null;if(e.isEqual(X.after(n))&&n.lastChild){if(a=X.after(n.lastChild),Qa(t)&&$i(n.lastChild)&&vv(n.lastChild))return eg(n.lastChild)?X.before(n.lastChild):a}else a=e;const i=a.container();let l=a.offset();if(as(i)){if(Qa(t)&&l>0)return X(i,--l);if(zi(t)&&l<i.length)return X(i,++l);o=i}else{if(Qa(t)&&l>0&&(r=Cv(i,l-1),$i(r)))return!yv(r)&&(s=oc(r,t,Pd,r),s)?as(s)?X(s,s.data.length):X.after(s):as(r)?X(r,r.data.length):X.before(r);if(zi(t)&&l<i.childNodes.length&&(r=Cv(i,l),$i(r)))return eg(r)?((d,u)=>{const m=u.nextSibling;return m&&$i(m)?as(m)?X(m,0):X.before(m):ng(1,X.after(u),d)})(n,r):!yv(r)&&(s=oc(r,t,Pd,r),s)?as(s)?X(s,0):X.before(s):as(r)?X(r,0):X.after(r);o=r||a.getNode()}if(o&&(zi(t)&&a.isAtEnd()||Qa(t)&&a.isAtStart())&&(o=oc(o,t,ae,n,!0),Pd(o,n)))return wv(t,o);r=o&&oc(o,t,Pd,n);const c=Vn(Ot(((d,u)=>{const m=[];let h=d;for(;h&&h!==u;)m.push(h),h=h.parentNode;return m})(i,n),DN));return!c||r&&c.contains(r)?r?wv(t,r):null:(a=zi(t)?X.after(c):X.before(c),a)},is=t=>({next:e=>ng(1,e,t),prev:e=>ng(-1,e,t)}),Sv=t=>X.isTextPosition(t)?t.offset()===0:Dr(t.getNode()),kv=t=>{if(X.isTextPosition(t)){const e=t.container();return t.offset()===e.data.length}return Dr(t.getNode(!0))},xv=(t,e)=>!X.isTextPosition(t)&&!X.isTextPosition(e)&&t.getNode()===e.getNode(!0),Mo=(t,e,n)=>{const o=is(e);return x.from(t?o.next(n):o.prev(n))},Hi=(t,e,n)=>Mo(t,e,n).bind(o=>ss(n,o,e)&&((r,s,a)=>{return r?!xv(s,a)&&(i=s,!(!X.isTextPosition(i)&&Ee(i.getNode())))&&kv(s)&&Sv(a):!xv(a,s)&&Sv(s)&&kv(a);var i})(t,n,o)?Mo(t,e,o):x.some(o)),Ev=(t,e,n,o)=>Hi(t,e,n).bind(r=>o(r)?Ev(t,e,r,o):x.some(r)),ji=(t,e)=>{const n=t?e.firstChild:e.lastChild;return rt(n)?x.some(X(n,t?0:n.data.length)):n?Dr(n)?x.some(t?X.before(n):Ee(o=n)?X.before(o):X.after(o)):((r,s,a)=>{const i=r?X.before(a):X.after(a);return Mo(r,s,i)})(t,e,n):x.none();var o},Wn=ft(Mo,!0),so=ft(Mo,!1),An=ft(ji,!0),gr=ft(ji,!1),og="_mce_caret",Fo=t=>wt(t)&&t.id===og,Za=(t,e)=>{let n=e;for(;n&&n!==t;){if(Fo(n))return n;n=n.parentNode}return null},_v=t=>Bt(t,"name"),Nv=t=>st.isArray(t.start),Id=t=>!(!_v(t)&&Sn(t.forward))||t.forward,Av=(t,e)=>(wt(e)&&t.isBlock(e)&&!e.innerHTML&&(e.innerHTML='<br data-mce-bogus="1" />'),e),PN=(t,e)=>gr(t).fold(te,n=>(e.setStart(n.container(),n.offset()),e.setEnd(n.container(),n.offset()),!0)),Rv=(t,e,n)=>!(!(o=>!o.hasChildNodes())(e)||!Za(t,e)||(((o,r)=>{var s;const a=((s=o.ownerDocument)!==null&&s!==void 0?s:document).createTextNode(an);o.appendChild(a),r.setStart(a,0),r.setEnd(a,0)})(e,n),0)),Tv=(t,e,n,o)=>{const r=n[e?"start":"end"],s=t.getRoot();if(r){let a=s,i=r[0];for(let l=r.length-1;a&&l>=1;l--){const c=a.childNodes;if(Rv(s,a,o))return!0;if(r[l]>c.length-1)return!!Rv(s,a,o)||PN(a,o);a=c[r[l]]}rt(a)&&(i=Math.min(r[0],a.data.length)),wt(a)&&(i=Math.min(r[0],a.childNodes.length)),e?o.setStart(a,i):o.setEnd(a,i)}return!0},rg=t=>rt(t)&&t.data.length>0,Ov=(t,e,n)=>{const o=t.get(n.id+"_"+e),r=o?.parentNode,s=n.keep;if(o&&r){let a,i;if(e==="start"?s?o.hasChildNodes()?(a=o.firstChild,i=1):rg(o.nextSibling)?(a=o.nextSibling,i=0):rg(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=t.nodeIndex(o)+1):(a=r,i=t.nodeIndex(o)):s?o.hasChildNodes()?(a=o.firstChild,i=1):rg(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=t.nodeIndex(o)):(a=r,i=t.nodeIndex(o)),!s){const l=o.previousSibling,c=o.nextSibling;let d;for(st.each(st.grep(o.childNodes),u=>{rt(u)&&(u.data=u.data.replace(/\uFEFF/g,""))});d=t.get(n.id+"_"+e);)t.remove(d,!0);if(rt(c)&&rt(l)&&!Kt.browser.isOpera()){const u=l.data.length;l.appendData(c.data),t.remove(c),a=l,i=u}}return x.some(X(a,i))}return x.none()},IN=(t,e,n)=>((o,r,s=!1)=>r===2?Eb(wo,s,o):r===3?(a=>{const i=a.getRng();return{start:yb(a.dom.getRoot(),X.fromRangeStart(i)),end:yb(a.dom.getRoot(),X.fromRangeEnd(i)),forward:a.isForward()}})(o):r?(a=>({rng:a.getRng(),forward:a.isForward()}))(o):Nb(o,!1))(t,e,n),MN=(t,e)=>{((n,o)=>{const r=n.dom;if(o){if(Nv(o))return((s,a)=>{const i=s.createRng();return Tv(s,!0,a,i)&&Tv(s,!1,a,i)?x.some({range:i,forward:Id(a)}):x.none()})(r,o);if((s=>vt(s.start))(o))return((s,a)=>{const i=x.from(Cb(s.getRoot(),a.start)),l=x.from(Cb(s.getRoot(),a.end));return ke(i,l,(c,d)=>{const u=s.createRng();return u.setStart(c.container(),c.offset()),u.setEnd(d.container(),d.offset()),{range:u,forward:Id(a)}})})(r,o);if((s=>Bt(s,"id"))(o))return((s,a)=>{const i=Ov(s,"start",a),l=Ov(s,"end",a);return ke(i,l.or(i),(c,d)=>{const u=s.createRng();return u.setStart(Av(s,c.container()),c.offset()),u.setEnd(Av(s,d.container()),d.offset()),{range:u,forward:Id(a)}})})(r,o);if(_v(o))return((s,a)=>x.from(s.select(a.name)[a.index]).map(i=>{const l=s.createRng();return l.selectNode(i),{range:l,forward:!0}}))(r,o);if((s=>Bt(s,"rng"))(o))return x.some({range:o.rng,forward:Id(o)})}return x.none()})(t,e).each(({range:n,forward:o})=>{t.setRng(n,o)})},Uo=t=>wt(t)&&t.tagName==="SPAN"&&t.getAttribute("data-mce-type")==="bookmark",Md=(Bv=ze,t=>Bv===t);var Bv;const Ja=t=>t!==""&&` \f
\r	\v`.indexOf(t)!==-1,sg=t=>!Ja(t)&&!Md(t)&&!Nl(t),ag=t=>{const e=[];if(t)for(let n=0;n<t.rangeCount;n++)e.push(t.getRangeAt(n));return e},Lv=(t,e)=>{const n=dn(e,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:(o=>Ot((r=>Qe(r,s=>{const a=xd(s);return a?[F(a)]:[]}))(o),Gl))(t)},Vi=t=>Lv(ag(t.selection.getSel()),F(t.getBody())),ic=(t,e)=>ia(t,"table",e),Dv=t=>fl(t).fold(it([t]),e=>[t].concat(Dv(e))),ig=t=>pl(t).fold(it([t]),e=>Gt(e)==="br"?Rr(e).map(n=>[t].concat(ig(n))).getOr([]):[t].concat(ig(e))),lg=(t,e)=>ke((n=>{const o=n.startContainer,r=n.startOffset;return rt(o)?r===0?x.some(F(o)):x.none():x.from(o.childNodes[r]).map(F)})(e),(n=>{const o=n.endContainer,r=n.endOffset;return rt(o)?r===o.data.length?x.some(F(o)):x.none():x.from(o.childNodes[r-1]).map(F)})(e),(n,o)=>{const r=Te(Dv(t),ft(ne,n)),s=Te(ig(t),ft(ne,o));return r.isSome()&&s.isSome()}).getOr(!1),cg=(t,e,n,o)=>{const r=n,s=new Ge(n,r),a=Ao(t.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Xt(["td","th","table"],c.toLowerCase()));let i=n;do{if(rt(i)&&st.trim(i.data).length!==0)return void(o?e.setStart(i,0):e.setEnd(i,i.data.length));if(a[i.nodeName])return void(o?e.setStartBefore(i):i.nodeName==="BR"?e.setEndBefore(i):e.setEndAfter(i))}while(i=o?s.next():s.prev());r.nodeName==="BODY"&&(o?e.setStart(r,0):e.setEnd(r,r.childNodes.length))},Fd=t=>{const e=t.selection.getSel();return q(e)&&e.rangeCount>0},dg=(t,e)=>{const n=Vi(t);n.length>0?J(n,o=>{const r=o.dom,s=t.dom.createRng();s.setStartBefore(r),s.setEndAfter(r),e(s,!0)}):e(t.selection.getRng(),!1)},Pv=(t,e,n)=>{const o=Nb(t,e);n(o),t.moveToBookmark(o)},lc=t=>Ce(t?.nodeType),ug=t=>wt(t)&&!Uo(t)&&!Fo(t)&&!Is(t),Iv=(t,e,n)=>{const{selection:o,dom:r}=t,s=o.getNode(),a=me(s);Pv(o,!0,()=>{e()}),a&&me(s)&&r.isChildOf(s,t.getBody())?t.selection.select(s):n(o.getStart())&&FN(r,o)},FN=(t,e)=>{var n,o;const r=e.getRng(),{startContainer:s,startOffset:a}=r;if(!((i,l)=>{if(ug(l)&&!/^(TD|TH)$/.test(l.nodeName)){const c=i.getAttrib(l,"data-mce-selected"),d=parseInt(c,10);return!isNaN(d)&&d>0}return!1})(t,e.getNode())&&wt(s)){const i=s.childNodes,l=t.getRoot();let c;if(a<i.length){const d=i[a];c=new Ge(d,(n=t.getParent(d,t.isBlock))!==null&&n!==void 0?n:l)}else{const d=i[i.length-1];c=new Ge(d,(o=t.getParent(d,t.isBlock))!==null&&o!==void 0?o:l),c.next(!0)}for(let d=c.current();d;d=c.next()){if(t.getContentEditable(d)==="false")return;if(rt(d)&&!gg(d))return r.setStart(d,0),void e.setRng(r)}}},Mv=(t,e,n)=>{if(t){const o=e?"nextSibling":"previousSibling";for(t=n?t:t[o];t;t=t[o])if(wt(t)||!gg(t))return t}},mg=(t,e)=>!!t.getTextBlockElements()[e.nodeName.toLowerCase()]||_e(t,e),qi=(t,e,n)=>t.schema.isValidChild(e,n),gg=(t,e=!1)=>{if(q(t)&&rt(t)){const n=e?t.data.replace(/ /g,"\xA0"):t.data;return Ps(n)}return!1},Fv=(t,e)=>{const n=t.dom;return ug(e)&&n.getContentEditable(e)==="false"&&((o,r)=>{const s="[data-mce-cef-wrappable]",a=L_(o),i=rr(a)?s:`${s},${a}`;return eo(F(r),i)})(t,e)&&n.select('[contenteditable="true"]',e).length===0},ba=(t,e)=>jt(t)?t(e):(q(e)&&(t=t.replace(/%(\w+)/g,(n,o)=>e[o]||n)),t),fg=(t,e)=>(e=e||"",t=""+((t=t||"").nodeName||t),e=""+(e.nodeName||e),t.toLowerCase()===e.toLowerCase()),pg=(t,e)=>{if(Ht(t))return null;{let n=String(t);return e!=="color"&&e!=="backgroundColor"||(n=Fl(n)),e==="fontWeight"&&t===700&&(n="bold"),e==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Ud=(t,e,n)=>{const o=t.getStyle(e,n);return pg(o,n)},Uv=(t,e)=>{let n;return t.getParent(e,o=>!!wt(o)&&(n=t.getStyle(o,"text-decoration"),!!n&&n!=="none")),n},zd=(t,e,n)=>t.getParents(e,n,t.getRoot()),hg=(t,e,n)=>{const o=t.formatter.get(e);return q(o)&&de(o,n)},ls=t=>Ro(t,"block"),zo=t=>Ro(t,"selector"),Je=t=>Ro(t,"inline"),bg=t=>zo(t)&&t.expand!==!1&&!Je(t),zv=t=>(e=>{const n=[];let o=e;for(;o;){if(rt(o)&&o.data!==an||o.childNodes.length>1)return[];wt(o)&&n.push(o),o=o.firstChild}return n})(t).length>0,vg=t=>Fo(t.dom)&&zv(t.dom),Wi=Uo,$v=zd,Hv=gg,UN=mg,jv=(t,e)=>{let n=e;for(;n;){if(wt(n)&&t.getContentEditable(n))return t.getContentEditable(n)==="false"?n:e;n=n.parentNode}return e},Vv=(t,e,n,o)=>{const r=e.data;if(t){for(let s=n;s>0;s--)if(o(r.charAt(s-1)))return s}else for(let s=n;s<r.length;s++)if(o(r.charAt(s)))return s;return-1},zN=(t,e,n)=>Vv(t,e,n,o=>Md(o)||Ja(o)),$N=(t,e,n)=>Vv(t,e,n,sg),qv=(t,e,n,o,r,s)=>{let a;const i=t.getParent(n,d=>Bl(d)||t.isBlock(d)),l=q(i)?i:e,c=(d,u,m)=>{const h=Wa(t),f=r?h.backwards:h.forwards;return x.from(f(d,u,(b,p)=>Wi(b.parentNode)?-1:(a=b,m(r,b,p)),l))};return c(n,o,zN).bind(d=>s?c(d.container,d.offset+(r?-1:0),$N):x.some(d)).orThunk(()=>a?x.some({container:a,offset:r?0:a.length}):x.none())},Wv=(t,e,n,o,r)=>{const s=o[r];rt(o)&&rr(o.data)&&s&&(o=s);const a=$v(t,o);for(let i=0;i<a.length;i++)for(let l=0;l<e.length;l++){const c=e[l];if((!q(c.collapsed)||c.collapsed===n.collapsed)&&zo(c)&&t.is(a[i],c.selector))return a[i]}return o},Kv=(t,e,n,o)=>{var r;let s=n;const a=t.getRoot(),i=e[0];if(ls(i)&&(s=i.wrapper?null:t.getParent(n,i.block,a)),!s){const l=(r=t.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&r!==void 0?r:a;s=t.getParent(rt(n)?n.parentNode:n,c=>c!==a&&UN(t.schema,c),l)}if(s&&ls(i)&&i.wrapper&&(s=$v(t,s,"ul,ol").reverse()[0]||s),!s)for(s=n;s&&s[o]&&!t.isBlock(s[o])&&(s=s[o],!fg(s,"br")););return s||n},Gv=(t,e,n,o)=>{const r=n.parentNode;return!q(n[o])&&(!(r!==e&&!Ht(r)&&!t.isBlock(r))||Gv(t,e,r,o))},$d=(t,e,n,o,r,s)=>{let a=n;const i=r?"previousSibling":"nextSibling",l=t.getRoot();if(rt(n)&&!Hv(n)&&(r?o>0:o<n.data.length))return n;for(;a;){if(Bl(a))return n;if(!e[0].block_expand&&t.isBlock(a))return s?a:n;for(let d=a[i];d;d=d[i]){const u=rt(d)&&!Gv(t,l,d,i);if(!Wi(d)&&(!Ee(c=d)||!c.getAttribute("data-mce-bogus")||c.nextSibling)&&!Hv(d,u))return a}if(a===l||a.parentNode===l){n=a;break}a=a.parentNode}var c;return n},Yv=t=>Wi(t.parentNode)||Wi(t),ti=(t,e,n,o={})=>{const{includeTrailingSpace:r=!1,expandToBlock:s=!0}=o,a=t.getParent(e.commonAncestorContainer,h=>Bl(h)),i=q(a)?a:t.getRoot();let{startContainer:l,startOffset:c,endContainer:d,endOffset:u}=e;const m=n[0];return wt(l)&&l.hasChildNodes()&&(l=fa(l,c),rt(l)&&(c=0)),wt(d)&&d.hasChildNodes()&&(d=fa(d,e.collapsed?u:u-1),rt(d)&&(u=d.data.length)),l=jv(t,l),d=jv(t,d),Yv(l)&&(l=Wi(l)?l:l.parentNode,l=e.collapsed?l.previousSibling||l:l.nextSibling||l,rt(l)&&(c=e.collapsed?l.length:0)),Yv(d)&&(d=Wi(d)?d:d.parentNode,d=e.collapsed?d.nextSibling||d:d.previousSibling||d,rt(d)&&(u=e.collapsed?0:d.length)),e.collapsed&&(qv(t,i,l,c,!0,r).each(({container:h,offset:f})=>{l=h,c=f}),qv(t,i,d,u,!1,r).each(({container:h,offset:f})=>{d=h,u=f})),(Je(m)||m.block_expand)&&(Je(m)&&rt(l)&&c!==0||(l=$d(t,n,l,c,!0,s)),Je(m)&&rt(d)&&u!==d.data.length||(d=$d(t,n,d,u,!1,s))),bg(m)&&(l=Wv(t,n,e,l,"previousSibling"),d=Wv(t,n,e,d,"nextSibling")),(ls(m)||zo(m))&&(l=Kv(t,n,l,"previousSibling"),d=Kv(t,n,d,"nextSibling"),ls(m)&&(t.isBlock(l)||(l=$d(t,n,l,c,!0,s),rt(l)&&(c=0)),t.isBlock(d)||(d=$d(t,n,d,u,!1,s),rt(d)&&(u=d.data.length)))),wt(l)&&l.parentNode&&(c=t.nodeIndex(l),l=l.parentNode),wt(d)&&d.parentNode&&(u=t.nodeIndex(d)+1,d=d.parentNode),{startContainer:l,startOffset:c,endContainer:d,endOffset:u}},cc=(t,e,n)=>{var o;const r=e.startOffset,s=fa(e.startContainer,r),a=e.endOffset,i=fa(e.endContainer,a-1),l=p=>{const y=p[0];rt(y)&&y===s&&r>=y.data.length&&p.splice(0,1);const w=p[p.length-1];return a===0&&p.length>0&&w===i&&rt(w)&&p.splice(p.length-1,1),p},c=(p,y,w)=>{const S=[];for(;p&&p!==w;p=p[y])S.push(p);return S},d=(p,y)=>t.getParent(p,w=>w.parentNode===y,y),u=(p,y,w)=>{const S=w?"nextSibling":"previousSibling";for(let N=p,E=N.parentNode;N&&N!==y;N=E){E=N.parentNode;const R=c(N===p?N:N[S],S);R.length&&(w||R.reverse(),n(l(R)))}};if(s===i)return n(l([s]));const m=(o=t.findCommonAncestor(s,i))!==null&&o!==void 0?o:t.getRoot();if(t.isChildOf(s,i))return u(s,m,!0);if(t.isChildOf(i,s))return u(i,m);const h=d(s,m)||s,f=d(i,m)||i;u(s,h,!0);const b=c(h===s?h:h.nextSibling,"nextSibling",f===i?f.nextSibling:f);b.length&&n(l(b)),u(i,f)},HN=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],Xv=(t,e,n,o,r,s)=>{const{uid:a=e,...i}=n;Ue(t,Hl()),et(t,`${Bi()}`,a),et(t,`${Va()}`,o);const{attributes:l={},classes:c=[]}=r(a,i);if(mt(t,l),((d,u)=>{J(u,m=>{Ue(d,m)})})(t,c),s){c.length>0&&et(t,`${Vl()}`,c.join(","));const d=je(l);d.length>0&&et(t,`${ql()}`,d.join(","))}},Qv=(t,e,n,o,r)=>{const s=xe("span",t);return Xv(s,e,n,o,r,!1),s},jN=(t,e,n,o,r,s)=>{const a=[],i=Qv(t.getDoc(),n,s,o,r),l=Or(),c=()=>{l.clear()},d=m=>{J(m,u)},u=m=>{switch(((h,f,b,p)=>pn(f).fold(()=>"skipping",y=>p==="br"||(w=>Be(w)&&Kl(w)===an)(f)?"valid":(w=>on(w)&&Ze(w,Hl()))(f)?"existing":Fo(f.dom)?"caret":de(HN,w=>eo(f,w))?"valid-block":qi(h,b,p)&&qi(h,Gt(y),b)?"valid":"invalid-child"))(t,m,"span",Gt(m))){case"invalid-child":{c();const h=rn(m);d(h),c();break}case"valid-block":c(),Xv(m,n,s,o,r,!0);break;case"valid":{const h=l.get().getOrThunk(()=>{const f=qa(i);return a.push(f),l.set(f),f});nd(m,h);break}}};return cc(t.dom,e,m=>{c(),(h=>{const f=qt(h,F);d(f)})(m)}),a},Zv=t=>{const e=(()=>{const s={};return{register:(a,i)=>{s[a]={name:a,settings:i}},lookup:a=>ee(s,a).map(i=>i.settings),getNames:()=>je(s)}})();((s,a)=>{const i=Va(),l=d=>x.from(d.attr(i)).bind(a.lookup),c=d=>{var u,m;d.attr(Bi(),null),d.attr(Va(),null),d.attr(jl(),null);const h=x.from(d.attr(ql())).map(y=>y.split(",")).getOr([]),f=x.from(d.attr(Vl())).map(y=>y.split(",")).getOr([]);J(h,y=>d.attr(y,null));const b=(m=(u=d.attr("class"))===null||u===void 0?void 0:u.split(" "))!==null&&m!==void 0?m:[],p=Qo(b,[Hl()].concat(f));d.attr("class",p.length>0?p.join(" "):null),d.attr(Vl(),null),d.attr(ql(),null)};s.serializer.addTempAttr(jl()),s.serializer.addAttributeFilter(i,d=>{for(const u of d)l(u).each(m=>{m.persistent===!1&&(u.name==="span"?u.unwrap():c(u))})})})(t,e);const n=((s,a)=>{const i=Ye({}),l=()=>({listeners:[],previous:Or()}),c=(h,f)=>{d(h,b=>(f(b),b))},d=(h,f)=>{const b=i.get(),p=f(ee(b,h).getOrThunk(l));b[h]=p,i.set(b)},u=(h,f)=>{J(qh(s,h),b=>{f?et(b,jl(),"true"):C(b,jl())})},m=Rm(()=>{const h=Yn(a.getNames());J(h,f=>{d(f,b=>{const p=b.previous.get();return jh(s,x.some(f)).fold(()=>{p.each(y=>{(w=>{c(w,S=>{J(S.listeners,N=>N(!1,w))})})(f),b.previous.clear(),u(y,!1)})},({uid:y,name:w,elements:S})=>{bo(p,y)||(p.each(N=>u(N,!1)),((N,E,R)=>{c(N,I=>{J(I.listeners,D=>D(!0,N,{uid:E,nodes:qt(R,$=>$.dom)}))})})(w,y,S),b.previous.set(y),u(y,!0))}),{previous:b.previous,listeners:b.listeners}})})},30);return s.on("remove",()=>{m.cancel()}),s.on("NodeChange",()=>{m.throttle()}),{addListener:(h,f)=>{d(h,b=>({previous:b.previous,listeners:b.listeners.concat([f])}))}}})(t,e),o=j("span"),r=s=>{J(s,a=>{o(a)?no(a):(i=>{to(i,Hl()),C(i,`${Bi()}`),C(i,`${Va()}`),C(i,`${jl()}`);const l=se(i,`${ql()}`).map(u=>u.split(",")).getOr([]),c=se(i,`${Vl()}`).map(u=>u.split(",")).getOr([]);var d;J(l,u=>C(i,u)),d=i,J(c,u=>{to(d,u)}),C(i,`${Vl()}`),C(i,`${ql()}`)})(a)})};return{register:(s,a)=>{e.register(s,a)},annotate:(s,a)=>{e.lookup(s).each(i=>{((l,c,d,u)=>{l.undoManager.transact(()=>{const m=l.selection,h=m.getRng(),f=Vi(l).length>0,b=Wl("mce-annotation");if(h.collapsed&&!f&&((p,y)=>{const w=ti(p.dom,y,[{inline:"span"}]);y.setStart(w.startContainer,w.startOffset),y.setEnd(w.endContainer,w.endOffset),p.selection.setRng(y)})(l,h),m.getRng().collapsed&&!f){const p=Qv(l.getDoc(),b,u,c,d.decorate);_i(p,ze),m.getRng().insertNode(p.dom),m.select(p.dom)}else Pv(m,!1,()=>{dg(l,p=>{jN(l,p,b,c,d.decorate,u)})})})})(t,s,i,a)})},annotationChanged:(s,a)=>{n.addListener(s,a)},remove:s=>{jh(t,x.some(s)).each(({elements:a})=>{const i=t.selection.getBookmark();r(a),t.selection.moveToBookmark(i)})},removeAll:s=>{const a=t.selection.getBookmark();re(Wh(t,s),(i,l)=>{r(i)}),t.selection.moveToBookmark(a)},getAll:s=>{const a=Wh(t,s);return Zo(a,i=>qt(i,l=>l.dom))}}},dc=t=>({getBookmark:ft(IN,t),moveToBookmark:ft(MN,t)});dc.isBookmarkNode=Uo;const Jv=(t,e,n)=>!n.collapsed&&de(n.getClientRects(),o=>((r,s,a)=>s>=r.left&&s<=r.right&&a>=r.top&&a<=r.bottom)(o,t,e)),t0=()=>F(document),e0=(t,e=!1)=>t.dom.focus({preventScroll:e}),n0=t=>{const e=Qr(t).dom;return t.dom===e.activeElement},yg=(t=t0())=>x.from(t.dom.activeElement).map(F),o0=(t,e,n,o)=>({start:t,soffset:e,finish:n,foffset:o}),Cg=rs([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),zs={before:Cg.before,on:Cg.on,after:Cg.after,cata:(t,e,n,o)=>t.fold(e,n,o),getStart:t=>t.fold(Zt,Zt,Zt)},Hd=rs([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ki={domRange:Hd.domRange,relative:Hd.relative,exact:Hd.exact,exactFromRange:t=>Hd.exact(t.start,t.soffset,t.finish,t.foffset),getWin:t=>{const e=(n=>n.match({domRange:o=>F(o.startContainer),relative:(o,r)=>zs.getStart(o),exact:(o,r,s,a)=>o}))(t);return La(e)},range:o0},r0=(t,e)=>{const n=Be(e)?Kl(e).length:rn(e).length+1;return t>n?n:t<0?0:t},VN=t=>Ki.range(t.start,r0(t.soffset,t.start),t.finish,r0(t.foffset,t.finish)),s0=(t,e)=>!za(e.dom)&&(Pn(t,e)||ne(t,e)),a0=t=>e=>s0(t,e.start)&&s0(t,e.finish),qN=t=>Ki.range(F(t.startContainer),t.startOffset,F(t.endContainer),t.endOffset),WN=t=>{const e=document.createRange();try{return e.setStart(t.start.dom,t.soffset),e.setEnd(t.finish.dom,t.foffset),x.some(e)}catch{return x.none()}},jd=t=>{const e=(o=>o.inline||Kt.browser.isFirefox())(t)?(n=F(t.getBody()),(o=>{const r=o.getSelection();return(r&&r.rangeCount!==0?x.from(r.getRangeAt(0)):x.none()).map(qN)})(La(n).dom).filter(a0(n))):x.none();var n;t.bookmark=e.isSome()?e:t.bookmark},wg=t=>(t.bookmark?t.bookmark:x.none()).bind(e=>{return n=F(t.getBody()),o=e,x.from(o).filter(a0(n)).map(VN);var n,o}).bind(WN),i0={isEditorUIElement:t=>{const e=t.className.toString();return e.indexOf("tox-")!==-1||e.indexOf("mce-")!==-1}},$o={setEditorTimeout:(t,e,n)=>((o,r)=>(Ce(r)||(r=0),setTimeout(o,r)))(()=>{t.removed||e()},n),setEditorInterval:(t,e,n)=>{const o=((r,s)=>(Ce(s)||(s=0),setInterval(r,s)))(()=>{t.removed?clearInterval(o):e()},n);return o}};let Gi;const Sg=ye.DOM,kg=t=>{const e=t.classList;return e!==void 0&&(e.contains("tox-edit-area")||e.contains("tox-edit-area__iframe")||e.contains("mce-content-body"))},Vd=(t,e)=>{const n=D_(t);return Sg.getParent(e,r=>(s=>wt(s)&&i0.isEditorUIElement(s))(r)||!!n&&t.dom.is(r,n))!==null},xg=t=>{try{const e=Qr(F(t.getElement()));return yg(e).fold(()=>document.body,n=>n.dom)}catch{return document.body}},KN=(t,e)=>{const n=e.editor;(r=>{const s=yd(()=>{jd(r)},0);r.on("init",()=>{r.inline&&((a,i)=>{const l=()=>{i.throttle()};ye.DOM.bind(document,"mouseup",l),a.on("remove",()=>{ye.DOM.unbind(document,"mouseup",l)})})(r,s),((a,i)=>{((l,c)=>{l.on("mouseup touchend",d=>{c.throttle()})})(a,i),a.on("keyup NodeChange AfterSetSelectionRange",l=>{(c=>c.type==="nodechange"&&c.selectionChange)(l)||jd(a)})})(r,s)}),r.on("remove",()=>{s.cancel()})})(n);const o=(r,s)=>{fN(r)&&r.inline!==!0&&s(F(r.getContainer()),"tox-edit-focus")};n.on("focusin",()=>{const r=t.focusedEditor;kg(xg(n))&&o(n,Ue),r!==n&&(r&&r.dispatch("blur",{focusedEditor:n}),t.setActive(n),t.focusedEditor=n,n.dispatch("focus",{blurredEditor:r}),n.focus(!0))}),n.on("focusout",()=>{$o.setEditorTimeout(n,()=>{const r=t.focusedEditor;kg(xg(n))&&r===n||o(n,to),Vd(n,xg(n))||r!==n||(n.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})}),Gi||(Gi=r=>{const s=t.activeEditor;s&&yl(r).each(a=>{const i=a;i.ownerDocument===document&&(i===document.body||Vd(s,i)||t.focusedEditor!==s||(s.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null))})},Sg.bind(document,"focusin",Gi))},GN=(t,e)=>{t.focusedEditor===e.editor&&(t.focusedEditor=null),!t.activeEditor&&Gi&&(Sg.unbind(document,"focusin",Gi),Gi=null)},l0=(t,e)=>{((n,o)=>(r=>r.collapsed?x.from(fa(r.startContainer,r.startOffset)).map(F):x.none())(o).bind(r=>UE(r)?x.some(r):Pn(n,r)?x.none():x.some(n)))(F(t.getBody()),e).bind(n=>An(n.dom)).fold(()=>{t.selection.normalize()},n=>t.selection.setRng(n.toRange()))},qd=t=>{if(t.setActive)try{t.setActive()}catch{t.focus()}else t.focus()},Yi=t=>t.inline?(e=>{const n=e.getBody();return n&&(o=F(n),n0(o)||(r=o,yg(Qr(r)).filter(s=>r.dom.contains(s.dom))).isSome());var o,r})(t):(e=>q(e.iframeElement)&&n0(F(e.iframeElement)))(t),Eg=t=>Yi(t)||(e=>{const n=Qr(F(e.getElement()));return yg(n).filter(o=>!kg(o.dom)&&Vd(e,o.dom)).isSome()})(t),_g=t=>t.editorManager.setActive(t),ht={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:t=>t.shiftKey||t.ctrlKey||t.altKey||ht.metaKeyPressed(t),metaKeyPressed:t=>Kt.os.isMacOS()||Kt.os.isiOS()?t.metaKey:t.ctrlKey&&!t.altKey},ei="data-mce-selected",c0=Math.abs,Wd=Math.round,Ng={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},d0=(t,e)=>{const n=e.dom,o=e.getDoc(),r=document,s=e.getBody();let a,i,l,c,d,u,m,h,f,b,p,y,w,S,N;const E=dt=>q(dt)&&(ud(dt)||n.is(dt,"figure.image")),R=dt=>ur(dt)||n.hasClass(dt,"mce-preview-object"),I=dt=>{const Ct=dt.target;((U,H)=>{if((Y=>Y.type==="longpress"||Y.type.indexOf("touch")===0)(U)){const Y=U.touches[0];return E(U.target)&&!Jv(Y.clientX,Y.clientY,H)}return E(U.target)&&!Jv(U.clientX,U.clientY,H)})(dt,e.selection.getRng())&&!dt.isDefaultPrevented()&&e.selection.select(Ct)},D=dt=>n.hasClass(dt,"mce-preview-object")&&q(dt.firstElementChild)?[dt,dt.firstElementChild]:n.is(dt,"figure.image")?[dt.querySelector("img")]:[dt],$=dt=>{const Ct=Yb(e);return!(!Ct||e.mode.isReadOnly())&&dt.getAttribute("data-mce-resize")!=="false"&&dt!==e.getBody()&&(n.hasClass(dt,"mce-preview-object")&&q(dt.firstElementChild)?eo(F(dt.firstElementChild),Ct):eo(F(dt),Ct))},W=(dt,Ct,U)=>{if(q(U)){const H=D(dt);J(H,Y=>{Y.style[Ct]||!e.schema.isValid(Y.nodeName.toLowerCase(),Ct)?n.setStyle(Y,Ct,U):n.setAttrib(Y,Ct,""+U)})}},B=(dt,Ct,U)=>{W(dt,"width",Ct),W(dt,"height",U)},P=dt=>{let Ct,U,H,Y,G;Ct=dt.screenX-u,U=dt.screenY-m,y=Ct*c[2]+h,w=U*c[3]+f,y=y<5?5:y,w=w<5?5:w,H=(E(a)||R(a))&&E_(e)!==!1?!ht.modifierPressed(dt):ht.modifierPressed(dt),H&&(c0(Ct)>c0(U)?(w=Wd(y*b),y=Wd(w/b)):(y=Wd(w/b),w=Wd(y*b))),B(i,y,w),Y=c.startPos.x+Ct,G=c.startPos.y+U,Y=Y>0?Y:0,G=G>0?G:0,n.setStyles(l,{left:Y,top:G,display:"block"}),l.innerHTML=y+" &times; "+w,Ct=s.scrollWidth-S,U=s.scrollHeight-N,Ct+U!==0&&n.setStyles(l,{left:Y-Ct,top:G-U}),p||(((ct,lt,Et,At,Ft)=>{ct.dispatch("ObjectResizeStart",{target:lt,width:Et,height:At,origin:Ft})})(e,a,h,f,"corner-"+c.name),p=!0)},z=()=>{const dt=p;p=!1,dt&&(W(a,"width",y),W(a,"height",w)),n.unbind(o,"mousemove",P),n.unbind(o,"mouseup",z),r!==o&&(n.unbind(r,"mousemove",P),n.unbind(r,"mouseup",z)),n.remove(i),n.remove(l),n.remove(d),Q(a),dt&&(((Ct,U,H,Y,G)=>{Ct.dispatch("ObjectResized",{target:U,width:H,height:Y,origin:G})})(e,a,y,w,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),e.nodeChanged()},Q=dt=>{kt();const Ct=n.getPos(dt,s),U=Ct.x,H=Ct.y,Y=dt.getBoundingClientRect(),G=Y.width||Y.right-Y.left,ct=Y.height||Y.bottom-Y.top;a!==dt&&(ot(),a=dt,y=w=0);const lt=e.dispatch("ObjectSelected",{target:dt});$(dt)&&!lt.isDefaultPrevented()?re(Ng,(Et,At)=>{let Ft=n.get("mceResizeHandle"+At);Ft&&n.remove(Ft),Ft=n.add(s,"div",{id:"mceResizeHandle"+At,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+At+"-resize; margin:0; padding:0"}),n.bind(Ft,"mousedown",we=>{we.stopImmediatePropagation(),we.preventDefault(),(Se=>{const ko=D(a)[0];u=Se.screenX,m=Se.screenY,h=ko.clientWidth,f=ko.clientHeight,b=f/h,c=Et,c.name=At,c.startPos={x:G*Et[0]+U,y:ct*Et[1]+H},S=s.scrollWidth,N=s.scrollHeight,d=n.add(s,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(d,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=((gt,Ut)=>{if(R(Ut))return gt.create("img",{src:Kt.transparentSrc});if(dr(Ut)){const Vt=ie(c.name,"n")?We:Bn,It=Ut.cloneNode(!0);return Vt(gt.select("tr",It)).each(Jt=>{const pe=gt.select("td,th",Jt);gt.setStyle(Jt,"height",null),J(pe,ut=>gt.setStyle(ut,"height",null))}),It}return Ut.cloneNode(!0)})(n,a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:U,top:H,margin:0}),B(i,G,ct),i.removeAttribute(ei),s.appendChild(i),n.bind(o,"mousemove",P),n.bind(o,"mouseup",z),r!==o&&(n.bind(r,"mousemove",P),n.bind(r,"mouseup",z)),l=n.add(s,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},h+" &times; "+f)})(we)}),Et.elm=Ft,n.setStyles(Ft,{left:G*Et[0]+U-Ft.offsetWidth/2,top:ct*Et[1]+H-Ft.offsetHeight/2})}):ot(!1)},at=yd(Q,0),ot=(dt=!0)=>{at.cancel(),kt(),a&&dt&&a.removeAttribute(ei),re(Ng,(Ct,U)=>{const H=n.get("mceResizeHandle"+U);H&&(n.unbind(H),n.remove(H))})},yt=(dt,Ct)=>n.isChildOf(dt,Ct),St=dt=>{if(p||e.removed||e.composing)return;const Ct=dt.type==="mousedown"?dt.target:t.getNode(),U=Ts(F(Ct),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(Y=>Y.dom).filter(Y=>n.isEditable(Y.parentElement)||Y.nodeName==="IMG"&&n.isEditable(Y)).getOrUndefined(),H=q(U)?n.getAttrib(U,ei,"1"):"1";if(J(n.select(`img[${ei}],hr[${ei}]`),Y=>{Y.removeAttribute(ei)}),q(U)&&yt(U,s)&&Eg(e)){Nt();const Y=t.getStart(!0);if(yt(Y,U)&&yt(t.getEnd(!0),U))return n.setAttrib(U,ei,H),void at.throttle(U)}ot()},kt=()=>{re(Ng,dt=>{dt.elm&&(n.unbind(dt.elm),delete dt.elm)})},Nt=()=>{try{e.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return e.on("init",()=>{Nt(),e.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",St),e.on("keyup compositionend",dt=>{a&&a.nodeName==="TABLE"&&St(dt)}),e.on("hide blur",ot),e.on("contextmenu longpress",I,!0)}),e.on("remove",kt),{isResizable:$,showResizeRect:Q,hideResizeRect:ot,updateResizeRect:St,destroy:()=>{at.cancel(),a=i=d=null}}},u0=(t,e,n)=>{const o=t.document.createRange();var r;return r=o,e.fold(s=>{r.setStartBefore(s.dom)},(s,a)=>{r.setStart(s.dom,a)},s=>{r.setStartAfter(s.dom)}),((s,a)=>{a.fold(i=>{s.setEndBefore(i.dom)},(i,l)=>{s.setEnd(i.dom,l)},i=>{s.setEndAfter(i.dom)})})(o,n),o},Ag=(t,e,n,o,r)=>{const s=t.document.createRange();return s.setStart(e.dom,n),s.setEnd(o.dom,r),s},uc=rs([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),m0=(t,e,n)=>e(F(n.startContainer),n.startOffset,F(n.endContainer),n.endOffset);uc.ltr,uc.rtl;const Kd=(t,e)=>{const n=Gt(t);return n==="input"?zs.after(t):Xt(["br","img"],n)?e===0?zs.before(t):zs.after(t):zs.on(t,e)},YN=(t,e)=>{const n=t.fold(zs.before,Kd,zs.after),o=e.fold(zs.before,Kd,zs.after);return Ki.relative(n,o)},g0=(t,e,n,o)=>{const r=Kd(t,e),s=Kd(n,o);return Ki.relative(r,s)},Rg=(t,e)=>{const n=(e||document).createDocumentFragment();return J(t,o=>{n.appendChild(o.dom)}),F(n)},XN=t=>{const e=Ki.getWin(t).dom,n=(r,s,a,i)=>Ag(e,r,s,a,i),o=(r=>r.match({domRange:s=>{const a=F(s.startContainer),i=F(s.endContainer);return g0(a,s.startOffset,i,s.endOffset)},relative:YN,exact:g0}))(t);return((r,s)=>{const a=((i,l)=>l.match({domRange:c=>({ltr:it(c),rtl:x.none}),relative:(c,d)=>({ltr:ln(()=>u0(i,c,d)),rtl:ln(()=>x.some(u0(i,d,c)))}),exact:(c,d,u,m)=>({ltr:ln(()=>Ag(i,c,d,u,m)),rtl:ln(()=>x.some(Ag(i,u,m,c,d)))})}))(r,s);return((i,l)=>{const c=l.ltr();return c.collapsed?l.rtl().filter(d=>d.collapsed===!1).map(d=>uc.rtl(F(d.endContainer),d.endOffset,F(d.startContainer),d.startOffset)).getOrThunk(()=>m0(0,uc.ltr,c)):m0(0,uc.ltr,c)})(0,a)})(e,o).match({ltr:n,rtl:n})},QN=(t,e,n)=>((o,r,s)=>((a,i,l)=>a.caretPositionFromPoint?((c,d,u)=>{var m;return x.from((m=c.caretPositionFromPoint)===null||m===void 0?void 0:m.call(c,d,u)).bind(h=>{if(h.offsetNode===null)return x.none();const f=c.createRange();return f.setStart(h.offsetNode,h.offset),f.collapse(),x.some(f)})})(a,i,l):a.caretRangeFromPoint?((c,d,u)=>{var m;return x.from((m=c.caretRangeFromPoint)===null||m===void 0?void 0:m.call(c,d,u))})(a,i,l):x.none())(o.document,r,s).map(a=>o0(F(a.startContainer),a.startOffset,F(a.endContainer),a.endOffset)))(t,e,n),f0=(t,e,n)=>{const o=La(F(n));return QN(o.dom,t,e).map(r=>{const s=n.createRange();return s.setStart(r.start.dom,r.soffset),s.setEnd(r.finish.dom,r.foffset),s}).getOrUndefined()},Tg=(t,e)=>q(t)&&q(e)&&t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset,p0=(t,e,n)=>((o,r,s)=>{let a=o;for(;a&&a!==r;){if(s(a))return a;a=a.parentNode}return null})(t,e,n)!==null,ZN=(t,e,n)=>p0(t,e,o=>o.nodeName===n),JN=(t,e)=>Io(t)&&!p0(t,e,Fo),h0=(t,e,n)=>{const o=e.parentNode;if(o){const r=new Ge(e,t.getParent(o,t.isBlock)||t.getRoot());let s;for(;s=r[n?"prev":"next"]();)if(Ee(s))return!0}return!1},Og=(t,e,n,o,r)=>{const s=t.getRoot(),a=t.schema.getNonEmptyElements(),i=r.parentNode;let l,c;if(!i)return x.none();const d=t.getParent(i,t.isBlock)||s;if(o&&Ee(r)&&e&&t.isEmpty(d))return x.some(X(i,t.nodeIndex(r)));const u=new Ge(r,d);for(;c=u[o?"prev":"next"]();){if(t.getContentEditableParent(c)==="false"||JN(c,s))return x.none();if(rt(c)&&c.data.length>0)return ZN(c,s,"A")?x.none():x.some(X(c,o?c.data.length:0));if(t.isBlock(c)||a[c.nodeName.toLowerCase()])return x.none();l=c}return ns(l)?x.none():n&&l?x.some(X(l,0)):x.none()},b0=(t,e,n,o)=>{const r=t.getRoot();let s,a=!1,i=n?o.startContainer:o.endContainer,l=n?o.startOffset:o.endOffset;const c=wt(i)&&l===i.childNodes.length,d=t.schema.getNonEmptyElements();let u=n;if(Io(i))return x.none();if(wt(i)&&l>i.childNodes.length-1&&(u=!1),Ms(i)&&(i=r,l=0),i===r){if(u&&(s=i.childNodes[l>0?l-1:0],s)&&(Io(s)||d[s.nodeName]||dr(s)))return x.none();if(i.hasChildNodes()){if(l=Math.min(!u&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=rt(i)&&c?i.data.length:0,!e&&i===r.lastChild&&dr(i)||((m,h)=>{let f=h;for(;f&&f!==m;){if(me(f))return!0;f=f.parentNode}return!1})(r,i)||Io(i)||Ll(i))return x.none();if(i.hasChildNodes()&&!dr(i)){s=i;const m=new Ge(i,r);do{if(me(s)||Io(s)){a=!1;break}if(rt(s)&&s.data.length>0){l=u?0:s.data.length,i=s,a=!0;break}if(d[s.nodeName.toLowerCase()]&&!dm(s)){l=t.nodeIndex(s),i=s.parentNode,u||l++,a=!0;break}}while(s=u?m.next():m.prev())}}}return e&&(rt(i)&&l===0&&Og(t,c,e,!0,i).each(m=>{i=m.container(),l=m.offset(),a=!0}),wt(i)&&(s=i.childNodes[l],s||(s=i.childNodes[l-1]),!s||!Ee(s)||(m=>{var h;return((h=m.previousSibling)===null||h===void 0?void 0:h.nodeName)==="A"})(s)||h0(t,s,!1)||h0(t,s,!0)||Og(t,c,e,!0,s).each(m=>{i=m.container(),l=m.offset(),a=!0}))),u&&!e&&rt(i)&&l===i.data.length&&Og(t,c,e,!1,i).each(m=>{i=m.container(),l=m.offset(),a=!0}),a&&i?x.some(X(i,l)):x.none()},Gd=(t,e)=>{const n=e.collapsed,o=e.cloneRange(),r=X.fromRangeStart(e);return b0(t,n,!0,o).each(s=>{n&&X.isAbove(r,s)||o.setStart(s.container(),s.offset())}),n||b0(t,n,!1,o).each(s=>{o.setEnd(s.container(),s.offset())}),n&&o.collapse(!0),Tg(e,o)?x.none():x.some(o)},Yd=(t,e)=>t.splitText(e),Xd=t=>{let e=t.startContainer,n=t.startOffset,o=t.endContainer,r=t.endOffset;if(e===o&&rt(e)){if(n>0&&n<e.data.length)if(o=Yd(e,n),e=o.previousSibling,r>n){r-=n;const s=Yd(o,r).previousSibling;e=o=s,r=s.data.length,n=0}else r=0}else if(rt(e)&&n>0&&n<e.data.length&&(e=Yd(e,n),n=0),rt(o)&&r>0&&r<o.data.length){const s=Yd(o,r).previousSibling;o=s,r=s.data.length}return{startContainer:e,startOffset:n,endContainer:o,endOffset:r}},ni=t=>({walk:(e,n)=>cc(t,e,n),split:Xd,expand:(e,n={type:"word"})=>{if(n.type==="word"){const o=ti(t,e,[{inline:"span"}],{includeTrailingSpace:!1,expandToBlock:!1}),r=t.createRng();return r.setStart(o.startContainer,o.startOffset),r.setEnd(o.endContainer,o.endOffset),r}return e},normalize:e=>Gd(t,e).fold(te,n=>(e.setStart(n.startContainer,n.startOffset),e.setEnd(n.endContainer,n.endOffset),!0))});ni.compareRanges=Tg,ni.getCaretRangeFromPoint=f0,ni.getSelectedNode=xd,ni.getNode=fa;const tA=(t=>{const e=o=>{const r=(s=>{const a=s.dom;return aa(s)?a.getBoundingClientRect().height:a.offsetHeight})(o);if(r<=0||r===null){const s=lr(o,t);return parseFloat(s)||0}return r},n=(o,r)=>en(r,(s,a)=>{const i=lr(o,a),l=i===void 0?0:parseInt(i,10);return isNaN(l)?s:s+l},0);return{set:(o,r)=>{if(!Ce(r)&&!r.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+r);const s=o.dom;Ia(s)&&(s.style[t]=r+"px")},get:e,getOuter:e,aggregate:n,max:(o,r,s)=>{const a=n(o,s);return r>a?r-a:0}}})("height"),v0=(t,e)=>t.view(e).fold(it([]),n=>{const o=t.owner(n),r=v0(t,o);return[n].concat(r)});var eA=Object.freeze({__proto__:null,view:t=>{var e;return(t.dom===document?x.none():x.from((e=t.dom.defaultView)===null||e===void 0?void 0:e.frameElement)).map(F)},owner:t=>Ar(t)});const Bg=t=>Gt(t)==="textarea",y0=(t,e)=>{const n=(r=>{const s=r.dom.ownerDocument,a=s.body,i=s.defaultView,l=s.documentElement;if(a===r.dom)return ca(a.offsetLeft,a.offsetTop);const c=Ds(i?.pageYOffset,l.scrollTop),d=Ds(i?.pageXOffset,l.scrollLeft),u=Ds(l.clientTop,a.clientTop),m=Ds(l.clientLeft,a.clientLeft);return Fa(r).translate(d-m,c-u)})(t),o=(r=>tA.get(r))(t);return{element:t,bottom:n.top+o,height:o,pos:n,cleanup:e}},C0=(t,e,n,o)=>{oA(t,(r,s)=>nA(t,e,n,o),n)},w0=(t,e,n,o,r)=>{const s={elm:o.element.dom,alignToTop:r};((a,i)=>a.dispatch("ScrollIntoView",i).isDefaultPrevented())(t,s)||(n(t,e,kl(e).top,o,r),((a,i)=>{a.dispatch("AfterScrollIntoView",i)})(t,s))},nA=(t,e,n,o)=>{const r=F(t.getBody()),s=F(t.getDoc());r.dom.offsetWidth;const a=((i,l)=>{const c=((u,m)=>{const h=rn(u);if(h.length===0||Bg(u))return{element:u,offset:m};if(m<h.length&&!Bg(h[m]))return{element:h[m],offset:0};{const f=h[h.length-1];return Bg(f)?{element:u,offset:m}:Gt(f)==="img"?{element:f,offset:1}:Be(f)?{element:f,offset:Kl(f).length}:{element:f,offset:rn(f).length}}})(i,l),d=As('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return hn(c.element,d),y0(d,()=>le(d))})(F(n.startContainer),n.startOffset);w0(t,s,e,a,o),a.cleanup()},S0=(t,e,n,o)=>{const r=F(t.getDoc());w0(t,r,n,(s=>y0(F(s),Dt))(e),o)},oA=(t,e,n)=>{const o=n.startContainer,r=n.startOffset,s=n.endContainer,a=n.endOffset;e(F(o),F(s));const i=t.dom.createRng();i.setStart(o,r),i.setEnd(s,a),t.selection.setRng(n)},Lg=(t,e,n,o,r)=>{const s=e.pos;if(o)rd(s.left,s.top,r);else{const a=s.top-n+e.height;rd(-t.getBody().getBoundingClientRect().left,a,r)}},k0=(t,e,n,o,r,s)=>{const a=o+n,i=r.pos.top,l=r.bottom,c=l-i>=o;i<n?Lg(t,r,o,s!==!1,e):i>a?Lg(t,r,o,c?s!==!1:s===!0,e):l>a&&!c&&Lg(t,r,o,s===!0,e)},x0=(t,e,n,o,r)=>{const s=La(e).dom.innerHeight;k0(t,e,n,s,o,r)},E0=(t,e,n,o,r)=>{const s=La(e).dom.innerHeight;k0(t,e,n,s,o,r);const a=(l=>{const c=t0(),d=kl(c),u=((f,b)=>{const p=b.owner(f);return v0(b,p)})(l,eA),m=Fa(l),h=yr(u,(f,b)=>{const p=Fa(b);return{left:f.left+p.left,top:f.top+p.top}},{left:0,top:0});return ca(h.left+m.left+d.left,h.top+m.top+d.top)})(o.element),i=ad(window);a.top<i.y?sd(o.element,r!==!1):a.top>i.bottom&&sd(o.element,r===!0)},rA=(t,e,n)=>C0(t,x0,e,n),sA=(t,e,n)=>S0(t,e,x0,n),aA=(t,e,n)=>C0(t,E0,e,n),iA=(t,e,n)=>S0(t,e,E0,n),mc=(t,e,n)=>{(t.inline?rA:aA)(t,e,n)},_0=(t,e)=>e.collapsed?t.isEditable(e.startContainer):t.isEditable(e.startContainer)&&t.isEditable(e.endContainer),N0=(t,e,n,o,r)=>{const s=n?e.startContainer:e.endContainer,a=n?e.startOffset:e.endOffset;return x.from(s).map(F).map(i=>o&&e.collapsed?i:sa(i,r(i,a)).getOr(i)).bind(i=>on(i)?x.some(i):pn(i).filter(on)).map(i=>i.dom).getOr(t)},A0=(t,e,n=!1)=>N0(t,e,!0,n,(o,r)=>Math.min(hl(o),r)),R0=(t,e,n=!1)=>N0(t,e,!1,n,(o,r)=>r>0?r-1:r),T0=(t,e)=>{const n=t;for(;t&&rt(t)&&t.length===0;)t=e?t.nextSibling:t.previousSibling;return t||n},Dg=(t,e)=>qt(e,n=>{const o=t.dispatch("GetSelectionRange",{range:n});return o.range!==n?o.range:n}),lA={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Qd=(t,e,n)=>{const o=n?"lastChild":"firstChild",r=n?"prev":"next";if(t[o])return t[o];if(t!==e){let s=t[r];if(s)return s;for(let a=t.parent;a&&a!==e;a=a.parent)if(s=a[r],s)return s}},cA=t=>{var e;const n=(e=t.value)!==null&&e!==void 0?e:"";if(!Ps(n))return!1;const o=t.parent;return!o||o.name==="span"&&!o.attr("style")||!/^[ ]+$/.test(n)},O0=t=>{const e=t.name==="a"&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||e};class Fn{static create(e,n){const o=new Fn(e,lA[e]||1);return n&&re(n,(r,s)=>{o.attr(s,r)}),o}constructor(e,n){this.name=e,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(e){const n=this;return e.parent&&e.remove(),n.insert(e,n),n.remove(),n}attr(e,n){const o=this;if(!vt(e))return q(e)&&re(e,(s,a)=>{o.attr(a,s)}),o;const r=o.attributes;if(r){if(n!==void 0){if(n===null){if(e in r.map){delete r.map[e];let s=r.length;for(;s--;)if(r[s].name===e)return r.splice(s,1),o}return o}if(e in r.map){let s=r.length;for(;s--;)if(r[s].name===e){r[s].value=n;break}}else r.push({name:e,value:n});return r.map[e]=n,o}return r.map[e]}}clone(){const e=this,n=new Fn(e.name,e.type),o=e.attributes;if(o){const r=[];r.map={};for(let s=0,a=o.length;s<a;s++){const i=o[s];i.name!=="id"&&(r[r.length]={name:i.name,value:i.value},r.map[i.name]=i.value)}n.attributes=r}return n.value=e.value,n}wrap(e){const n=this;return n.parent&&(n.parent.insert(e,n),e.append(n)),n}unwrap(){const e=this;for(let n=e.firstChild;n;){const o=n.next;e.insert(n,e,!0),n=o}e.remove()}remove(){const e=this,n=e.parent,o=e.next,r=e.prev;return n&&(n.firstChild===e?(n.firstChild=o,o&&(o.prev=null)):r&&(r.next=o),n.lastChild===e?(n.lastChild=r,r&&(r.next=null)):o&&(o.prev=r),e.parent=e.next=e.prev=null),e}append(e){const n=this;e.parent&&e.remove();const o=n.lastChild;return o?(o.next=e,e.prev=o,n.lastChild=e):n.lastChild=n.firstChild=e,e.parent=n,e}insert(e,n,o){e.parent&&e.remove();const r=n.parent||this;return o?(n===r.firstChild?r.firstChild=e:n.prev&&(n.prev.next=e),e.prev=n.prev,e.next=n,n.prev=e):(n===r.lastChild?r.lastChild=e:n.next&&(n.next.prev=e),e.next=n.next,e.prev=n,n.next=e),e.parent=r,e}getAll(e){const n=this,o=[];for(let r=n.firstChild;r;r=Qd(r,n))r.name===e&&o.push(r);return o}children(){const e=[];for(let n=this.firstChild;n;n=n.next)e.push(n);return e}empty(){const e=this;if(e.firstChild){const n=[];for(let r=e.firstChild;r;r=Qd(r,e))n.push(r);let o=n.length;for(;o--;){const r=n[o];r.parent=r.firstChild=r.lastChild=r.next=r.prev=null}}return e.firstChild=e.lastChild=null,e}isEmpty(e,n={},o){var r;const s=this;let a=s.firstChild;if(O0(s))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(e[a.name]||O0(a))return!1}if(a.type===8||a.type===3&&!cA(a)||a.type===3&&a.parent&&n[a.parent.name]&&Ps((r=a.value)!==null&&r!==void 0?r:"")||o&&o(a))return!1}while(a=Qd(a,s));return!0}walk(e){return Qd(this,null,e)}}const dA=st.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),B0=t=>vt(t.nodeValue)&&t.nodeValue.includes(an),L0=t=>(t.length===0?"":`${qt(t,e=>`[${e}]`).join(",")},`)+'[data-mce-bogus="all"]',D0=t=>document.createTreeWalker(t,NodeFilter.SHOW_COMMENT,e=>B0(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),P0=t=>document.createTreeWalker(t,NodeFilter.SHOW_TEXT,e=>{if(B0(e)){const n=e.parentNode;return n&&Bt(dA,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_SKIP}),uA=t=>D0(t).nextNode()!==null,mA=t=>P0(t).nextNode()!==null,gA=(t,e)=>e.querySelector(L0(t))!==null,fA=(t,e)=>{J(((n,o)=>o.querySelectorAll(L0(n)))(t,e),n=>{const o=F(n);Pt(o,"data-mce-bogus")==="all"?le(o):J(t,r=>{Yt(o,r)&&C(o,r)})})},I0=t=>{let e=t.nextNode();for(;e!==null;)e.nodeValue=null,e=t.nextNode()},pA=qe(I0,D0),hA=qe(I0,P0),M0=(t,e)=>{const n=[{condition:ft(gA,e),action:ft(fA,e)},{condition:uA,action:pA},{condition:mA,action:hA}];let o=t,r=!1;return J(n,({condition:s,action:a})=>{s(o)&&(r||(o=t.cloneNode(!0),r=!0),a(o))}),o},F0=t=>{const e=dn(t,"[data-mce-bogus]");J(e,n=>{Pt(n,"data-mce-bogus")==="all"?le(n):Ka(n)?(hn(n,Rs(Ua)),le(n)):no(n)})},U0=t=>{const e=dn(t,"input");J(e,n=>{C(n,"name")})},bA=(t,e,n)=>{let o;return o=e.format==="raw"?st.trim(wo(M0(n,t.serializer.getTempAttrs()).innerHTML)):e.format==="text"?((r,s)=>{const a=r.getDoc(),i=Qr(F(r.getBody())),l=xe("div",a);et(l,"data-mce-bogus","all"),xi(l,{position:"fixed",left:"-9999999px",top:"0"}),_i(l,s.innerHTML),F0(l),U0(l);const c=(u=>bl(u)?u:F(Ar(u).dom.body))(i);Ie(c,l);const d=wo(l.dom.innerText);return le(l),d})(t,n):e.format==="tree"?t.serializer.serialize(n,e):((r,s)=>{const a=Nn(r),i=new RegExp(`^(<${a}[^>]*>(&nbsp;|&#160;|\\s|\xA0|<br \\/>|)<\\/${a}>[\r
]*|<br \\/>[\r
]*)$`);return s.replace(i,"")})(t,t.serializer.serialize(n,e)),e.format!=="text"&&!Cd(F(n))&&vt(o)?st.trim(o):o},z0=st.makeMap,$0=t=>{const e=[],n=(t=t||{}).indent,o=z0(t.indent_before||""),r=z0(t.indent_after||""),s=Ha.getEncodeFunc(t.entity_encoding||"raw",t.entities),a=t.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&o[i]&&e.length>0){const d=e[e.length-1];d.length>0&&d!==`
`&&e.push(`
`)}if(e.push("<",i),l)for(let d=0,u=l.length;d<u;d++){const m=l[d];e.push(" ",m.name,'="',s(m.value,!0),'"')}if(e[e.length]=!c||a?">":" />",c&&n&&r[i]&&e.length>0){const d=e[e.length-1];d.length>0&&d!==`
`&&e.push(`
`)}},end:i=>{let l;e.push("</",i,">"),n&&r[i]&&e.length>0&&(l=e[e.length-1],l.length>0&&l!==`
`&&e.push(`
`))},text:(i,l)=>{i.length>0&&(e[e.length]=l?i:s(i))},cdata:i=>{e.push("<![CDATA[",i,"]]>")},comment:i=>{e.push("<!--",i,"-->")},pi:(i,l)=>{l?e.push("<?",i," ",s(l),"?>"):e.push("<?",i,"?>"),n&&e.push(`
`)},doctype:i=>{e.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{e.length=0},getContent:()=>e.join("").replace(/\n$/,"")}},va=(t={},e=ua())=>{const n=$0(t);return t.validate=!("validate"in t)||t.validate,{serialize:o=>{const r=t.validate,s={3:i=>{var l;n.text((l=i.value)!==null&&l!==void 0?l:"",i.raw)},8:i=>{var l;n.comment((l=i.value)!==null&&l!==void 0?l:"")},7:i=>{n.pi(i.name,i.value)},10:i=>{var l;n.doctype((l=i.value)!==null&&l!==void 0?l:"")},4:i=>{var l;n.cdata((l=i.value)!==null&&l!==void 0?l:"")},11:i=>{let l=i;if(l=l.firstChild)do a(l);while(l=l.next)}};n.reset();const a=i=>{var l;const c=s[i.type];if(c)c(i);else{const d=i.name,u=d in e.getVoidElements();let m=i.attributes;if(r&&m&&m.length>1){const h=[];h.map={};const f=e.getElementRule(i.name);if(f){for(let b=0,p=f.attributesOrder.length;b<p;b++){const y=f.attributesOrder[b];if(y in m.map){const w=m.map[y];h.map[y]=w,h.push({name:y,value:w})}}for(let b=0,p=m.length;b<p;b++){const y=m[b].name;if(!(y in h.map)){const w=m.map[y];h.map[y]=w,h.push({name:y,value:w})}}m=h}}if(n.start(d,m,u),Fs(d))vt(i.value)&&n.text(i.value,!0),n.end(d);else if(!u){let h=i.firstChild;if(h){d!=="pre"&&d!=="textarea"||h.type!==3||((l=h.value)===null||l===void 0?void 0:l[0])!==`
`||n.text(`
`,!0);do a(h);while(h=h.next)}n.end(d)}}};return o.type!==1||t.inner?o.type===3?s[3](o):s[11](o):a(o),n.getContent()}}},H0=new Set;J(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{H0.add(t)});const j0=new Set;J(["background-color"],t=>{j0.add(t)});const V0=["font","text-decoration","text-emphasis"],Xi=(t,e)=>je(((n,o)=>n.parseStyle(n.getAttrib(o,"style")))(t,e)),q0=(t,e)=>de(Xi(t,e),n=>(o=>H0.has(o))(n)),W0=(t,e,n)=>x.from(n.container()).filter(rt).exists(o=>{const r=t?0:-1;return e(o.data.charAt(n.offset()+r))}),Pg=ft(W0,!0,Ja),Ig=ft(W0,!1,Ja),vA=t=>{const e=t.container();return rt(e)&&(e.data.length===0||wd(e.data)&&dc.isBookmarkNode(e.parentNode))},ya=(t,e)=>n=>Zm(t?0:-1,n).filter(e).isSome(),K0=t=>ud(t)&&lr(F(t),"display")==="block",G0=t=>me(t)&&!(e=>wt(e)&&e.getAttribute("data-mce-bogus")==="all")(t),yA=ya(!0,K0),CA=ya(!1,K0),gc=ya(!0,ur),fc=ya(!1,ur),Y0=ya(!0,dr),Mg=ya(!1,dr),Ca=ya(!0,G0),wa=ya(!1,G0),X0=(t,e)=>((n,o,r)=>Pn(o,n)?Yc(n,s=>r(s)||ne(s,o)).slice(0,-1):[])(t,e,te),$s=(t,e)=>[t].concat(X0(t,e)),Fg=(t,e,n)=>Ev(t,e,n,vA),Q0=(t,e,n)=>Te($s(F(e.container()),t),(o=>r=>o.isBlock(Gt(r)))(n)),Z0=(t,e,n,o)=>Fg(t,e.dom,n).forall(r=>Q0(e,n,o).fold(()=>!ss(r,n,e.dom),s=>!ss(r,n,e.dom)&&Pn(s,F(r.container())))),J0=(t,e,n,o)=>Q0(e,n,o).fold(()=>Fg(t,e.dom,n).forall(r=>!ss(r,n,e.dom)),r=>Fg(t,r.dom,n).isNone()),Ug=ft(J0,!1),ty=ft(J0,!0),wA=ft(Z0,!1),SA=ft(Z0,!0),kA=t=>Ld(t).exists(Ka),Zd=(t,e,n,o)=>{const r=Ot($s(F(n.container()),e),a=>o.isBlock(Gt(a))),s=We(r).getOr(e);return Mo(t,s.dom,n).filter(kA)},zg=(t,e,n)=>Ld(e).exists(Ka)||Zd(!0,t,e,n).isSome(),Jd=(t,e,n)=>(o=>x.from(o.getNode(!0)).map(F))(e).exists(Ka)||Zd(!1,t,e,n).isSome(),ey=ft(Zd,!1),xA=ft(Zd,!0),ny=t=>X.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd(),oy=(t,e,n)=>{const o=Ot($s(F(e.container()),t),r=>n.isBlock(Gt(r)));return We(o).getOr(t)},ry=(t,e,n)=>ny(e)?Ig(e):Ig(e)||so(oy(t,e,n).dom,e).exists(Ig),sy=(t,e,n)=>ny(e)?Pg(e):Pg(e)||Wn(oy(t,e,n).dom,e).exists(Pg),$g=t=>Ld(t).bind(e=>Zr(e,on)).exists(e=>(n=>Xt(["pre","pre-wrap"],n))(lr(e,"white-space"))),ay=(t,e)=>n=>{return o=new Ge(n,t)[e](),q(o)&&me(o)&&mv(o);var o},iy=(t,e,n)=>!$g(e)&&(((o,r,s)=>((a,i)=>so(a.dom,i).isNone())(o,r)||((a,i)=>Wn(a.dom,i).isNone())(o,r)||Ug(o,r,s)||ty(o,r,s)||Jd(o,r,s)||zg(o,r,s))(t,e,n)||ry(t,e,n)||sy(t,e,n)),pc=(t,e,n)=>!$g(e)&&(Ug(t,e,n)||wA(t,e,n)||Jd(t,e,n)||ry(t,e,n)||((o,r)=>{const s=so(o.dom,r).getOr(r),a=ay(o.dom,"prev");return r.isAtStart()&&(a(r.container())||a(s.container()))})(t,e)),hc=(t,e,n)=>!$g(e)&&(ty(t,e,n)||SA(t,e,n)||zg(t,e,n)||sy(t,e,n)||((o,r)=>{const s=Wn(o.dom,r).getOr(r),a=ay(o.dom,"next");return r.isAtEnd()&&(a(r.container())||a(s.container()))})(t,e)),Hg=(t,e,n)=>pc(t,e,n)||hc(t,(o=>{const r=o.container(),s=o.offset();return rt(r)&&s<r.data.length?X(r,s+1):o})(e),n),ly=(t,e)=>Md(t.charAt(e)),cy=(t,e)=>Ja(t.charAt(e)),dy=(t,e,n,o)=>{const r=e.data,s=X(e,0);return n||!ly(r,0)||Hg(t,s,o)?!!(n&&cy(r,0)&&pc(t,s,o))&&(e.data=ze+r.slice(1),!0):(e.data=" "+r.slice(1),!0)},uy=(t,e,n,o)=>{const r=e.data,s=X(e,r.length-1);return n||!ly(r,r.length-1)||Hg(t,s,o)?!!(n&&cy(r,r.length-1)&&hc(t,s,o))&&(e.data=r.slice(0,-1)+ze,!0):(e.data=r.slice(0,-1)+" ",!0)},EA=(t,e,n)=>{const o=e.container();if(!rt(o))return x.none();if((r=>{const s=r.container();return rt(s)&&Pe(s.data,ze)})(e)){const r=dy(t,o,!1,n)||(s=>{const a=s.data,i=(l=>{const c=l.split("");return qt(c,(d,u)=>Md(d)&&u>0&&u<c.length-1&&sg(c[u-1])&&sg(c[u+1])?" ":d).join("")})(a);return i!==a&&(s.data=i,!0)})(o)||uy(t,o,!1,n);return Lo(r,e)}if(Hg(t,e,n)){const r=dy(t,o,!0,n)||uy(t,o,!0,n);return Lo(r,e)}return x.none()},my=(t,e,n,o)=>{if(n===0)return;const r=F(t),s=Tr(r,c=>o.isBlock(Gt(c))).getOr(r),a=t.data.slice(e,e+n),i=e+n>=t.data.length&&hc(s,X(t,t.data.length),o),l=e===0&&pc(s,X(t,0),o);t.replaceData(e,n,Rl(a,4,l,i))},tu=(t,e,n)=>{const o=t.data.slice(e),r=o.length-ws(o).length;my(t,e,r,n)},jg=(t,e,n)=>{const o=t.data.slice(0,e),r=o.length-po(o).length;my(t,e-r,r,n)},Vg=(t,e,n,o,r=!0)=>{const s=po(t.data).length,a=r?t:e,i=r?e:t;return r?a.appendData(i.data):a.insertData(0,i.data),le(F(i)),o&&tu(a,s,n),a},_A=(t,e)=>((n,o)=>{const r=n.container(),s=n.offset();return!X.isTextPosition(n)&&r===o.parentNode&&s>X.before(o).offset()})(e,t)?X(e.container(),e.offset()-1):e,gy=t=>{return Dr(t.previousSibling)?x.some((e=t.previousSibling,rt(e)?X(e,e.data.length):X.after(e))):t.previousSibling?gr(t.previousSibling):x.none();var e},fy=t=>{return Dr(t.nextSibling)?x.some((e=t.nextSibling,rt(e)?X(e,0):X.before(e))):t.nextSibling?An(t.nextSibling):x.none();var e},NA=(t,e,n)=>((o,r,s)=>o?((a,i)=>fy(i).orThunk(()=>gy(i)).orThunk(()=>((l,c)=>Wn(l,X.after(c)).orThunk(()=>so(l,X.before(c))))(a,i)))(r,s):((a,i)=>gy(i).orThunk(()=>fy(i)).orThunk(()=>((l,c)=>x.from(c.previousSibling?c.previousSibling:c.parentNode).bind(d=>so(l,X.before(d))).orThunk(()=>Wn(l,X.after(c))))(a,i)))(r,s))(t,e,n).map(ft(_A,n)),py=(t,e,n)=>{n.fold(()=>{t.focus()},o=>{t.selection.setRng(o.toRange(),e)})},AA=(t,e)=>e&&Bt(t.schema.getBlockElements(),Gt(e)),oi=(t,e,n,o=!0,r=!1)=>{const s=NA(e,t.getBody(),n.dom),a=Tr(n,ft(AA,t),(i=t.getBody(),c=>c.dom===i));var i;const l=((c,d,u,m)=>{const h=Rr(c).filter(Be),f=Pa(c).filter(Be);return le(c),(b=h,p=f,y=d,w=(S,N,E)=>{const R=S.dom,I=N.dom,D=R.data.length;return Vg(R,I,u,m),E.container()===I?X(R,D):E},b.isSome()&&p.isSome()&&y.isSome()?x.some(w(b.getOrDie(),p.getOrDie(),y.getOrDie())):x.none()).orThunk(()=>(m&&(h.each(S=>jg(S.dom,S.dom.length,u)),f.each(S=>tu(S.dom,0,u))),d));var b,p,y,w})(n,s,t.schema,((c,d)=>Bt(c.schema.getTextInlineElements(),Gt(d)))(t,n));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):a.bind(c=>((d,u,m)=>{if(sn(d,u)){const h=As('<br data-mce-bogus="1">');return m?J(rn(u),f=>{vg(f)||le(f)}):la(u),Ie(u,h),x.some(X.before(h.dom))}return x.none()})(t.schema,c,r)).fold(()=>{o&&py(t,e,l)},c=>{o&&py(t,e,x.some(c))})},RA=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,ri=(t,e)=>eo(F(e),x_(t))&&!_e(t.schema,e)&&t.dom.isEditable(e),hy=t=>{var e;return ye.DOM.getStyle(t,"direction",!0)==="rtl"||(n=>RA.test(n))((e=t.textContent)!==null&&e!==void 0?e:"")},Sa=(t,e,n)=>{const o=((r,s,a)=>Ot(ye.DOM.getParents(a.container(),"*",s),r))(t,e,n);return x.from(o[o.length-1])},Ho=(t,e)=>{const n=e.container(),o=e.offset();return t?ga(n)?rt(n.nextSibling)?X(n.nextSibling,0):X.after(n):Bm(e)?X(n,o+1):e:ga(n)?rt(n.previousSibling)?X(n.previousSibling,n.previousSibling.data.length):X.before(n):Lm(e)?X(n,o-1):e},by=ft(Ho,!0),vy=ft(Ho,!1),yy=(t,e)=>{const n=o=>o.stopImmediatePropagation();t.on("beforeinput input",n,!0),t.getDoc().execCommand(e),t.off("beforeinput input",n)},eu=t=>yy(t,"Delete"),Cy=t=>yy(t,"ForwardDelete"),TA=t=>Jh(t)||Di(t),nu=(t,e)=>Pn(t,e)?Zr(e,TA,(n=>o=>bo(pn(o),n,ne))(t)):x.none(),qg=(t,e=!0)=>{t.dom.isEmpty(t.getBody())&&t.setContent("",{no_selection:!e})},wy=(t,e,n)=>ke(An(n),gr(n),(o,r)=>{const s=Ho(!0,o),a=Ho(!1,r),i=Ho(!1,e);return t?Wn(n,i).exists(l=>l.isEqual(a)&&e.isEqual(s)):so(n,i).exists(l=>l.isEqual(s)&&e.isEqual(a))}).getOr(!0),Sy=t=>{var e;return(Ns(e=t)===8||Gt(e)==="#comment"?Rr(t):pl(t)).bind(Sy).orThunk(()=>x.some(t))},ky=(t,e,n,o=!0)=>{var r;e.deleteContents();const s=Sy(n).getOr(n),a=F((r=t.dom.getParent(s.dom,t.dom.isBlock))!==null&&r!==void 0?r:n.dom);if(a.dom===t.getBody()?qg(t,o):sn(t.schema,a,{checkRootAsContent:!1})&&(ma(a),o&&t.selection.setCursorLocation(a.dom,0)),!ne(n,a)){const l=bo(pn(a),n)?[]:pn(i=a).map(rn).map(c=>Ot(c,d=>!ne(i,d))).getOr([]);J(l.concat(rn(n)),c=>{ne(c,a)||Pn(c,a)||!sn(t.schema,c)||le(c)})}var i},Wg=t=>dn(t,"td,th"),xy=(t,e)=>ic(F(t),e),Kg=(t,e)=>({start:t,end:e}),bc=rs([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),ou=(t,e)=>Ts(F(t),"td,th",e),Ey=t=>!ne(t.start,t.end),_y=(t,e)=>ic(t.start,e).bind(n=>ic(t.end,e).bind(o=>Lo(ne(n,o),n))),Gg=t=>e=>_y(e,t).map(n=>((o,r,s)=>({rng:o,table:r,cells:s}))(e,n,Wg(n))),Ny=(t,e,n,o)=>{if(n.collapsed||!t.forall(Ey))return x.none();if(e.isSameTable){const r=t.bind(Gg(o));return x.some({start:r,end:r})}{const r=ou(n.startContainer,o),s=ou(n.endContainer,o),a=r.bind((l=>c=>ic(c,l).bind(d=>Bn(Wg(d)).map(u=>Kg(c,u))))(o)).bind(Gg(o)),i=s.bind((l=>c=>ic(c,l).bind(d=>We(Wg(d)).map(u=>Kg(u,c))))(o)).bind(Gg(o));return x.some({start:a,end:i})}},Ay=(t,e)=>oe(t,n=>ne(n,e)),Yg=t=>ke(Ay(t.cells,t.rng.start),Ay(t.cells,t.rng.end),(e,n)=>t.cells.slice(e,n+1)),Ry=(t,e)=>{const{startTable:n,endTable:o}=e,r=t.cloneRange();return n.each(s=>r.setStartAfter(s.dom)),o.each(s=>r.setEndBefore(s.dom)),r},OA=(t,e)=>{const n=(s=>a=>ne(s,a))(t),o=((s,a)=>{const i=ou(s.startContainer,a),l=ou(s.endContainer,a);return ke(i,l,Kg)})(e,n),r=((s,a)=>{const i=xy(s.startContainer,a),l=xy(s.endContainer,a),c=i.isSome(),d=l.isSome(),u=ke(i,l,ne).getOr(!1);return(m=>ke(m.startTable,m.endTable,(h,f)=>{const b=_l(h,y=>ne(y,f)),p=_l(f,y=>ne(y,h));return b||p?{...m,startTable:b?x.none():m.startTable,endTable:p?x.none():m.endTable,isSameTable:!1,isMultiTable:!1}:m}).getOr(m))({startTable:i,endTable:l,isStartInTable:c,isEndInTable:d,isSameTable:u,isMultiTable:!u&&c&&d})})(e,n);return((s,a,i)=>s.exists(l=>((c,d)=>!Ey(c)&&_y(c,d).exists(u=>{const m=u.dom.rows;return m.length===1&&m[0].cells.length===1}))(l,i)&&lg(l.start,a)))(o,e,n)?o.map(s=>bc.singleCellTable(e,s.start)):r.isMultiTable?((s,a,i,l)=>Ny(s,a,i,l).bind(({start:c,end:d})=>{const u=c.bind(Yg).getOr([]),m=d.bind(Yg).getOr([]);if(u.length>0&&m.length>0){const h=Ry(i,a);return x.some(bc.multiTable(u,m,h))}return x.none()}))(o,r,e,n):((s,a,i,l)=>Ny(s,a,i,l).bind(({start:c,end:d})=>c.or(d)).bind(c=>{const{isSameTable:d}=a,u=Yg(c).getOr([]);if(d&&c.cells.length===u.length)return x.some(bc.fullTable(c.table));if(u.length>0){if(d)return x.some(bc.partialTable(u,x.none()));{const m=Ry(i,a);return x.some(bc.partialTable(u,x.some({...a,rng:m})))}}return x.none()}))(o,r,e,n)},Ty=t=>J(t,e=>{C(e,"contenteditable"),ma(e)}),Xg=(t,e,n,o)=>{const r=n.cloneRange();o?(r.setStart(n.startContainer,n.startOffset),r.setEndAfter(e.dom.lastChild)):(r.setStartBefore(e.dom.firstChild),r.setEnd(n.endContainer,n.endOffset)),Qg(t,r,e,!1).each(s=>s())},Oy=t=>{const e=Vi(t),n=F(t.selection.getNode());Ri(n.dom)&&sn(t.schema,n)?t.selection.setCursorLocation(n.dom,0):t.selection.collapse(!0),e.length>1&&de(e,o=>ne(o,n))&&et(n,"data-mce-selected","1")},By=(t,e,n)=>x.some(()=>{const o=t.selection.getRng(),r=n.bind(({rng:s,isStartInTable:a})=>{const i=((c,d)=>x.from(c.dom.getParent(d,c.dom.isBlock)).map(F))(t,a?s.endContainer:s.startContainer);s.deleteContents(),((c,d,u)=>{u.each(m=>{d?le(m):(ma(m),c.selection.setCursorLocation(m.dom,0))})})(t,a,i.filter(ft(sn,t.schema)));const l=a?e[0]:e[e.length-1];return Xg(t,l,o,a),sn(t.schema,l)?x.none():x.some(a?e.slice(1):e.slice(0,-1))}).getOr(e);Ty(r),Oy(t)}),BA=(t,e,n,o)=>x.some(()=>{const r=t.selection.getRng(),s=e[0],a=n[n.length-1];Xg(t,s,r,!0),Xg(t,a,r,!1);const i=sn(t.schema,s)?e:e.slice(1),l=sn(t.schema,a)?n:n.slice(0,-1);Ty(i.concat(l)),o.deleteContents(),Oy(t)}),Qg=(t,e,n,o=!0)=>x.some(()=>{ky(t,e,n,o)}),LA=(t,e)=>x.some(()=>oi(t,!1,e)),Ly=(t,e)=>Te($s(e,t),Gl),Zg=(t,e)=>Te($s(e,t),j("caption")),ru=(t,e)=>x.some(()=>{ma(e),t.selection.setCursorLocation(e.dom,0)}),Dy=(t,e)=>t?Y0(e):Mg(e),DA=(t,e,n)=>{const o=F(t.getBody());return Zg(o,n).fold(()=>((r,s,a,i)=>{const l=X.fromRangeStart(r.selection.getRng());return Ly(a,i).bind(c=>sn(r.schema,c,{checkRootAsContent:!1})?ru(r,c):((d,u,m,h,f)=>Hi(m,d.getBody(),f).bind(b=>Ly(u,F(b.getNode())).bind(p=>ne(p,h)?x.none():x.some(Dt))))(r,a,s,c,l))})(t,e,o,n).orThunk(()=>Lo(((r,s)=>{const a=X.fromRangeStart(r.selection.getRng());return Dy(s,a)||Mo(s,r.getBody(),a).exists(i=>Dy(s,i))})(t,e),Dt)),r=>((s,a,i,l)=>{const c=X.fromRangeStart(s.selection.getRng());return sn(s.schema,l)?ru(s,l):((d,u,m,h,f)=>Hi(m,d.getBody(),f).fold(()=>x.some(Dt),b=>((p,y,w,S)=>An(p.dom).bind(N=>gr(p.dom).map(E=>y?w.isEqual(N)&&S.isEqual(E):w.isEqual(E)&&S.isEqual(N))).getOr(!0))(h,m,f,b)?((p,y)=>ru(p,y))(d,h):((p,y,w)=>Zg(p,F(w.getNode())).fold(()=>x.some(Dt),S=>Lo(!ne(S,y),Dt)))(u,h,b)))(s,i,a,l,c)})(t,e,o,r))},Jg=(t,e)=>{const n=F(t.selection.getStart(!0)),o=Vi(t);return t.selection.isCollapsed()&&o.length===0?DA(t,e,n):((r,s,a)=>{const i=F(r.getBody()),l=r.selection.getRng();return a.length!==0?By(r,a,x.none()):((c,d,u,m)=>Zg(d,m).fold(()=>((h,f,b)=>OA(f,b).bind(p=>p.fold(ft(Qg,h),ft(LA,h),ft(By,h),ft(BA,h))))(c,d,u),h=>((f,b)=>ru(f,b))(c,h)))(r,i,l,s)})(t,n,o)},si=(t,e)=>{let n=e;for(;n&&n!==t;){if(ro(n)||me(n))return n;n=n.parentNode}return null},PA=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],IA=st.each,tf=t=>{const e=t.dom,n=new Set(t.serializer.getTempAttrs()),o=r=>de(PA,s=>ie(r,s))||n.has(r);return{compare:(r,s)=>{if(r.nodeName!==s.nodeName||r.nodeType!==s.nodeType)return!1;const a=l=>{const c={};return IA(e.getAttribs(l),d=>{const u=d.nodeName.toLowerCase();u==="style"||o(u)||(c[u]=e.getAttrib(l,u))}),c},i=(l,c)=>{for(const d in l)if(Bt(l,d)){const u=c[d];if(tt(u)||l[d]!==u)return!1;delete c[d]}for(const d in c)if(Bt(c,d))return!1;return!0};return wt(r)&&wt(s)&&(!i(a(r),a(s))||!i(e.parseStyle(e.getAttrib(r,"style")),e.parseStyle(e.getAttrib(s,"style"))))?!1:!Uo(r)&&!Uo(s)},isAttributeInternal:o}},Py=t=>["h1","h2","h3","h4","h5","h6"].includes(t.name),Iy=(t,e,n,o)=>{const r=n.name;for(let s=0,a=t.length;s<a;s++){const i=t[s];if(i.name===r){const l=o.nodes[r];l?l.nodes.push(n):o.nodes[r]={filter:i,nodes:[n]}}}if(n.attributes)for(let s=0,a=e.length;s<a;s++){const i=e[s],l=i.name;if(l in n.attributes.map){const c=o.attributes[l];c?c.nodes.push(n):o.attributes[l]={filter:i,nodes:[n]}}}},My=(t,e)=>{const n=(o,r)=>{re(o,s=>{const a=Oe(s.nodes);J(s.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(r?c.attr(s.filter.name)!==void 0:c.name===s.filter.name)&&!Ht(c.parent)||a.splice(l,1)}a.length>0&&i(a,s.filter.name,e)})})};n(t.nodes,!1),n(t.attributes,!0)},Fy=(t,e,n,o={})=>{const r=((s,a,i)=>{const l={nodes:{},attributes:{}};return i.firstChild&&(c=>{let d=c;for(;d=d.walk();)Iy(s,a,d,l)})(i),l})(t,e,n);My(r,o)},ef=(t,e,n,o)=>{if((t.pad_empty_with_br||e.insert)&&n(o)){const r=new Fn("br",1);e.insert&&r.attr("data-mce-bogus","1"),o.empty().append(r)}else o.empty().append(new Fn("#text",3)).value=ze},Uy=(t,e)=>{const n=t?.firstChild;return q(n)&&n===t.lastChild&&n.name===e},vc=(t,e,n,o)=>o.isEmpty(e,n,r=>((s,a)=>{const i=s.getElementRule(a.name);return i?.paddEmpty===!0})(t,r)),MA=t=>{let e;for(let n=t;n;n=n.parent){const o=n.attr("contenteditable");if(o==="false")break;o==="true"&&(e=n)}return x.from(e)},nf=(t,e,n=t.parent)=>{if(e.getSpecialElements()[t.name])t.empty().remove();else{const o=t.children();for(const r of o)n&&!e.isValidChild(n.name,r.name)&&nf(r,e,n);t.unwrap()}},of=(t,e,n,o=Dt)=>{const r=e.getTextBlockElements(),s=e.getNonEmptyElements(),a=e.getWhitespaceElements(),i=st.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),l=new Set,c=d=>d!==n&&!i[d.name];for(let d=0;d<t.length;d++){const u=t[d];let m,h,f;if(!u.parent||l.has(u))continue;if(r[u.name]&&u.parent.name==="li"){let p=u.next;for(;p&&r[p.name];)p.name="li",l.add(p),u.parent.insert(p,u.parent),p=p.next;u.unwrap();continue}const b=[u];for(m=u.parent;m&&!e.isValidChild(m.name,u.name)&&c(m);m=m.parent)b.push(m);if(m&&b.length>1)if(rf(e,u,m))nf(u,e);else{b.reverse(),h=b[0].clone(),o(h);let p=h;for(let y=0;y<b.length-1;y++){e.isValidChild(p.name,b[y].name)&&y>0?(f=b[y].clone(),o(f),p.append(f)):f=p;for(let w=b[y].firstChild;w&&w!==b[y+1];){const S=w.next;f.append(w),w=S}p=f}vc(e,s,a,h)?m.insert(u,b[0],!0):(m.insert(h,b[0],!0),m.insert(u,h)),m=b[0],(vc(e,s,a,m)||Uy(m,"br"))&&m.empty().remove()}else if(u.parent){if(u.name==="li"){let p=u.prev;if(p&&(p.name==="ul"||p.name==="ol")){p.append(u);continue}if(p=u.next,p&&(p.name==="ul"||p.name==="ol")&&p.firstChild){p.insert(u,p.firstChild,!0);continue}const y=new Fn("ul",1);o(y),u.wrap(y);continue}if(e.isValidChild(u.parent.name,"div")&&e.isValidChild("div",u.name)){const p=new Fn("div",1);o(p),u.wrap(p)}else nf(u,e)}}},rf=(t,e,n=e.parent)=>!(!n||(!t.children[e.name]||t.isValidChild(n.name,e.name))&&(e.name!=="a"||!(o=>{let r=o;for(;r;){if(r.name==="a")return!0;r=r.parent}return!1})(n))&&(!(o=>o.name==="summary")(n)||!Py(e)||n?.firstChild===e&&n?.lastChild===e)),sf=t=>t.collapsed?t:(e=>{const n=X.fromRangeStart(e),o=X.fromRangeEnd(e),r=e.commonAncestorContainer;return Mo(!1,r,o).map(s=>!ss(n,o,r)&&ss(n,s,r)?((a,i,l,c)=>{const d=document.createRange();return d.setStart(a,i),d.setEnd(l,c),d})(n.container(),n.offset(),s.container(),s.offset()):e).getOr(e)})(t),FA=(t,e)=>{let n=e.firstChild,o=e.lastChild;return n&&n.name==="meta"&&(n=n.next),o&&o.attr("id")==="mce_marker"&&(o=o.prev),((r,s)=>{const a=r.getNonEmptyElements();return q(s)&&(s.isEmpty(a)||((i,l)=>i.getBlockElements()[l.name]&&(c=>q(c.firstChild)&&c.firstChild===c.lastChild)(l)&&(c=>c.name==="br"||c.value===ze)(l.firstChild))(r,s))})(t,o)&&(o=o?.prev),!(!n||n!==o||n.name!=="ul"&&n.name!=="ol")},UA=t=>{return t.length>0&&(!(n=t[t.length-1]).firstChild||q((e=n)==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&(o=>o.data===ze||Ee(o))(e.firstChild))?t.slice(0,-1):t;var e,n},af=(t,e)=>{const n=t.getParent(e,t.isBlock);return n&&n.nodeName==="LI"?n:null},zy=(t,e)=>{const n=X.after(t),o=is(e).prev(n);return o?o.toRange():null},zA=(t,e,n,o)=>{const r=((u,m,h)=>{const f=m.serialize(h);return(b=>{var p,y;const w=b.firstChild,S=b.lastChild;return w&&w.nodeName==="META"&&((p=w.parentNode)===null||p===void 0||p.removeChild(w)),S&&S.id==="mce_marker"&&((y=S.parentNode)===null||y===void 0||y.removeChild(S)),b})(u.createFragment(f))})(e,t,o),s=af(e,n.startContainer),a=UA((i=r.firstChild,Ot((l=i?.childNodes)!==null&&l!==void 0?l:[],u=>u.nodeName==="LI")));var i,l;const c=e.getRoot(),d=u=>{const m=X.fromRangeStart(n),h=is(e.getRoot()),f=u===1?h.prev(m):h.next(m),b=f?.getNode();return!b||af(e,b)!==s};return s?d(1)?((u,m,h)=>{const f=u.parentNode;return f&&st.each(m,b=>{f.insertBefore(b,u)}),((b,p)=>{const y=X.before(b),w=is(p).next(y);return w?w.toRange():null})(u,h)})(s,a,c):d(2)?((u,m,h,f)=>(f.insertAfter(m.reverse(),u),zy(m[0],h)))(s,a,c,e):((u,m,h,f)=>{const b=((y,w)=>{const S=w.cloneRange(),N=w.cloneRange();return S.setStartBefore(y),N.setEndAfter(y),[S.cloneContents(),N.cloneContents()]})(u,f),p=u.parentNode;return p&&(p.insertBefore(b[0],u),st.each(m,y=>{p.insertBefore(y,u)}),p.insertBefore(b[1],u),p.removeChild(u)),zy(m[m.length-1],h)})(s,a,c,n):null},$A=["pre"],lf=Ri,HA=(t,e,n)=>{var o,r;const s=t.selection,a=t.dom,i=t.parser,l=n.merge,c=va({validate:!0},t.schema),d='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(e=wo(e)),e.indexOf("{$caret}")===-1&&(e+="{$caret}"),e=e.replace(/\{\$caret\}/,d);let u=s.getRng();const m=u.startContainer,h=t.getBody();m===h&&s.isCollapsed()&&a.isBlock(h.firstChild)&&((S,N)=>q(N)&&!S.schema.getVoidElements()[N.nodeName])(t,h.firstChild)&&a.isEmpty(h.firstChild)&&(u=a.createRng(),u.setStart(h.firstChild,0),u.setEnd(h.firstChild,0),s.setRng(u)),s.isCollapsed()||(S=>{const N=S.dom,E=sf(S.selection.getRng());S.selection.setRng(E);const R=N.getParent(E.startContainer,lf);((I,D,$)=>!!q($)&&$===I.getParent(D.endContainer,lf)&&lg(F($),D))(N,E,R)?Qg(S,E,F(R)):E.startContainer===E.endContainer&&E.endOffset-E.startOffset==1&&rt(E.startContainer.childNodes[E.startOffset])?E.deleteContents():S.getDoc().execCommand("Delete",!1)})(t);const f=s.getNode(),b={context:f.nodeName.toLowerCase(),data:n.data,insert:!0},p=i.parse(e,b);if(n.paste===!0&&FA(t.schema,p)&&((S,N)=>!!af(S,N))(a,f))return u=zA(c,a,s.getRng(),p),u&&s.setRng(u),e;n.paste===!0&&((S,N,E,R)=>{var I;const D=N.firstChild,$=N.lastChild,W=D===($.attr("data-mce-type")==="bookmark"?$.prev:$),B=Xt($A,D.name);if(W&&B){const P=D.attr("contenteditable")!=="false",z=((I=S.getParent(E,S.isBlock))===null||I===void 0?void 0:I.nodeName.toLowerCase())===D.name,Q=x.from(si(R,E)).forall(ro);return P&&z&&Q}return!1})(a,p,f,t.getBody())&&((o=p.firstChild)===null||o===void 0||o.unwrap()),(S=>{let N=S;for(;N=N.walk();)N.type===1&&N.attr("data-mce-fragment","1")})(p);let y=p.lastChild;if(y&&y.attr("id")==="mce_marker"){const S=y;for(y=y.prev;y&&y.name!=="table";y=y.walk(!0))if(y.type===3||!a.isBlock(y.name)){y.parent&&t.schema.isValidChild(y.parent.name,"span")&&y.parent.insert(S,y,y.name==="br");break}}if(t._selectionOverrides.showBlockCaretContainer(f),b.invalid||((S,N,E)=>{var R;return de(E.children(),Py)&&((R=S.getParent(N,S.isBlock))===null||R===void 0?void 0:R.nodeName)==="SUMMARY"})(a,f,p)){t.selection.setContent(d);let S,N=s.getNode();const E=t.getBody();for(Ms(N)?N=S=E:S=N;S&&S!==E;)N=S,S=S.parentNode;e=N===E?E.innerHTML:a.getOuterHTML(N);const R=i.parse(e),I=(P=>{for(let z=P;z;z=z.walk())if(z.attr("id")==="mce_marker")return x.some(z);return x.none()})(R),D=I.bind(MA).getOr(R);I.each(P=>P.replace(p));const $=p.children(),W=(r=p.parent)!==null&&r!==void 0?r:R;p.unwrap();const B=Ot($,P=>rf(t.schema,P,W));of(B,t.schema,D),Fy(i.getNodeFilters(),i.getAttributeFilters(),R),e=c.serialize(R),N===E?a.setHTML(E,e):a.setOuterHTML(N,e)}else e=c.serialize(p),((S,N,E)=>{var R;E.getAttribute("data-mce-bogus")==="all"?(R=E.parentNode)===null||R===void 0||R.insertBefore(S.dom.createFragment(N),E):((I,D)=>{if(I.isBlock(D)&&I.isEditable(D)){const $=D.childNodes;return $.length===1&&Ee($[0])||$.length===0}return!1})(S.dom,E)?S.dom.setHTML(E,N):S.selection.setContent(N,{no_events:!0})})(t,e,f);var w;return((S,N)=>{const E=S.schema.getTextInlineElements(),R=S.dom;if(N){const I=S.getBody(),D=tf(S),$="*[data-mce-fragment]",W=R.select($);st.each(W,B=>{const P=at=>q(E[at.nodeName.toLowerCase()]),z=at=>at.childNodes.length===1;if(!q0(R,Q=B)&&!((at,ot)=>q0(at,ot)&&de(Xi(at,ot),yt=>(St=>j0.has(St))(yt)))(R,Q)&&P(B)&&z(B)){const at=Xi(R,B),ot=(Nt,dt)=>kn(Nt,Ct=>Xt(dt,Ct)),yt=Nt=>z(B)&&R.is(Nt,$)&&P(Nt)&&(Nt.nodeName===B.nodeName&&ot(at,Xi(R,Nt))||yt(Nt.children[0])),St=Nt=>q(Nt)&&Nt!==I&&(D.compare(B,Nt)||St(Nt.parentElement)),kt=Nt=>q(Nt)&&Nt!==I&&R.is(Nt,$)&&(((dt,Ct,U)=>{const H=Xi(dt,Ct),Y=Xi(dt,U),G=ct=>{var lt,Et;const At=(lt=dt.getStyle(Ct,ct))!==null&&lt!==void 0?lt:"",Ft=(Et=dt.getStyle(U,ct))!==null&&Et!==void 0?Et:"";return cn(At)&&cn(Ft)&&At!==Ft};return de(H,ct=>{const lt=Et=>de(Et,At=>At===ct);if(!lt(Y)&&lt(V0)){const Et=Ot(Y,At=>de(V0,Ft=>ie(At,Ft)));return de(Et,G)}return G(ct)})})(R,B,Nt)||kt(Nt.parentElement));(yt(B.children[0])||St(B.parentElement)&&!kt(B.parentElement))&&R.remove(B,!0)}var Q})}})(t,l),((S,N)=>{var E,R,I;let D;const $=S.dom,W=S.selection;if(!N)return;W.scrollIntoView(N);const B=si(S.getBody(),N);if(B&&$.getContentEditable(B)==="false")return $.remove(N),void W.select(B);let P=$.createRng();const z=N.previousSibling;if(rt(z)){P.setStart(z,(R=(E=z.nodeValue)===null||E===void 0?void 0:E.length)!==null&&R!==void 0?R:0);const at=N.nextSibling;rt(at)&&(z.appendData(at.data),(I=at.parentNode)===null||I===void 0||I.removeChild(at))}else P.setStartBefore(N),P.setEndBefore(N);const Q=$.getParent(N,$.isBlock);if($.remove(N),Q&&$.isEmpty(Q)){const at=lf(Q);la(F(Q)),P.setStart(Q,0),P.setEnd(Q,0),at||(ot=>!!ot.getAttribute("data-mce-fragment"))(Q)||!(D=(ot=>{let yt=X.fromRangeStart(ot);return yt=is(S.getBody()).next(yt),yt?.toRange()})(P))?$.add(Q,$.create("br",at?{}:{"data-mce-bogus":"1"})):(P=D,$.remove(Q))}W.setRng(P)})(t,a.get("mce_marker")),w=t.getBody(),st.each(w.getElementsByTagName("*"),S=>{S.removeAttribute("data-mce-fragment")}),((S,N,E)=>{x.from(S.getParent(N,"td,th")).map(F).each(R=>((I,D)=>{pl(I).each($=>{Rr($).each(W=>{D.isBlock(Gt(I))&&Ka($)&&D.isBlock(Gt(W))&&le($)})})})(R,E))})(a,s.getStart(),t.schema),((S,N,E)=>{const R=Yc(F(E),I=>ne(I,F(N)));fo(R,R.length-2).filter(on).fold(()=>_t(S,N),I=>_t(S,I.dom))})(t.schema,t.getBody(),s.getStart()),e},su=t=>t instanceof Fn,cf=(t,e,n)=>{t.dom.setHTML(t.getBody(),e),n!==!0&&(o=>{Yi(o)&&An(o.getBody()).each(r=>{const s=r.getNode(),a=dr(s)?An(s).getOr(r):r;o.selection.setRng(a.toRange())})})(t)},$y=t=>jt(t)?t:te,df=(t,e,n)=>{const o=e(t),r=$y(n);return o.orThunk(()=>r(t)?x.none():((s,a,i)=>{let l=s.dom;const c=$y(i);for(;l.parentNode;){l=l.parentNode;const d=F(l),u=a(d);if(u.isSome())return u;if(c(d))break}return x.none()})(t,e,r))},uf=fg,Hy=(t,e,n)=>{const o=t.formatter.get(n);if(o)for(let r=0;r<o.length;r++){const s=o[r];if(zo(s)&&s.inherit===!1&&t.dom.is(e,s.selector))return!0}return!1},mf=(t,e,n,o,r)=>{const s=t.dom.getRoot();if(e===s)return!1;const a=t.dom.getParent(e,i=>!!Hy(t,i,n)||i.parentNode===s||!!cs(t,i,n,o,!0));return!!cs(t,a,n,o,r)},au=(t,e,n)=>!(!Je(n)||!uf(e,n.inline))||!(!ls(n)||!uf(e,n.block))||!!zo(n)&&wt(e)&&t.is(e,n.selector),jy=(t,e,n,o,r,s)=>{const a=n[o],i=o==="attributes";if(jt(n.onmatch))return n.onmatch(e,n,o);if(a){if(Sr(a)){for(let l=0;l<a.length;l++)if(i?t.getAttrib(e,a[l]):Ud(t,e,a[l]))return!0}else for(const l in a)if(Bt(a,l)){const c=i?t.getAttrib(e,l):Ud(t,e,l),d=ba(a[l],s),u=Ht(c)||rr(c);if(u&&Ht(d))continue;if(r&&u&&!n.exact||(!r||n.exact)&&!uf(c,pg(d,l)))return!1}}return!0},cs=(t,e,n,o,r)=>{const s=t.formatter.get(n),a=t.dom;if(s&&wt(e))for(let i=0;i<s.length;i++){const l=s[i];if(au(t.dom,e,l)&&jy(a,e,l,"attributes",r,o)&&jy(a,e,l,"styles",r,o)){const c=l.classes;if(c){for(let d=0;d<c.length;d++)if(!t.dom.hasClass(e,ba(c[d],o)))return}return l}}},gf=(t,e,n,o,r)=>{if(o)return mf(t,o,e,n,r);if(o=t.selection.getNode(),mf(t,o,e,n,r))return!0;const s=t.selection.getStart();return!(s===o||!mf(t,s,e,n,r))},yc=an,Vy=t=>{if(t){const e=new Ge(t,t);for(let n=e.current();n;n=e.next())if(rt(n))return n}return null},ff=t=>{const e=xe("span");return mt(e,{id:og,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&Ie(e,Rs(yc)),e},pf=(t,e,n)=>{const o=t.dom,r=t.selection;if(zv(e))oi(t,!1,F(e),n,!0);else{const s=r.getRng(),a=o.getParent(e,o.isBlock),i=s.startContainer,l=s.startOffset,c=s.endContainer,d=s.endOffset,u=(m=>{const h=Vy(m);return h&&h.data.charAt(0)===yc&&h.deleteData(0,1),h})(e);o.remove(e,!0),i===u&&l>0&&s.setStart(u,l-1),c===u&&d>0&&s.setEnd(u,d-1),a&&o.isEmpty(a)&&ma(F(a)),r.setRng(s)}},hf=(t,e,n)=>{const o=t.dom,r=t.selection;if(e)pf(t,e,n);else if(!(e=Za(t.getBody(),r.getStart())))for(;e=o.get(og);)pf(t,e,n)},qy=(t,e)=>(t.appendChild(e),e),Wy=(t,e)=>{var n;const o=yr(t,(s,a)=>qy(s,a.cloneNode(!1)),e),r=(n=o.ownerDocument)!==null&&n!==void 0?n:document;return qy(o,r.createTextNode(yc))},Ky=t=>Zh(t,Kl(t).replace(new RegExp(`${ze}$`)," ")),Gy=(t,e)=>{const n=()=>{e===null||t.dom.isEmpty(e)||Rr(F(e)).each(o=>{Be(o)?Ky(o):Cl(o,r=>Be(r)).each(r=>{Be(r)&&Ky(r)})})};t.once("input",o=>{o.data&&!Ja(o.data)&&(o.isComposing?t.once("compositionend",()=>{n()}):n())})},jA=(t,e,n,o)=>{const r=t.dom,s=t.selection;let a=!1;const i=t.formatter.get(e);if(!i)return;const l=s.getRng(),c=l.startContainer,d=l.startOffset;let u=c;rt(c)&&(d!==c.data.length&&(a=!0),u=u.parentNode);const m=[];let h;for(;u;){if(cs(t,u,e,n,o)){h=u;break}u.nextSibling&&(a=!0),m.push(u),u=u.parentNode}if(h)if(a){const f=s.getBookmark();l.collapse(!0);let b=ti(r,l,i,{includeTrailingSpace:!0});b=Xd(b),t.formatter.remove(e,n,b,o),s.moveToBookmark(f)}else{const f=Za(t.getBody(),h),b=q(f)?r.getParents(h.parentNode,ae,f):[],p=ff(!1).dom;((S,N,E)=>{var R,I;const D=S.dom,$=D.getParent(E,ft(mg,S.schema));$&&D.isEmpty($)?(R=E.parentNode)===null||R===void 0||R.replaceChild(N,E):((W=>{const B=dn(W,"br"),P=Ot((z=>{const Q=[];let at=z.dom;for(;at;)Q.push(F(at)),at=at.lastChild;return Q})(W).slice(-1),Ka);B.length===P.length&&J(P,le)})(F(E)),D.isEmpty(E)?(I=E.parentNode)===null||I===void 0||I.replaceChild(N,E):D.insertAfter(N,E))})(t,p,f??h);const y=((S,N,E,R,I,D)=>{const $=S.formatter,W=S.dom,B=Ot(je($.get()),z=>z!==R&&!Pe(z,"removeformat")),P=((z,Q,at)=>en(at,(ot,yt)=>{const St=((kt,Nt)=>hg(kt,Nt,dt=>{const Ct=U=>jt(U)||U.length>1&&U.charAt(0)==="%";return de(["styles","attributes"],U=>ee(dt,U).exists(H=>{const Y=Qt(H)?H:Hr(H);return de(Y,Ct)}))}))(z,yt);return z.formatter.matchNode(Q,yt,{},St)?ot.concat([yt]):ot},[]))(S,E,B);if(Ot(P,z=>!((Q,at,ot)=>{const yt=["inline","block","selector","attributes","styles","classes"],St=kt=>Ao(kt,(Nt,dt)=>de(yt,Ct=>Ct===dt));return hg(Q,at,kt=>{const Nt=St(kt);return hg(Q,ot,dt=>{const Ct=St(dt);return((U,H,Y=mo)=>yn(Y).eq(U,H))(Nt,Ct)})})})(S,z,R)).length>0){const z=E.cloneNode(!1);return W.add(N,z),$.remove(R,I,z,D),W.remove(z),x.some(z)}return x.none()})(t,p,h,e,n,o),w=Wy([...m,...y.toArray(),...b],p);f&&pf(t,f,q(f)),s.setCursorLocation(w,1),Gy(t,p),r.isEmpty(h)&&r.remove(h)}},Yy=t=>{const e=ff(!1),n=Wy(t,e.dom);return{caretContainer:e,caretPosition:X(n,0)}},Xy=(t,e)=>{const{caretContainer:n,caretPosition:o}=Yy(e);return hn(F(t),n),le(F(t)),o},Qy=(t,e)=>{if(Fo(e.dom))return!1;const n=t.schema.getTextInlineElements();return Bt(n,Gt(e))&&!Fo(e.dom)&&!Is(e.dom)},Cc={},Zy=oo(["pre"]);(t=>{Cc[t]||(Cc[t]=[]),Cc[t].push(e=>{if(!e.selection.getRng().collapsed){const n=e.selection.getSelectedBlocks(),o=Ot(Ot(n,Zy),(r=>s=>{const a=s.previousSibling;return Zy(a)&&Xt(r,a)})(n));J(o,r=>{((s,a)=>{const i=F(a),l=Ar(i).dom;le(i),Os(F(s),[xe("br",l),xe("br",l),...rn(i)])})(r.previousSibling,r)})}})})("pre");const Jy=["fontWeight","fontStyle","color","fontSize","fontFamily"],tC=(t,e)=>{const n=t.get(e);return Qt(n)?Te(n,o=>Je(o)&&o.inline==="span"&&(r=>Re(r.styles)&&de(je(r.styles),s=>Xt(Jy,s)))(o)):x.none()},eC=(t,e)=>so(e,X.fromRangeStart(t)).isNone(),nC=(t,e)=>Wn(e,X.fromRangeEnd(t)).exists(n=>!Ee(n.getNode())||Wn(e,n).isSome())===!1,oC=t=>e=>um(e)&&t.isEditable(e),rC=t=>Ot(t.getSelectedBlocks(),oC(t.dom)),bf=st.each,vf=t=>wt(t)&&!Uo(t)&&!Fo(t)&&!Is(t),sC=(t,e)=>{for(let n=t;n;n=n[e]){if(rt(n)&&cn(n.data))return t;if(wt(n)&&!Uo(n))return n}return t},aC=(t,e,n)=>{const o=tf(t),r=cr(e)&&t.dom.isEditable(e),s=cr(n)&&t.dom.isEditable(n);if(r&&s){const a=sC(e,"previousSibling"),i=sC(n,"nextSibling");if(o.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return t.dom.remove(i),st.each(st.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},iC=(t,e,n,o)=>{var r;if(o&&e.merge_siblings!==!1){const s=(r=aC(t,Mv(o),o))!==null&&r!==void 0?r:o;aC(t,s,Mv(s,!0))}},yf=(t,e,n)=>{bf(t.childNodes,o=>{vf(o)&&(e(o)&&n(o),o.hasChildNodes()&&yf(o,e,n))})},lC=(t,e)=>n=>!(!n||!Ud(t,n,e)),cC=(t,e,n)=>o=>{t.setStyle(o,e,n),o.getAttribute("style")===""&&o.removeAttribute("style"),((r,s)=>{s.nodeName==="SPAN"&&r.getAttribs(s).length===0&&r.remove(s,!0)})(t,o)},ai=rs([{keep:[]},{rename:["name"]},{removed:[]}]),VA=/^(src|href|style)$/,Cf=st.each,iu=fg,dC=(t,e,n)=>t.isChildOf(e,n)&&e!==n&&!t.isBlock(n),uC=(t,e,n)=>{let o=e[n?"startContainer":"endContainer"],r=e[n?"startOffset":"endOffset"];if(wt(o)){const s=o.childNodes.length-1;!n&&r&&r--,o=o.childNodes[r>s?s:r]}return rt(o)&&n&&r>=o.data.length&&(o=new Ge(o,t.getBody()).next()||o),rt(o)&&!n&&r===0&&(o=new Ge(o,t.getBody()).prev()||o),o},mC=(t,e)=>{const n=e?"firstChild":"lastChild",o=t[n];return(r=>/^(TR|TH|TD)$/.test(r.nodeName))(t)&&o?t.nodeName==="TR"&&o[n]||o:t},wf=(t,e,n,o)=>{var r;const s=t.create(n,o);return(r=e.parentNode)===null||r===void 0||r.insertBefore(s,e),s.appendChild(e),s},gC=(t,e,n,o,r)=>{const s=F(e),a=F(t.create(o,r)),i=n?Qc(s):Xc(s);return Os(a,i),n?(hn(s,a),Sl(a,s)):(Co(s,a),Ie(a,s)),a.dom},fC=(t,e,n)=>{const o=e.parentNode;let r;const s=t.dom,a=Nn(t);ls(n)&&o===s.getRoot()&&(n.list_block&&iu(e,n.list_block)||J(Oe(e.childNodes),i=>{qi(t,a,i.nodeName.toLowerCase())?r?r.appendChild(i):(r=wf(s,i,a),s.setAttribs(r,Jl(t))):r=null})),(i=>zo(i)&&Je(i)&&bo(ee(i,"mixed"),!0))(n)&&!iu(n.inline,e)||s.remove(e,!0)},pC=(t,e,n)=>Ce(t)?{name:e,value:null}:{name:t,value:ba(e,n)},hC=(t,e)=>{t.getAttrib(e,"style")===""&&(e.removeAttribute("style"),e.removeAttribute("data-mce-style"))},bC=(t,e,n,o,r)=>{let s=!1;Cf(n.styles,(a,i)=>{const{name:l,value:c}=pC(i,a,o),d=pg(c,l);(n.remove_similar||Le(c)||!wt(r)||iu(Ud(t,r,l),d))&&t.setStyle(e,l,""),s=!0}),s&&hC(t,e)},vC=(t,e,n,o,r)=>{const s=t.dom,a=tf(t),i=t.schema;if(Je(e)&&xt(i,e.inline)&&_e(i,o)&&o.parentElement===t.getBody())return fC(t,o,e),ai.removed();if(!e.ceFalseOverride&&o&&s.getContentEditableParent(o)==="false"||o&&!au(s,o,e)&&!((d,u)=>u.links&&d.nodeName==="A")(o,e))return ai.keep();const l=o,c=e.preserve_attributes;if(Je(e)&&e.remove==="all"&&Qt(c)){const d=Ot(s.getAttribs(l),u=>Xt(c,u.name.toLowerCase()));if(s.removeAllAttribs(l),J(d,u=>s.setAttrib(l,u.name,u.value)),d.length>0)return ai.rename("span")}if(e.remove!=="all"){bC(s,l,e,n,r),Cf(e.attributes,(u,m)=>{const{name:h,value:f}=pC(m,u,n);if(e.remove_similar||Le(f)||!wt(r)||iu(s.getAttrib(r,h),f)){if(h==="class"){const b=s.getAttrib(l,h);if(b){let p="";if(J(b.split(/\s+/),y=>{/mce\-\w+/.test(y)&&(p+=(p?" ":"")+y)}),p)return void s.setAttrib(l,h,p)}}if(VA.test(h)&&l.removeAttribute("data-mce-"+h),h==="style"&&oo(["li"])(l)&&s.getStyle(l,"list-style-type")==="none")return l.removeAttribute(h),void s.setStyle(l,"list-style-type","none");h==="class"&&l.removeAttribute("className"),l.removeAttribute(h)}}),Cf(e.classes,u=>{u=ba(u,n),wt(r)&&!s.hasClass(r,u)||s.removeClass(l,u)});const d=s.getAttribs(l);for(let u=0;u<d.length;u++){const m=d[u].nodeName;if(!a.isAttributeInternal(m))return ai.keep()}}return e.remove!=="none"?(fC(t,l,e),ai.removed()):ai.keep()},qA=(t,e,n,o)=>vC(t,e,n,o,o).fold(it(o),r=>(t.dom.createFragment().appendChild(o),t.dom.rename(o,r)),it(null)),yC=(t,e,n,o,r)=>{(o||t.selection.isEditable())&&((s,a,i,l,c)=>{const d=s.formatter.get(a),u=d[0],m=s.dom,h=s.selection,f=S=>{const N=((E,R,I,D,$)=>{let W;return R.parentNode&&J(zd(E.dom,R.parentNode).reverse(),B=>{if(!W&&wt(B)&&B.id!=="_start"&&B.id!=="_end"){const P=cs(E,B,I,D,$);P&&P.split!==!1&&(W=B)}}),W})(s,S,a,i,c);return((E,R,I,D,$,W,B,P)=>{var z,Q;let at,ot;const yt=E.dom;if(I){const St=I.parentNode;for(let kt=D.parentNode;kt&&kt!==St;kt=kt.parentNode){let Nt=yt.clone(kt,!1);for(let dt=0;dt<R.length&&(Nt=qA(E,R[dt],P,Nt),Nt!==null);dt++);Nt&&(at&&Nt.appendChild(at),ot||(ot=Nt),at=Nt)}B.mixed&&yt.isBlock(I)||(D=(z=yt.split(I,D))!==null&&z!==void 0?z:D),at&&ot&&((Q=$.parentNode)===null||Q===void 0||Q.insertBefore(at,$),ot.appendChild($),Je(B)&&iC(E,B,0,at))}return D})(s,d,N,S,S,0,u,i)},b=S=>de(d,N=>wc(s,N,i,S,S)),p=S=>{const N=Oe(S.childNodes),E=b(S)||de(d,I=>au(m,S,I)),R=S.parentNode;if(!E&&q(R)&&bg(u)&&b(R),u.deep&&N.length)for(let I=0;I<N.length;I++)p(N[I]);J(["underline","line-through","overline"],I=>{wt(S)&&s.dom.getStyle(S,"text-decoration")===I&&S.parentNode&&Uv(m,S.parentNode)===I&&wc(s,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:I}},void 0,S)})},y=S=>{const N=m.get(S?"_start":"_end");if(N){let E=N[S?"firstChild":"lastChild"];return(R=>Uo(R)&&wt(R)&&(R.id==="_start"||R.id==="_end"))(E)&&(E=E[S?"firstChild":"lastChild"]),rt(E)&&E.data.length===0&&(E=S?N.previousSibling||N.nextSibling:N.nextSibling||N.previousSibling),m.remove(N,!0),E}return null},w=S=>{let N,E,R=ti(m,S,d,{includeTrailingSpace:S.collapsed});if(u.split){if(R=Xd(R),N=uC(s,R,!0),E=uC(s,R),N!==E){if(N=mC(N,!0),E=mC(E,!1),dC(m,N,E)){const D=x.from(N.firstChild).getOr(N);return f(gC(m,D,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void y(!0)}if(dC(m,E,N)){const D=x.from(E.lastChild).getOr(E);return f(gC(m,D,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void y(!1)}N=wf(m,N,"span",{id:"_start","data-mce-type":"bookmark"}),E=wf(m,E,"span",{id:"_end","data-mce-type":"bookmark"});const I=m.createRng();I.setStartAfter(N),I.setEndBefore(E),cc(m,I,D=>{J(D,$=>{Uo($)||Uo($.parentNode)||f($)})}),f(N),f(E),N=y(!0),E=y()}else N=E=f(N);R.startContainer=N.parentNode?N.parentNode:N,R.startOffset=m.nodeIndex(N),R.endContainer=E.parentNode?E.parentNode:E,R.endOffset=m.nodeIndex(E)+1}cc(m,R,I=>{J(I,p)})};if(l){if(lc(l)){const S=m.createRng();S.setStartBefore(l),S.setEndAfter(l),w(S)}else w(l);Pb(s,a,l,i)}else h.isCollapsed()&&Je(u)&&!Vi(s).length?jA(s,a,i,c):(Iv(s,()=>dg(s,w),S=>Je(u)&&gf(s,a,i,S)),s.nodeChanged()),((S,N,E)=>{N==="removeformat"?J(rC(S.selection),R=>{J(Jy,I=>S.dom.setStyle(R,I,"")),hC(S.dom,R)}):tC(S.formatter,N).each(R=>{J(rC(S.selection),I=>bC(S.dom,I,R,E,null))})})(s,a,i),Pb(s,a,l,i)})(t,e,n,o,r)},wc=(t,e,n,o,r)=>vC(t,e,n,o,r).fold(te,s=>(t.dom.rename(o,s),!0),ae),CC=st.each,lu=st.each,wC=(t,e,n,o)=>{if(lu(n.styles,(r,s)=>{t.setStyle(e,s,ba(r,o))}),n.styles){const r=t.getAttrib(e,"style");r&&t.setAttrib(e,"data-mce-style",r)}},WA=(t,e,n,o)=>{const r=t.formatter.get(e),s=r[0],a=!o&&t.selection.isCollapsed(),i=t.dom,l=t.selection,c=(f,b=s)=>{jt(b.onformat)&&b.onformat(f,b,n,o),wC(i,f,b,n),lu(b.attributes,(p,y)=>{i.setAttrib(f,y,ba(p,n))}),lu(b.classes,p=>{const y=ba(p,n);i.hasClass(f,y)||i.addClass(f,y)})},d=(f,b)=>{let p=!1;return lu(f,y=>!(!zo(y)||(i.getContentEditable(b)!=="false"||y.ceFalseOverride)&&(!q(y.collapsed)||y.collapsed===a)&&i.is(b,y.selector)&&!Fo(b)&&(c(b,y),p=!0,1))),p},u=f=>{if(vt(f)){const b=i.create(f);return c(b),b}return null},m=(f,b,p)=>{const y=[];let w=!0;const S=s.inline||s.block,N=u(S);cc(f,b,E=>{let R;const I=D=>{let $=!1,W=w,B=!1;const P=D.parentNode,z=P.nodeName.toLowerCase(),Q=f.getContentEditable(D);q(Q)&&(W=w,w=Q==="true",$=!0,B=Fv(t,D));const at=w&&!$;if(Ee(D)&&!((ot,yt,St,kt)=>{if(B_(ot)&&Je(yt)&&St.parentNode){const Nt=Bh(ot.schema),dt=El(F(St),Ct=>Fo(Ct.dom));return Ro(Nt,kt)&&mr(ot.schema,St.parentNode,{skipBogus:!1,includeZwsp:!0})&&!dt}return!1})(t,s,D,z))return R=null,void(ls(s)&&f.remove(D));if((ot=>(yt=>ls(yt)&&yt.wrapper===!0)(s)&&cs(t,ot,e,n))(D))R=null;else{if(((ot,yt,St)=>{const kt=(Nt=>ls(Nt)&&Nt.wrapper!==!0)(s)&&mg(t.schema,ot)&&qi(t,yt,S);return St&&kt})(D,z,at)){const ot=f.rename(D,S);return c(ot),y.push(ot),void(R=null)}if(zo(s)){let ot=d(r,D);if(!ot&&q(P)&&bg(s)&&(ot=d(r,P)),!Je(s)||ot)return void(R=null)}q(N)&&((ot,yt,St,kt)=>{const Nt=ot.nodeName.toLowerCase(),dt=qi(t,S,Nt)&&qi(t,yt,S),Ct=!p&&rt(ot)&&wd(ot.data),U=Fo(ot),H=!Je(s)||!f.isBlock(ot);return(St||kt)&&dt&&!Ct&&!U&&H})(D,z,at,B)?(R||(R=f.clone(N,!1),P.insertBefore(R,D),y.push(R)),B&&$&&(w=W),R.appendChild(D)):(R=null,J(Oe(D.childNodes),I),$&&(w=W),R=null)}};J(E,I)}),s.links===!0&&J(y,E=>{const R=I=>{I.nodeName==="A"&&c(I,s),J(Oe(I.childNodes),R)};R(E)}),J(y,E=>{const R=(I=>{let D=0;return J(I.childNodes,$=>{(W=>q(W)&&rt(W)&&W.length===0)($)||Uo($)||D++}),D})(E);!(y.length>1)&&f.isBlock(E)||R!==0?(Je(s)||ls(s)&&s.wrapper)&&(s.exact||R!==1||(E=(I=>Te(I.childNodes,ug).filter($=>f.getContentEditable($)!=="false"&&au(f,$,s)).map($=>{const W=f.clone($,!1);return c(W),f.replace(W,I,!0),f.remove($,!0),W}).getOr(I))(E)),((I,D,$,W)=>{CC(D,B=>{Je(B)&&CC(I.dom.select(B.inline,W),P=>{vf(P)&&wc(I,B,$,P,B.exact?P:null)}),((P,z,Q)=>{if(z.clear_child_styles){const at=z.links?"*:not(a)":"*";bf(P.select(at,Q),ot=>{vf(ot)&&P.isEditable(ot)&&bf(z.styles,(yt,St)=>{P.setStyle(ot,St,"")})})}})(I.dom,B,W)})})(t,r,n,E),((I,D,$,W,B)=>{const P=B.parentNode;cs(I,P,$,W)&&wc(I,D,W,B)||D.merge_with_parents&&P&&I.dom.getParent(P,z=>!!cs(I,z,$,W)&&(wc(I,D,W,B),!0))})(t,s,e,n,E),((I,D,$,W)=>{if(D.styles&&D.styles.backgroundColor){const B=lC(I,"fontSize");yf(W,P=>B(P)&&I.isEditable(P),cC(I,"backgroundColor",ba(D.styles.backgroundColor,$)))}})(f,s,n,E),((I,D,$,W)=>{const B=P=>{if(cr(P)&&wt(P.parentNode)&&I.isEditable(P)){const z=Uv(I,P.parentNode);I.getStyle(P,"color")&&z?I.setStyle(P,"text-decoration",z):I.getStyle(P,"text-decoration")===z&&I.setStyle(P,"text-decoration",null)}};D.styles&&(D.styles.color||D.styles.textDecoration)&&(st.walk(W,B,"childNodes"),B(W))})(f,s,0,E),((I,D,$,W)=>{if(Je(D)&&(D.inline==="sub"||D.inline==="sup")){const B=lC(I,"fontSize");yf(W,z=>B(z)&&I.isEditable(z),cC(I,"fontSize",""));const P=Ot(I.select(D.inline==="sup"?"sub":"sup",W),I.isEditable);I.remove(P,!0)}})(f,s,0,E),iC(t,s,0,E)):f.remove(E,!0)})},h=lc(o)?o:l.getNode();if(i.getContentEditable(h)==="false"&&!Fv(t,h))return d(r,o=h),void Db(t,e,o,n);if(s){if(o)if(lc(o)){if(!d(r,o)){const f=i.createRng();f.setStartBefore(o),f.setEndAfter(o),m(i,ti(i,f,r),!0)}}else m(i,o,!0);else a&&Je(s)&&!Vi(t).length?((f,b,p)=>{let y;const w=f.selection,S=f.formatter.get(b);if(!S)return;const N=w.getRng();let E=N.startOffset;const R=N.startContainer.nodeValue;y=Za(f.getBody(),w.getStart());const I=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(R&&E>0&&E<R.length&&I.test(R.charAt(E))&&I.test(R.charAt(E-1))){const W=w.getBookmark();N.collapse(!0);let B=ti(f.dom,N,S);B=Xd(B),f.formatter.apply(b,p,B),w.moveToBookmark(W)}else{let W=y?Vy(y):null;y&&W?.data===yc||(D=f.getDoc(),$=ff(!0).dom,y=D.importNode($,!0),W=y.firstChild,N.insertNode(y),E=1,Gy(f,y)),f.formatter.apply(b,p,y),w.setCursorLocation(W,E)}var D,$})(t,e,n):(l.setRng(sf(l.getRng())),Iv(t,()=>{dg(t,(f,b)=>{const p=b?f:ti(i,f,r);m(i,p,!1)})},ae),t.nodeChanged()),tC(t.formatter,e).each(f=>{J((b=>Ot((p=>{const y=p.getSelectedBlocks(),w=p.getRng();if(p.isCollapsed())return[];if(y.length===1)return eC(w,y[0])&&nC(w,y[0])?y:[];{const S=We(y).filter(R=>eC(w,R)).toArray(),N=Bn(y).filter(R=>nC(w,R)).toArray(),E=y.slice(1,-1);return S.concat(E).concat(N)}})(b),oC(b.dom)))(t.selection),b=>wC(i,b,f,n))});((f,b)=>{Bt(Cc,f)&&J(Cc[f],p=>{p(b)})})(e,t)}Db(t,e,o,n)},SC=(t,e,n,o)=>{(o||t.selection.isEditable())&&WA(t,e,n,o)},kC=t=>Bt(t,"vars"),xC=t=>t.selection.getStart(),EC=(t,e,n,o,r)=>Xo(e,s=>{const a=t.formatter.matchNode(s,n,r??{},o);return!tt(a)},s=>!!Hy(t,s,n)||!o&&q(t.formatter.matchNode(s,n,r,!0))),_C=(t,e)=>{const n=e??xC(t);return Ot(zd(t.dom,n),o=>wt(o)&&!Is(o))},NC=(t,e,n)=>{const o=_C(t,e);re(n,(r,s)=>{const a=i=>{const l=EC(t,o,s,i.similar,kC(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const d=l.getOr(e);kC(i)?i.callback(c,{node:d,format:s,parents:o}):J(i.callbacks,u=>u(c,{node:d,format:s,parents:o}))}};J([r.withSimilar,r.withoutSimilar],a),J(r.withVars,a)})},AC=st.explode,RC=()=>{const t={};return{addFilter:(e,n)=>{J(AC(e),o=>{Bt(t,o)||(t[o]={name:o,callbacks:[]}),t[o].callbacks.push(n)})},getFilters:()=>Hr(t),removeFilter:(e,n)=>{J(AC(e),o=>{if(Bt(t,o))if(q(n)){const r=t[o],s=Ot(r.callbacks,a=>a!==n);s.length>0?r.callbacks=s:delete t[o]}else delete t[o]})}}},KA=(t,e,n)=>{var o;const r=km();e.convert_fonts_to_spans&&((s,a,i)=>{s.addNodeFilter("font",l=>{J(l,c=>{const d=a.parse(c.attr("style")),u=c.attr("color"),m=c.attr("face"),h=c.attr("size");u&&(d.color=u),m&&(d["font-family"]=m),h&&Oo(h).each(f=>{d["font-size"]=i[f-1]}),c.name="span",c.attr("style",a.serialize(d)),(f=>{J(["color","face","size"],b=>{f.attr(b,null)})})(c)})})})(t,r,st.explode((o=e.font_size_legacy_values)!==null&&o!==void 0?o:"")),((s,a,i)=>{s.addNodeFilter("strike",l=>{const c=a.type!=="html4";J(l,d=>{if(c)d.name="s";else{const u=i.parse(d.attr("style"));u["text-decoration"]="line-through",d.name="span",d.attr("style",i.serialize(u))}})})})(t,n,r)},Sf=t=>{const[e,...n]=t.split(","),o=n.join(","),r=/data:([^/]+\/[^;]+)(;.+)?/.exec(e);if(r){const s=r[2]===";base64",a=(l=>{try{return decodeURIComponent(l)}catch{return l}})(o),i=s?(l=>{const c=/([a-z0-9+\/=\s]+)/i.exec(l);return c?c[1]:""})(a):a;return x.some({type:r[1],data:i,base64Encoded:s})}return x.none()},TC=(t,e,n=!0)=>{let o=e;if(n)try{o=atob(e)}catch{return x.none()}const r=new Uint8Array(o.length);for(let s=0;s<r.length;s++)r[s]=o.charCodeAt(s);return x.some(new Blob([r],{type:t}))},OC=t=>new Promise((e,n)=>{const o=new FileReader;o.onloadend=()=>{e(o.result)},o.onerror=()=>{var r;n((r=o.error)===null||r===void 0?void 0:r.message)},o.readAsDataURL(t)});let GA=0;const BC=(t,e,n)=>Sf(t).bind(({data:o,type:r,base64Encoded:s})=>{if(e&&!s)return x.none();{const a=s?o:btoa(o);return n(a,r)}}),LC=(t,e,n)=>{const o=t.create("blobid"+GA++,e,n);return t.add(o),o},DC=(t,e,n=!1)=>BC(e,n,(o,r)=>x.from(t.getByData(o,r)).orThunk(()=>TC(r,o).map(s=>LC(t,s,o)))),YA=/^(?:(?:(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)([A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*))(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?)$/,XA=t=>x.from(t.match(YA)).bind(e=>fo(e,1)).map(e=>ie(e,"www.")?e.substring(4):e),PC=(t,e)=>{x.from(t.attr("src")).bind(XA).forall(n=>!Xt(e,n))&&t.attr("sandbox","")},kf=(t,e)=>ie(t,`${e}/`),{entries:IC,setPrototypeOf:MC,isFrozen:QA,getPrototypeOf:ZA,getOwnPropertyDescriptor:JA}=Object;let{freeze:ao,seal:fr,create:FC}=Object,{apply:xf,construct:Ef}=typeof Reflect<"u"&&Reflect;ao||(ao=function(t){return t}),fr||(fr=function(t){return t}),xf||(xf=function(t,e,n){return t.apply(e,n)}),Ef||(Ef=function(t,e){return new t(...e)});const cu=lo(Array.prototype.forEach),tR=lo(Array.prototype.lastIndexOf),UC=lo(Array.prototype.pop),Sc=lo(Array.prototype.push),eR=lo(Array.prototype.splice),du=lo(String.prototype.toLowerCase),_f=lo(String.prototype.toString),zC=lo(String.prototype.match),kc=lo(String.prototype.replace),nR=lo(String.prototype.indexOf),oR=lo(String.prototype.trim),Ir=lo(Object.prototype.hasOwnProperty),io=lo(RegExp.prototype.test),xc=($C=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ef($C,e)});var $C;function lo(t){return function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return xf(t,e,o)}}function ue(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:du;MC&&MC(t,null);let o=e.length;for(;o--;){let r=e[o];if(typeof r=="string"){const s=n(r);s!==r&&(QA(e)||(e[o]=s),r=s)}t[r]=!0}return t}function rR(t){for(let e=0;e<t.length;e++)Ir(t,e)||(t[e]=null);return t}function ii(t){const e=FC(null);for(const[n,o]of IC(t))Ir(t,n)&&(Array.isArray(o)?e[n]=rR(o):o&&typeof o=="object"&&o.constructor===Object?e[n]=ii(o):e[n]=o);return e}function Ec(t,e){for(;t!==null;){const n=JA(t,e);if(n){if(n.get)return lo(n.get);if(typeof n.value=="function")return lo(n.value)}t=ZA(t)}return function(){return null}}const HC=ao(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Nf=ao(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Af=ao(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),sR=ao(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Rf=ao(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),aR=ao(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jC=ao(["#text"]),VC=ao(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Tf=ao(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),qC=ao(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),uu=ao(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),iR=fr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lR=fr(/<%[\w\W]*|[\w\W]*%>/gm),cR=fr(/\$\{[\w\W]*/gm),dR=fr(/^data-[\-\w.\u00B7-\uFFFF]+$/),uR=fr(/^aria-[\-\w]+$/),WC=fr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mR=fr(/^(?:\w+script|data):/i),gR=fr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),KC=fr(/^html$/i),fR=fr(/^[a-z][.\w]*(-[.\w]+)+$/i);var GC=Object.freeze({__proto__:null,ARIA_ATTR:uR,ATTR_WHITESPACE:gR,CUSTOM_ELEMENT:fR,DATA_ATTR:dR,DOCTYPE_NAME:KC,ERB_EXPR:lR,IS_ALLOWED_URI:WC,IS_SCRIPT_OR_DATA:mR,MUSTACHE_EXPR:iR,TMPLIT_EXPR:cR});const pR=function(){return typeof window>"u"?null:window};var Of=function t(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pR();const n=V=>t(V);if(n.version="3.2.4",n.removed=[],!e||!e.document||e.document.nodeType!==9||!e.Element)return n.isSupported=!1,n;let{document:o}=e;const r=o,s=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:i,Node:l,Element:c,NodeFilter:d,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:m,DOMParser:h,trustedTypes:f}=e,b=c.prototype,p=Ec(b,"cloneNode"),y=Ec(b,"remove"),w=Ec(b,"nextSibling"),S=Ec(b,"childNodes"),N=Ec(b,"parentNode");if(typeof i=="function"){const V=o.createElement("template");V.content&&V.content.ownerDocument&&(o=V.content.ownerDocument)}let E,R="";const{implementation:I,createNodeIterator:D,createDocumentFragment:$,getElementsByTagName:W}=o,{importNode:B}=r;let P={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported=typeof IC=="function"&&typeof N=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:Q,TMPLIT_EXPR:at,DATA_ATTR:ot,ARIA_ATTR:yt,IS_SCRIPT_OR_DATA:St,ATTR_WHITESPACE:kt,CUSTOM_ELEMENT:Nt}=GC;let{IS_ALLOWED_URI:dt}=GC,Ct=null;const U=ue({},[...HC,...Nf,...Af,...Rf,...jC]);let H=null;const Y=ue({},[...VC,...Tf,...qC,...uu]);let G=Object.seal(FC(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ct=null,lt=null,Et=!0,At=!0,Ft=!1,we=!0,Se=!1,ko=!0,gt=!1,Ut=!1,Vt=!1,It=!1,Jt=!1,pe=!1,ut=!0,Tt=!1,ge=!0,fe=!1,Me={},un=null;const Fr=ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Rn=null;const Wo=ue({},["audio","video","img","source","image","track"]);let tn=null;const hi=ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ea="http://www.w3.org/1998/Math/MathML",gs="http://www.w3.org/2000/svg",Ko="http://www.w3.org/1999/xhtml";let _a=Ko,Ws=!1,fs=null;const sm=ue({},[Ea,gs,Ko],_f);let co=ue({},["mi","mo","mn","ms","mtext"]),Ks=ue({},["annotation-xml"]);const bi=ue({},["title","style","font","a","script"]);let Na=null;const lL=["application/xhtml+xml","text/html"];let Tn=null,gl=null;const cL=o.createElement("form"),mE=function(V){return V instanceof RegExp||V instanceof Function},fh=function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!gl||gl!==V){if(V&&typeof V=="object"||(V={}),V=ii(V),Na=lL.indexOf(V.PARSER_MEDIA_TYPE)===-1?"text/html":V.PARSER_MEDIA_TYPE,Tn=Na==="application/xhtml+xml"?_f:du,Ct=Ir(V,"ALLOWED_TAGS")?ue({},V.ALLOWED_TAGS,Tn):U,H=Ir(V,"ALLOWED_ATTR")?ue({},V.ALLOWED_ATTR,Tn):Y,fs=Ir(V,"ALLOWED_NAMESPACES")?ue({},V.ALLOWED_NAMESPACES,_f):sm,tn=Ir(V,"ADD_URI_SAFE_ATTR")?ue(ii(hi),V.ADD_URI_SAFE_ATTR,Tn):hi,Rn=Ir(V,"ADD_DATA_URI_TAGS")?ue(ii(Wo),V.ADD_DATA_URI_TAGS,Tn):Wo,un=Ir(V,"FORBID_CONTENTS")?ue({},V.FORBID_CONTENTS,Tn):Fr,ct=Ir(V,"FORBID_TAGS")?ue({},V.FORBID_TAGS,Tn):{},lt=Ir(V,"FORBID_ATTR")?ue({},V.FORBID_ATTR,Tn):{},Me=!!Ir(V,"USE_PROFILES")&&V.USE_PROFILES,Et=V.ALLOW_ARIA_ATTR!==!1,At=V.ALLOW_DATA_ATTR!==!1,Ft=V.ALLOW_UNKNOWN_PROTOCOLS||!1,we=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=V.SAFE_FOR_TEMPLATES||!1,ko=V.SAFE_FOR_XML!==!1,gt=V.WHOLE_DOCUMENT||!1,It=V.RETURN_DOM||!1,Jt=V.RETURN_DOM_FRAGMENT||!1,pe=V.RETURN_TRUSTED_TYPE||!1,Vt=V.FORCE_BODY||!1,ut=V.SANITIZE_DOM!==!1,Tt=V.SANITIZE_NAMED_PROPS||!1,ge=V.KEEP_CONTENT!==!1,fe=V.IN_PLACE||!1,dt=V.ALLOWED_URI_REGEXP||WC,_a=V.NAMESPACE||Ko,co=V.MATHML_TEXT_INTEGRATION_POINTS||co,Ks=V.HTML_INTEGRATION_POINTS||Ks,G=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&mE(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&mE(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(At=!1),Jt&&(It=!0),Me&&(Ct=ue({},jC),H=[],Me.html===!0&&(ue(Ct,HC),ue(H,VC)),Me.svg===!0&&(ue(Ct,Nf),ue(H,Tf),ue(H,uu)),Me.svgFilters===!0&&(ue(Ct,Af),ue(H,Tf),ue(H,uu)),Me.mathMl===!0&&(ue(Ct,Rf),ue(H,qC),ue(H,uu))),V.ADD_TAGS&&(Ct===U&&(Ct=ii(Ct)),ue(Ct,V.ADD_TAGS,Tn)),V.ADD_ATTR&&(H===Y&&(H=ii(H)),ue(H,V.ADD_ATTR,Tn)),V.ADD_URI_SAFE_ATTR&&ue(tn,V.ADD_URI_SAFE_ATTR,Tn),V.FORBID_CONTENTS&&(un===Fr&&(un=ii(un)),ue(un,V.FORBID_CONTENTS,Tn)),ge&&(Ct["#text"]=!0),gt&&ue(Ct,["html","head","body"]),Ct.table&&(ue(Ct,["tbody"]),delete ct.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw xc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw xc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=V.TRUSTED_TYPES_POLICY,R=E.createHTML("")}else E===void 0&&(E=function(zt,Rt){if(typeof zt!="object"||typeof zt.createPolicy!="function")return null;let he=null;const Ne="data-tt-policy-suffix";Rt&&Rt.hasAttribute(Ne)&&(he=Rt.getAttribute(Ne));const ce="dompurify"+(he?"#"+he:"");try{return zt.createPolicy(ce,{createHTML:vn=>vn,createScriptURL:vn=>vn})}catch{return console.warn("TrustedTypes policy "+ce+" could not be created."),null}}(f,s)),E!==null&&typeof R=="string"&&(R=E.createHTML(""));ao&&ao(V),gl=V}},gE=ue({},[...Nf,...Af,...sR]),fE=ue({},[...Rf,...aR]),ps=function(V){Sc(n.removed,{element:V});try{N(V).removeChild(V)}catch{y(V)}},Wc=function(V,zt){try{Sc(n.removed,{attribute:zt.getAttributeNode(V),from:zt})}catch{Sc(n.removed,{attribute:null,from:zt})}if(zt.removeAttribute(V),V==="is")if(It||Jt)try{ps(zt)}catch{}else try{zt.setAttribute(V,"")}catch{}},pE=function(V){let zt=null,Rt=null;if(Vt)V="<remove></remove>"+V;else{const ce=zC(V,/^[\r\n\t ]+/);Rt=ce&&ce[0]}Na==="application/xhtml+xml"&&_a===Ko&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");const he=E?E.createHTML(V):V;if(_a===Ko)try{zt=new h().parseFromString(he,Na)}catch{}if(!zt||!zt.documentElement){zt=I.createDocument(_a,"template",null);try{zt.documentElement.innerHTML=Ws?R:he}catch{}}const Ne=zt.body||zt.documentElement;return V&&Rt&&Ne.insertBefore(o.createTextNode(Rt),Ne.childNodes[0]||null),_a===Ko?W.call(zt,gt?"html":"body")[0]:gt?zt.documentElement:Ne},hE=function(V){return D.call(V.ownerDocument||V,V,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},ph=function(V){return V instanceof m&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof u)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},bE=function(V){return typeof l=="function"&&V instanceof l};function Gs(V,zt,Rt){cu(V,he=>{he.call(n,zt,Rt,gl)})}const vE=function(V){let zt=null;if(Gs(P.beforeSanitizeElements,V,null),ph(V))return ps(V),!0;const Rt=Tn(V.nodeName);if(Gs(P.uponSanitizeElement,V,{tagName:Rt,allowedTags:Ct}),V.hasChildNodes()&&!bE(V.firstElementChild)&&io(/<[/\w]/g,V.innerHTML)&&io(/<[/\w]/g,V.textContent)||V.nodeType===7||ko&&V.nodeType===8&&io(/<[/\w]/g,V.data))return ps(V),!0;if(!Ct[Rt]||ct[Rt]){if(!ct[Rt]&&CE(Rt)&&(G.tagNameCheck instanceof RegExp&&io(G.tagNameCheck,Rt)||G.tagNameCheck instanceof Function&&G.tagNameCheck(Rt)))return!1;if(ge&&!un[Rt]){const he=N(V)||V.parentNode,Ne=S(V)||V.childNodes;if(Ne&&he)for(let ce=Ne.length-1;ce>=0;--ce){const vn=p(Ne[ce],!0);vn.__removalCount=(V.__removalCount||0)+1,he.insertBefore(vn,w(V))}}return ps(V),!0}return V instanceof c&&!function(he){let Ne=N(he);Ne&&Ne.tagName||(Ne={namespaceURI:_a,tagName:"template"});const ce=du(he.tagName),vn=du(Ne.tagName);return!!fs[he.namespaceURI]&&(he.namespaceURI===gs?Ne.namespaceURI===Ko?ce==="svg":Ne.namespaceURI===Ea?ce==="svg"&&(vn==="annotation-xml"||co[vn]):!!gE[ce]:he.namespaceURI===Ea?Ne.namespaceURI===Ko?ce==="math":Ne.namespaceURI===gs?ce==="math"&&Ks[vn]:!!fE[ce]:he.namespaceURI===Ko?!(Ne.namespaceURI===gs&&!Ks[vn])&&!(Ne.namespaceURI===Ea&&!co[vn])&&!fE[ce]&&(bi[ce]||!gE[ce]):!(Na!=="application/xhtml+xml"||!fs[he.namespaceURI]))}(V)?(ps(V),!0):Rt!=="noscript"&&Rt!=="noembed"&&Rt!=="noframes"||!io(/<\/no(script|embed|frames)/i,V.innerHTML)?(Se&&V.nodeType===3&&(zt=V.textContent,cu([z,Q,at],he=>{zt=kc(zt,he," ")}),V.textContent!==zt&&(Sc(n.removed,{element:V.cloneNode()}),V.textContent=zt)),Gs(P.afterSanitizeElements,V,null),!1):(ps(V),!0)},yE=function(V,zt,Rt){if(ut&&(zt==="id"||zt==="name")&&(Rt in o||Rt in cL))return!1;if(!(At&&!lt[zt]&&io(ot,zt))){if(!(Et&&io(yt,zt))){if(!H[zt]||lt[zt]){if(!(CE(V)&&(G.tagNameCheck instanceof RegExp&&io(G.tagNameCheck,V)||G.tagNameCheck instanceof Function&&G.tagNameCheck(V))&&(G.attributeNameCheck instanceof RegExp&&io(G.attributeNameCheck,zt)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(zt))||zt==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&io(G.tagNameCheck,Rt)||G.tagNameCheck instanceof Function&&G.tagNameCheck(Rt))))return!1}else if(!tn[zt]){if(!io(dt,kc(Rt,kt,""))){if((zt!=="src"&&zt!=="xlink:href"&&zt!=="href"||V==="script"||nR(Rt,"data:")!==0||!Rn[V])&&!(Ft&&!io(St,kc(Rt,kt,"")))){if(Rt)return!1}}}}}return!0},CE=function(V){return V!=="annotation-xml"&&zC(V,Nt)},wE=function(V){Gs(P.beforeSanitizeAttributes,V,null);const{attributes:zt}=V;if(!zt||ph(V))return;const Rt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H,forceKeepAttr:void 0};let he=zt.length;for(;he--;){const Ne=zt[he],{name:ce,namespaceURI:vn,value:Ys}=Ne,hs=Tn(ce);let zn=ce==="value"?Ys:oR(Ys);const uL=zn;if(Rt.attrName=hs,Rt.attrValue=zn,Rt.keepAttr=!0,Rt.forceKeepAttr=void 0,Gs(P.uponSanitizeAttribute,V,Rt),zn=Rt.attrValue,!Tt||hs!=="id"&&hs!=="name"||(Wc(ce,V),zn="user-content-"+zn),ko&&io(/((--!?|])>)|<\/(style|title)/i,zn)){Wc(ce,V);continue}if(Rt.forceKeepAttr)continue;if(!Rt.keepAttr){Wc(ce,V);continue}if(!we&&io(/\/>/i,zn)){Wc(ce,V);continue}Se&&cu([z,Q,at],kE=>{zn=kc(zn,kE," ")});const SE=Tn(V.nodeName);if(yE(SE,hs,zn)){if(E&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!vn)switch(f.getAttributeType(SE,hs)){case"TrustedHTML":zn=E.createHTML(zn);break;case"TrustedScriptURL":zn=E.createScriptURL(zn)}if(zn!==uL)try{vn?V.setAttributeNS(vn,ce,zn):V.setAttribute(ce,zn),ph(V)?ps(V):UC(n.removed)}catch{}}else Wc(ce,V)}Gs(P.afterSanitizeAttributes,V,null)},dL=function V(zt){let Rt=null;const he=hE(zt);for(Gs(P.beforeSanitizeShadowDOM,zt,null);Rt=he.nextNode();)Gs(P.uponSanitizeShadowNode,Rt,null),vE(Rt),wE(Rt),Rt.content instanceof a&&V(Rt.content);Gs(P.afterSanitizeShadowDOM,zt,null)};return n.sanitize=function(V){let zt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Rt=null,he=null,Ne=null,ce=null;if(Ws=!V,Ws&&(V="<!-->"),typeof V!="string"&&!bE(V)){if(typeof V.toString!="function")throw xc("toString is not a function");if(typeof(V=V.toString())!="string")throw xc("dirty is not a string, aborting")}if(!n.isSupported)return V;if(Ut||fh(zt),n.removed=[],typeof V=="string"&&(fe=!1),fe){if(V.nodeName){const hs=Tn(V.nodeName);if(!Ct[hs]||ct[hs])throw xc("root node is forbidden and cannot be sanitized in-place")}}else if(V instanceof l)Rt=pE("<!---->"),he=Rt.ownerDocument.importNode(V,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?Rt=he:Rt.appendChild(he);else{if(!It&&!Se&&!gt&&V.indexOf("<")===-1)return E&&pe?E.createHTML(V):V;if(Rt=pE(V),!Rt)return It?null:pe?R:""}Rt&&Vt&&ps(Rt.firstChild);const vn=hE(fe?V:Rt);for(;Ne=vn.nextNode();)vE(Ne),wE(Ne),Ne.content instanceof a&&dL(Ne.content);if(fe)return V;if(It){if(Jt)for(ce=$.call(Rt.ownerDocument);Rt.firstChild;)ce.appendChild(Rt.firstChild);else ce=Rt;return(H.shadowroot||H.shadowrootmode)&&(ce=B.call(r,ce,!0)),ce}let Ys=gt?Rt.outerHTML:Rt.innerHTML;return gt&&Ct["!doctype"]&&Rt.ownerDocument&&Rt.ownerDocument.doctype&&Rt.ownerDocument.doctype.name&&io(KC,Rt.ownerDocument.doctype.name)&&(Ys="<!DOCTYPE "+Rt.ownerDocument.doctype.name+`>
`+Ys),Se&&cu([z,Q,at],hs=>{Ys=kc(Ys,hs," ")}),E&&pe?E.createHTML(Ys):Ys},n.setConfig=function(){fh(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}),Ut=!0},n.clearConfig=function(){gl=null,Ut=!1},n.isValidAttribute=function(V,zt,Rt){gl||fh({});const he=Tn(V),Ne=Tn(zt);return yE(he,Ne,Rt)},n.addHook=function(V,zt){typeof zt=="function"&&Sc(P[V],zt)},n.removeHook=function(V,zt){if(zt!==void 0){const Rt=tR(P[V],zt);return Rt===-1?void 0:eR(P[V],Rt,1)[0]}return UC(P[V])},n.removeHooks=function(V){P[V]=[]},n.removeAllHooks=function(){P={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();const YC=st.each,hR=st.trim,bR=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],vR={ftp:21,http:80,https:443,mailto:25},yR=["img","video"],XC=(t,e,n)=>{const o=(r=>{try{return decodeURIComponent(r)}catch{return unescape(r)}})(e).replace(/\s/g,"");return!t.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(o)||!t.allow_html_data_urls&&(/^data:image\//i.test(o)?((r,s)=>q(r)?!r:!q(s)||!Xt(yR,s))(t.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(o):/^data:/i.test(o)))};class pr{static parseDataUri(e){let n;const o=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(o[0]);return r&&(n=r[1]),{type:n,data:o[1]}}static isDomSafe(e,n,o={}){if(o.allow_script_urls)return!0;{const r=Ha.decode(e).replace(/[\s\u0000-\u001F]+/g,"");return!XC(o,r,n)}}static getDocumentBaseUrl(e){var n;let o;return o=e.protocol.indexOf("http")!==0&&e.protocol!=="file:"?(n=e.href)!==null&&n!==void 0?n:"":e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/")),o}constructor(e,n={}){this.path="",this.directory="",e=hR(e),this.settings=n;const o=n.base_uri,r=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))return void(r.source=e);const s=e.indexOf("//")===0;if(e.indexOf("/")!==0||s||(e=(o&&o.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){const i=o?o.path:new pr(document.location.href).directory;if(o?.protocol==="")e="//mce_host"+r.toAbsPath(i,e);else{const l=/([^#?]*)([#?]?.*)/.exec(e);l&&(e=(o&&o.protocol||"http")+"://mce_host"+r.toAbsPath(i,l[1])+l[2])}}e=e.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);a&&YC(bR,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),r[i]=c}),o&&(r.protocol||(r.protocol=o.protocol),r.userInfo||(r.userInfo=o.userInfo),r.port||r.host!=="mce_host"||(r.port=o.port),r.host&&r.host!=="mce_host"||(r.host=o.host),r.source=""),s&&(r.protocol="")}setPath(e){const n=/^(.*?)\/?(\w+)?$/.exec(e);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(e){if(e==="./")return e;const n=new pr(e,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const o=this.getURI(),r=n.getURI();if(o===r||o.charAt(o.length-1)==="/"&&o.substr(0,o.length-1)===r)return o;let s=this.toRelPath(this.path,n.path);return n.query&&(s+="?"+n.query),n.anchor&&(s+="#"+n.anchor),s}toAbsolute(e,n){const o=new pr(e,{base_uri:this});return o.getURI(n&&this.isSameOrigin(o))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;const n=this.protocol?vR[this.protocol]:null;if(n&&(this.port||n)==(e.port||n))return!0}return!1}toRelPath(e,n){let o,r,s=0,a="";const i=e.substring(0,e.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(o=0,r=i.length;o<r;o++)if(o>=l.length||i[o]!==l[o]){s=o+1;break}}if(i.length<l.length){for(o=0,r=l.length;o<r;o++)if(o>=i.length||i[o]!==l[o]){s=o+1;break}}if(s===1)return n;for(o=0,r=i.length-(s-1);o<r;o++)a+="../";for(o=s-1,r=l.length;o<r;o++)a+=o!==s-1?"/"+l[o]:l[o];return a}toAbsPath(e,n){let o=0;const r=/\/$/.test(n)?"/":"",s=e.split("/"),a=n.split("/"),i=[];YC(s,u=>{u&&i.push(u)});const l=[];for(let u=a.length-1;u>=0;u--)a[u].length!==0&&a[u]!=="."&&(a[u]!==".."?o>0?o--:l.push(a[u]):o++);const c=i.length-o;let d;return d=c<=0?No(l).join("/"):i.slice(0,c).join("/")+"/"+No(l).join("/"),d.indexOf("/")!==0&&(d="/"+d),r&&d.lastIndexOf("/")!==d.length-1&&(d+=r),d}getURI(e=!1){let n;return this.source&&!e||(n="",e||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const CR=st.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),Bf="data-mce-type";let QC=0;const ZC=(t,e,n,o,r)=>{var s,a,i,l;const c=e.validate,d=n.getSpecialElements();t.nodeType===8&&!e.allow_conditional_comments&&/^\[if/i.test((s=t.nodeValue)!==null&&s!==void 0?s:"")&&(t.nodeValue=" "+t.nodeValue);const u=(a=r?.tagName)!==null&&a!==void 0?a:t.nodeName.toLowerCase();if(o!=="html"&&n.isValid(o))return void(q(r)&&(r.allowedTags[u]=!0));if(t.nodeType!==1||u==="body")return;const m=F(t),h=Yt(m,Bf),f=Pt(m,"data-mce-bogus");if(!h&&vt(f))return void(f==="all"?le(m):no(m));const b=n.getElementRule(u);if(!c||b){if(q(r)&&(r.allowedTags[u]=!0),c&&b&&!h){if(J((i=b.attributesForced)!==null&&i!==void 0?i:[],p=>{et(m,p.name,p.value==="{$uid}"?"mce_"+QC++:p.value)}),J((l=b.attributesDefault)!==null&&l!==void 0?l:[],p=>{Yt(m,p.name)||et(m,p.name,p.value==="{$uid}"?"mce_"+QC++:p.value)}),b.attributesRequired&&!de(b.attributesRequired,p=>Yt(m,p))||b.removeEmptyAttrs&&(p=>{const y=p.dom.attributes;return y==null||y.length===0})(m))return void no(m);b.outputName&&b.outputName!==u&&((p,y)=>{const w=((N,E)=>{const R=xe(E),I=A(N);return mt(R,I),R})(p,y);Co(p,w);const S=rn(p);Os(w,S),le(p)})(m,b.outputName)}}else Bt(d,u)?le(m):no(m)},JC=(t,e,n,o,r,s)=>n!=="html"&&!Fs(o)||!(r in CR&&XC(t,s,o))&&(!t.validate||e.isValid(o,r)||ie(r,"data-")||ie(r,"aria-")),t1=(t,e)=>t.hasAttribute(Bf)&&(e==="id"||e==="class"||e==="style"),e1=(t,e)=>t in e.getBoolAttrs(),wR=(t,e,n,o)=>{const{attributes:r}=t;for(let s=r.length-1;s>=0;s--){const a=r[s],i=a.name,l=a.value;JC(e,n,o,t.tagName.toLowerCase(),i,l)||t1(t,i)?e1(i,n)&&t.setAttribute(i,i):t.removeAttribute(i)}},SR=(t,e,n)=>{const o=Of();return o.addHook("uponSanitizeElement",(r,s)=>{ZC(r,t,e,n.track(r),s)}),o.addHook("uponSanitizeAttribute",(r,s)=>{((a,i,l,c,d)=>{const u=a.tagName.toLowerCase(),{attrName:m,attrValue:h}=d;d.keepAttr=JC(i,l,c,u,m,h),d.keepAttr?(d.allowedAttributes[m]=!0,e1(m,l)&&(d.attrValue=m),i.allow_svg_data_urls&&ie(h,"data:image/svg+xml")&&(d.forceKeepAttr=!0)):t1(a,m)&&(d.forceKeepAttr=!0)})(r,t,e,n.current(),s)}),o},kR=t=>e=>{const n=fd(e);if(n==="svg")(o=>{const r=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(a=>`xlink:${a}`),s={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:r};Of().sanitize(o,s)})(e);else{if(n!=="math")throw new Error("Not a namespace element");((o,r)=>{const s=Of(),a=r.allow_mathml_annotation_encodings,i=Qt(a)&&a.length>0;s.addHook("uponSanitizeElement",(l,c)=>{var d;const u=(d=c.tagName)!==null&&d!==void 0?d:l.nodeName.toLowerCase();if(i&&u==="semantics"&&(c.allowedTags[u]=!0),u==="annotation"){const m=l,h=(f=>{const b=f.getAttribute("encoding");return i&&vt(b)&&Xt(a,b)})(m);c.allowedTags[u]=h,h||m.remove()}}),s.sanitize(o,{IN_PLACE:!0,USE_PROFILES:{mathMl:!0}})})(e,t)}},n1=st.makeMap,o1=st.extend,r1=(t,e,n,o)=>{const r=t.name,s=r in n&&r!=="title"&&r!=="textarea"&&r!=="noscript",a=e.childNodes;for(let i=0,l=a.length;i<l;i++){const c=a[i],d=new Fn(c.nodeName.toLowerCase(),c.nodeType);if(wt(c)){const u=c.attributes;for(let m=0,h=u.length;m<h;m++){const f=u[m];d.attr(f.name,f.value)}Fs(d.name)&&(o(c),d.value=c.innerHTML)}else rt(c)?(d.value=c.data,s&&(d.raw=!0)):(ns(c)||cm(c)||dd(c))&&(d.value=c.data);Fs(d.name)||r1(d,c,n,o),t.append(d)}},Qi=(t={},e=ua())=>{const n=RC(),o=RC(),r={validate:!0,root_name:"body",sanitize:!0,...t},s=new DOMParser,a=((b,p)=>{const y=(()=>{const w=Or(),S=()=>w.get().map(fd).getOr("html");return{track:N=>(Il(N)?w.set(N):w.get().exists(E=>!E.contains(N))&&w.clear(),S()),current:S,reset:()=>{w.clear()}}})();if(b.sanitize){const w=SR(b,p,y);return{sanitizeHtmlElement:(N,E)=>{w.sanitize(N,((R,I)=>{const D={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[],SAFE_FOR_XML:!1};return D.PARSER_MEDIA_TYPE=I,R.allow_script_urls?D.ALLOWED_URI_REGEXP=/.*/:R.allow_html_data_urls&&(D.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),D})(b,E)),w.removed=[],y.reset()},sanitizeNamespaceElement:kR(b)}}return{sanitizeHtmlElement:(w,S)=>{const N=document.createNodeIterator(w,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let E;for(;E=N.nextNode();){const R=y.track(E);ZC(E,b,p,R),wt(E)&&wR(E,b,p,R)}y.reset()},sanitizeNamespaceElement:Dt}})(r,e),i=n.addFilter,l=n.getFilters,c=n.removeFilter,d=o.addFilter,u=o.getFilters,m=o.removeFilter,h=(b,p)=>{const y=vt(p.attr(Bf)),w=p.type===1&&!Bt(b,p.name)&&!In(e,p)&&!Fs(p.name);return p.type===3||w&&!y},f={schema:e,addAttributeFilter:d,getAttributeFilters:u,removeAttributeFilter:m,addNodeFilter:i,getNodeFilters:l,removeNodeFilter:c,parse:(b,p={})=>{var y;const w=r.validate,S=(y=p.context)!==null&&y!==void 0?y:r.root_name,N=((z,Q,at="html")=>{const ot=at==="xhtml"?"application/xhtml+xml":"text/html",yt=Bt(e.getSpecialElements(),Q.toLowerCase()),St=yt?`<${Q}>${z}</${Q}>`:z,kt=s.parseFromString(at==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${St}</body></html>`:/^[\s]*<head/i.test(z)||/^[\s]*<html/i.test(z)||/^[\s]*<!DOCTYPE/i.test(z)?`<html>${St}</html>`:`<body>${St}</body>`,ot).body;return a.sanitizeHtmlElement(kt,ot),yt?kt.firstChild:kt})(b,S,p.format);_t(e,N);const E=new Fn(S,11);r1(E,N,e.getSpecialElements(),a.sanitizeNamespaceElement),N.innerHTML="";const[R,I]=((z,Q,at,ot)=>{const yt=at.validate,St=Q.getNonEmptyElements(),kt=Q.getWhitespaceElements(),Nt=o1(n1("script,style,head,html,body,title,meta,param"),Q.getBlockElements()),dt=Bh(Q),Ct=/[ \t\r\n]+/g,U=/^[ \t\r\n]+/,H=/[ \t\r\n]+$/,Y=lt=>{let Et=lt.parent;for(;q(Et);){if(Et.name in kt)return!0;Et=Et.parent}return!1},G=lt=>lt.name in Nt||In(Q,lt)||Fs(lt.name)&&lt.parent===z,ct=(lt,Et)=>{const At=Et?lt.prev:lt.next;return!q(At)&&!Ht(lt.parent)&&G(lt.parent)&&(lt.parent!==z||ot.isRootContent===!0)};return[lt=>{var Et;if(lt.type===3&&!Y(lt)){let At=(Et=lt.value)!==null&&Et!==void 0?Et:"";At=At.replace(Ct," "),(((Ft,we)=>q(Ft)&&(we(Ft)||Ft.name==="br"))(lt.prev,G)||ct(lt,!0))&&(At=At.replace(U,"")),At.length===0||At===" "&&lt.prev&&lt.prev.type===8&&lt.next&&lt.next.type===8?lt.remove():lt.value=At}},lt=>{var Et;if(lt.type===1){const At=Q.getElementRule(lt.name);if(yt&&At){const Ft=vc(Q,St,kt,lt);At.paddInEmptyBlock&&Ft&&(we=>{let Se=we;for(;q(Se);){if(Se.name in dt)return vc(Q,St,kt,Se);Se=Se.parent}return!1})(lt)?ef(at,ot,G,lt):At.removeEmpty&&Ft?G(lt)?lt.remove():lt.unwrap():At.paddEmpty&&(Ft||(we=>{var Se;return Uy(we,"#text")&&((Se=we?.firstChild)===null||Se===void 0?void 0:Se.value)===ze})(lt))&&ef(at,ot,G,lt)}}else if(lt.type===3&&!Y(lt)){let At=(Et=lt.value)!==null&&Et!==void 0?Et:"";(lt.next&&G(lt.next)||ct(lt,!1))&&(At=At.replace(H,"")),At.length===0?lt.remove():lt.value=At}}]})(E,e,r,p),D=[],$=w?z=>((Q,at)=>{rf(e,Q)&&at.push(Q)})(z,D):Dt,W={nodes:{},attributes:{}},B=z=>Iy(l(),u(),z,W);if(((z,Q,at)=>{const ot=[];for(let yt=z,St=yt;yt;St=yt,yt=yt.walk()){const kt=yt;J(Q,Nt=>Nt(kt)),Ht(kt.parent)&&kt!==z?yt=St:ot.push(kt)}for(let yt=ot.length-1;yt>=0;yt--){const St=ot[yt];J(at,kt=>kt(St))}})(E,[R,B],[I,$]),D.reverse(),w&&D.length>0)if(p.context){const{pass:z,fail:Q}=Yo(D,at=>at.parent===E);of(Q,e,E,B),p.invalid=z.length>0}else of(D,e,E,B);const P=((z,Q)=>{var at;const ot=(at=Q.forced_root_block)!==null&&at!==void 0?at:z.forced_root_block;return ot===!1?"":ot===!0?"p":ot})(r,p);return P&&(E.name==="body"||p.isRootContent)&&((z,Q)=>{const at=o1(n1("script,style,head,html,body,title,meta,param"),e.getBlockElements()),ot=/^[ \t\r\n]+/,yt=/[ \t\r\n]+$/;let St=z.firstChild,kt=null;const Nt=dt=>{var Ct,U;dt&&(St=dt.firstChild,St&&St.type===3&&(St.value=(Ct=St.value)===null||Ct===void 0?void 0:Ct.replace(ot,"")),St=dt.lastChild,St&&St.type===3&&(St.value=(U=St.value)===null||U===void 0?void 0:U.replace(yt,"")))};if(e.isValidChild(z.name,Q.toLowerCase())){for(;St;){const dt=St.next;h(at,St)?(kt||(kt=new Fn(Q,1),kt.attr(r.forced_root_block_attrs),z.insert(kt,St)),kt.append(St)):(Nt(kt),kt=null),St=dt}Nt(kt)}})(E,P),p.invalid||My(W,p),E}};return((b,p)=>{var y,w;const S=b.schema;b.addAttributeFilter("href",I=>{let D=I.length;const $=W=>{const B=W?st.trim(W):"";return/\b(noopener)\b/g.test(B)?B:(P=>P.split(" ").filter(z=>z.length>0).concat(["noopener"]).sort().join(" "))(B)};if(!p.allow_unsafe_link_target)for(;D--;){const W=I[D];W.name==="a"&&W.attr("target")==="_blank"&&W.attr("rel",$(W.attr("rel")))}}),p.allow_html_in_named_anchor||b.addAttributeFilter("id,name",I=>{let D,$,W,B,P=I.length;for(;P--;)if(B=I[P],B.name==="a"&&B.firstChild&&!B.attr("href"))for(W=B.parent,D=B.lastChild;D&&W;)$=D.prev,W.insert(D,B),D=$}),p.fix_list_elements&&b.addNodeFilter("ul,ol",I=>{let D,$,W=I.length;for(;W--;)if(D=I[W],$=D.parent,$&&($.name==="ul"||$.name==="ol"))if(D.prev&&D.prev.name==="li")D.prev.append(D);else{const B=new Fn("li",1);B.attr("style","list-style-type: none"),D.wrap(B)}});const N=S.getValidClasses();p.validate&&N&&b.addAttributeFilter("class",I=>{var D;let $=I.length;for(;$--;){const W=I[$],B=(D=W.attr("class"))!==null&&D!==void 0?D:"",P=st.explode(B," ");let z="";for(let Q=0;Q<P.length;Q++){const at=P[Q];let ot=!1,yt=N["*"];yt&&yt[at]&&(ot=!0),yt=N[W.name],!ot&&yt&&yt[at]&&(ot=!0),ot&&(z&&(z+=" "),z+=at)}z.length||(z=null),W.attr("class",z)}}),((I,D)=>{const{blob_cache:$}=D;if($){const W=B=>{const P=B.attr("src");(z=>z.attr("src")===Kt.transparentSrc||q(z.attr("data-mce-placeholder")))(B)||(z=>q(z.attr("data-mce-bogus")))(B)||Ht(P)||DC($,P,!0).each(z=>{B.attr("src",z.blobUri())})};I.addAttributeFilter("src",B=>J(B,W))}})(b,p);const E=(y=p.sandbox_iframes)!==null&&y!==void 0&&y,R=Qn((w=p.sandbox_iframes_exclusions)!==null&&w!==void 0?w:[]);p.convert_unsafe_embeds&&b.addNodeFilter("object,embed",I=>J(I,D=>{D.replace((({type:$,src:W,width:B,height:P}={},z,Q)=>{const at=(yt=>tt(yt)?"iframe":kf(yt,"image")?"img":kf(yt,"video")?"video":kf(yt,"audio")?"audio":"iframe")($),ot=new Fn(at,1);return ot.attr(at==="audio"?{src:W}:{src:W,width:B,height:P}),at!=="audio"&&at!=="video"||ot.attr("controls",""),at==="iframe"&&z&&PC(ot,Q),ot})({type:D.attr("type"),src:D.name==="object"?D.attr("data"):D.attr("src"),width:D.attr("width"),height:D.attr("height")},E,R))})),E&&b.addNodeFilter("iframe",I=>J(I,D=>PC(D,R)))})(f,r),((b,p,y)=>{p.inline_styles&&KA(b,p,y)})(f,r,e),f},s1=(t,e,n)=>{const o=(s=>su(s)?va({validate:!1}).serialize(s):s)(t),r=e(o);if(r.isDefaultPrevented())return r;if(su(t)){if(r.content!==o){const s=Qi({validate:!1,forced_root_block:!1,...n}).parse(r.content,{context:t.name});return{...r,content:s}}return{...r,content:t}}return r},a1=t=>({sanitize:nv(t),sandbox_iframes:rv(t),sandbox_iframes_exclusions:Xm(t)}),i1=(t,e)=>{if(e.no_events)return qn.value(e);{const n=((o,r)=>o.dispatch("BeforeGetContent",r))(t,e);return n.isDefaultPrevented()?qn.error(Mb(t,{content:"",...n}).content):qn.value(n)}},l1=(t,e,n)=>n.no_events?e:s1(e,r=>Mb(t,{...n,content:r}),a1(t)).content,Lf=(t,e)=>{if(e.no_events)return qn.value(e);{const n=s1(e.content,o=>((r,s)=>r.dispatch("BeforeSetContent",s))(t,{...e,content:o}),a1(t));return n.isDefaultPrevented()?(Ib(t,n),qn.error(void 0)):qn.value(n)}},Df=(t,e,n)=>{n.no_events||Ib(t,{...n,content:e})},Pf=(t,e,n)=>({element:t,width:e,rows:n}),c1=(t,e)=>({element:t,cells:e}),xR=(t,e)=>({x:t,y:e}),d1=(t,e)=>se(t,e).bind(Oo).getOr(1),ER=(t,e,n)=>{const o=t.rows;return!!(o[n]?o[n].cells:[])[e]},u1=t=>en(t,(e,n)=>n.cells.length>e?n.cells.length:e,0),m1=(t,e)=>{const n=t.rows;for(let o=0;o<n.length;o++){const r=n[o].cells;for(let s=0;s<r.length;s++)if(ne(r[s],e))return x.some(xR(s,o))}return x.none()},g1=(t,e,n,o,r)=>{const s=[],a=t.rows;for(let i=n;i<=r;i++){const l=a[i].cells,c=e<o?l.slice(e,o+1):l.slice(o,e+1);s.push(c1(a[i].element,c))}return s},_R=t=>((e,n)=>{const o=qa(e.element),r=xe("tbody");return Os(r,n),Ie(o,r),o})(t,(e=>qt(e.rows,n=>{const o=qt(n.cells,s=>{const a=Xh(s);return C(a,"colspan"),C(a,"rowspan"),a}),r=qa(n.element);return Os(r,o),r}))(t)),NR=(t,e,n)=>{const o=F(e.commonAncestorContainer),r=$s(o,t),s=Ot(r,l=>n.isWrapper(Gt(l))),a=((l,c)=>Te(l,d=>Gt(d)==="li"&&lg(d,c)).fold(it([]),d=>(u=>Te(u,m=>Gt(m)==="ul"||Gt(m)==="ol"))(l).map(u=>{const m=xe(Gt(u)),h=Ao(Ma(u),(f,b)=>ie(b,"list-style"));return xi(m,h),[xe("li"),m]}).getOr([])))(r,e),i=s.concat(a.length?a:(l=>Di(l)?pn(l).filter(Om).fold(it([]),c=>[l,c]):Om(l)?[l]:[])(o));return qt(i,qa)},f1=()=>Rg([]),AR=(t,e)=>((n,o)=>ia(o,"table",ft(ne,n)))(t,e[0]).bind(n=>{const o=e[0],r=e[e.length-1],s=(a=>{const i=Pf(qa(a),0,[]);return J(dn(a,"tr"),(l,c)=>{J(dn(l,"td,th"),(d,u)=>{((m,h,f,b,p)=>{const y=d1(p,"rowspan"),w=d1(p,"colspan"),S=m.rows;for(let N=f;N<f+y;N++){S[N]||(S[N]=c1(Xh(b),[]));for(let E=h;E<h+w;E++)S[N].cells[E]=N===f&&E===h?p:qa(p)}})(i,((m,h,f)=>{for(;ER(m,h,f);)h++;return h})(i,u,c),c,l,d)})}),Pf(i.element,u1(i.rows),i.rows)})(n);return((a,i,l)=>m1(a,i).bind(c=>m1(a,l).map(d=>((u,m,h)=>{const f=m.x,b=m.y,p=h.x,y=h.y,w=b<y?g1(u,f,b,p,y):g1(u,f,y,p,b);return Pf(u.element,u1(w),w)})(a,c,d))))(s,o,r).map(a=>Rg([_R(a)]))}).getOrThunk(f1),RR=(t,e,n)=>{const o=Lv(e,t);return o.length>0?AR(t,o):((r,s,a)=>s.length>0&&s[0].collapsed?f1():((i,l,c)=>((d,u)=>{const m=en(u,(h,f)=>(Ie(f,h),f),d);return u.length>0?Rg([m]):m})(F(l.cloneContents()),NR(i,l,c)))(r,s[0],a))(t,e,n)},mu=(t,e)=>e>=0&&e<t.length&&Ja(t.charAt(e)),p1=t=>wo(t.innerText),h1=t=>wt(t)?t.outerHTML:rt(t)?Ha.encodeRaw(t.data,!1):ns(t)?"<!--"+t.data+"-->":"",TR=(t,e)=>(((n,o)=>{let r=0;J(n,s=>{s[0]===0?r++:s[0]===1?(((a,i,l)=>{const c=(d=>{let u;const m=document.createElement("div"),h=document.createDocumentFragment();for(d&&(m.innerHTML=d);u=m.firstChild;)h.appendChild(u);return h})(i);if(a.hasChildNodes()&&l<a.childNodes.length){const d=a.childNodes[l];a.insertBefore(c,d)}else a.appendChild(c)})(o,s[1],r),r++):s[0]===2&&((a,i)=>{if(a.hasChildNodes()&&i<a.childNodes.length){const l=a.childNodes[i];a.removeChild(l)}})(o,r)})})(((n,o)=>{const r=n.length+o.length+2,s=new Array(r),a=new Array(r),i=(u,m,h,f,b)=>{const p=c(u,m,h,f);if(p===null||p.start===m&&p.diag===m-f||p.end===u&&p.diag===u-h){let y=u,w=h;for(;y<m||w<f;)y<m&&w<f&&n[y]===o[w]?(b.push([0,n[y]]),++y,++w):m-u>f-h?(b.push([2,n[y]]),++y):(b.push([1,o[w]]),++w)}else{i(u,p.start,h,p.start-p.diag,b);for(let y=p.start;y<p.end;++y)b.push([0,n[y]]);i(p.end,m,p.end-p.diag,f,b)}},l=(u,m,h,f)=>{let b=u;for(;b-m<f&&b<h&&n[b]===o[b-m];)++b;return((p,y,w)=>({start:p,end:y,diag:w}))(u,b,m)},c=(u,m,h,f)=>{const b=m-u,p=f-h;if(b===0||p===0)return null;const y=b-p,w=p+b,S=(w%2==0?w:w+1)/2;let N,E,R,I,D;for(s[1+S]=u,a[1+S]=m+1,N=0;N<=S;++N){for(E=-N;E<=N;E+=2){for(R=E+S,E===-N||E!==N&&s[R-1]<s[R+1]?s[R]=s[R+1]:s[R]=s[R-1]+1,I=s[R],D=I-u+h-E;I<m&&D<f&&n[I]===o[D];)s[R]=++I,++D;if(y%2!=0&&y-N<=E&&E<=y+N&&a[R-y]<=s[R])return l(a[R-y],E+u-h,m,f)}for(E=y-N;E<=y+N;E+=2){for(R=E+S-y,E===y-N||E!==y+N&&a[R+1]<=a[R-1]?a[R]=a[R+1]-1:a[R]=a[R-1],I=a[R]-1,D=I-u+h-E;I>=u&&D>=h&&n[I]===o[D];)a[R]=I--,D--;if(y%2==0&&-N<=E&&E<=N&&a[R]<=s[R+y])return l(a[R],E+u-h,m,f)}}return null},d=[];return i(0,n.length,0,o.length,d),d})(qt(Oe(e.childNodes),h1),t),e),e),OR=ln(()=>document.implementation.createHTMLDocument("undo")),gu=t=>{const e=t.serializer.getTempAttrs(),n=M0(t.getBody(),e);return(o=>o.querySelector("iframe")!==null)(n)?{type:"fragmented",fragments:Ot(qt(Oe(n.childNodes),qe(wo,h1)),o=>o.length>0),content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:wo(n.innerHTML),bookmark:null,beforeBookmark:null}},If=(t,e,n)=>{const o=n?e.beforeBookmark:e.bookmark;e.type==="fragmented"?TR(e.fragments,t.getBody()):t.setContent(e.content,{format:"raw",no_selection:!q(o)||!Nv(o)||!o.isFakeCaret}),o&&(t.selection.moveToBookmark(o),t.selection.scrollIntoView())},Mf=t=>t.type==="fragmented"?t.fragments.join(""):t.content,b1=t=>{const e=xe("body",OR());return _i(e,Mf(t)),J(dn(e,"*[data-mce-bogus]"),no),Bs(e)},Ff=(t,e)=>!(!t||!e)&&(!!((n,o)=>Mf(n)===Mf(o))(t,e)||((n,o)=>b1(n)===b1(o))(t,e)),Uf=t=>t.get()===0,fu=(t,e,n)=>{Uf(n)&&(t.typing=e)},v1=(t,e)=>{t.typing&&(fu(t,!1,e),t.add())},y1=t=>({init:{bindEvents:Dt},undoManager:{beforeChange:(e,n)=>((o,r,s)=>{Uf(r)&&s.set(jm(o.selection))})(t,e,n),add:(e,n,o,r,s,a)=>((i,l,c,d,u,m,h)=>{const f=gu(i),b=st.extend(m||{},f);if(!Uf(d)||i.removed)return null;const p=l.data[c.get()];if(i.dispatch("BeforeAddUndo",{level:b,lastLevel:p,originalEvent:h}).isDefaultPrevented()||p&&Ff(p,b))return null;l.data[c.get()]&&u.get().each(S=>{l.data[c.get()].beforeBookmark=S});const y=U_(i);if(y&&l.data.length>y){for(let S=0;S<l.data.length-1;S++)l.data[S]=l.data[S+1];l.data.length--,c.set(l.data.length)}b.bookmark=jm(i.selection),c.get()<l.data.length-1&&(l.data.length=c.get()+1),l.data.push(b),c.set(l.data.length-1);const w={level:b,lastLevel:p,originalEvent:h};return c.get()>0?(i.setDirty(!0),i.dispatch("AddUndo",w),i.dispatch("change",w)):i.dispatch("AddUndo",w),b})(t,e,n,o,r,s,a),undo:(e,n,o)=>((r,s,a,i)=>{let l;return s.typing&&(s.add(),s.typing=!1,fu(s,!1,a)),i.get()>0&&(i.set(i.get()-1),l=s.data[i.get()],If(r,l,!0),r.setDirty(!0),r.dispatch("Undo",{level:l})),l})(t,e,n,o),redo:(e,n)=>((o,r,s)=>{let a;return r.get()<s.length-1&&(r.set(r.get()+1),a=s[r.get()],If(o,a,!1),o.setDirty(!0),o.dispatch("Redo",{level:a})),a})(t,e,n),clear:(e,n)=>((o,r,s)=>{r.data=[],s.set(0),r.typing=!1,o.dispatch("ClearUndos")})(t,e,n),reset:e=>(n=>{n.clear(),n.add()})(e),hasUndo:(e,n)=>((o,r,s)=>s.get()>0||r.typing&&r.data[0]&&!Ff(gu(o),r.data[0]))(t,e,n),hasRedo:(e,n)=>((o,r)=>r.get()<o.data.length-1&&!o.typing)(e,n),transact:(e,n,o)=>((r,s,a)=>(v1(r,s),r.beforeChange(),r.ignore(a),r.add()))(e,n,o),ignore:(e,n)=>((o,r)=>{try{o.set(o.get()+1),r()}finally{o.set(o.get()-1)}})(e,n),extra:(e,n,o,r)=>((s,a,i,l,c)=>{if(a.transact(l)){const d=a.data[i.get()].bookmark,u=a.data[i.get()-1];If(s,u,!0),a.transact(c)&&(a.data[i.get()-1].beforeBookmark=d)}})(t,e,n,o,r)},formatter:{match:(e,n,o,r)=>gf(t,e,n,o,r),matchAll:(e,n)=>((o,r,s)=>{const a=[],i={},l=o.selection.getStart();return o.dom.getParent(l,c=>{for(let d=0;d<r.length;d++){const u=r[d];!i[u]&&cs(o,c,u,s)&&(i[u]=!0,a.push(u))}},o.dom.getRoot()),a})(t,e,n),matchNode:(e,n,o,r)=>cs(t,e,n,o,r),canApply:e=>((n,o)=>{const r=n.formatter.get(o),s=n.dom;if(r&&n.selection.isEditable()){const a=n.selection.getStart(),i=zd(s,a);for(let l=r.length-1;l>=0;l--){const c=r[l];if(!zo(c))return!0;for(let d=i.length-1;d>=0;d--)if(s.is(i[d],c.selector))return!0}}return!1})(t,e),closest:e=>((n,o)=>{const r=s=>ne(s,F(n.getBody()));return x.from(n.selection.getStart(!0)).bind(s=>df(F(s),a=>Xn(o,i=>((l,c)=>cs(n,l.dom,c)?x.some(c):x.none())(a,i)),r)).getOrNull()})(t,e),apply:(e,n,o)=>SC(t,e,n,o),remove:(e,n,o,r)=>yC(t,e,n,o,r),toggle:(e,n,o)=>((r,s,a,i)=>{const l=r.formatter.get(s);l&&(!gf(r,s,a,i)||"toggle"in l[0]&&!l[0].toggle?SC(r,s,a,i):yC(r,s,a,i))})(t,e,n,o),formatChanged:(e,n,o,r,s)=>((a,i,l,c,d,u)=>(((m,h,f,b,p,y)=>{const w=h.get();J(f.split(","),S=>{const N=ee(w,S).getOrThunk(()=>{const R={withSimilar:{state:Ye(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Ye(!1),similar:!1,callbacks:[]},withVars:[]};return w[S]=R,R}),E=()=>{const R=_C(m);return EC(m,R,S,p,y).isSome()};if(tt(y)){const R=p?N.withSimilar:N.withoutSimilar;R.callbacks.push(b),R.callbacks.length===1&&R.state.set(E())}else N.withVars.push({state:Ye(E()),similar:p,vars:y,callback:b})}),h.set(w)})(a,i,l,c,d,u),{unbind:()=>((m,h,f)=>{const b=m.get();J(h.split(","),p=>ee(b,p).each(y=>{b[p]={withSimilar:{...y.withSimilar,callbacks:Ot(y.withSimilar.callbacks,w=>w!==f)},withoutSimilar:{...y.withoutSimilar,callbacks:Ot(y.withoutSimilar.callbacks,w=>w!==f)},withVars:Ot(y.withVars,w=>w.callback!==f)}})),m.set(b)})(i,l,c)}))(t,e,n,o,r,s)},editor:{getContent:e=>((n,o)=>x.from(n.getBody()).fold(it(o.format==="tree"?new Fn("body",11):""),r=>bA(n,o,r)))(t,e),setContent:(e,n)=>((o,r,s)=>x.from(o.getBody()).map(a=>su(r)?((i,l,c,d)=>{Fy(i.parser.getNodeFilters(),i.parser.getAttributeFilters(),c);const u=va({validate:!1},i.schema).serialize(c),m=wo(Cd(F(l))?u:st.trim(u));return cf(i,m,d.no_selection),{content:c,html:m}})(o,a,r,s):((i,l,c,d)=>{if((c=wo(c)).length===0||/^\s+$/.test(c)){const u='<br data-mce-bogus="1">';l.nodeName==="TABLE"?c="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(l.nodeName)&&(c="<li>"+u+"</li>");const m=Nn(i);return i.schema.isValidChild(l.nodeName.toLowerCase(),m.toLowerCase())?(c=u,c=i.dom.createHTML(m,Jl(i),c)):c||(c=u),cf(i,c,d.no_selection),{content:c,html:c}}{d.format!=="raw"&&(c=va({validate:!1},i.schema).serialize(i.parser.parse(c,{isRootContent:!0,insert:!0})));const u=Cd(F(l))?c:st.trim(c);return cf(i,u,d.no_selection),{content:u,html:u}}})(o,a,r,s)).getOr({content:r,html:su(s.content)?"":s.content}))(t,e,n),insertContent:(e,n)=>HA(t,e,n),addVisual:e=>((n,o)=>{const r=n.dom,s=q(o)?o:n.getBody();J(r.select("table,a",s),a=>{switch(a.nodeName){case"TABLE":const i=q_(n),l=r.getAttrib(a,"border");l&&l!=="0"||!n.hasVisual?r.removeClass(a,i):r.addClass(a,i);break;case"A":if(!r.getAttrib(a,"href")){const c=r.getAttrib(a,"name")||a.id,d=Jb(n);c&&n.hasVisual?r.addClass(a,d):r.removeClass(a,d)}}}),n.dispatch("VisualAid",{element:o,hasVisual:n.hasVisual})})(t,e)},selection:{getContent:(e,n)=>((o,r,s={})=>{const a=((i,l)=>({...i,format:l,get:!0,selection:!0,getInner:!0}))(s,r);return i1(o,a).fold(Zt,i=>{const l=((c,d)=>{if(d.format==="text")return(u=>x.from(u.selection.getRng()).map(m=>{var h;const f=x.from(u.dom.getParent(m.commonAncestorContainer,u.dom.isBlock)),b=u.getBody(),p=(E=>E.map(R=>R.nodeName).getOr("div").toLowerCase())(f),y=F(m.cloneContents());F0(y),U0(y);const w=u.dom.add(b,p,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},y.dom),S=p1(w),N=wo((h=w.textContent)!==null&&h!==void 0?h:"");if(u.dom.remove(w),mu(N,0)||mu(N,N.length-1)){const E=f.getOr(b),R=p1(E),I=R.indexOf(S);return I===-1?S:(mu(R,I-1)?" ":"")+S+(mu(R,I+S.length)?" ":"")}return S}).getOr(""))(c);{const u=((m,h)=>{const f=m.selection.getRng(),b=m.dom.create("body"),p=m.selection.getSel(),y=Dg(m,ag(p)),w=h.contextual?RR(F(m.getBody()),y,m.schema).dom:f.cloneContents();return w&&b.appendChild(w),m.selection.serializer.serialize(b,h)})(c,d);return d.format==="tree"?u:c.selection.isCollapsed()?"":u}})(o,i);return l1(o,l,i)})})(t,e,n)},autocompleter:{addDecoration:Dt,removeDecoration:Dt},raw:{getModel:()=>x.none()}}),ds=t=>Bt(t.plugins,"rtc"),zf=t=>t.rtcInstance?t.rtcInstance:y1(t),Xe=t=>{const e=t.rtcInstance;if(e)return e;throw new Error("Failed to get RTC instance not yet initialized.")},C1=t=>Xe(t).init.bindEvents(),w1=t=>t.dom.length===0?(le(t),x.none()):x.some(t),S1=(t,e,n,o,r)=>{t.bind(s=>((o?jg:tu)(s.dom,o?s.dom.length:0,r),e.filter(Be).map(a=>((i,l,c,d,u)=>{const m=i.dom,h=l.dom,f=d?m.length:h.length;d?(Vg(m,h,u,!1,!d),c.setStart(h,f)):(Vg(h,m,u,!1,!d),c.setEnd(h,f))})(s,a,n,o,r)))).orThunk(()=>((a,i)=>a.filter(l=>dc.isBookmarkNode(l.dom)).bind(i?Pa:Rr))(e,o).or(e).filter(Be).map(a=>((i,l,c)=>{pn(i).each(d=>{const u=i.dom;l&&pc(d,X(u,0),c)?tu(u,0,c):!l&&hc(d,X(u,u.length),c)&&jg(u,u.length,c)})})(a,o,r)))},k1=(t,e,n)=>{if(Bt(t,e)){const o=Ot(t[e],r=>r!==n);o.length===0?delete t[e]:t[e]=o}},x1=t=>!(!t||!t.ownerDocument)&&Pn(F(t.ownerDocument),F(t)),E1=(t,e,n,o)=>{let r,s;const{selectorChangedWithUnbind:a}=((p,y)=>{let w,S;const N=(R,I)=>Te(I,D=>p.is(D,R)),E=R=>p.getParents(R,void 0,p.getRoot());return{selectorChangedWithUnbind:(R,I)=>(w||(w={},S={},y.on("NodeChange",D=>{const $=D.element,W=E($),B={};re(w,(P,z)=>{N(z,W).each(Q=>{S[z]||(J(P,at=>{at(!0,{node:Q,selector:z,parents:W})}),S[z]=P),B[z]=P})}),re(S,(P,z)=>{B[z]||(delete S[z],J(P,Q=>{Q(!1,{node:$,selector:z,parents:W})}))})})),w[R]||(w[R]=[]),w[R].push(I),N(R,E(y.selection.getStart())).each(()=>{S[R]=w[R]}),{unbind:()=>{k1(w,R,I),k1(S,R,I)}})}})(t,o),i=(p,y)=>((w,S,N={})=>{const E=((R,I)=>({format:"html",...R,set:!0,selection:!0,content:I}))(N,S);Lf(w,E).each(R=>{const I=(($,W)=>{if(W.format!=="raw"){const B=$.selection.getRng(),P=$.dom.getParent(B.commonAncestorContainer,$.dom.isBlock),z=P?{context:P.nodeName.toLowerCase()}:{},Q=$.parser.parse(W.content,{forced_root_block:!1,...z,...W});return va({validate:!1},$.schema).serialize(Q)}return W.content})(w,R),D=w.selection.getRng();(($,W,B)=>{const P=x.from(W.firstChild).map(F),z=x.from(W.lastChild).map(F);$.deleteContents(),$.insertNode(W);const Q=P.bind(Rr).filter(Be).bind(w1),at=z.bind(Pa).filter(Be).bind(w1);S1(Q,P,$,!0,B),S1(at,z,$,!1,B),$.collapse(!1)})(D,D.createContextualFragment(I),w.schema),w.selection.setRng(D),mc(w,D),Df(w,I,R)})})(o,p,y),l=p=>{const y=d();y.collapse(!!p),u(y)},c=()=>e.getSelection?e.getSelection():e.document.selection,d=()=>{let p;const y=(S,N,E)=>{try{return N.compareBoundaryPoints(S,E)}catch{return-1}},w=e.document;if(q(o.bookmark)&&!Yi(o)){const S=wg(o);if(S.isSome())return S.map(N=>Dg(o,[N])[0]).getOr(w.createRange())}try{const S=c();S&&!za(S.anchorNode)&&(p=S.rangeCount>0?S.getRangeAt(0):w.createRange(),p=Dg(o,[p])[0])}catch{}if(p||(p=w.createRange()),Ms(p.startContainer)&&p.collapsed){const S=t.getRoot();p.setStart(S,0),p.setEnd(S,0)}return r&&s&&(y(p.START_TO_START,p,r)===0&&y(p.END_TO_END,p,r)===0?p=s:(r=null,s=null)),p},u=(p,y)=>{if(!(S=>!!S&&x1(S.startContainer)&&x1(S.endContainer))(p))return;const w=c();if(p=o.dispatch("SetSelectionRange",{range:p,forward:y}).range,w){s=p;try{w.removeAllRanges(),w.addRange(p)}catch{}y===!1&&w.extend&&(w.collapse(p.endContainer,p.endOffset),w.extend(p.startContainer,p.startOffset)),r=w.rangeCount>0?w.getRangeAt(0):null}if(!p.collapsed&&p.startContainer===p.endContainer&&w?.setBaseAndExtent&&p.endOffset-p.startOffset<2&&p.startContainer.hasChildNodes()){const S=p.startContainer.childNodes[p.startOffset];S&&S.nodeName==="IMG"&&(w.setBaseAndExtent(p.startContainer,p.startOffset,p.endContainer,p.endOffset),w.anchorNode===p.startContainer&&w.focusNode===p.endContainer||w.setBaseAndExtent(S,0,S,1))}o.dispatch("AfterSetSelectionRange",{range:p,forward:y})},m=()=>{const p=c(),y=p?.anchorNode,w=p?.focusNode;if(!p||!y||!w||za(y)||za(w))return!0;const S=t.createRng(),N=t.createRng();try{S.setStart(y,p.anchorOffset),S.collapse(!0),N.setStart(w,p.focusOffset),N.collapse(!0)}catch{return!0}return S.compareBoundaryPoints(S.START_TO_START,N)<=0},h={dom:t,win:e,serializer:n,editor:o,expand:(p={type:"word"})=>u(ni(t).expand(d(),p)),collapse:l,setCursorLocation:(p,y)=>{const w=t.createRng();q(p)&&q(y)?(w.setStart(p,y),w.setEnd(p,y),u(w),l(!1)):(cg(t,w,o.getBody(),!0),u(w))},getContent:p=>((y,w={})=>((S,N,E)=>Xe(S).selection.getContent(N,E))(y,w.format?w.format:"html",w))(o,p),setContent:i,getBookmark:(p,y)=>f.getBookmark(p,y),moveToBookmark:p=>f.moveToBookmark(p),select:(p,y)=>(((w,S,N)=>x.from(S).bind(E=>x.from(E.parentNode).map(R=>{const I=w.nodeIndex(E),D=w.createRng();return D.setStart(R,I),D.setEnd(R,I+1),N&&(cg(w,D,E,!0),cg(w,D,E,!1)),D})))(t,p,y).each(u),p),isCollapsed:()=>{const p=d(),y=c();return!(!p||p.item)&&(p.compareEndPoints?p.compareEndPoints("StartToEnd",p)===0:!y||p.collapsed)},isEditable:()=>{if(o.mode.isReadOnly())return!1;const p=d(),y=o.getBody().querySelectorAll('[data-mce-selected="1"]');return y.length>0?kn(y,w=>t.isEditable(w.parentElement)):_0(t,p)},isForward:m,setNode:p=>(i(t.getOuterHTML(p)),p),getNode:()=>((p,y)=>{if(!y)return p;let w=y.startContainer,S=y.endContainer;const N=y.startOffset,E=y.endOffset;let R=y.commonAncestorContainer;y.collapsed||(w===S&&E-N<2&&w.hasChildNodes()&&(R=w.childNodes[N]),rt(w)&&rt(S)&&(w=w.length===N?T0(w.nextSibling,!0):w.parentNode,S=E===0?T0(S.previousSibling,!1):S.parentNode,w&&w===S&&(R=w)));const I=rt(R)?R.parentNode:R;return cr(I)?I:p})(o.getBody(),d()),getSel:c,setRng:u,getRng:d,getStart:p=>A0(o.getBody(),d(),p),getEnd:p=>R0(o.getBody(),d(),p),getSelectedBlocks:(p,y)=>((w,S,N,E)=>{const R=[],I=w.getRoot(),D=w.getParent(N||A0(I,S,S.collapsed),w.isBlock),$=w.getParent(E||R0(I,S,S.collapsed),w.isBlock);if(D&&D!==I&&R.push(D),D&&$&&D!==$){let W;const B=new Ge(D,I);for(;(W=B.next())&&W!==$;)w.isBlock(W)&&R.push(W)}return $&&D!==$&&$!==I&&R.push($),R})(t,d(),p,y),normalize:()=>{const p=d(),y=c();if(!(ag(y).length>1)&&Fd(o)){const w=Gd(t,p);return w.each(S=>{u(S,m())}),w.getOr(p)}return p},selectorChanged:(p,y)=>(a(p,y),h),selectorChangedWithUnbind:a,getScrollContainer:()=>{let p,y=t.getRoot();for(;y&&y.nodeName!=="BODY";){if(y.scrollHeight>y.clientHeight){p=y;break}y=y.parentNode}return p},scrollIntoView:(p,y)=>{q(p)?((w,S,N)=>{(w.inline?sA:iA)(w,S,N)})(o,p,y):mc(o,d(),y)},placeCaretAt:(p,y)=>u(f0(p,y,o.getDoc())),getBoundingClientRect:()=>{const p=d();return p.collapsed?X.fromRangeStart(p).getClientRects()[0]:p.getBoundingClientRect()},destroy:()=>{e=r=s=null,b.destroy()}},f=dc(h),b=d0(h,o);return h.bookmarkManager=f,h.controlSelection=b,h},BR=(t,e,n)=>{st.inArray(e,n)===-1&&(t.addAttributeFilter(n,(o,r)=>{let s=o.length;for(;s--;)o[s].attr(r,null)}),e.push(n))},LR=(t,e)=>{const n=["data-mce-selected"],o={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...t},r=e&&e.dom?e.dom:ye.DOM,s=e&&e.schema?e.schema:ua(o),a=Qi(o,s);return((i,l,c)=>{i.addAttributeFilter("data-mce-tabindex",(d,u)=>{let m=d.length;for(;m--;){const h=d[m];h.attr("tabindex",h.attr("data-mce-tabindex")),h.attr(u,null)}}),i.addAttributeFilter("src,href,style",(d,u)=>{const m="data-mce-"+u,h=l.url_converter,f=l.url_converter_scope;let b=d.length;for(;b--;){const p=d[b];let y=p.attr(m);y!==void 0?(p.attr(u,y.length>0?y:null),p.attr(m,null)):(y=p.attr(u),u==="style"?y=c.serializeStyle(c.parseStyle(y),p.name):h&&(y=h.call(f,y,u,p.name)),p.attr(u,y.length>0?y:null))}}),i.addAttributeFilter("class",d=>{let u=d.length;for(;u--;){const m=d[u];let h=m.attr("class");h&&(h=h.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),m.attr("class",h.length>0?h:null))}}),i.addAttributeFilter("data-mce-type",(d,u,m)=>{let h=d.length;for(;h--;){const f=d[h];f.attr("data-mce-type")==="bookmark"&&!m.cleanup&&(x.from(f.firstChild).exists(p=>{var y;return!wd((y=p.value)!==null&&y!==void 0?y:"")})?f.unwrap():f.remove())}}),i.addNodeFilter("script,style",(d,u)=>{var m;const h=b=>b.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let f=d.length;for(;f--;){const b=d[f],p=b.firstChild,y=(m=p?.value)!==null&&m!==void 0?m:"";if(u==="script"){const w=b.attr("type");w&&b.attr("type",w==="mce-no/type"?null:w.replace(/^mce\-/,"")),l.element_format==="xhtml"&&p&&y.length>0&&(p.value=`// <![CDATA[
`+h(y)+`
// ]]>`)}else l.element_format==="xhtml"&&p&&y.length>0&&(p.value=`<!--
`+h(y)+`
-->`)}}),i.addNodeFilter("#comment",d=>{let u=d.length;for(;u--;){const m=d[u],h=m.value;l.preserve_cdata&&h?.indexOf("[CDATA[")===0?(m.name="#cdata",m.type=4,m.value=c.decode(h.replace(/^\[CDATA\[|\]\]$/g,""))):h?.indexOf("mce:protected ")===0&&(m.name="#text",m.type=3,m.raw=!0,m.value=unescape(h).substr(14))}}),i.addNodeFilter("xml:namespace,input",(d,u)=>{let m=d.length;for(;m--;){const h=d[m];h.type===7?h.remove():h.type===1&&(u!=="input"||h.attr("type")||h.attr("type","text"))}}),i.addAttributeFilter("data-mce-type",d=>{J(d,u=>{u.attr("data-mce-type")==="format-caret"&&(u.isEmpty(i.schema.getNonEmptyElements())?u.remove():u.unwrap())})}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(d,u)=>{let m=d.length;for(;m--;)d[m].attr(u,null)}),l.remove_trailing_brs&&((d,u,m)=>{u.addNodeFilter("br",(h,f,b)=>{const p=st.extend({},m.getBlockElements()),y=m.getNonEmptyElements(),w=m.getWhitespaceElements();p.body=1;const S=N=>N.name in p||In(m,N);for(let N=0,E=h.length;N<E;N++){let R=h[N],I=R.parent;if(I&&S(I)&&R===I.lastChild){let D=R.prev;for(;D;){const $=D.name;if($!=="span"||D.attr("data-mce-type")!=="bookmark"){$==="br"&&(R=null);break}D=D.prev}if(R&&(R.remove(),vc(m,y,w,I))){const $=m.getElementRule(I.name);$&&($.removeEmpty?I.remove():$.paddEmpty&&ef(d,b,S,I))}}else{let D=R;for(;I&&I.firstChild===D&&I.lastChild===D&&(D=I,!p[I.name]);)I=I.parent;if(D===I){const $=new Fn("#text",3);$.value=ze,R.replace($)}}}})})(l,i,i.schema)})(a,o,r),{schema:s,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:(i,l={})=>{const c={format:"html",...l},d=((h,f,b)=>((p,y)=>q(p)&&p.hasEventListeners("PreProcess")&&!y.no_events)(h,b)?((p,y,w)=>{let S;const N=p.dom;let E=y.cloneNode(!0);const R=document.implementation;if(R.createHTMLDocument){const I=R.createHTMLDocument("");st.each(E.nodeName==="BODY"?E.childNodes:[E],D=>{I.body.appendChild(I.importNode(D,!0))}),E=E.nodeName!=="BODY"?I.body.firstChild:I.body,S=N.doc,N.doc=I}return((I,D)=>{I.dispatch("PreProcess",D)})(p,{...w,node:E}),S&&(N.doc=S),E})(h,f,b):f)(e,i,c),u=((h,f,b)=>{const p=wo(b.getInner?f.innerHTML:h.getOuterHTML(f));return b.selection||Cd(F(f))?p:st.trim(p)})(r,d,c),m=((h,f,b)=>{const p=b.selection?{forced_root_block:!1,...b}:b,y=h.parse(f,p);return(w=>{const S=E=>E?.name==="br",N=w.lastChild;if(S(N)){const E=N.prev;S(E)&&(N.remove(),E.remove())}})(y),y})(a,u,c);return c.format==="tree"?m:((h,f,b,p,y)=>{const w=((S,N,E)=>va(S,N).serialize(E))(f,b,p);return((S,N,E)=>!N.no_events&&S?((I,D)=>I.dispatch("PostProcess",D))(S,{...N,content:E}).content:E)(h,y,w)})(e,o,s,m,c)},addRules:s.addValidElements,setRules:s.setValidElements,addTempAttr:ft(BR,a,n),getTempAttrs:it(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},_1=(t,e)=>{const n=LR(t,e);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},$f=(t,e,n={})=>{const o=((r,s)=>({format:"html",...r,set:!0,content:s}))(n,e);return Lf(t,o).map(r=>{const s=((a,i,l)=>zf(a).editor.setContent(i,l))(t,r.content,r);return Df(t,s.html,r),s.content}).getOr(e)},DR="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists,template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),PR=[],IR="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,template,textcolor,rtc".split(","),N1=[],A1=(t,e)=>{const n=Ot(e,o=>Bt(t,o));return Yn(n)},MR=t=>{const e=A1(t,DR),n=t.forced_root_block;return n!==!1&&n!==""||e.push("forced_root_block (false only)"),Yn(e)},FR=t=>A1(t,PR),R1=(t,e)=>{const n=st.makeMap(t.plugins," "),o=Ot(e,r=>Bt(n,r));return Yn(o)},UR=t=>R1(t,IR),zR=t=>R1(t,N1.map(e=>e.name)),$R=t=>Te(N1,e=>e.name===t).fold(()=>t,e=>e.replacedWith?`${t}, replaced by ${e.replacedWith}`:t),pu=ye.DOM,hu=t=>x.from(t).each(e=>e.destroy()),bu=(()=>{const t={};return{add:(e,n)=>{t[e]=n},get:e=>t[e]?t[e]:{icons:{}},has:e=>Bt(t,e)}})(),Zi=Mn.ModelManager,T1=(t,e)=>e.dom[t],O1=(t,e)=>parseInt(lr(e,t),10),HR=ft(T1,"clientWidth"),jR=ft(T1,"clientHeight"),VR=ft(O1,"margin-top"),qR=ft(O1,"margin-left"),B1=t=>{const e=[],n=()=>{const l=t.theme;return l&&l.getNotificationManagerImpl?l.getNotificationManagerImpl():(()=>{const c=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:c,close:c,getArgs:c}})()},o=()=>x.from(e[0]),r=()=>{o().each(l=>{l.reposition()})},s=l=>{oe(e,c=>c===l).each(c=>{e.splice(c,1)})},a=(l,c=!0)=>t.removed||!(d=>{return(u=d.inline?d.getBody():d.getContentAreaContainer(),x.from(u).map(F)).map(aa).getOr(!1);var u})(t)?{}:(c&&t.dispatch("BeforeOpenNotification",{notification:l}),Te(e,d=>{return u=n().getArgs(d),m=l,!(u.type!==m.type||u.text!==m.text||u.progressBar||u.timeout||m.progressBar||m.timeout);var u,m}).getOrThunk(()=>{t.editorManager.setActive(t);const d=n().open(l,()=>{s(d)},()=>Eg(t));return(u=>{e.push(u)})(d),r(),t.dispatch("OpenNotification",{notification:{...d}}),d})),i=it(e);return(l=>{l.on("SkinLoaded",()=>{const c=N_(l);c&&a({text:c,type:"warning",timeout:0},!1),r()}),l.on("show ResizeEditor ResizeWindow NodeChange ToggleView FullscreenStateChanged",()=>{requestAnimationFrame(r)}),l.on("remove",()=>{J(e.slice(),c=>{n().close(c)})}),l.on("keydown",c=>{var d;const u=((d=c.key)===null||d===void 0?void 0:d.toLowerCase())==="f12"||c.keyCode===123;c.altKey&&u&&(c.preventDefault(),o().map(m=>F(m.getEl())).each(m=>e0(m)))})})(t),{open:a,close:()=>{o().each(l=>{n().close(l),s(l),r()})},getNotifications:i}},Ji=Mn.PluginManager,li=Mn.ThemeManager,L1=t=>{let e=[];const n=()=>{const a=t.theme;return a&&a.getWindowManagerImpl?a.getWindowManagerImpl():(()=>{const i=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:i,openUrl:i,alert:i,confirm:i,close:i}})()},o=(a,i)=>(...l)=>i?i.apply(a,l):void 0,r=a=>{(i=>{t.dispatch("CloseWindow",{dialog:i})})(a),e=Ot(e,i=>i!==a),e.length===0&&t.focus()},s=a=>{t.editorManager.setActive(t),jd(t),t.ui.show();const i=a();return(l=>{e.push(l),(c=>{t.dispatch("OpenWindow",{dialog:c})})(l)})(i),i};return t.on("remove",()=>{J(e,a=>{n().close(a)})}),{open:(a,i)=>s(()=>n().open(a,i,r)),openUrl:a=>s(()=>n().openUrl(a,r)),alert:(a,i,l)=>{const c=n();c.alert(a,o(l||c,i))},confirm:(a,i,l)=>{const c=n();c.confirm(a,o(l||c,i))},close:()=>{x.from(e[e.length-1]).each(a=>{n().close(a),r(a)})}}},D1=(t,e)=>{t.notificationManager.open({type:"error",text:e})},vu=(t,e)=>{t._skinLoaded?D1(t,e):t.on("SkinLoaded",()=>{D1(t,e)})},_c=(t,e,n)=>{Lb(t,e,{message:n}),console.error(n)},Nc=(t,e,n)=>n?`Failed to load ${t}: ${n} from url ${e}`:`Failed to load ${t} url: ${e}`,yu=(t,...e)=>{const n=window.console;n&&(n.error?n.error(t,...e):n.log(t,...e))},Hf=(t,e,n)=>{try{t.getDoc().execCommand(e,!1,String(n))}catch{}},P1=(t,e,n)=>{Ze(t,e)&&!n?to(t,e):n&&Ue(t,e)},I1=t=>{const e=F(t.getBody());P1(e,"mce-content-readonly",!0),t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),(n=>{x.from(n.selection.getNode()).each(o=>{o.removeAttribute("data-mce-selected")})})(t)},M1=t=>{const e=F(t.getBody());P1(e,"mce-content-readonly",!1),t.hasEditableRoot()&&ki(e,!0),((n,o)=>{Hf(n,"StyleWithCSS",o),Hf(n,"enableInlineTableEditing",o),Hf(n,"enableObjectResizing",o)})(t,!1),Eg(t)&&t.focus(),(n=>{n.selection.setRng(n.selection.getRng())})(t),t.nodeChanged()},Hs=t=>Od(t),ci="data-mce-contenteditable",F1=(t,e)=>{const n=F(t.getBody());e?(I1(t),ki(n,!1),J(dn(n,'*[contenteditable="true"]'),o=>{et(o,ci,"true"),ki(o,!1)})):(J(dn(n,`*[${ci}="true"]`),o=>{C(o,ci),ki(o,!0)}),M1(t))},U1=t=>{t.parser.addAttributeFilter("contenteditable",e=>{Hs(t)&&J(e,n=>{n.attr(ci,n.attr("contenteditable")),n.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(ci,e=>{Hs(t)&&J(e,n=>{n.attr("contenteditable",n.attr(ci))})}),t.serializer.addTempAttr(ci)},WR=["copy"],jf=t=>"content/"+t+"/content.css",z1=(t,e)=>{const n=t.editorManager.baseURL+"/skins/content",o=`content${t.editorManager.suffix}.css`;return qt(e,r=>(s=>tinymce.Resource.has(jf(s)))(r)?r:(s=>/^[a-z0-9\-]+$/i.test(s))(r)&&!t.inline?`${n}/${r}/${o}`:t.documentBaseURI.toAbsolute(r))},KR=(t,e)=>{const n={};return{findAll:(o,r=ae)=>{const s=Ot((i=>i?Oe(i.getElementsByTagName("img")):[])(o),i=>{const l=i.src;return!i.hasAttribute("data-mce-bogus")&&!i.hasAttribute("data-mce-placeholder")&&!(!l||l===Kt.transparentSrc)&&(ie(l,"blob:")?!t.isUploaded(l)&&r(i):!!ie(l,"data:")&&r(i))}),a=qt(s,i=>{const l=i.src;if(Bt(n,l))return n[l].then(c=>vt(c)?c:{image:i,blobInfo:c.blobInfo});{const c=((d,u)=>{const m=()=>Promise.reject("Invalid data URI");if(ie(u,"blob:")){const b=d.getByUri(u);return q(b)?Promise.resolve(b):(h=u,ie(h,"blob:")?(p=>fetch(p).then(y=>y.ok?y.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${p} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})))(h):ie(h,"data:")?(f=h,new Promise((p,y)=>{Sf(f).bind(({type:w,data:S,base64Encoded:N})=>TC(w,S,N)).fold(()=>y("Invalid data URI"),p)})):Promise.reject("Unknown URI format")).then(p=>OC(p).then(y=>BC(y,!1,w=>x.some(LC(d,p,w))).getOrThunk(m)))}var h,f;return ie(u,"data:")?DC(d,u).fold(m,b=>Promise.resolve(b)):Promise.reject("Unknown image data format")})(e,l).then(d=>(delete n[l],{image:i,blobInfo:d})).catch(d=>(delete n[l],d));return n[l]=c,c}});return Promise.all(a)}}},$1=()=>{let t={};const e=(o,r)=>({status:o,resultUri:r}),n=o=>o in t;return{hasBlobUri:n,getResultUri:o=>{const r=t[o];return r?r.resultUri:null},isPending:o=>!!n(o)&&t[o].status===1,isUploaded:o=>!!n(o)&&t[o].status===2,markPending:o=>{t[o]=e(1,null)},markUploaded:(o,r)=>{t[o]=e(2,r)},removeFailed:o=>{delete t[o]},destroy:()=>{t={}}}};let GR=0;const YR=(t,e)=>{const n={},o=(l,c)=>new Promise((d,u)=>{const m=new XMLHttpRequest;m.open("POST",e.url),m.withCredentials=e.credentials,m.upload.onprogress=f=>{c(f.loaded/f.total*100)},m.onerror=()=>{u("Image upload failed due to a XHR Transport error. Code: "+m.status)},m.onload=()=>{if(m.status<200||m.status>=300)return void u("HTTP Error: "+m.status);const f=JSON.parse(m.responseText);var b,p;f&&vt(f.location)?d((b=e.basePath,p=f.location,b?b.replace(/\/$/,"")+"/"+p.replace(/^\//,""):p)):u("Invalid JSON: "+m.responseText)};const h=new FormData;h.append("file",l.blob(),l.filename()),m.send(h)}),r=jt(e.handler)?e.handler:o,s=(l,c)=>({url:c,blobInfo:l,status:!0}),a=(l,c)=>({url:"",blobInfo:l,status:!1,error:c}),i=(l,c)=>{st.each(n[l],d=>{d(c)}),delete n[l]};return{upload:(l,c)=>e.url||r!==o?((d,u)=>(d=st.grep(d,m=>!t.isUploaded(m.blobUri())),Promise.all(st.map(d,m=>t.isPending(m.blobUri())?(h=>{const f=h.blobUri();return new Promise(b=>{n[f]=n[f]||[],n[f].push(b)})})(m):((h,f,b)=>(t.markPending(h.blobUri()),new Promise(p=>{let y,w;try{const S=()=>{y&&(y.close(),w=Dt)},N=R=>{S(),t.markUploaded(h.blobUri(),R),i(h.blobUri(),s(h,R)),p(s(h,R))},E=R=>{S(),t.removeFailed(h.blobUri()),i(h.blobUri(),a(h,R)),p(a(h,R))};w=R=>{R<0||R>100||x.from(y).orThunk(()=>x.from(b).map(go)).each(I=>{y=I,I.progressBar.value(R)})},f(h,w).then(N,R=>{E(vt(R)?{message:R}:R)})}catch(S){p(a(h,S))}})))(m,r,u)))))(l,c):new Promise(d=>{d([])})}},H1=t=>()=>t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),j1=(t,e)=>YR(e,{url:f_(t),basePath:p_(t),credentials:h_(t),handler:b_(t)}),XR=t=>{const e=(()=>{let b=[];const p=S=>{if(!S.blob||!S.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const N=S.id||"blobid"+GR+++(()=>{const D=()=>Math.round(4294967295*Kh()).toString(36);return"s"+new Date().getTime().toString(36)+D()+D()+D()})(),E=S.name||N,R=S.blob;var I;return{id:it(N),name:it(E),filename:it(S.filename||E+"."+(I=R.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[I.toLowerCase()]||"dat")),blob:it(R),base64:it(S.base64),blobUri:it(S.blobUri||URL.createObjectURL(R)),uri:it(S.uri)}},y=S=>Te(b,S).getOrUndefined(),w=S=>y(N=>N.id()===S);return{create:(S,N,E,R,I)=>{if(vt(S))return p({id:S,name:R,filename:I,blob:N,base64:E});if(Re(S))return p(S);throw new Error("Unknown input type")},add:S=>{w(S.id())||b.push(S)},get:w,getByUri:S=>y(N=>N.blobUri()===S),getByData:(S,N)=>y(E=>E.base64()===S&&E.blob().type===N),findFirst:y,removeByUri:S=>{b=Ot(b,N=>N.blobUri()!==S||(URL.revokeObjectURL(N.blobUri()),!1))},destroy:()=>{J(b,S=>{URL.revokeObjectURL(S.blobUri())}),b=[]}}})();let n,o;const r=$1(),s=[],a=b=>p=>t.selection?b(p):[],i=(b,p,y)=>{let w=0;do w=b.indexOf(p,w),w!==-1&&(b=b.substring(0,w)+y+b.substr(w+p.length),w+=y.length-p.length+1);while(w!==-1);return b},l=(b,p,y)=>{const w=`src="${y}"${y===Kt.transparentSrc?' data-mce-placeholder="1"':""}`;return b=i(b,`src="${p}"`,w),i(b,'data-mce-src="'+p+'"','data-mce-src="'+y+'"')},c=(b,p)=>{J(t.undoManager.data,y=>{y.type==="fragmented"?y.fragments=qt(y.fragments,w=>l(w,b,p)):y.content=l(y.content,b,p)})},d=()=>(n||(n=j1(t,r)),h().then(a(b=>{const p=qt(b,y=>y.blobInfo);return n.upload(p,H1(t)).then(a(y=>{const w=[];let S=!1;const N=qt(y,(E,R)=>{const{blobInfo:I,image:D}=b[R];let $=!1;return E.status&&m_(t)?(E.url&&!Pe(D.src,E.url)&&(S=!0),e.removeByUri(D.src),ds(t)||((W,B)=>{const P=t.convertURL(B,"src");var z;c(W.src,B),mt(F(W),{src:Vb(t)?(z=B,z+(z.indexOf("?")===-1?"?":"&")+new Date().getTime()):B,"data-mce-src":P})})(D,E.url)):E.error&&(E.error.remove&&(c(D.src,Kt.transparentSrc),w.push(D),$=!0),((W,B)=>{vu(W,Lr.translate(["Failed to upload image: {0}",B]))})(t,E.error.message)),{element:D,status:E.status,uploadUri:E.url,blobInfo:I,removed:$}});return w.length>0&&!ds(t)?t.undoManager.transact(()=>{J(ts(w),E=>{const R=pn(E);le(E),R.each((I=>D=>{(($,W)=>$.dom.isEmpty(W.dom)&&q($.schema.getTextBlockElements()[Gt(W)]))(I,D)&&Ie(D,As('<br data-mce-bogus="1" />'))})(t)),e.removeByUri(E.dom.src)})}):S&&t.undoManager.dispatchChange(),N}))}))),u=()=>jb(t)?d():Promise.resolve([]),m=b=>kn(s,p=>p(b)),h=()=>(o||(o=KR(r,e)),o.findAll(t.getBody(),m).then(a(b=>{const p=Ot(b,y=>vt(y)?(vu(t,y),!1):y.uriType!=="blob");return ds(t)||J(p,y=>{c(y.image.src,y.blobInfo.blobUri()),y.image.src=y.blobInfo.blobUri(),y.image.removeAttribute("data-mce-src")}),p}))),f=b=>b.replace(/src="(blob:[^"]+)"/g,(p,y)=>{const w=r.getResultUri(y);if(w)return'src="'+w+'"';let S=e.getByUri(y);return S||(S=en(t.editorManager.get(),(N,E)=>N||E.editorUpload&&E.editorUpload.blobCache.getByUri(y),void 0)),S?'src="data:'+S.blob().type+";base64,"+S.base64()+'"':p});return t.on("SetContent",()=>{jb(t)?u():h()}),t.on("RawSaveContent",b=>{b.content=f(b.content)}),t.on("GetContent",b=>{b.source_view||b.format==="raw"||b.format==="tree"||(b.content=f(b.content))}),t.on("PostRender",()=>{t.parser.addNodeFilter("img",b=>{J(b,p=>{const y=p.attr("src");if(!y||e.getByUri(y))return;const w=r.getResultUri(y);w&&p.attr("src",w)})})}),{blobCache:e,addFilter:b=>{s.push(b)},uploadImages:d,uploadImagesAuto:u,scanForImages:h,destroy:()=>{e.destroy(),r.destroy(),o=n=null}}},V1={remove_similar:!0,inherit:!1},tl={selector:"td,th",...V1},QR={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...tl},tablecellverticalalign:{styles:{"vertical-align":"%value"},...tl},tablecellbordercolor:{styles:{borderColor:"%value"},...tl},tablecellclass:{classes:["%value"],...tl},tableclass:{selector:"table",classes:["%value"],...V1},tablecellborderstyle:{styles:{borderStyle:"%value"},...tl},tablecellborderwidth:{styles:{borderWidth:"%value"},...tl}},ZR=it(QR),Cu=st.each,jo=ye.DOM,Vf=t=>q(t)&&Re(t),q1=(t,e)=>{const n=e&&e.schema||ua({}),o=a=>{const i=vt(a)?{name:a,classes:[],attrs:{}}:a,l=jo.create(i.name);return((c,d)=>{d.classes.length>0&&jo.addClass(c,d.classes.join(" ")),jo.setAttribs(c,d.attrs)})(l,i),l},r=(a,i,l)=>{let c;const d=i[0],u=Vf(d)?d.name:void 0,m=((b,p)=>{const y=n.getElementRule(b.nodeName.toLowerCase()),w=y?.parentsRequired;return!(!w||!w.length)&&(p&&Xt(w,p)?p:w[0])})(a,u);if(m)u===m?(c=d,i=i.slice(1)):c=m;else if(d)c=d,i=i.slice(1);else if(!l)return a;const h=c?o(c):jo.create("div");h.appendChild(a),l&&st.each(l,b=>{const p=o(b);h.insertBefore(p,a)});const f=Vf(c)?c.siblings:void 0;return r(h,i,f)},s=jo.create("div");if(t.length>0){const a=t[0],i=o(a),l=Vf(a)?a.siblings:void 0;s.appendChild(r(i,t.slice(1),l))}return s},JR=t=>{let e="div";const n={name:e,classes:[],attrs:{},selector:t=st.trim(t)};return t!=="*"&&(e=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(o,r,s,a,i)=>{switch(r){case"#":n.attrs.id=s;break;case".":n.classes.push(s);break;case":":st.inArray("checked disabled enabled read-only required".split(" "),s)!==-1&&(n.attrs[s]=s)}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=e||"div",n},tT=(t,e)=>{let n="",o=O_(t);if(o==="")return"";const r=h=>vt(h)?h.replace(/%(\w+)/g,""):"",s=(h,f)=>jo.getStyle(f??t.getBody(),h,!0);if(vt(e)){const h=t.formatter.get(e);if(!h)return"";e=h[0]}if("preview"in e){const h=e.preview;if(h===!1)return"";o=h||o}let a,i=e.block||e.inline||"span";const l=(c=e.selector,vt(c)?(c=(c=c.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),st.map(c.split(/(?:>|\s+(?![^\[\]]+\]))/),h=>{const f=st.map(h.split(/(?:~\+|~|\+)/),JR),b=f.pop();return f.length&&(b.siblings=f),b}).reverse()):[]);var c;l.length>0?(l[0].name||(l[0].name=i),i=e.selector,a=q1(l,t)):a=q1([i],t);const d=jo.select(i,a)[0]||a.firstChild;Cu(e.styles,(h,f)=>{const b=r(h);b&&jo.setStyle(d,f,b)}),Cu(e.attributes,(h,f)=>{const b=r(h);b&&jo.setAttrib(d,f,b)}),Cu(e.classes,h=>{const f=r(h);jo.hasClass(d,f)||jo.addClass(d,f)}),t.dispatch("PreviewFormats"),jo.setStyles(a,{position:"absolute",left:-65535}),t.getBody().appendChild(a);const u=s("fontSize"),m=/px$/.test(u)?parseInt(u,10):0;return Cu(o.split(" "),h=>{let f=s(h,d);if(!(h==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(f)&&(f=s(h),Fl(f).toLowerCase()==="#ffffff")||h==="color"&&Fl(f).toLowerCase()==="#000000")){if(h==="font-size"&&/em|%$/.test(f)){if(m===0)return;f=parseFloat(f)/(/%$/.test(f)?100:1)*m+"px"}h==="border"&&f&&(n+="padding:0 2px;"),n+=h+":"+f+";"}}),t.dispatch("AfterPreviewFormats"),jo.remove(a),n},W1=t=>{const e=(o=>{const r={},s=(a,i)=>{a&&(vt(a)?(Qt(i)||(i=[i]),J(i,l=>{tt(l.deep)&&(l.deep=!zo(l)),tt(l.split)&&(l.split=!zo(l)||Je(l)),tt(l.remove)&&zo(l)&&!Je(l)&&(l.remove="none"),zo(l)&&Je(l)&&(l.mixed=!0,l.block_expand=!0),vt(l.classes)&&(l.classes=l.classes.split(/\s+/))}),r[a]=i):re(a,(l,c)=>{s(c,l)}))};return s((a=>{const i=a.dom,l=a.schema.type,c={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"left"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:d=>{i.setStyle(d,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:".mce-placeholder",styles:{display:"block",marginLeft:"auto",marginRight:"auto"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"right"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:d=>{i.setStyle(d,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const d={inline:"span",styles:{textDecoration:"line-through"},exact:!0},u={inline:"strike",remove:"all",preserve_attributes:["class","style"]},m={inline:"s",remove:"all",preserve_attributes:["class","style"]};return l!=="html4"?[m,d,u]:[d,m,u]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},samp:{inline:"samp"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(d,u,m)=>wt(d)&&d.hasAttribute("href"),onformat:(d,u,m)=>{st.each(m,(h,f)=>{i.setAttrib(d,f,h)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":d=>{var u;return(u=d?.customValue)!==null&&u!==void 0?u:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return st.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd".split(/\s/),d=>{c[d]={block:d,remove:"all"}}),c})(o)),s(ZR()),s(T_(o)),{get:a=>q(a)?r[a]:r,has:a=>Bt(r,a),register:s,unregister:a=>(a&&r[a]&&delete r[a],r)}})(t),n=Ye({});return(o=>{o.addShortcut("meta+b","","Bold"),o.addShortcut("meta+i","","Italic"),o.addShortcut("meta+u","","Underline");for(let r=1;r<=6;r++)o.addShortcut("access+"+r,"",["FormatBlock",!1,"h"+r]);o.addShortcut("access+7","",["FormatBlock",!1,"p"]),o.addShortcut("access+8","",["FormatBlock",!1,"div"]),o.addShortcut("access+9","",["FormatBlock",!1,"address"])})(t),(o=>{o.on("mouseup keydown",r=>{var s;((a,i,l)=>{const c=a.selection,d=a.getBody();hf(a,null,l),i!==8&&i!==46||!c.isCollapsed()||c.getStart().innerHTML!==yc||hf(a,Za(d,c.getStart()),!0),i!==37&&i!==39||hf(a,Za(d,c.getStart()),!0)})(o,r.keyCode,(s=o.selection.getRng().endContainer,rt(s)&&Zn(s.data,ze)))})})(t),ds(t)||((o,r)=>{o.set({}),r.on("NodeChange",s=>{NC(r,s.element,o.get())}),r.on("FormatApply FormatRemove",s=>{const a=x.from(s.node).map(i=>lc(i)?i:i.startContainer).bind(i=>wt(i)?x.some(i):x.from(i.parentElement)).getOrThunk(()=>xC(r));NC(r,a,o.get())})})(n,t),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:(o,r,s)=>{((a,i,l,c)=>{Xe(a).formatter.apply(i,l,c)})(t,o,r,s)},remove:(o,r,s,a)=>{((i,l,c,d,u)=>{Xe(i).formatter.remove(l,c,d,u)})(t,o,r,s,a)},toggle:(o,r,s)=>{((a,i,l,c)=>{Xe(a).formatter.toggle(i,l,c)})(t,o,r,s)},match:(o,r,s,a)=>((i,l,c,d,u)=>Xe(i).formatter.match(l,c,d,u))(t,o,r,s,a),closest:o=>((r,s)=>Xe(r).formatter.closest(s))(t,o),matchAll:(o,r)=>((s,a,i)=>Xe(s).formatter.matchAll(a,i))(t,o,r),matchNode:(o,r,s,a)=>((i,l,c,d,u)=>Xe(i).formatter.matchNode(l,c,d,u))(t,o,r,s,a),canApply:o=>((r,s)=>Xe(r).formatter.canApply(s))(t,o),formatChanged:(o,r,s,a)=>((i,l,c,d,u,m)=>Xe(i).formatter.formatChanged(l,c,d,u,m))(t,n,o,r,s,a),getCssText:ft(tT,t)}},K1=t=>{switch(t.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},G1=t=>{const e=Or(),n=Ye(0),o=Ye(0),r={data:[],typing:!1,beforeChange:()=>{((s,a,i)=>{Xe(s).undoManager.beforeChange(a,i)})(t,n,e)},add:(s,a)=>((i,l,c,d,u,m,h)=>Xe(i).undoManager.add(l,c,d,u,m,h))(t,r,o,n,e,s,a),dispatchChange:()=>{t.setDirty(!0);const s=gu(t);s.bookmark=jm(t.selection),t.dispatch("change",{level:s,lastLevel:fo(r.data,o.get()).getOrUndefined()})},undo:()=>((s,a,i,l)=>Xe(s).undoManager.undo(a,i,l))(t,r,n,o),redo:()=>((s,a,i)=>Xe(s).undoManager.redo(a,i))(t,o,r.data),clear:()=>{((s,a,i)=>{Xe(s).undoManager.clear(a,i)})(t,r,o)},reset:()=>{((s,a)=>{Xe(s).undoManager.reset(a)})(t,r)},hasUndo:()=>((s,a,i)=>Xe(s).undoManager.hasUndo(a,i))(t,r,o),hasRedo:()=>((s,a,i)=>Xe(s).undoManager.hasRedo(a,i))(t,r,o),transact:s=>((a,i,l,c)=>Xe(a).undoManager.transact(i,l,c))(t,r,n,s),ignore:s=>{((a,i,l)=>{Xe(a).undoManager.ignore(i,l)})(t,n,s)},extra:(s,a)=>{((i,l,c,d,u)=>{Xe(i).undoManager.extra(l,c,d,u)})(t,r,o,s,a)}};return ds(t)||((s,a,i)=>{const l=Ye(!1),c=d=>{fu(a,!1,i),a.add({},d)};s.on("init",()=>{a.add()}),s.on("BeforeExecCommand",d=>{const u=d.command;K1(u)||(v1(a,i),a.beforeChange())}),s.on("ExecCommand",d=>{const u=d.command;K1(u)||c(d)}),s.on("ObjectResizeStart cut",()=>{a.beforeChange()}),s.on("SaveContent ObjectResized blur",c),s.on("dragend",c),s.on("keyup",d=>{const u=d.keyCode;if(d.isDefaultPrevented())return;const m=Kt.os.isMacOS()&&d.key==="Meta";(u>=33&&u<=36||u>=37&&u<=40||u===45||d.ctrlKey||m)&&(c(),s.nodeChanged()),u!==46&&u!==8||s.nodeChanged(),l.get()&&a.typing&&!Ff(gu(s),a.data[0])&&(s.isDirty()||s.setDirty(!0),s.dispatch("TypingUndo"),l.set(!1),s.nodeChanged())}),s.on("keydown",d=>{const u=d.keyCode;if(d.isDefaultPrevented())return;if(u>=33&&u<=36||u>=37&&u<=40||u===45)return void(a.typing&&c(d));const m=d.ctrlKey&&!d.altKey||d.metaKey;if((u<16||u>20)&&u!==224&&u!==91&&!a.typing&&!m)return a.beforeChange(),fu(a,!0,i),a.add({},d),void l.set(!0);(Kt.os.isMacOS()?d.metaKey:d.ctrlKey&&!d.altKey)&&a.beforeChange()}),s.on("mousedown",d=>{a.typing&&c(d)}),s.on("input",d=>{var u;d.inputType&&(d.inputType==="insertReplacementText"||(u=d).inputType==="insertText"&&u.data===null||(m=>m.inputType==="insertFromPaste"||m.inputType==="insertFromDrop")(d))&&c(d)}),s.on("AddUndo Undo Redo ClearUndos",d=>{d.isDefaultPrevented()||s.nodeChanged()})})(t,r,n),(s=>{s.addShortcut("meta+z","","Undo"),s.addShortcut("meta+y,meta+shift+z","","Redo")})(t),r},eT=[9,27,ht.HOME,ht.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,ht.DOWN,ht.UP,ht.LEFT,ht.RIGHT].concat(Kt.browser.isFirefox()?[224]:[]),Y1="data-mce-placeholder",X1=t=>t.type==="keydown"||t.type==="keyup",Q1=t=>{const e=t.keyCode;return e===ht.BACKSPACE||e===ht.DELETE},nT=(t,e)=>({from:t,to:e}),qf=(t,e)=>{const n=F(t),o=F(e.container());return nu(n,o).map(r=>((s,a)=>({block:s,position:a}))(r,e))},Z1=(t,e)=>Zr(e,n=>Gl(n)||ro(n.dom),n=>ne(n,t)).filter(on).getOr(t),J1=(t,e)=>{const n=((o,r)=>{const s=rn(o);return oe(s,a=>r.isBlock(Gt(a))).fold(it(s),a=>s.slice(0,a))})(t,e);return J(n,le),n},tw=(t,e,n)=>{const o=$s(n,e);return Te(o.reverse(),r=>sn(t,r)).each(le)},oT=(t,e,n,o,r)=>{if(sn(o,n))return ma(n),An(n.dom);((a,i)=>Ot(Xc(i),l=>!sn(a,l)).length===0)(o,r)&&sn(o,e)&&hn(r,xe("br"));const s=so(n.dom,X.before(r.dom));return J(J1(e,o),a=>{hn(r,a)}),tw(o,t,e),s},rT=(t,e,n,o)=>{if(sn(o,n)){if(sn(o,e)){const s=i=>{const l=(c,d)=>fl(c).fold(()=>d,u=>((m,h)=>m.isInline(Gt(h)))(o,u)?l(u,d.concat(qa(u))):d);return l(i,[])},a=yr(s(n),(i,l)=>(nd(i,l),l),Pi());la(e),Ie(e,a)}return le(n),An(e.dom)}const r=gr(n.dom);return J(J1(e,o),s=>{Ie(n,s)}),tw(o,t,e),r},ew=(t,e)=>{ji(t,e.dom).bind(n=>x.from(n.getNode())).map(F).filter(Ka).each(le)},nw=(t,e,n,o)=>(ew(!0,e),ew(!1,n),((r,s)=>Pn(s,r)?((a,i)=>{const l=$s(i,a);return x.from(l[l.length-1])})(s,r):x.none())(e,n).fold(ft(rT,t,e,n,o),ft(oT,t,e,n,o))),ow=(t,e,n,o,r)=>e?nw(t,o,n,r):nw(t,n,o,r),Wf=(t,e)=>{const n=F(t.getBody());return((r,s,a,i)=>i.collapsed?((l,c,d,u)=>{const m=qf(c,X.fromRangeStart(u)),h=m.bind(f=>Mo(d,c,f.position).bind(b=>qf(c,b).map(p=>((y,w,S,N)=>Ee(N.position.getNode())&&!sn(y,N.block)?ji(!1,N.block.dom).bind(E=>E.isEqual(N.position)?Mo(S,w,E).bind(R=>qf(w,R)):x.some(N)).getOr(N):N)(l,c,d,p))));return ke(m,h,nT).filter(f=>(b=>!ne(b.from.block,b.to.block))(f)&&((b,p)=>{const y=F(b);return ne(Z1(y,p.from.block),Z1(y,p.to.block))})(c,f)&&(b=>me(b.from.block.dom)===!1&&me(b.to.block.dom)===!1)(f)&&(b=>{const p=y=>Jh(y)||Mt(y.dom)||Di(y);return p(b.from.block)&&p(b.to.block)})(f)&&(b=>!(Pn(b.to.block,b.from.block)||Pn(b.from.block,b.to.block)))(f))})(r,s,a,i):x.none())(t.schema,n.dom,e,t.selection.getRng()).map(r=>()=>{ow(n,e,r.from.block,r.to.block,t.schema).each(s=>{t.selection.setRng(s.toRange())})})},rw=(t,e)=>{const n=F(e),o=ft(ne,t);return Tr(n,Gl,o).isSome()},sT=t=>{const e=F(t.getBody());return((n,o)=>{const r=so(n.dom,X.fromRangeStart(o)).isNone(),s=Wn(n.dom,X.fromRangeEnd(o)).isNone();return!((a,i)=>rw(a,i.startContainer)||rw(a,i.endContainer))(n,o)&&r&&s})(e,t.selection.getRng())?(n=>x.some(()=>{n.setContent(""),n.selection.setCursorLocation()}))(t):((n,o,r)=>{const s=o.getRng();return ke(nu(n,F(s.startContainer)),nu(n,F(s.endContainer)),(a,i)=>ne(a,i)?x.none():x.some(()=>{s.deleteContents(),ow(n,!0,a,i,r).each(l=>{o.setRng(l.toRange())})})).getOr(x.none())})(e,t.selection,t.schema)},Kf=(t,e)=>t.selection.isCollapsed()?x.none():sT(t),js=(t,e,n,o,r)=>x.from(e._selectionOverrides.showCaret(t,n,o,r)),Ac=(t,e)=>t.dispatch("BeforeObjectSelected",{target:e}).isDefaultPrevented()?x.none():x.some((n=>{const o=n.ownerDocument.createRange();return o.selectNode(n),o})(e)),Gf=(t,e,n)=>e.collapsed?((o,r,s)=>{const a=Jm(1,o.getBody(),r),i=X.fromRangeStart(a),l=i.getNode();if(ec(l))return js(1,o,l,!i.isAtEnd(),!1);const c=i.getNode(!0);if(ec(c))return js(1,o,c,!1,!1);const d=si(o.dom.getRoot(),i.getNode());return ec(d)?js(1,o,d,!1,s):x.none()})(t,e,n).getOr(e):e,aT=t=>Ca(t)||gc(t),iT=t=>wa(t)||fc(t),sw=(t,e,n,o,r,s)=>{js(o,t,s.getNode(!r),r,!0).each(a=>{if(e.collapsed){const i=e.cloneRange();r?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else e.deleteContents();t.selection.setRng(a)}),((a,i)=>{rt(i)&&i.data.length===0&&a.remove(i)})(t.dom,n)},Yf=(t,e)=>((n,o)=>{const r=n.selection.getRng();if(!rt(r.commonAncestorContainer))return x.none();const s=o?1:-1,a=is(n.getBody()),i=ft(tg,o?a.next:a.prev),l=o?aT:iT,c=ac(s,n.getBody(),r),d=i(c),u=d&&Ho(o,d);if(!u||!Dd(c,u))return x.none();if(l(u))return x.some(()=>sw(n,r,c.getNode(),s,o,u));const m=i(u);return m&&l(m)&&Dd(u,m)?x.some(()=>sw(n,r,c.getNode(),s,o,m)):x.none()})(t,e),Xf=(t,e)=>{const n=t.getBody();return e?An(n).filter(Ca):gr(n).filter(wa)},Qf=t=>{const e=t.selection.getRng();return!e.collapsed&&(Xf(t,!0).exists(n=>n.isEqual(X.fromRangeStart(e)))||Xf(t,!1).exists(n=>n.isEqual(X.fromRangeEnd(e))))},Vo=rs([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),aw=(t,e,n,o)=>Mo(e,t,n).bind(r=>{return s=r.getNode(),q(s)&&(Gl(F(s))||Di(F(s)))||((a,i,l,c,d)=>{const u=m=>d.isInline(m.nodeName.toLowerCase())&&!ss(l,c,a);return bv(!i,l).fold(()=>bv(i,c).fold(te,u),u)})(t,e,n,r,o)?x.none():e&&me(r.getNode())||!e&&me(r.getNode(!0))?((a,i,l,c,d)=>{const u=d.getNode(!l);return nu(F(i),F(c.getNode())).map(m=>sn(a,m)?Vo.remove(m.dom):Vo.moveToElement(u)).orThunk(()=>x.some(Vo.moveToElement(u)))})(o,t,e,n,r):e&&wa(n)||!e&&Ca(n)?x.some(Vo.moveToPosition(r)):x.none();var s}),iw=(t,e)=>x.from(si(t.getBody(),e)),lT=(t,e)=>{const n=t.selection.getNode();return iw(t,n).filter(me).fold(()=>((o,r,s,a)=>{const i=Jm(r?1:-1,o,s),l=X.fromRangeStart(i),c=F(o);return!r&&wa(l)?x.some(Vo.remove(l.getNode(!0))):r&&Ca(l)?x.some(Vo.remove(l.getNode())):!r&&Ca(l)&&Jd(c,l,a)?ey(c,l,a).map(d=>Vo.remove(d.getNode())):r&&wa(l)&&zg(c,l,a)?xA(c,l,a).map(d=>Vo.remove(d.getNode())):((d,u,m,h)=>((f,b)=>{const p=b.getNode(!f),y=f?"after":"before";return wt(p)&&p.getAttribute("data-mce-caret")===y})(u,m)?((f,b)=>Ht(b)?x.none():f&&me(b.nextSibling)?x.some(Vo.moveToElement(b.nextSibling)):!f&&me(b.previousSibling)?x.some(Vo.moveToElement(b.previousSibling)):x.none())(u,m.getNode(!u)).orThunk(()=>aw(d,u,m,h)):aw(d,u,m,h).bind(f=>((b,p,y)=>y.fold(w=>x.some(Vo.remove(w)),w=>x.some(Vo.moveToElement(w)),w=>ss(p,w,b)?x.none():x.some(Vo.moveToPosition(w))))(d,m,f)))(o,r,l,a)})(t.getBody(),e,t.selection.getRng(),t.schema).map(o=>()=>o.fold(((r,s)=>a=>(r._selectionOverrides.hideFakeCaret(),oi(r,s,F(a)),!0))(t,e),((r,s)=>a=>{const i=s?X.before(a):X.after(a);return r.selection.setRng(i.toRange()),!0})(t,e),(r=>s=>(r.selection.setRng(s.toRange()),!0))(t))),()=>x.some(Dt))},lw=t=>{const e=t.dom,n=t.selection,o=si(t.getBody(),n.getNode());if(ro(o)&&e.isBlock(o)&&e.isEmpty(o)){const r=e.create("br",{"data-mce-bogus":"1"});e.setHTML(o,""),o.appendChild(r),n.setRng(X.before(r).toRange())}return!0},Zf=(t,e)=>t.selection.isCollapsed()?lT(t,e):((n,o)=>{const r=n.selection.getNode();return me(r)&&!Ri(r)?iw(n,r.parentNode).filter(me).fold(()=>x.some(()=>{var s;s=F(n.getBody()),J(dn(s,".mce-offscreen-selection"),le),oi(n,o,F(n.selection.getNode())),qg(n)}),()=>x.some(Dt)):Qf(n)?x.some(()=>{ky(n,n.selection.getRng(),F(n.getBody()))}):x.none()})(t,e),cw=t=>t.hasOwnProperty("text"),dw=t=>t.hasOwnProperty("marker"),uw=(t,e)=>{const n=(r,s)=>{if(rt(r))return{text:r,offset:s};{const a=e(),i=r.childNodes;return s<i.length?(r.insertBefore(a,i[s]),{marker:a,before:!0}):(r.appendChild(a),{marker:a,before:!1})}},o=n(t.endContainer,t.endOffset);return{start:n(t.startContainer,t.startOffset),end:o}},mw=t=>{var e,n;const{start:o,end:r}=t,s=new window.Range;return cw(o)?s.setStart(o.text,o.offset):dw(o)&&(o.before?s.setStartBefore(o.marker):s.setStartAfter(o.marker),(e=o.marker.parentNode)===null||e===void 0||e.removeChild(o.marker)),cw(r)?s.setEnd(r.text,r.offset):dw(r)&&(r.before?s.setEndBefore(r.marker):s.setEndAfter(r.marker),(n=r.marker.parentNode)===null||n===void 0||n.removeChild(r.marker)),s},Jf=(t,e)=>{var n;const o=t.dom,r=o.getParent(t.selection.getStart(),o.isBlock),s=o.getParent(t.selection.getEnd(),o.isBlock),a=t.getBody();if(((n=r?.nodeName)===null||n===void 0?void 0:n.toLowerCase())==="div"&&r&&s&&r===a.firstChild&&s===a.lastChild&&!o.isEmpty(a)){const i=r.cloneNode(!1),l=()=>{if(e?Cy(t):eu(t),a.firstChild!==r){const c=uw(t.selection.getRng(),()=>document.createElement("span"));Array.from(a.childNodes).forEach(d=>i.appendChild(d)),a.appendChild(i),t.selection.setRng(mw(c))}};return x.some(l)}return x.none()},tp=(t,e)=>t.selection.isCollapsed()?((n,o)=>{const r=X.fromRangeStart(n.selection.getRng());return Mo(o,n.getBody(),r).filter(s=>o?yA(s):CA(s)).bind(s=>Zm(o?0:-1,s)).map(s=>()=>n.selection.select(s))})(t,e):x.none(),el=rt,gw=t=>el(t)&&t.data[0]===an,fw=t=>el(t)&&t.data[t.data.length-1]===an,pw=t=>{var e;return((e=t.ownerDocument)!==null&&e!==void 0?e:document).createTextNode(an)},wu=(t,e)=>t?(n=>{var o;if(el(n.previousSibling))return fw(n.previousSibling)||n.previousSibling.appendData(an),n.previousSibling;if(el(n))return gw(n)||n.insertData(0,an),n;{const r=pw(n);return(o=n.parentNode)===null||o===void 0||o.insertBefore(r,n),r}})(e):(n=>{var o,r;if(el(n.nextSibling))return gw(n.nextSibling)||n.nextSibling.insertData(0,an),n.nextSibling;if(el(n))return fw(n)||n.appendData(an),n;{const s=pw(n);return n.nextSibling?(o=n.parentNode)===null||o===void 0||o.insertBefore(s,n.nextSibling):(r=n.parentNode)===null||r===void 0||r.appendChild(s),s}})(e),cT=ft(wu,!0),dT=ft(wu,!1),hw=(t,e)=>rt(t.container())?wu(e,t.container()):wu(e,t.getNode()),bw=(t,e)=>{const n=e.get();return n&&t.container()===n&&ga(n)},ep=(t,e)=>e.fold(n=>{Xa(t.get());const o=cT(n);return t.set(o),x.some(X(o,o.length-1))},n=>An(n).map(o=>{if(bw(o,t)){const r=t.get();return X(r,1)}{Xa(t.get());const r=hw(o,!0);return t.set(r),X(r,1)}}),n=>gr(n).map(o=>{if(bw(o,t)){const r=t.get();return X(r,r.length-1)}{Xa(t.get());const r=hw(o,!1);return t.set(r),X(r,r.length-1)}}),n=>{Xa(t.get());const o=dT(n);return t.set(o),x.some(X(o,1))}),vw=(t,e)=>{for(let n=0;n<t.length;n++){const o=t[n].apply(null,e);if(o.isSome())return o}return x.none()},Un=rs([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),yw=(t,e)=>ha(e,t)||t,uT=(t,e,n)=>{const o=by(n),r=yw(e,o.container());return Sa(t,r,o).fold(()=>Wn(r,o).bind(ft(Sa,t,r)).map(s=>Un.before(s)),x.none)},mT=(t,e)=>Za(t,e)===null,Cw=(t,e,n)=>Sa(t,e,n).filter(ft(mT,e)),gT=(t,e,n)=>{const o=vy(n);return Cw(t,e,o).bind(r=>so(r,o).isNone()?x.some(Un.start(r)):x.none())},fT=(t,e,n)=>{const o=by(n);return Cw(t,e,o).bind(r=>Wn(r,o).isNone()?x.some(Un.end(r)):x.none())},pT=(t,e,n)=>{const o=vy(n),r=yw(e,o.container());return Sa(t,r,o).fold(()=>so(r,o).bind(ft(Sa,t,r)).map(s=>Un.after(s)),x.none)},ww=t=>!hy(np(t)),us=(t,e,n)=>vw([uT,gT,fT,pT],[t,e,n]).filter(ww),np=t=>t.fold(Zt,Zt,Zt,Zt),Sw=t=>t.fold(it("before"),it("start"),it("end"),it("after")),Su=t=>t.fold(Un.before,Un.before,Un.after,Un.after),op=t=>t.fold(Un.start,Un.start,Un.end,Un.end),hT=(t,e,n,o,r,s)=>ke(Sa(e,n,o),Sa(e,n,r),(a,i)=>a!==i&&((l,c,d)=>{const u=ha(c,l),m=ha(d,l);return q(u)&&u===m})(n,a,i)?Un.after(t?a:i):s).getOr(s),bT=(t,e)=>t.fold(ae,n=>{return r=e,!(Sw(o=n)===Sw(r)&&np(o)===np(r));var o,r}),vT=(t,e)=>t?e.fold(qe(x.some,Un.start),x.none,qe(x.some,Un.after),x.none):e.fold(x.none,qe(x.some,Un.before),x.none,qe(x.some,Un.end)),kw=(t,e,n)=>{const o=t?1:-1;return e.setRng(X(n.container(),n.offset()+o).toRange()),e.getSel().modify("move",t?"forward":"backward","word"),!0};var ms;(function(t){t[t.Br=0]="Br",t[t.Block=1]="Block",t[t.Wrap=2]="Wrap",t[t.Eol=3]="Eol"})(ms||(ms={}));const ku=(t,e)=>t===-1?No(e):e,yT=(t,e,n)=>t===1?e.next(n):e.prev(n),CT=(t,e,n,o)=>Ee(o.getNode(e===1))?ms.Br:ss(n,o)===!1?ms.Block:ms.Wrap,xw=(t,e,n,o)=>{const r=is(n);let s=o;const a=[];for(;s;){const i=yT(e,r,s);if(!i)break;if(Ee(i.getNode(!1)))return e===1?{positions:ku(e,a).concat([i]),breakType:ms.Br,breakAt:x.some(i)}:{positions:ku(e,a),breakType:ms.Br,breakAt:x.some(i)};if(i.isVisible()){if(t(s,i)){const l=CT(0,e,s,i);return{positions:ku(e,a),breakType:l,breakAt:x.some(i)}}a.push(i),s=i}else s=i}return{positions:ku(e,a),breakType:ms.Eol,breakAt:x.none()}},Ew=(t,e,n,o)=>e(n,o).breakAt.map(r=>{const s=e(n,r).positions;return t===-1?s.concat(r):[r].concat(s)}).getOr([]),rp=(t,e)=>en(t,(n,o)=>n.fold(()=>x.some(o),r=>ke(We(r.getClientRects()),We(o.getClientRects()),(s,a)=>{const i=Math.abs(e-s.left);return Math.abs(e-a.left)<=i?o:r}).or(n)),x.none()),xu=(t,e)=>We(e.getClientRects()).bind(n=>rp(t,n.left)),Rc=ft(xw,X.isAbove,-1),Tc=ft(xw,X.isBelow,1),_w=ft(Ew,-1,Rc),Nw=ft(Ew,1,Tc),Aw=(t,e)=>Rc(t,e).breakAt.isNone(),Rw=(t,e)=>Tc(t,e).breakAt.isNone(),wT=(t,e)=>xu(_w(t,e),e),ST=(t,e)=>xu(Nw(t,e),e),kT=me,Tw=(t,e)=>Math.abs(t.left-e),Ow=(t,e)=>Math.abs(t.right-e),Bw=(t,e)=>nr(t,(n,o)=>{const r=Math.min(Tw(n,e),Ow(n,e)),s=Math.min(Tw(o,e),Ow(o,e));return s===r&&Ro(o,"node")&&kT(o.node)||s<r?o:n}),xT=t=>{const e=n=>qt(n,o=>{const r=Ga(o);return r.node=t,r});if(wt(t))return e(t.getClientRects());if(rt(t)){const n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())}return[]},Lw=t=>Qe(t,xT);var di;(function(t){t[t.Up=-1]="Up",t[t.Down=1]="Down"})(di||(di={}));const Dw=(t,e,n,o,r,s)=>{let a=0;const i=[],l=u=>{let m=Lw([u]);t===di.Up&&(m=m.reverse());for(let h=0;h<m.length;h++){const f=m[h];if(!n(f,c)){if(i.length>0&&e(f,Vn(i))&&a++,f.line=a,r(f))return!0;i.push(f)}}return!1},c=Vn(s.getClientRects());if(!c)return i;const d=s.getNode();return d&&(l(d),((u,m,h,f)=>{let b=f;for(;b=oc(b,u,lb,m);)if(h(b))return})(t,o,l,d)),i},ET=ft(Dw,di.Up,Yl,Xl),_T=ft(Dw,di.Down,Xl,Yl),Pw=t=>Vn(t.getClientRects()),Iw=t=>e=>((n,o)=>o.line>n)(t,e),sp=t=>e=>((n,o)=>o.line===n)(t,e),Vs=(t,e)=>{t.selection.setRng(e),mc(t,t.selection.getRng())},ap=(t,e,n)=>x.some(Gf(t,e,n)),Mw=(t,e,n,o,r,s)=>{const a=e===1,i=is(t.getBody()),l=ft(tg,a?i.next:i.prev),c=a?o:r;if(!n.collapsed){const f=xd(n);if(s(f))return js(e,t,f,e===-1,!1);if(Qf(t)){const b=n.cloneRange();return b.collapse(e===-1),x.from(b)}}const d=ac(e,t.getBody(),n);if(c(d))return Ac(t,d.getNode(!a));let u=l(d);const m=eb(n);if(!u)return m?x.some(n):x.none();if(u=Ho(a,u),c(u))return js(e,t,u.getNode(!a),a,!1);const h=l(u);return h&&c(h)&&Dd(u,h)?js(e,t,h.getNode(!a),a,!1):m?ap(t,u.toRange(),!1):x.none()},Fw=(t,e,n,o,r,s)=>{const a=ac(e,t.getBody(),n),i=Vn(a.getClientRects()),l=e===di.Down,c=t.getBody();if(!i)return x.none();if(Qf(t)){const b=l?X.fromRangeEnd(n):X.fromRangeStart(n);return(l?ST:wT)(c,b).orThunk(()=>x.from(b)).map(p=>p.toRange())}const d=(l?_T:ET)(c,Iw(1),a),u=Ot(d,sp(1)),m=i.left,h=Bw(u,m);if(h&&s(h.node)){const b=Math.abs(m-h.left),p=Math.abs(m-h.right);return js(e,t,h.node,b<p,!1)}let f;if(f=o(a)?a.getNode():r(a)?a.getNode(!0):xd(n),f){const b=((y,w,S,N)=>{const E=is(w);let R,I,D,$;const W=[];let B=0;y===di.Down?(R=E.next,I=Xl,D=Yl,$=X.after(N)):(R=E.prev,I=Yl,D=Xl,$=X.before(N));const P=Pw($);do{if(!$.isVisible())continue;const z=Pw($);if(D(z,P))continue;W.length>0&&I(z,Vn(W))&&B++;const Q=Ga(z);if(Q.position=$,Q.line=B,S(Q))return W;W.push(Q)}while($=R($));return W})(e,c,Iw(1),f);let p=Bw(Ot(b,sp(1)),m);if(p||(p=Vn(Ot(b,sp(0))),p))return ap(t,p.position.toRange(),!1)}return u.length===0?ip(t,l).filter(l?r:o).map(b=>Gf(t,b.toRange(),!1)):x.none()},ip=(t,e)=>{const n=t.selection.getRng(),o=e?X.fromRangeEnd(n):X.fromRangeStart(n),r=(s=o.container(),a=t.getBody(),Tr(F(s),i=>AN(i.dom),i=>i.dom===a).map(i=>i.dom).getOr(a));var s,a;if(e){const i=Tc(r,o);return Bn(i.positions)}{const i=Rc(r,o);return We(i.positions)}},Uw=(t,e,n)=>ip(t,e).filter(n).exists(o=>(t.selection.setRng(o.toRange()),!0)),Eu=(t,e)=>{const n=t.dom.createRng();n.setStart(e.container(),e.offset()),n.setEnd(e.container(),e.offset()),t.selection.setRng(n)},zw=(t,e)=>{t?e.setAttribute("data-mce-selected","inline-boundary"):e.removeAttribute("data-mce-selected")},$w=(t,e,n)=>ep(e,n).map(o=>(Eu(t,o),n)),NT=(t,e,n)=>{const o=t.getBody(),r=((s,a,i)=>{const l=X.fromRangeStart(s);if(s.collapsed)return l;{const c=X.fromRangeEnd(s);return i?so(a,c).getOr(c):Wn(a,l).getOr(l)}})(t.selection.getRng(),o,n);return((s,a,i,l)=>{const c=Ho(s,l),d=us(a,i,c);return us(a,i,c).bind(ft(vT,s)).orThunk(()=>((u,m,h,f,b)=>{const p=Ho(u,b);return Mo(u,h,p).map(ft(Ho,u)).fold(()=>f.map(Su),y=>us(m,h,y).map(ft(hT,u,m,h,p,y)).filter(ft(bT,f))).filter(ww)})(s,a,i,d,l))})(n,ft(ri,t),o,r).bind(s=>$w(t,e,s))},Hw=(t,e,n)=>!!tc(t)&&NT(t,e,n).isSome(),jw=(t,e,n)=>!!tc(e)&&((o,r)=>{const s=r.selection.getRng(),a=o?X.fromRangeEnd(s):X.fromRangeStart(s);return!!(i=>jt(i.selection.getSel().modify))(r)&&(o&&Bm(a)?kw(!0,r.selection,a):!(o||!Lm(a))&&kw(!1,r.selection,a))})(t,e),AT=t=>{const e=Ye(null),n=ft(ri,t);return t.on("NodeChange",o=>{tc(t)&&(((r,s,a)=>{const i=qt(dn(F(s.getRoot()),'*[data-mce-selected="inline-boundary"]'),d=>d.dom),l=Ot(i,r),c=Ot(a,r);J(Qo(l,c),ft(zw,!1)),J(Qo(c,l),ft(zw,!0))})(n,t.dom,o.parents),((r,s)=>{const a=s.get();if(r.selection.isCollapsed()&&!r.composing&&a){const i=X.fromRangeStart(r.selection.getRng());X.isTextPosition(i)&&!(l=>Bm(l)||Lm(l))(i)&&(Eu(r,kN(a,i)),s.set(null))}})(t,e),((r,s,a,i)=>{if(s.selection.isCollapsed()){const l=Ot(i,r);J(l,c=>{const d=X.fromRangeStart(s.selection.getRng());us(r,s.getBody(),d).bind(u=>$w(s,a,u))})}})(n,t,e,o.parents))}),e},RT=ft(jw,!0),TT=ft(jw,!1),_u=(t,e,n)=>{if(tc(t)){const o=ip(t,e).getOrThunk(()=>{const r=t.selection.getRng();return e?X.fromRangeEnd(r):X.fromRangeStart(r)});return us(ft(ri,t),t.getBody(),o).exists(r=>{const s=Su(r);return ep(n,s).exists(a=>(Eu(t,a),!0))})}return!1},Vw=(t,e)=>n=>ep(e,n).map(o=>()=>Eu(t,o)),qw=(t,e,n,o)=>{const r=t.getBody(),s=ft(ri,t);t.undoManager.ignore(()=>{t.selection.setRng(((a,i)=>{const l=document.createRange();return l.setStart(a.container(),a.offset()),l.setEnd(i.container(),i.offset()),l})(n,o)),eu(t),us(s,r,X.fromRangeStart(t.selection.getRng())).map(op).bind(Vw(t,e)).each(Gn)}),t.nodeChanged()},lp=(t,e,n)=>{if(t.selection.isCollapsed()&&tc(t)){const o=X.fromRangeStart(t.selection.getRng());return((r,s,a,i)=>{const l=((u,m)=>ha(m,u)||u)(r.getBody(),i.container()),c=ft(ri,r),d=us(c,l,i);return d.bind(u=>a?u.fold(it(x.some(op(u))),x.none,it(x.some(Su(u))),x.none):u.fold(x.none,it(x.some(Su(u))),x.none,it(x.some(op(u))))).map(Vw(r,s)).getOrThunk(()=>{const u=Hi(a,l,i),m=u.bind(h=>us(c,l,h));return ke(d,m,()=>Sa(c,l,i).bind(h=>(f=>ke(An(f),gr(f),(b,p)=>{const y=Ho(!0,b),w=Ho(!1,p);return Wn(f,y).forall(S=>S.isEqual(w))}).getOr(!0))(h)?x.some(()=>{oi(r,a,F(h))}):x.none())).getOrThunk(()=>m.bind(()=>u.map(h=>()=>{a?qw(r,s,i,h):qw(r,s,h,i)})))})})(t,e,n,o)}return x.none()},Ww=(t,e)=>{const n=F(t.getBody()),o=F(t.selection.getStart()),r=$s(o,n);return oe(r,e).fold(it(r),s=>r.slice(0,s))},OT=t=>hl(t)===1,Kw=(t,e)=>{const n=ft(Qy,t);return Qe(e,o=>n(o)?[o.dom]:[])},Gw=t=>{const e=(n=>Ww(n,o=>n.schema.isBlock(Gt(o))))(t);return Kw(t,e)},BT=(t,e)=>{const n=Ot((o=>Ww(o,r=>o.schema.isBlock(Gt(r))||(s=>hl(s)>1)(r)))(t),OT);return Bn(n).bind(o=>{const r=X.fromRangeStart(t.selection.getRng());return wy(e,r,o.dom)&&!vg(o)?x.some(()=>((s,a,i,l)=>{const c=Kw(a,l);if(c.length===0)oi(a,s,i);else{const d=Xy(i.dom,c);a.selection.setRng(d.toRange())}})(e,t,o,n)):x.none()})},Yw=(t,e)=>{const n=t.selection.getStart(),o=((r,s)=>{const a=s.parentElement;return Ee(s)&&!Le(a)&&r.dom.isEmpty(a)})(t,n)||vg(F(n))?Xy(n,e):((r,s)=>{const{caretContainer:a,caretPosition:i}=Yy(s);return r.insertNode(a.dom),i})(t.selection.getRng(),e);t.selection.setRng(o.toRange())},Xw=t=>rt(t.startContainer),LT=t=>{const e=t.selection.getRng();return(n=>n.startOffset===0&&Xw(n))(e)&&((n,o)=>{const r=o.startContainer.parentElement;return!Le(r)&&Qy(n,F(r))})(t,e)&&(n=>(o=>(r=>{const s=r.startContainer.parentNode,a=r.endContainer.parentNode;return!Le(s)&&!Le(a)&&s.isEqualNode(a)})(o)&&(r=>{const s=r.endContainer;return r.endOffset===(rt(s)?s.length:s.childNodes.length)})(o))(n)||(o=>!o.endContainer.isEqualNode(o.commonAncestorContainer))(n))(e)},cp=(t,e)=>t.selection.isCollapsed()?BT(t,e):(n=>{if(LT(n)){const o=Gw(n);return x.some(()=>{eu(n),((r,s)=>{const a=Qo(s,Gw(r));a.length>0&&Yw(r,a)})(n,o)})}return x.none()})(t),Oc=t=>((e=>{const n=e.selection.getRng();return n.collapsed&&(Xw(n)||e.dom.isEmpty(n.startContainer))&&!(o=>{return r=F(o.selection.getStart()),s=o.schema,xl(r,a=>Fo(a.dom),a=>s.isBlock(Gt(a)));var r,s})(e)})(t)&&Yw(t,[]),!0),dp=(t,e,n)=>q(n)?x.some(()=>{t._selectionOverrides.hideFakeCaret(),oi(t,e,F(n))}):x.none(),up=(t,e)=>t.selection.isCollapsed()?((n,o)=>{const r=o?gc:fc,s=ac(o?1:-1,n.getBody(),n.selection.getRng());return r(s)?dp(n,o,s.getNode(!o)):x.from(Ho(o,s)).filter(a=>r(a)&&Dd(s,a)).bind(a=>dp(n,o,a.getNode(!o)))})(t,e):((n,o)=>{const r=n.selection.getNode();return ur(r)?dp(n,o,r):x.none()})(t,e),mp=t=>Oo(t??"").getOr(0),Qw=(t,e)=>(t||Gt(e)==="table"?"margin":"padding")+(lr(e,"direction")==="rtl"?"-right":"-left"),Zw=t=>{const e=tS(t);return!t.mode.isReadOnly()&&(e.length>1||((n,o)=>kn(o,r=>{const s=Qw(Kb(n),r),a=Ei(r,s).map(mp).getOr(0);return n.dom.getContentEditable(r.dom)!=="false"&&a>0}))(t,e))},Jw=t=>Om(t)||Di(t),tS=t=>Ot(ts(t.selection.getSelectedBlocks()),e=>!Jw(e)&&!(n=>pn(n).exists(Jw))(e)&&Zr(e,n=>ro(n.dom)||me(n.dom)).exists(n=>ro(n.dom))),eS=(t,e)=>{var n,o;if(t.mode.isReadOnly())return;const{dom:r}=t,s=C_(t),a=(o=(n=/[a-z%]+$/i.exec(s))===null||n===void 0?void 0:n[0])!==null&&o!==void 0?o:"px",i=mp(s),l=Kb(t);J(tS(t),c=>{((d,u,m,h,f,b)=>{const p=Qw(m,F(b)),y=mp(d.getStyle(b,p));if(u==="outdent"){const w=Math.max(0,y-h);d.setStyle(b,p,w?w+f:"")}else{const w=y+h+f;d.setStyle(b,p,w)}})(r,e,l,i,a,c.dom)})},nS=t=>eS(t,"outdent"),oS=t=>{if(t.selection.isCollapsed()&&Zw(t)){const e=t.dom,n=t.selection.getRng(),o=X.fromRangeStart(n),r=e.getParent(n.startContainer,e.isBlock);if(r!==null&&Ug(F(r),o,t.schema))return x.some(()=>nS(t))}return x.none()},rS=(t,e,n)=>Xn([oS,Zf,Yf,(o,r)=>lp(o,e,r),Wf,Jg,tp,up,Kf,cp,Jf],o=>o(t,n)).filter(o=>t.selection.isEditable()),sS=t=>t.touches===void 0||t.touches.length!==1?x.none():x.some(t.touches[0]),gp=(t,e)=>Bt(t,e.nodeName),DT=(t,e)=>!!rt(e)||!!wt(e)&&!(gp(t.getBlockElements(),e)||Uo(e)||_e(t,e)||Il(e)),PT=(t,e)=>{if(rt(e)){if(e.data.length===0)return!0;if(/^\s+$/.test(e.data))return!e.nextSibling||gp(t,e.nextSibling)||Il(e.nextSibling)}return!1},fp=t=>t.dom.create(Nn(t),Jl(t)),aS=(t,e,n)=>{const o=F(fp(t)),r=Pi();Ie(o,r),n(e,o);const s=document.createRange();return s.setStartBefore(r.dom),s.setEndBefore(r.dom),s},iS=t=>e=>(" "+e.attr("class")+" ").indexOf(t)!==-1,IT=(t,e,n)=>function(o){const r=arguments,s=r[r.length-2],a=s>0?e.charAt(s-1):"";if(a==='"')return o;if(a===">"){const i=e.lastIndexOf("<",s);if(i!==-1&&e.substring(i,s).indexOf('contenteditable="false"')!==-1)return o}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(r[0])+'">'+t.dom.encode(typeof r[1]=="string"?r[1]:r[0])+"</span>"},MT=(t,e)=>kn(t,n=>{const o=e.match(n);return o!==null&&o[0].length===e.length}),lS=(t,e)=>{e.hasAttribute("data-mce-caret")&&(Dm(e),t.selection.setRng(t.selection.getRng()),t.selection.scrollIntoView(e))},FT=(t,e)=>{const n=(o=>wi(F(o.getBody()),"*[data-mce-caret]").map(r=>r.dom).getOrNull())(t);if(n)return e.type==="compositionstart"?(e.preventDefault(),e.stopPropagation(),void lS(t,n)):void(tb(n)&&(lS(t,n),t.undoManager.add()))},cS=me,dS=(t,e,n)=>{const o=is(t.getBody()),r=ft(tg,e===1?o.next:o.prev);if(n.collapsed){const s=t.dom.getParent(n.startContainer,"PRE");if(!s)return;if(!r(X.fromRangeStart(n))){const a=F((i=>{const l=i.dom.create(Nn(i));return l.innerHTML='<br data-mce-bogus="1">',l})(t));e===1?Co(F(s),a):hn(F(s),a),t.selection.select(a.dom,!0),t.selection.collapse()}}},uS=(t,e)=>((n,o)=>{const r=o?1:-1,s=n.selection.getRng();return((a,i,l)=>Mw(i,a,l,Ca,wa,cS))(r,n,s).orThunk(()=>(dS(n,r,s),x.none()))})(t,((n,o)=>{const r=o?n.getEnd(!0):n.getStart(!0);return hy(r)?!o:o})(t.selection,e)).exists(n=>(Vs(t,n),!0)),mS=(t,e)=>((n,o)=>{const r=o?1:-1,s=n.selection.getRng();return((a,i,l)=>Fw(i,a,l,c=>Ca(c)||Y0(c),c=>wa(c)||Mg(c),cS))(r,n,s).orThunk(()=>(dS(n,r,s),x.none()))})(t,e).exists(n=>(Vs(t,n),!0)),gS=(t,e)=>Uw(t,e,e?wa:Ca),Nu=(t,e)=>Xf(t,!e).map(n=>{const o=n.toRange(),r=t.selection.getRng();return e?o.setStart(r.startContainer,r.startOffset):o.setEnd(r.endContainer,r.endOffset),o}).exists(n=>(Vs(t,n),!0)),UT=t=>Xt(["figcaption"],Gt(t)),fS=(t,e)=>!!t.selection.isCollapsed()&&((n,o)=>{const r=F(n.getBody()),s=X.fromRangeStart(n.selection.getRng());return((a,i,l)=>{const c=ft(ne,i);return Zr(F(a.container()),d=>l.isBlock(Gt(d)),c).filter(UT)})(s,r,n.schema).exists(()=>{if(((a,i,l)=>i?Rw(a.dom,l):Aw(a.dom,l))(r,o,s)){const a=aS(n,r,o?Ie:Sl);return n.selection.setRng(a),!0}return!1})})(t,e),pS=(t,e)=>((n,o)=>o?x.from(n.dom.getParent(n.selection.getNode(),"details")).map(r=>((s,a)=>{const i=s.selection.getRng(),l=X.fromRangeStart(i);return!(s.getBody().lastChild!==a||!Rw(a,l)||(s.execCommand("InsertNewBlockAfter"),0))})(n,r)).getOr(!1):x.from(n.dom.getParent(n.selection.getNode(),"summary")).bind(r=>x.from(n.dom.getParent(r,"details")).map(s=>((a,i,l)=>{const c=a.selection.getRng(),d=X.fromRangeStart(c);return!(a.getBody().firstChild!==i||!Aw(l,d)||(a.execCommand("InsertNewBlockBefore"),0))})(n,s,r))).getOr(!1))(t,e),hS={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},bS=(t,e)=>e.keyCode===t.keyCode&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&e.ctrlKey===t.ctrlKey&&e.metaKey===t.metaKey,Lt=(t,...e)=>()=>t.apply(null,e),Bc=(t,e)=>Te(((n,o)=>Qe((r=>qt(r,s=>({...hS,...s})))(n),r=>bS(r,o)?[r]:[]))(t,e),n=>n.action()),vS=(t,e)=>Xn(((n,o)=>Qe((r=>qt(r,s=>({...hS,...s})))(n),r=>bS(r,o)?[r]:[]))(t,e),n=>n.action()),yS=(t,e)=>{const n=e?1:-1,o=t.selection.getRng();return Mw(t,n,o,gc,fc,ur).exists(r=>(Vs(t,r),!0))},CS=(t,e)=>{const n=e?1:-1,o=t.selection.getRng();return Fw(t,n,o,gc,fc,ur).exists(r=>(Vs(t,r),!0))},wS=(t,e)=>Uw(t,e,e?fc:gc),SS=rs([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Lc={...SS,none:t=>SS.none(t)},kS=(t,e,n)=>Qe(rn(t),o=>eo(o,e)?n(o)?[o]:[]:kS(o,e,n)),xS=(t,e)=>Ts(t,"table",e),pp=(t,e,n,o,r=ae)=>{const s=o===1;if(!s&&n<=0)return Lc.first(t[0]);if(s&&n>=t.length-1)return Lc.last(t[t.length-1]);{const a=n+o,i=t[a];return r(i)?Lc.middle(e,i):pp(t,e,a,o,r)}},ES=(t,e)=>xS(t,e).bind(n=>{const o=kS(n,"th,td",ae);return oe(o,r=>ne(t,r)).map(r=>({index:r,all:o}))}),zT=["img","br"],$T=t=>{return(e=t,Tm.getOption(e)).filter(n=>n.trim().length!==0||n.indexOf(ze)>-1).isSome()||Xt(zT,Gt(t))||(n=>ir(n)&&Pt(n,"contenteditable")==="false")(t);var e},_S=(t,e,n,o,r)=>{const s=dn(F(n),"td,th,caption").map(i=>i.dom),a=Ot(((i,l)=>Qe(l,c=>{const d=((u,m)=>({left:u.left-m,top:u.top-m,right:u.right+-2,bottom:u.bottom+-2,width:u.width+m,height:u.height+m}))(Ga(c.getBoundingClientRect()),-1);return[{x:d.left,y:i(d),cell:c},{x:d.right,y:i(d),cell:c}]}))(t,s),i=>e(i,r));return((i,l,c)=>en(i,(d,u)=>d.fold(()=>x.some(u),m=>{const h=Math.sqrt(Math.abs(m.x-l)+Math.abs(m.y-c)),f=Math.sqrt(Math.abs(u.x-l)+Math.abs(u.y-c));return x.some(f<h?u:m)}),x.none()))(a,o,r).map(i=>i.cell)},HT=ft(_S,t=>t.bottom,(t,e)=>t.y<e),jT=ft(_S,t=>t.top,(t,e)=>t.y>e),NS=(t,e,n)=>{const o=t(e,n);return(r=>r.breakType===ms.Wrap&&r.positions.length===0)(o)||!Ee(n.getNode())&&(r=>r.breakType===ms.Br&&r.positions.length===1)(o)?!((r,s,a)=>a.breakAt.exists(i=>r(s,i).breakAt.isSome()))(t,e,o):o.breakAt.isNone()},VT=ft(NS,Rc),qT=ft(NS,Tc),WT=(t,e,n,o)=>{const r=t.selection.getRng(),s=e?1:-1;return!(!uv()||!((a,i,l)=>{const c=X.fromRangeStart(i);return ji(!a,l).exists(d=>d.isEqual(c))})(e,r,n)||(js(s,t,n,!e,!1).each(a=>{Vs(t,a)}),0))},AS=(t,e,n)=>{const o=((s,a)=>{const i=a.getNode(s);return dr(i)?x.some(i):x.none()})(!!e,n),r=e===!1;o.fold(()=>Vs(t,n.toRange()),s=>ji(r,t.getBody()).filter(a=>a.isEqual(n)).fold(()=>Vs(t,n.toRange()),a=>((i,l,c)=>{l.undoManager.transact(()=>{const d=i?Co:hn,u=aS(l,F(c),d);Vs(l,u)})})(e,t,s)))},KT=(t,e,n,o)=>{const r=t.selection.getRng(),s=X.fromRangeStart(r),a=t.getBody();if(!e&&VT(o,s)){const i=((l,c,d)=>((u,m)=>We(m.getClientRects()).bind(h=>HT(u,h.left,h.top)).bind(h=>{return xu(gr(f=h).map(b=>Rc(f,b).positions.concat(b)).getOr([]),m);var f}))(c,d).orThunk(()=>We(d.getClientRects()).bind(u=>rp(_w(l,X.before(c)),u.left))).getOr(X.before(c)))(a,n,s);return AS(t,e,i),!0}if(e&&qT(o,s)){const i=((l,c,d)=>((u,m)=>Bn(m.getClientRects()).bind(h=>jT(u,h.left,h.top)).bind(h=>{return xu(An(f=h).map(b=>[b].concat(Tc(f,b).positions)).getOr([]),m);var f}))(c,d).orThunk(()=>We(d.getClientRects()).bind(u=>rp(Nw(l,X.after(c)),u.left))).getOr(X.after(c)))(a,n,s);return AS(t,e,i),!0}return!1},RS=(t,e,n)=>x.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(o=>x.from(t.dom.getParent(o,"table")).map(r=>n(t,e,r,o))).getOr(!1),TS=(t,e)=>RS(t,e,WT),hp=(t,e)=>RS(t,e,KT),OS=(t,e,n)=>n.fold(x.none,x.none,(o,r)=>{return(s=r,Cl(s,$T)).map(a=>(i=>{const l=Ki.exact(i,0,i,0);return XN(l)})(a));var s},o=>t.mode.isReadOnly()||!GT(o)?x.none():(t.execCommand("mceTableInsertRowAfter"),BS(t,e,o))),GT=t=>Zr(t,j("table")).exists(Jr),BS=(t,e,n)=>{return OS(t,e,(r=LS,ES(o=n,void 0).fold(()=>Lc.none(o),s=>pp(s.all,o,s.index,1,r))));var o,r},YT=(t,e,n)=>{return OS(t,e,(r=LS,ES(o=n,void 0).fold(()=>Lc.none(),s=>pp(s.all,o,s.index,-1,r))));var o,r},LS=t=>Jr(t)||_l(t,XT),XT=t=>ir(t)&&Jr(t),DS=(t,e)=>{const n=["table","li","dl"],o=F(t.getBody()),r=a=>{const i=Gt(a);return ne(a,o)||Xt(n,i)},s=t.selection.getRng();return((a,i)=>((l,c,d=te)=>d(c)?x.none():Xt(l,Gt(c))?x.some(c):ia(c,l.join(","),u=>eo(u,"table")||d(u)))(["td","th"],a,i))(F(e?s.endContainer:s.startContainer),r).map(a=>(xS(a,r).each(i=>{t.model.table.clearSelectedCells(i.dom)}),t.selection.collapse(!e),(e?BS:YT)(t,r,a).each(i=>{t.selection.setRng(i)}),!0)).getOr(!1)},Mr=(t,e)=>({container:t,offset:e}),Au=ye.DOM,Ru=t=>e=>t===e?-1:0,bp=(t,e,n)=>{if(rt(t)&&e>=0)return x.some(Mr(t,e));{const o=Wa(Au);return x.from(o.backwards(t,e,Ru(t),n)).map(r=>Mr(r.container,r.container.data.length))}},vp=(t,e,n)=>{if(!rt(t))return x.none();const o=t.data;if(e>=0&&e<=o.length)return x.some(Mr(t,e));{const r=Wa(Au);return x.from(r.backwards(t,e,Ru(t),n)).bind(s=>{const a=s.container.data;return vp(s.container,e+a.length,n)})}},PS=(t,e,n)=>{if(!rt(t))return x.none();const o=t.data;if(e<=o.length)return x.some(Mr(t,e));{const r=Wa(Au);return x.from(r.forwards(t,e,Ru(t),n)).bind(s=>PS(s.container,e-o.length,n))}},yp=(t,e,n,o,r)=>{const s=Wa(t,(a=>i=>a.isBlock(i)||Xt(["BR","IMG","HR","INPUT"],i.nodeName)||a.getContentEditable(i)==="false")(t));return x.from(s.backwards(e,n,o,r))},IS=t=>t!==""&&` \xA0\uFEFF\f
\r	\v`.indexOf(t)!==-1,QT=(t,e)=>t.substring(e.length),Cp=(t,e,n,o=!1)=>{if(!(r=e).collapsed||!rt(r.startContainer))return x.none();var r;const s={text:"",offset:0},a=t.getParent(e.startContainer,t.isBlock)||t.getRoot();return yp(t,e.startContainer,e.startOffset,(i,l,c)=>(s.text=c+s.text,s.offset+=l,((d,u,m,h=!1)=>{let f;const b=m.charAt(0);for(f=u-1;f>=0;f--){const p=d.charAt(f);if(!h&&IS(p))return x.none();if(b===p&&Pe(d,m,f,u))break}return x.some(f)})(s.text,s.offset,n,o).getOr(l)),a).bind(i=>{const l=e.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(e.endContainer,e.endOffset),l.collapsed)return x.none();const c=(d=>wo(d.toString().replace(/\u00A0/g," ")))(l);return c.lastIndexOf(n)!==0?x.none():x.some({text:QT(c,n),range:l,trigger:n})})},MS=t=>{if((e=>e.nodeType===3)(t))return Mr(t,t.data.length);{const e=t.childNodes;return e.length>0?MS(e[e.length-1]):Mr(t,e.length)}},FS=(t,e)=>{const n=t.childNodes;return n.length>0&&e<n.length?FS(n[e],0):n.length>0&&(o=>o.nodeType===1)(t)&&n.length===e?MS(n[n.length-1]):Mr(t,e)},US=(t,e,n,o={})=>{var r;const s=e(),a=(r=t.selection.getRng().startContainer.nodeValue)!==null&&r!==void 0?r:"",i=Ot(s.lookupByTrigger(n.trigger),c=>n.text.length>=c.minChars&&c.matches.getOrThunk(()=>(d=>u=>{const m=FS(u.startContainer,u.startOffset);return!((h,f)=>{var b;const p=(b=h.getParent(f.container,h.isBlock))!==null&&b!==void 0?b:h.getRoot();return yp(h,f.container,f.offset,(y,w)=>w===0?-1:w,p).filter(y=>{const w=y.container.data.charAt(y.offset-1);return!IS(w)}).isSome()})(d,m)})(t.dom))(n.range,a,n.text));if(i.length===0)return x.none();const l=Promise.all(qt(i,c=>c.fetch(n.text,c.maxResults,o).then(d=>({matchText:n.text,items:d,columns:c.columns,onAction:c.onAction,highlightOn:c.highlightOn}))));return x.some({lookupData:l,context:n})};var hr;(function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"})(hr||(hr={}));const wp=(t,e,n)=>t.stype===hr.Error?e(t.serror):n(t.svalue),nl=t=>({stype:hr.Value,svalue:t}),Dc=t=>({stype:hr.Error,serror:t}),ZT=wp,Sp=t=>Re(t)&&je(t).length>100?" removed due to size":JSON.stringify(t,null,2),Tu=(t,e)=>Dc([{path:t,getErrorInfo:e}]),JT=(t,e)=>({extract:(n,o)=>ee(o,t).fold(()=>((r,s)=>Tu(r,()=>'Choice schema did not contain choice key: "'+s+'"'))(n,t),r=>((s,a,i,l)=>ee(i,l).fold(()=>((c,d,u)=>Tu(c,()=>'The chosen schema: "'+u+'" did not exist in branches: '+Sp(d)))(s,i,l),c=>c.extract(s.concat(["branch: "+l]),a)))(n,o,e,r)),toString:()=>"chooseOn("+t+"). Possible values: "+je(e)}),zS=t=>(...e)=>{if(e.length===0)throw new Error("Can't merge zero objects");const n={};for(let o=0;o<e.length;o++){const r=e[o];for(const s in r)Bt(r,s)&&(n[s]=t(n[s],r[s]))}return n},kp=zS((t,e)=>Hn(t)&&Hn(e)?kp(t,e):e),tO=zS((t,e)=>e),$S=t=>({tag:"defaultedThunk",process:it(t)}),HS=t=>{const e=(o=>{const r=[],s=[];return J(o,a=>{wp(a,i=>s.push(i),i=>r.push(i))}),{values:r,errors:s}})(t);return e.errors.length>0?(n=e.errors,qe(Dc,zr)(n)):nl(e.values);var n},jS=(t,e,n)=>{switch(t.tag){case"field":return e(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}},xp=t=>({extract:(e,n)=>{return o=t(n),r=s=>((a,i)=>Tu(a,it(i)))(e,s),o.stype===hr.Error?r(o.serror):o;var o,r},toString:it("val")}),eO=xp(nl),VS=(t,e,n,o)=>o(ee(t,e).getOrThunk(()=>n(t))),nO=(t,e,n,o,r)=>{const s=i=>r.extract(e.concat([o]),i),a=i=>i.fold(()=>nl(x.none()),l=>{return d=r.extract(e.concat([o]),l),u=x.some,d.stype===hr.Value?{stype:hr.Value,svalue:u(d.svalue)}:d;var d,u});switch(t.tag){case"required":return((i,l,c,d)=>ee(l,c).fold(()=>((u,m,h)=>Tu(u,()=>'Could not find valid *required* value for "'+m+'" in '+Sp(h)))(i,c,l),d))(e,n,o,s);case"defaultedThunk":return VS(n,o,t.process,s);case"option":return((i,l,c)=>c(ee(i,l)))(n,o,a);case"defaultedOptionThunk":return((i,l,c,d)=>d(ee(i,l).map(u=>u===!0?c(i):u)))(n,o,t.process,a);case"mergeWithThunk":return VS(n,o,it({}),i=>{const l=kp(t.process(n),i);return s(l)})}},Ou=t=>({extract:(e,n)=>((o,r,s)=>{const a={},i=[];for(const l of s)jS(l,(c,d,u,m)=>{const h=nO(u,o,r,c,m);ZT(h,f=>{i.push(...f)},f=>{a[d]=f})},(c,d)=>{a[c]=d(r)});return i.length>0?Dc(i):nl(a)})(e,n,t),toString:()=>`obj{
`+qt(t,n=>jS(n,(o,r,s,a)=>o+" -> "+a.toString(),(o,r)=>"state("+o+")")).join(`
`)+"}"}),Ep=t=>({extract:(e,n)=>{const o=qt(n,(r,s)=>t.extract(e.concat(["["+s+"]"]),r));return HS(o)},toString:()=>"array("+t.toString()+")"}),oO=qe(Ep,Ou),rO=(t,e,n)=>{return o=((r,s,a)=>((i,l)=>i.stype===hr.Error?{stype:hr.Error,serror:l(i.serror)}:i)(s.extract([r],a),i=>({input:a,errors:i})))(t,e,n),wp(o,qn.error,qn.value);var o},_p=(t,e)=>JT(t,Zo(e,Ou)),sO=it(eO),Bu=(t,e)=>xp(n=>{const o=typeof n;return t(n)?nl(n):Dc(`Expected type: ${e} but got: ${o}`)}),aO=Bu(Ce,"number"),ol=Bu(vt,"string"),iO=Bu(Sn,"boolean"),Np=Bu(jt,"function"),rl=(t,e,n,o)=>({tag:"field",key:t,newKey:e,presence:n,prop:o}),qS=(t,e)=>({tag:"custom",newKey:t,instantiator:e}),WS=t=>{return e=n=>Xt(t,n)?qn.value(n):qn.error(`Unsupported value: "${n}", choose one of "${t.join(", ")}".`),xp(n=>e(n).fold(Dc,nl));var e},Ap=(t,e)=>rl(t,t,{tag:"required",process:{}},e),KS=t=>Ap(t,ol),Rp=(t,e)=>rl(t,t,{tag:"required",process:{}},WS(e)),GS=t=>Ap(t,Np),YS=(t,e)=>rl(t,t,{tag:"required",process:{}},Ep(e)),Tp=(t,e)=>rl(t,t,{tag:"option",process:{}},e),ui=t=>Tp(t,ol),sl=(t,e,n)=>rl(t,t,$S(e),n),XS=(t,e)=>sl(t,e,aO),Lu=(t,e)=>sl(t,e,ol),QS=(t,e,n)=>sl(t,e,WS(n)),Op=(t,e)=>sl(t,e,iO),qs=(t,e)=>sl(t,e,Np),lO=KS("type"),cO=GS("fetch"),Bp=GS("onAction"),dO=qs("onSetup",()=>Dt),uO=ui("text"),mO=ui("icon"),gO=ui("tooltip"),fO=ui("label"),pO=Op("active",!1),hO=Op("enabled",!0),ZS=Op("primary",!1),Pc=t=>Lu("type",t),bO=Ou([lO,KS("trigger"),XS("minChars",1),(t=>rl(t,t,$S(1),sO()))("columns"),XS("maxResults",10),Tp("matches",Np),cO,Bp,(JS=ol,sl("highlightOn",[],Ep(JS)))]);var JS;const Lp=[hO,gO,mO,uO,dO,Lu("context","mode:design")],tk=[pO].concat(Lp),Du=[qs("predicate",te),QS("scope","node",["node","editor"]),QS("position","selection",["node","selection","line"])],vO=Lp.concat([Pc("contextformbutton"),Lu("align","end"),ZS,Bp,qS("original",Zt)]),yO=tk.concat([Pc("contextformbutton"),Lu("align","end"),ZS,Bp,qS("original",Zt)]),CO=Lp.concat([Pc("contextformbutton")]),wO=tk.concat([Pc("contextformtogglebutton")]),Dp=[fO,YS("commands",_p("type",{contextformbutton:vO,contextformtogglebutton:yO})),Tp("launch",_p("type",{contextformbutton:CO,contextformtogglebutton:wO})),qs("onInput",Dt),qs("onSetup",Dt)];_p("type",{contextform:[...Du,...Dp,Rp("type",["contextform"]),qs("initValue",it("")),ui("placeholder")],contextsliderform:[...Du,...Dp,Rp("type",["contextsliderform"]),qs("initValue",it(0)),qs("min",it(0)),qs("max",it(100))],contextsizeinputform:[...Du,...Dp,Rp("type",["contextsizeinputform"]),qs("initValue",it({width:"",height:""}))]}),Ou([Pc("contexttoolbar"),Ap("items",(t=>{const e=Zt;return{extract:(n,o)=>{const r=[];for(const s of t){const a=s.extract(n,o);if(a.stype===hr.Value)return{stype:hr.Value,svalue:e(a.svalue)};r.push(a)}return HS(r)},toString:()=>"oneOf("+qt(t,n=>n.toString()).join(", ")+")"}})([ol,oO([ui("name"),ui("label"),YS("items",ol)])]))].concat(Du));const SO=t=>{const e=t.ui.registry.getAll().popups,n=Zo(e,s=>{return(a=s,rO("Autocompleter",bO,a)).fold(i=>{throw new Error(`Errors: 
`+(c=>{const d=c.length>10?c.slice(0,10).concat([{path:[],getErrorInfo:it("... (only showing first ten failures)")}]):c;return qt(d,u=>"Failed path: ("+u.path.join(" > ")+`)
`+u.getErrorInfo())})((l=i).errors).join(`
`)+`

Input object: `+Sp(l.input));var l},Zt);var a}),o=wr(xn(n,s=>s.trigger)),r=Hr(n);return{dataset:n,triggers:o,lookupByTrigger:s=>Ot(r,a=>a.trigger===s)}},kO=t=>{const e=Or(),n=Ye(!1),o=e.isSet,r=()=>{o()&&((l=>{l.dispatch("AutocompleterEnd")})(t),n.set(!1),e.clear())},s=ln(()=>SO(t)),a=l=>{(c=>e.get().map(d=>Cp(t.dom,t.selection.getRng(),d.trigger,!0).bind(u=>US(t,s,u,c))).getOrThunk(()=>((d,u)=>{const m=u(),h=d.selection.getRng();return((f,b,p)=>Xn(p.triggers,y=>Cp(f,b,y)))(d.dom,h,m).bind(f=>US(d,u,f))})(t,s)))(l).fold(r,c=>{(d=>{o()||e.set({trigger:d.trigger,matchLength:d.text.length})})(c.context),c.lookupData.then(d=>{e.get().map(u=>{const m=c.context;u.trigger===m.trigger&&(e.set({...u,matchLength:m.text.length}),n.get()?(qm(t,{range:m.range}),((h,f)=>{h.dispatch("AutocompleterUpdate",f)})(t,{lookupData:d})):(n.set(!0),qm(t,{range:m.range}),((h,f)=>{h.dispatch("AutocompleterStart",f)})(t,{lookupData:d})))})})})},i=()=>e.get().bind(({trigger:l})=>{const c=t.selection.getRng();return Cp(t.dom,c,l,n.get()).filter(({range:d})=>((u,m)=>{const h=u.compareBoundaryPoints(window.Range.START_TO_START,m),f=u.compareBoundaryPoints(window.Range.END_TO_END,m);return h>=0&&f<=0})(c,d)).map(({range:d})=>d)});t.addCommand("mceAutocompleterReload",(l,c)=>{const d=Re(c)?c.fetchOptions:{};a(d)}),t.addCommand("mceAutocompleterClose",r),t.addCommand("mceAutocompleterRefreshActiveRange",()=>{i().each(l=>{qm(t,{range:l})})}),t.editorCommands.addQueryStateHandler("mceAutoCompleterInRange",()=>i().isSome()),((l,c)=>{const d=Rm(c.load,50);l.on("input",u=>{(u.inputType!=="insertCompositionText"||l.composing)&&d.throttle()}),l.on("keydown",u=>{const m=u.which;m===8?d.throttle():m===27?(d.cancel(),c.cancelIfNecessary()):m!==38&&m!==40||d.cancel()},!0),l.on("remove",d.cancel)})(t,{cancelIfNecessary:r,load:a})},xO=Ke().browser.isSafari(),ek=t=>ma(F(t)),nk=(t,e)=>{var n;return t.startOffset===0&&t.endOffset===((n=e.textContent)===null||n===void 0?void 0:n.length)},Pu=(t,e)=>x.from(t.getParent(e.container(),"details")),ok=(t,e)=>Pu(t,e).isSome(),rk=(t,e)=>{const n=e.getNode();tt(n)||t.selection.setCursorLocation(n,e.offset())},sk=(t,e,n)=>{const o=t.dom.getParent(e.container(),"details");if(o&&!o.open){const r=t.dom.select("summary",o)[0];r&&(n?An(r):gr(r)).each(s=>rk(t,s))}else rk(t,e)},ak=(t,e,n)=>{const{dom:o,selection:r}=t,s=t.getBody();if(n==="character"){const a=X.fromRangeStart(r.getRng()),i=o.getParent(a.container(),o.isBlock),l=Pu(o,a),c=i&&o.isEmpty(i),d=Le(i?.previousSibling),u=Le(i?.nextSibling);return!!(c&&(e?u:d)&&Hi(!e,s,a).exists(m=>ok(o,m)&&!Yr(l,Pu(o,m))))||Hi(e,s,a).fold(te,m=>{const h=Pu(o,m);if(ok(o,m)&&!Yr(l,h)){if(e||sk(t,m,!1),i&&c){if(e&&d||!e&&u)return!0;sk(t,m,e),t.dom.remove(i)}return!0}return!1})}return!1},EO=(t,e,n,o)=>{const r=t.selection.getRng(),s=X.fromRangeStart(r),a=t.getBody();return o==="selection"?((i,l)=>{const c=l.startSummary.exists(m=>m.contains(i.startContainer)),d=l.startSummary.exists(m=>m.contains(i.endContainer)),u=l.startDetails.forall(m=>l.endDetails.forall(h=>m!==h));return(c||d)&&!(c&&d)||u})(r,e):n?((i,l)=>l.startSummary.exists(c=>((d,u)=>gr(u).exists(m=>Ee(m.getNode())&&so(u,m).exists(h=>h.isEqual(d))||m.isEqual(d)))(i,c)))(s,e)||((i,l,c)=>c.startDetails.exists(d=>Wn(i,l).forall(u=>!d.contains(u.container()))))(a,s,e):((i,l)=>l.startSummary.exists(c=>((d,u)=>An(u).exists(m=>m.isEqual(d)))(i,c)))(s,e)||((i,l)=>l.startDetails.exists(c=>so(c,i).forall(d=>l.startSummary.exists(u=>!u.contains(i.container())&&u.contains(d.container())))))(s,e)},mi=(t,e,n)=>((o,r,s)=>((a,i)=>{const l=x.from(a.getParent(i.startContainer,"details")),c=x.from(a.getParent(i.endContainer,"details"));if(l.isSome()||c.isSome()){const d=l.bind(u=>x.from(a.select("summary",u)[0]));return x.some({startSummary:d,startDetails:l,endDetails:c})}return x.none()})(o.dom,o.selection.getRng()).fold(()=>ak(o,r,s),a=>EO(o,a,r,s)||ak(o,r,s)))(t,e,n)||xO&&((o,r,s)=>{const a=o.selection,i=a.getNode(),l=a.getRng(),c=X.fromRangeStart(l);return!!mm(i)&&(s==="selection"&&nk(l,i)||wy(r,c,i)?ek(i):o.undoManager.transact(()=>{const d=a.getSel();let{anchorNode:u,anchorOffset:m,focusNode:h,focusOffset:f}=d??{};const b=()=>{q(u)&&q(m)&&q(h)&&q(f)&&d?.setBaseAndExtent(u,m,h,f)},p=(w,S)=>{J(w.childNodes,N=>{lc(N)&&S.appendChild(N)})},y=o.dom.create("span",{"data-mce-bogus":"1"});p(i,y),i.appendChild(y),b(),s!=="word"&&s!=="line"||d==null||d.modify("extend",r?"right":"left",s),!a.isCollapsed()&&nk(a.getRng(),y)?ek(i):(o.execCommand(r?"ForwardDelete":"Delete"),u=d?.anchorNode,m=d?.anchorOffset,h=d?.focusNode,f=d?.focusOffset,p(y,i),b()),o.dom.remove(y)}),!0)})(t,e,n)?x.some(Dt):x.none(),ik=t=>(e,n,o={})=>{const r=e.getBody(),s={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:r,currentTarget:r,eventPhase:Event.AT_TARGET,originalTarget:r,explicitOriginalTarget:r,isTrusted:!1,srcElement:r,cancelable:!1,preventDefault:Dt,inputType:n},a=Mh(new InputEvent(t));return e.dispatch(t,{...a,...s,...o})},Ic=ik("input"),Iu=ik("beforeinput"),lk=Ke(),ck=lk.os,dk=ck.isMacOS()||ck.isiOS(),_O=lk.browser.isFirefox(),al=(t,e)=>{const n=t.dom,o=t.schema.getMoveCaretBeforeOnEnterElements();if(!e)return;if(/^(LI|DT|DD)$/.test(e.nodeName)){const s=(a=>{for(;a;){if(wt(a)||rt(a)&&a.data&&/[\r\n\s]/.test(a.data))return a;a=a.nextSibling}return null})(e.firstChild);s&&/^(UL|OL|DL)$/.test(s.nodeName)&&e.insertBefore(n.doc.createTextNode(ze),e.firstChild)}const r=n.createRng();if(e.normalize(),e.hasChildNodes()){const s=new Ge(e,e);let a,i=e;for(;a=s.current();){if(rt(a)){r.setStart(a,0),r.setEnd(a,0);break}if(o[a.nodeName.toLowerCase()]){r.setStartBefore(a),r.setEndBefore(a);break}i=a,a=s.next()}a||(r.setStart(i,0),r.setEnd(i,0))}else Ee(e)?e.nextSibling&&n.isBlock(e.nextSibling)?(r.setStartBefore(e),r.setEndBefore(e)):(r.setStartAfter(e),r.setEndAfter(e)):(r.setStart(e,0),r.setEnd(e,0));t.selection.setRng(r),mc(t,r)},Mc=(t,e)=>{const n=t.getRoot();let o,r=e;for(;r!==n&&r&&t.getContentEditable(r)!=="false";){if(t.getContentEditable(r)==="true"){o=r;break}r=r.parentNode}return r!==n?o:n},Pp=t=>x.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock)),Ip=t=>{t.innerHTML='<br data-mce-bogus="1">'},Fc=(t,e)=>{Nn(t).toLowerCase()===e.tagName.toLowerCase()&&((n,o,r)=>{const s=n.dom;x.from(r.style).map(s.parseStyle).each(d=>{const u={...Ma(F(o)),...d};s.setStyles(o,u)});const a=x.from(r.class).map(d=>d.split(/\s+/)),i=x.from(o.className).map(d=>Ot(d.split(/\s+/),u=>u!==""));ke(a,i,(d,u)=>{const m=Ot(u,f=>!Xt(d,f)),h=[...d,...m];s.setAttrib(o,"class",h.join(" "))});const l=["style","class"],c=Ao(r,(d,u)=>!Xt(l,u));s.setAttribs(o,c)})(t,e,Jl(t))},uk=(t,e,n,o,r=!0,s,a)=>{const i=t.dom,l=t.schema,c=Nn(t),d=n?n.nodeName.toUpperCase():"";let u=e;const m=l.getTextInlineElements();let h;h=s||d==="TABLE"||d==="HR"?i.create(s||c,a||{}):n.cloneNode(!1);let f=h;if(r)do if(m[u.nodeName]){if(Fo(u)||Uo(u))continue;const b=u.cloneNode(!1);i.setAttrib(b,"id",""),h.hasChildNodes()?(b.appendChild(h.firstChild),h.appendChild(b)):(f=b,h.appendChild(b))}while((u=u.parentNode)&&u!==o);else i.setAttrib(h,"style",null),i.setAttrib(h,"class",null);return Fc(t,h),Ip(f),h},mk=(t,e)=>{const n=t?.parentNode;return q(n)&&n.nodeName===e},gk=t=>q(t)&&/^(OL|UL|LI)$/.test(t.nodeName),Mp=t=>q(t)&&/^(LI|DT|DD)$/.test(t.nodeName),Mu=t=>{const e=t.parentNode;return Mp(e)?e:t},Fu=(t,e,n)=>{let o=t[n?"firstChild":"lastChild"];for(;o&&!wt(o);)o=o[n?"nextSibling":"previousSibling"];return o===e},fk=t=>en(xn(Ma(F(t)),(e,n)=>`${n}: ${e};`),(e,n)=>e+n,""),NO=(t,e)=>e&&e.nodeName==="A"&&t.isEmpty(e),Fp=(t,e)=>t.nodeName===e||t.previousSibling&&t.previousSibling.nodeName===e,Up=(t,e)=>q(e)&&t.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&t.isEditable(e.parentNode)&&t.getContentEditable(e)!=="false",zp=(t,e,n)=>rt(e)?t?n===1&&e.data.charAt(n-1)===an?0:n:n===e.data.length-1&&e.data.charAt(n)===an?e.data.length:n:n,pk={insert:(t,e)=>{let n,o,r,s,a=!1;const i=t.dom,l=t.schema.getNonEmptyElements(),c=t.selection.getRng(),d=Nn(t),u=F(c.startContainer),m=sa(u,c.startOffset),h=m.exists($=>ir($)&&!Jr($)),f=c.collapsed&&h,b=($,W)=>uk(t,n,E,N,d_(t),$,W),p=$=>{const W=zp($,n,o);if(rt(n)&&($?W>0:W<n.data.length))return!1;if((n.parentNode===E||n===E)&&a&&!$||$&&wt(n)&&n===E.firstChild)return!0;if(Fp(n,"TABLE")||Fp(n,"HR"))return(z=>z.nodeName==="BR"||z.nextSibling&&z.nextSibling.nodeName==="BR")(n)?!$:a&&!$||!a&&$;const B=new Ge(n,E);let P;for(rt(n)&&($&&W===0?B.prev():$||W!==n.data.length||B.next());P=B.current();){if(wt(P)){if(!P.getAttribute("data-mce-bogus")){const z=P.nodeName.toLowerCase();if(l[z]&&z!=="br")return!1}}else if(rt(P)&&!Ps(P.data))return!1;$?B.prev():B.next()}return!0},y=()=>{let $;return $=/^(H[1-6]|PRE|FIGURE)$/.test(r)&&R!=="HGROUP"?b(d):b(),((W,B)=>{const P=u_(W);return!Ht(B)&&(vt(P)?Xt(st.explode(P),B.nodeName.toLowerCase()):P)})(t,s)&&Up(i,s)&&i.isEmpty(E,void 0,{includeZwsp:!0})?$=i.split(s,E):i.insertAfter($,E),al(t,$),$};Gd(i,c).each($=>{c.setStart($.startContainer,$.startOffset),c.setEnd($.endContainer,$.endOffset)}),n=c.startContainer,o=c.startOffset;const w=!(!e||!e.shiftKey),S=!(!e||!e.ctrlKey);wt(n)&&n.hasChildNodes()&&!f&&(a=o>n.childNodes.length-1,n=n.childNodes[Math.min(o,n.childNodes.length-1)]||n,o=a&&rt(n)?n.data.length:0);const N=Mc(i,n);if(!N||(($,W)=>{const B=$.dom.getParent(W,"ol,ul,dl");return B!==null&&$.dom.getContentEditableParent(B)==="false"})(t,n))return;w||(n=(($,W,B,P,z)=>{var Q,at;const ot=$.dom,yt=(Q=Mc(ot,P))!==null&&Q!==void 0?Q:ot.getRoot();let St=ot.getParent(P,ot.isBlock);if(!St||!Up(ot,St)){if(St=St||yt,!St.hasChildNodes()){const Ct=ot.create(W);return Fc($,Ct),St.appendChild(Ct),B.setStart(Ct,0),B.setEnd(Ct,0),Ct}let kt,Nt=P;for(;Nt&&Nt.parentNode!==St;)Nt=Nt.parentNode;for(;Nt&&!ot.isBlock(Nt);)kt=Nt,Nt=Nt.previousSibling;const dt=(at=kt?.parentElement)===null||at===void 0?void 0:at.nodeName;if(kt&&dt&&$.schema.isValidChild(dt,W.toLowerCase())){const Ct=kt.parentNode,U=ot.create(W);for(Fc($,U),Ct.insertBefore(U,kt),Nt=kt;Nt&&!ot.isBlock(Nt);){const H=Nt.nextSibling;U.appendChild(Nt),Nt=H}B.setStart(P,z),B.setEnd(P,z)}}return P})(t,d,c,n,o));let E=i.getParent(n,i.isBlock)||i.getRoot();s=q(E?.parentNode)?i.getParent(E.parentNode,i.isBlock):null,r=E?E.nodeName.toUpperCase():"";const R=s?s.nodeName.toUpperCase():"";if(R!=="LI"||S||(E=s,s=s.parentNode,r=R),wt(s)&&(($,W,B)=>!W&&B.nodeName.toLowerCase()===Nn($)&&$.dom.isEmpty(B)&&((P,z)=>{let Q=z;for(;Q&&Q!==P&&Le(Q.nextSibling);){const ot=Q.parentElement;if(!ot||(at=ot,!Bt($.schema.getTextBlockElements(),at.nodeName.toLowerCase())))return Ll(ot);Q=ot}var at;return!1})($.getBody(),B))(t,w,E))return(($,W,B)=>{var P,z,Q;const at=W(Nn($)),ot=((yt,St)=>yt.dom.getParent(St,Ll))($,B);ot&&($.dom.insertAfter(at,ot),al($,at),((Q=(z=(P=B.parentElement)===null||P===void 0?void 0:P.childNodes)===null||z===void 0?void 0:z.length)!==null&&Q!==void 0?Q:0)>1&&$.dom.remove(B))})(t,b,E);if(/^(LI|DT|DD)$/.test(r)&&wt(s)&&i.isEmpty(E))return void(($,W,B,P,z)=>{const Q=$.dom,at=$.selection.getRng(),ot=B.parentNode;if(B===$.getBody()||!ot)return;var yt;gk(yt=B)&&gk(yt.parentNode)&&(z="LI");const St=Mp(P)?fk(P):void 0;let kt=Mp(P)&&St?W(z,{style:fk(P)}):W(z);if(Fu(B,P,!0)&&Fu(B,P,!1))if(mk(B,"LI")){const Nt=Mu(B);Q.insertAfter(kt,Nt),(dt=>{var Ct;return((Ct=dt.parentNode)===null||Ct===void 0?void 0:Ct.firstChild)===dt})(B)?Q.remove(Nt):Q.remove(B)}else Q.replace(kt,B);else if(Fu(B,P,!0))mk(B,"LI")?(Q.insertAfter(kt,Mu(B)),kt.appendChild(Q.doc.createTextNode(" ")),kt.appendChild(B)):ot.insertBefore(kt,B),Q.remove(P);else if(Fu(B,P,!1))Q.insertAfter(kt,Mu(B)),Q.remove(P);else{B=Mu(B);const Nt=at.cloneRange();Nt.setStartAfter(P),Nt.setEndAfter(B);const dt=Nt.extractContents();if(z==="LI"&&(Ct=>Ct.firstChild&&Ct.firstChild.nodeName==="LI")(dt)){const Ct=Ot(qt(kt.children,F),De(j("br")));kt=dt.firstChild,Q.insertAfter(dt,B),J(Ct,U=>Sl(F(kt),U)),St&&kt.setAttribute("style",St)}else Q.insertAfter(dt,B),Q.insertAfter(kt,B);Q.remove(P)}al($,kt)})(t,b,s,E,d);if(!(f||E!==t.getBody()&&Up(i,E)))return;const I=E.parentNode;let D;if(f)D=b(d),m.fold(()=>{Ie(u,F(D))},$=>{hn($,F(D))}),t.selection.setCursorLocation(D,0);else if(Mi(E))D=Dm(E),i.isEmpty(E)&&Ip(E),Fc(t,D),al(t,D);else if(p(!1))D=y();else if(p(!0)&&I){const $=X.fromRangeStart(c),W=Mg($),B=F(E),P=Jd(B,$,t.schema)?ey(B,$,t.schema).bind(Q=>x.from(Q.getNode())):x.none();D=I.insertBefore(b(),E);const z=Fp(E,"HR")||W?D:P.getOr(E);al(t,z)}else{const $=(B=>{const P=B.cloneRange();return P.setStart(B.startContainer,zp(!0,B.startContainer,B.startOffset)),P.setEnd(B.endContainer,zp(!1,B.endContainer,B.endOffset)),P})(c).cloneRange();$.setEndAfter(E);const W=$.extractContents();(B=>{J(id(F(B),Be),P=>{const z=P.dom;z.nodeValue=wo(z.data)})})(W),(B=>{let P=B;do rt(P)&&(P.data=P.data.replace(/^[\r\n]+/,"")),P=P.firstChild;while(P)})(W),D=W.firstChild,i.insertAfter(W,E),((B,P,z)=>{var Q;const at=[];if(!z)return;let ot=z;for(;ot=ot.firstChild;){if(B.isBlock(ot))return;wt(ot)&&!P[ot.nodeName.toLowerCase()]&&at.push(ot)}let yt=at.length;for(;yt--;)ot=at[yt],(!ot.hasChildNodes()||ot.firstChild===ot.lastChild&&((Q=ot.firstChild)===null||Q===void 0?void 0:Q.nodeValue)===""||NO(B,ot))&&B.remove(ot)})(i,l,D),((B,P)=>{P.normalize();const z=P.lastChild;(!z||wt(z)&&/^(left|right)$/gi.test(B.getStyle(z,"float",!0)))&&B.add(P,"br")})(i,E),i.isEmpty(E)&&Ip(E),D.normalize(),i.isEmpty(D)?(i.remove(D),y()):(Fc(t,D),al(t,D))}i.setAttrib(D,"id",""),t.dispatch("NewBlock",{newBlock:D})},fakeEventName:"insertParagraph"},hk=(t,e,n)=>{const o=t.dom.createRng();n?(o.setStartBefore(e),o.setEndBefore(e)):(o.setStartAfter(e),o.setEndAfter(e)),t.selection.setRng(o),mc(t,o)},AO=(t,e)=>{const n=xe("br");hn(F(e),n),t.undoManager.add()},RO=(t,e)=>{TO(t.getBody(),e)||Co(F(e),xe("br"));const n=xe("br");Co(F(e),n),hk(t,n.dom,!1),t.undoManager.add()},TO=(t,e)=>{return n=X.after(e),!!Ee(n.getNode())||Wn(t,X.after(e)).map(o=>Ee(o.getNode())).getOr(!1);var n},bk=t=>t&&t.nodeName==="A"&&"href"in t,OO=t=>t.fold(te,bk,bk,te),BO=(t,e)=>{e.fold(Dt,ft(AO,t),ft(RO,t),Dt)},vk={insert:(t,e)=>{const n=(o=>{const r=ft(ri,o),s=X.fromRangeStart(o.selection.getRng());return us(r,o.getBody(),s).filter(OO)})(t);n.isSome()?n.each(ft(BO,t)):((o,r)=>{const s=o.selection,a=o.dom,i=s.getRng();let l,c=!1;Gd(a,i).each(p=>{i.setStart(p.startContainer,p.startOffset),i.setEnd(p.endContainer,p.endOffset)});let d=i.startOffset,u=i.startContainer;if(wt(u)&&u.hasChildNodes()){const p=d>u.childNodes.length-1;u=u.childNodes[Math.min(d,u.childNodes.length-1)]||u,d=p&&rt(u)?u.data.length:0}let m=a.getParent(u,a.isBlock);const h=m&&m.parentNode?a.getParent(m.parentNode,a.isBlock):null,f=h?h.nodeName.toUpperCase():"",b=!(!r||!r.ctrlKey);f!=="LI"||b||(m=h),rt(u)&&d>=u.data.length&&(((p,y,w)=>{const S=new Ge(y,w);let N;const E=p.getNonEmptyElements();for(;N=S.next();)if(E[N.nodeName.toLowerCase()]||rt(N)&&N.length>0)return!0;return!1})(o.schema,u,m||a.getRoot())||(l=a.create("br"),i.insertNode(l),i.setStartAfter(l),i.setEndAfter(l),c=!0)),l=a.create("br"),zm(a,i,l),hk(o,l,c),o.undoManager.add()})(t,e)},fakeEventName:"insertLineBreak"},yk=(t,e)=>Pp(t).filter(n=>e.length>0&&eo(F(n),e)).isSome(),So=rs([{br:[]},{block:[]},{none:[]}]),LO=(t,e)=>(n=>yk(n,c_(n)))(t),Ck=t=>(e,n)=>(o=>Pp(o).filter(r=>Di(F(r))).isSome())(e)===t,wk=(t,e)=>(n,o)=>(s=>Pp(s).fold(it(""),a=>a.nodeName.toUpperCase()))(n)===t.toUpperCase()===e,DO=t=>{const e=Mc(t.dom,t.selection.getStart());return Ht(e)},Uc=t=>wk("pre",t),Uu=t=>(e,n)=>a_(e)===t,PO=(t,e)=>(n=>yk(n,l_(n)))(t),zu=(t,e)=>e,IO=t=>{const e=Nn(t),n=Mc(t.dom,t.selection.getStart());return q(n)&&t.schema.isValidChild(n.nodeName,e)},MO=t=>{const e=t.selection.getRng(),n=F(e.startContainer),o=sa(n,e.startOffset).map(r=>ir(r)&&!Jr(r));return e.collapsed&&o.getOr(!0)},qo=(t,e)=>(n,o)=>en(t,(r,s)=>r&&s(n,o),!0)?x.some(e):x.none(),$u=(t,e,n)=>{if(!e.mode.isReadOnly()){if(e.selection.isCollapsed()||(o=>{o.execCommand("delete")})(e),q(n)&&Iu(e,t.fakeEventName).isDefaultPrevented())return;t.insert(e,n),q(n)&&Ic(e,t.fakeEventName)}},Sk=(t,e)=>{if(t.mode.isReadOnly())return;const n=()=>$u(vk,t,e),o=()=>$u(pk,t,e),r=((s,a)=>vw([qo([LO],So.none()),qo([Uc(!0),DO],So.none()),qo([wk("summary",!0)],So.br()),qo([Uc(!0),Uu(!1),zu],So.br()),qo([Uc(!0),Uu(!1)],So.block()),qo([Uc(!0),Uu(!0),zu],So.block()),qo([Uc(!0),Uu(!0)],So.br()),qo([Ck(!0),zu],So.br()),qo([Ck(!0)],So.block()),qo([PO],So.br()),qo([zu],So.br()),qo([IO],So.block()),qo([MO],So.block())],[s,!(!a||!a.shiftKey)]).getOr(So.none()))(t,e);switch(i_(t)){case"linebreak":r.fold(n,n,Dt);break;case"block":r.fold(o,o,Dt);break;case"invert":r.fold(o,n,Dt);break;default:r.fold(n,o,Dt)}},kk=Ke(),FO=kk.os.isiOS()&&kk.browser.isSafari(),xk=(t,e)=>{var n;e.isDefaultPrevented()||(e.preventDefault(),(n=t.undoManager).typing&&(n.typing=!1,n.add()),t.undoManager.transact(()=>{Sk(t,e)}))},UO=Ke(),Ek=t=>t.stopImmediatePropagation(),_k=t=>t.keyCode===ht.PAGE_UP||t.keyCode===ht.PAGE_DOWN,Nk=(t,e,n)=>{n&&!t.get()?e.on("NodeChange",Ek,!0):!n&&t.get()&&e.off("NodeChange",Ek),t.set(n)},Ak=(t,e)=>t===e||t.contains(e),Rk=(t,e)=>{const n=e.container(),o=e.offset();return rt(n)?(n.insertData(o,t),x.some(X(n,o+t.length))):Ld(e).map(r=>{const s=Rs(t);return e.isAtEnd()?Co(r,s):hn(r,s),X(s.dom,t.length)})},Tk=ft(Rk,ze),Ok=ft(Rk," "),Bk=t=>e=>{t.selection.setRng(e.toRange()),t.nodeChanged()},zO=t=>{const e=X.fromRangeStart(t.selection.getRng()),n=F(t.getBody());if(t.selection.isCollapsed()){const o=ft(ri,t),r=X.fromRangeStart(t.selection.getRng());return us(o,t.getBody(),r).bind((s=>a=>a.fold(i=>so(s.dom,X.before(i)),i=>An(i),i=>gr(i),i=>Wn(s.dom,X.after(i))))(n)).map(s=>()=>((a,i,l)=>c=>iy(a,c,l)?Tk(i):Ok(i))(n,e,t.schema)(s).each(Bk(t)))}return x.none()},$O=t=>{return Lo(Kt.browser.isFirefox()&&t.selection.isEditable()&&(e=t.dom,n=t.selection.getRng().startContainer,e.isEditable(e.getParent(n,"summary"))),()=>{const o=F(t.getBody());t.selection.isCollapsed()||t.getDoc().execCommand("Delete"),((r,s,a)=>iy(r,s,a)?Tk(s):Ok(s))(o,X.fromRangeStart(t.selection.getRng()),t.schema).each(Bk(t))});var e,n},HO=t=>hN(t)?[{keyCode:ht.TAB,action:Lt(DS,t,!0)},{keyCode:ht.TAB,shiftKey:!0,action:Lt(DS,t,!1)}]:[],jO=t=>{if(t.addShortcut("Meta+P","","mcePrint"),kO(t),ds(t))return Ye(null);{const e=AT(t);return(n=>{n.on("beforeinput",o=>{n.selection.isEditable()&&!de(o.getTargetRanges(),r=>!((s,a)=>!Ak(s.getBody(),a.startContainer)||!Ak(s.getBody(),a.endContainer)||_0(s.dom,a))(n,r))||o.preventDefault()})})(t),(n=>{n.on("keyup compositionstart",ft(FT,n))})(t),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Kt.os.isMacOS()||Kt.os.isiOS();Bc([{keyCode:ht.RIGHT,action:Lt(uS,s,!0)},{keyCode:ht.LEFT,action:Lt(uS,s,!1)},{keyCode:ht.UP,action:Lt(mS,s,!1)},{keyCode:ht.DOWN,action:Lt(mS,s,!0)},...l?[{keyCode:ht.UP,action:Lt(Nu,s,!1),metaKey:!0,shiftKey:!0},{keyCode:ht.DOWN,action:Lt(Nu,s,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:ht.RIGHT,action:Lt(TS,s,!0)},{keyCode:ht.LEFT,action:Lt(TS,s,!1)},{keyCode:ht.UP,action:Lt(hp,s,!1)},{keyCode:ht.DOWN,action:Lt(hp,s,!0)},{keyCode:ht.UP,action:Lt(hp,s,!1)},{keyCode:ht.UP,action:Lt(pS,s,!1)},{keyCode:ht.DOWN,action:Lt(pS,s,!0)},{keyCode:ht.RIGHT,action:Lt(yS,s,!0)},{keyCode:ht.LEFT,action:Lt(yS,s,!1)},{keyCode:ht.UP,action:Lt(CS,s,!1)},{keyCode:ht.DOWN,action:Lt(CS,s,!0)},{keyCode:ht.RIGHT,action:Lt(Hw,s,a,!0)},{keyCode:ht.LEFT,action:Lt(Hw,s,a,!1)},{keyCode:ht.RIGHT,ctrlKey:!l,altKey:l,action:Lt(RT,s,a)},{keyCode:ht.LEFT,ctrlKey:!l,altKey:l,action:Lt(TT,s,a)},{keyCode:ht.UP,action:Lt(fS,s,!1)},{keyCode:ht.DOWN,action:Lt(fS,s,!0)}],i).each(c=>{i.preventDefault()})})(n,o,r)})})(t,e),((n,o)=>{let r=!1;n.on("keydown",s=>{r=s.keyCode===ht.BACKSPACE,s.isDefaultPrevented()||((a,i,l)=>{const c=l.keyCode===ht.BACKSPACE?"deleteContentBackward":"deleteContentForward",d=a.selection.isCollapsed(),u=d?"character":"selection",m=h=>d?h?"word":"line":"selection";vS([{keyCode:ht.BACKSPACE,action:Lt(oS,a)},{keyCode:ht.BACKSPACE,action:Lt(Zf,a,!1)},{keyCode:ht.DELETE,action:Lt(Zf,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(Yf,a,!1)},{keyCode:ht.DELETE,action:Lt(Yf,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(lp,a,i,!1)},{keyCode:ht.DELETE,action:Lt(lp,a,i,!0)},{keyCode:ht.BACKSPACE,action:Lt(Jg,a,!1)},{keyCode:ht.DELETE,action:Lt(Jg,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(mi,a,!1,u)},{keyCode:ht.DELETE,action:Lt(mi,a,!0,u)},...dk?[{keyCode:ht.BACKSPACE,altKey:!0,action:Lt(mi,a,!1,m(!0))},{keyCode:ht.DELETE,altKey:!0,action:Lt(mi,a,!0,m(!0))},{keyCode:ht.BACKSPACE,metaKey:!0,action:Lt(mi,a,!1,m(!1))}]:[{keyCode:ht.BACKSPACE,ctrlKey:!0,action:Lt(mi,a,!1,m(!0))},{keyCode:ht.DELETE,ctrlKey:!0,action:Lt(mi,a,!0,m(!0))}],{keyCode:ht.BACKSPACE,action:Lt(tp,a,!1)},{keyCode:ht.DELETE,action:Lt(tp,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(up,a,!1)},{keyCode:ht.DELETE,action:Lt(up,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(Kf,a,!1)},{keyCode:ht.DELETE,action:Lt(Kf,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(Wf,a,!1)},{keyCode:ht.DELETE,action:Lt(Wf,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(cp,a,!1)},{keyCode:ht.DELETE,action:Lt(cp,a,!0)},{keyCode:ht.BACKSPACE,action:Lt(Jf,a,!1)},{keyCode:ht.DELETE,action:Lt(Jf,a,!0)}],l).filter(h=>a.selection.isEditable()).each(h=>{l.preventDefault(),Iu(a,c).isDefaultPrevented()||(h(),Ic(a,c))})})(n,o,s)}),n.on("keyup",s=>{s.isDefaultPrevented()||((a,i,l)=>{Bc([{keyCode:ht.BACKSPACE,action:Lt(lw,a)},{keyCode:ht.DELETE,action:Lt(lw,a)},...dk?[{keyCode:ht.BACKSPACE,altKey:!0,action:Lt(Oc,a)},{keyCode:ht.DELETE,altKey:!0,action:Lt(Oc,a)},...l?[{keyCode:_O?224:91,action:Lt(Oc,a)}]:[]]:[{keyCode:ht.BACKSPACE,ctrlKey:!0,action:Lt(Oc,a)},{keyCode:ht.DELETE,ctrlKey:!0,action:Lt(Oc,a)}]],i)})(n,s,r),r=!1})})(t,e),(n=>{let o=x.none();n.on("keydown",r=>{r.keyCode===ht.ENTER&&(FO&&(s=>{if(!s.collapsed)return!1;const a=s.startContainer;if(rt(a)){const i=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,l=a.data.charAt(s.startOffset-1);return i.test(l)}return!1})(n.selection.getRng())?(s=>{o=x.some(s.selection.getBookmark()),s.undoManager.add()})(n):xk(n,r))}),n.on("keyup",r=>{r.keyCode===ht.ENTER&&o.each(()=>((s,a)=>{s.undoManager.undo(),o.fold(Dt,i=>s.selection.moveToBookmark(i)),xk(s,a),o=x.none()})(n,r))})})(t),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{vS([{keyCode:ht.SPACEBAR,action:Lt(zO,r)},{keyCode:ht.SPACEBAR,action:Lt($O,r)}],s).each(a=>{s.preventDefault(),Iu(r,"insertText",{data:" "}).isDefaultPrevented()||(a(),Ic(r,"insertText",{data:" "}))})})(n,o)})})(t),(n=>{n.on("input",o=>{o.isComposing||(r=>{const s=F(r.getBody());r.selection.isCollapsed()&&EA(s,X.fromRangeStart(r.selection.getRng()),r.schema).each(a=>{r.selection.setRng(a.toRange())})})(n)})})(t),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{Bc([...HO(r)],s).each(a=>{s.preventDefault()})})(n,o)})})(t),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Kt.os.isMacOS()||Kt.os.isiOS();Bc([{keyCode:ht.END,action:Lt(gS,s,!0)},{keyCode:ht.HOME,action:Lt(gS,s,!1)},...l?[]:[{keyCode:ht.HOME,action:Lt(Nu,s,!1),ctrlKey:!0,shiftKey:!0},{keyCode:ht.END,action:Lt(Nu,s,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:ht.END,action:Lt(wS,s,!0)},{keyCode:ht.HOME,action:Lt(wS,s,!1)},{keyCode:ht.END,action:Lt(_u,s,!0,a)},{keyCode:ht.HOME,action:Lt(_u,s,!1,a)}],i).each(c=>{i.preventDefault()})})(n,o,r)})})(t,e),((n,o)=>{if(UO.os.isMacOS())return;const r=Ye(!1);n.on("keydown",s=>{_k(s)&&Nk(r,n,!0)}),n.on("keyup",s=>{s.isDefaultPrevented()||((a,i,l)=>{Bc([{keyCode:ht.PAGE_UP,action:Lt(_u,a,!1,i)},{keyCode:ht.PAGE_DOWN,action:Lt(_u,a,!0,i)}],l)})(n,o,s),_k(s)&&r.get()&&(Nk(r,n,!1),n.nodeChanged())})})(t,e),e}};class VO{constructor(e){let n;this.lastPath=[],this.editor=e;const o=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",r=>{const s=e.selection.getRng(),a={startContainer:s.startContainer,startOffset:s.startOffset,endContainer:s.endContainer,endOffset:s.endOffset};r.type!=="nodechange"&&Tg(a,n)||e.dispatch("SelectionChange"),n=a}),e.on("contextmenu",()=>{jd(e),e.dispatch("SelectionChange")}),e.on("SelectionChange",()=>{const r=e.selection.getStart(!0);r&&Fd(e)&&!o.isSameElementPath(r)&&e.dom.isChildOf(r,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",r=>{!r.isDefaultPrevented()&&Fd(e)&&(e.selection.getNode().nodeName==="IMG"?$o.setEditorTimeout(e,()=>{e.nodeChanged()}):e.nodeChanged())})}nodeChanged(e={}){const n=this.editor,o=n.selection;let r;if(n.initialized&&o&&!z_(n)&&!Od(n)){const s=n.getBody();r=o.getStart(!0)||s,r.ownerDocument===n.getDoc()&&n.dom.isChildOf(r,s)||(r=s);const a=[];n.dom.getParent(r,i=>i===s||(a.push(i),!1)),n.dispatch("NodeChange",{...e,element:r,parents:a})}}isSameElementPath(e){let n;const o=this.editor,r=No(o.dom.getParents(e,ae,o.getBody()));if(r.length===this.lastPath.length){for(n=r.length;n>=0&&r[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=r,!0}return this.lastPath=r,!1}}const Lk=Wl("image"),$p=Wl("event"),Hu=t=>e=>{e[$p]=t},Dk=Hu(0),qO=Hu(2),WO=Hu(1),KO=t=>{const e=t;return x.from(e[$p]).exists(n=>n===0)},Hp=Wl("mode"),ju=t=>e=>{e[Hp]=t},Pk=(t,e)=>ju(e)(t),Ik=ju(0),jp=ju(2),GO=ju(1),Mk=t=>e=>{const n=e;return x.from(n[Hp]).exists(o=>o===t)},il=Mk(0),Fk=Mk(1),YO=["none","copy","link","move"],XO=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],Vp=()=>{const t=new window.DataTransfer;let e="move",n="all";const o={get dropEffect(){return e},set dropEffect(r){Xt(YO,r)&&(e=r)},get effectAllowed(){return n},set effectAllowed(r){KO(o)&&Xt(XO,r)&&(n=r)},get items(){return((r,s)=>({...s,get length(){return s.length},add:(a,i)=>{if(il(r)){if(!vt(a))return s.add(a);if(!tt(i))return s.add(a,i)}return null},remove:a=>{il(r)&&s.remove(a)},clear:()=>{il(r)&&s.clear()}}))(o,t.items)},get files(){return Fk(o)?Object.freeze({length:0,item:r=>null}):t.files},get types(){return t.types},setDragImage:(r,s,a)=>{var i;il(o)&&(i={image:r,x:s,y:a},o[Lk]=i,t.setDragImage(r,s,a))},getData:r=>Fk(o)?"":t.getData(r),setData:(r,s)=>{il(o)&&t.setData(r,s)},clearData:r=>{il(o)&&t.clearData(r)}};return Ik(o),o},Uk=(t,e)=>t.setData("text/html",e),zk="x-tinymce/html",Vu=it(zk),qp="<!-- "+zk+" -->",QO=t=>qp+t,$k=t=>t.indexOf(qp)!==-1,Hk="%MCEPASTEBIN%",Wp=t=>t.dom.get("mcepastebin"),ZO=t=>q(t)&&t.id==="mcepastebin",jk=t=>t===Hk,Vk=(t,e)=>(st.each(e,n=>{t=wn(n,RegExp)?t.replace(n,""):t.replace(n[0],n[1])}),t),qk=t=>Vk(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,n,o)=>n||o?ze:" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),Wk=(t,e)=>({content:t,cancelled:e}),Kp=(t,e)=>(t.insertContent(e,{merge:rN(t),paste:!0}),!0),Gp=t=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(t),JO=(t,e,n)=>!(t.selection.isCollapsed()||!Gp(e))&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.execCommand("mceInsertLink",!1,r)}),!0))(t,e,n),tB=(t,e,n)=>!!((o,r)=>Gp(r)&&de(ov(o),s=>Zn(r.toLowerCase(),`.${s.toLowerCase()}`)))(t,e)&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.insertContent('<img src="'+r+'">')}),!0))(t,e,n),eB=(()=>{let t=0;return()=>"mceclip"+t++})(),nB=t=>{const e=Vp();return Uk(e,t),jp(e),e},Kk=(t,e,n,o,r)=>{const s=((a,i,l)=>((c,d,u)=>{const m=((f,b,p)=>f.dispatch("PastePreProcess",{content:b,internal:p}))(c,d,u),h=((f,b)=>{const p=Qi({sanitize:nv(f),sandbox_iframes:rv(f),sandbox_iframes_exclusions:Xm(f),convert_unsafe_embeds:yN(f)},f.schema);p.addNodeFilter("meta",w=>{st.each(w,S=>{S.remove()})});const y=p.parse(b,{forced_root_block:!1,isRootContent:!0});return va({validate:!0},f.schema).serialize(y)})(c,m.content);return c.hasEventListeners("PastePostProcess")&&!m.isDefaultPrevented()?((f,b,p)=>{const y=f.dom.create("div",{style:"display:none"},b),w=((S,N,E)=>S.dispatch("PastePostProcess",{node:N,internal:E}))(f,y,p);return Wk(w.node.innerHTML,w.isDefaultPrevented())})(c,h,u):Wk(h,m.isDefaultPrevented())})(a,i,l))(t,e,n);if(!s.cancelled){const a=s.content,i=()=>((l,c,d)=>{d||!sN(l)?Kp(l,c):((u,m)=>{st.each([JO,tB,Kp],h=>!h(u,m,Kp))})(l,c)})(t,a,o);r?Iu(t,"insertFromPaste",{dataTransfer:nB(a)}).isDefaultPrevented()||(i(),Ic(t,"insertFromPaste")):i()}},qu=(t,e,n,o)=>{const r=n||$k(e);Kk(t,(s=>s.replace(qp,""))(e),r,!1,o)},Yp=(t,e,n)=>{const o=t.dom.encode(e).replace(/\r\n/g,`
`),r=((s,a,i)=>{const l=s.split(/\n\n/),c=((m,h)=>{let f="<"+m;const b=xn(h,(p,y)=>y+'="'+Ha.encodeAllRaw(p)+'"');return b.length&&(f+=" "+b.join(" ")),f+">"})(a,i),d="</"+a+">",u=qt(l,m=>m.split(/\n/).join("<br />"));return u.length===1?u[0]:qt(u,m=>c+m+d).join("")})(Rl(o,iN(t)),Nn(t),Jl(t));Kk(t,r,!1,!0,n)},Gk=t=>{const e={};if(t&&t.types)for(let n=0;n<t.types.length;n++){const o=t.types[n];try{e[o]=t.getData(o)}catch{e[o]=""}}return e},ka=(t,e)=>e in t&&t[e].length>0,Yk=t=>ka(t,"text/html")||ka(t,"text/plain"),Xk=(t,e,n)=>{const o=e.type==="paste"?e.clipboardData:e.dataTransfer;var r;if(Td(t)&&o){const s=((a,i)=>{const l=i.items?Qe(Oe(i.items),d=>d.kind==="file"?[d.getAsFile()]:[]):[],c=i.files?Oe(i.files):[];return Ot(l.length>0?l:c,(d=>{const u=ov(d);return m=>ie(m.type,"image/")&&de(u,h=>(f=>{const b=f.toLowerCase(),p={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return st.hasOwn(p,b)?"image/"+p[b]:"image/"+b})(h)===m.type)})(a))})(t,o);if(s.length>0)return e.preventDefault(),(r=s,Promise.all(qt(r,a=>OC(a).then(i=>({file:a,uri:i}))))).then(a=>{n&&t.selection.setRng(n),J(a,i=>{((l,c)=>{Sf(c.uri).each(({data:d,type:u,base64Encoded:m})=>{const h=m?d:btoa(d),f=c.file,b=l.editorUpload.blobCache,p=b.getByData(h,u),y=p??((w,S,N,E)=>{const R=eB(),I=Vb(w)&&q(N.name),D=I?((B,P)=>{const z=P.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return q(z)?B.dom.encode(z[1]):void 0})(w,N.name):R,$=I?N.name:void 0,W=S.create(R,N,E,D,$);return S.add(W),W})(l,b,f,h);qu(l,`<img src="${y.blobUri()}">`,!1,!0)})})(t,i)})}),!0}return!1},Xp=(t,e,n,o,r)=>{let s=qk(n);const a=ka(e,Vu())||$k(n),i=!a&&(c=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(c))(s),l=Gp(s);(jk(s)||!s.length||i&&!l)&&(o=!0),(o||l)&&(s=ka(e,"text/plain")&&i?e["text/plain"]:(c=>{const d=ua(),u=Qi({},d);let m="";const h=d.getVoidElements(),f=st.makeMap("script noscript style textarea video audio iframe object"," "),b=d.getBlockElements(),p=y=>{const w=y.name,S=y;if(w!=="br"){if(w!=="wbr")if(h[w]&&(m+=" "),f[w])m+=" ";else{if(y.type===3&&(m+=y.value),!(y.name in d.getVoidElements())){let N=y.firstChild;if(N)do p(N);while(N=N.next)}b[w]&&S.next&&(m+=`
`,w==="p"&&(m+=`
`))}}else m+=`
`};return c=Vk(c,[/<!\[[^\]]+\]>/g]),p(u.parse(c)),m})(s)),jk(s)||(o?Yp(t,s,r):qu(t,s,a,r))},oB=(t,e,n)=>{((o,r,s)=>{let a;o.on("keydown",i=>{(l=>ht.metaKeyPressed(l)&&l.keyCode===86||l.shiftKey&&l.keyCode===45)(i)&&!i.isDefaultPrevented()&&(a=i.shiftKey&&i.keyCode===86)}),o.on("paste",i=>{if(i.isDefaultPrevented()||(d=>{var u,m;return Kt.os.isAndroid()&&((m=(u=d.clipboardData)===null||u===void 0?void 0:u.items)===null||m===void 0?void 0:m.length)===0})(i))return;const l=s.get()==="text"||a;a=!1;const c=Gk(i.clipboardData);!Yk(c)&&Xk(o,i,r.getLastRng()||o.selection.getRng())||(ka(c,"text/html")?(i.preventDefault(),Xp(o,c,c["text/html"],l,!0)):ka(c,"text/plain")&&ka(c,"text/uri-list")?(i.preventDefault(),Xp(o,c,c["text/plain"],l,!0)):(r.create(),$o.setEditorTimeout(o,()=>{const d=r.getHtml();r.remove(),Xp(o,c,d,l,!1)},0)))})})(t,e,n),(o=>{const r=a=>ie(a,"webkit-fake-url"),s=a=>ie(a,"data:");o.parser.addNodeFilter("img",(a,i,l)=>{if(!Td(o)&&(c=>{var d;return((d=c.data)===null||d===void 0?void 0:d.paste)===!0})(l))for(const c of a){const d=c.attr("src");vt(d)&&!c.attr("data-mce-object")&&d!==Kt.transparentSrc&&(r(d)||!lN(o)&&s(d))&&c.remove()}})})(t)},Qk=(t,e,n,o)=>{((r,s,a)=>{if(!r)return!1;try{return r.clearData(),r.setData("text/html",s),r.setData("text/plain",a),r.setData(Vu(),s),!0}catch{return!1}})(t.clipboardData,e.html,e.text)?(t.preventDefault(),o()):n(e.html,o)},Zk=t=>(e,n)=>{const{dom:o,selection:r}=t,s=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=o.create("div",{contenteditable:"true"},e);o.setStyles(s,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),s.appendChild(a),o.add(t.getBody(),s);const i=r.getRng();a.focus();const l=o.createRng();l.selectNodeContents(a),r.setRng(l),$o.setEditorTimeout(t,()=>{r.setRng(i),o.remove(s),n()},0)},Jk=t=>({html:QO(t.selection.getContent({contextual:!0})),text:t.selection.getContent({format:"text"})}),tx=t=>!t.selection.isCollapsed()||(e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()))(t),ex=(t,e)=>{var n,o;return ni.getCaretRangeFromPoint((n=e.clientX)!==null&&n!==void 0?n:0,(o=e.clientY)!==null&&o!==void 0?o:0,t.getDoc())},nx=(t,e)=>{t.focus(),e&&t.selection.setRng(e)},rB=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,ox=t=>st.trim(t).replace(rB,Fl).toLowerCase(),sB=(t,e,n)=>{const o=nN(t);if(n||o==="all"||!oN(t))return e;const r=o?o.split(/[, ]/):[];if(r&&o!=="none"){const s=t.dom,a=t.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,d)=>{const u=s.parseStyle(s.decode(c)),m={};for(let f=0;f<r.length;f++){const b=u[r[f]];let p=b,y=s.getStyle(a,r[f],!0);/color/.test(r[f])&&(p=ox(p),y=ox(y)),y!==p&&(m[r[f]]=b)}const h=s.serializeStyle(m,"span");return h?l+' style="'+h+'"'+d:l+d})}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e=e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(s,a,i,l)=>a+' style="'+i+'"'+l),e},aB=t=>{const e=Ye(!1),n=Ye(aN(t)?"text":"html"),o=(r=>{const s=Ye(null);return{create:()=>((a,i)=>{const{dom:l,selection:c}=a,d=a.getBody();i.set(c.getRng());const u=l.add(a.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},Hk);Kt.browser.isFirefox()&&l.setStyle(u,"left",l.getStyle(d,"direction",!0)==="rtl"?65535:-65535),l.bind(u,"beforedeactivate focusin focusout",m=>{m.stopPropagation()}),u.focus(),c.select(u,!0)})(r,s),remove:()=>((a,i)=>{const l=a.dom;if(Wp(a)){let c;const d=i.get();for(;c=Wp(a);)l.remove(c),l.unbind(c);d&&a.selection.setRng(d)}i.set(null)})(r,s),getEl:()=>Wp(r),getHtml:()=>(a=>{const i=a.dom,l=(m,h)=>{m.appendChild(h),i.remove(h,!0)},[c,...d]=Ot(a.getBody().childNodes,ZO);J(d,m=>{l(c,m)});const u=i.select("div[id=mcepastebin]",c);for(let m=u.length-1;m>=0;m--){const h=i.create("div");c.insertBefore(h,u[m]),l(h,u[m])}return c?c.innerHTML:""})(r),getLastRng:s.get}})(t);(r=>{(Kt.browser.isChromium()||Kt.browser.isSafari())&&((s,a)=>{s.on("PastePreProcess",i=>{i.content=a(s,i.content,i.internal)})})(r,sB)})(t),((r,s)=>{r.addCommand("mceTogglePlainTextPaste",()=>{((a,i)=>{i.get()==="text"?(i.set("html"),Fb(a,!1)):(i.set("text"),Fb(a,!0)),a.focus()})(r,s)}),r.addCommand("mceInsertClipboardContent",(a,i)=>{i.html&&qu(r,i.html,i.internal,!1),i.text&&Yp(r,i.text,!1)})})(t,n),(r=>{const s=l=>c=>{l(r,c)},a=J_(r);jt(a)&&r.on("PastePreProcess",s(a));const i=tN(r);jt(i)&&r.on("PastePostProcess",s(i))})(t),t.addQueryStateHandler("mceTogglePlainTextPaste",()=>n.get()==="text"),t.on("PreInit",()=>{(r=>{r.on("cut",(s=>a=>{!a.isDefaultPrevented()&&tx(s)&&s.selection.isEditable()&&Qk(a,Jk(s),Zk(s),()=>{if(Kt.browser.isChromium()||Kt.browser.isFirefox()){const i=s.selection.getRng();$o.setEditorTimeout(s,()=>{s.selection.setRng(i),s.execCommand("Delete")},0)}else s.execCommand("Delete")})})(r)),r.on("copy",(s=>a=>{!a.isDefaultPrevented()&&tx(s)&&Qk(a,Jk(s),Zk(s),Dt)})(r))})(t),((r,s)=>{Z_(r)&&r.on("dragend dragover draggesture dragdrop drop drag",a=>{a.preventDefault(),a.stopPropagation()}),Td(r)||r.on("drop",a=>{const i=a.dataTransfer;i&&(l=>de(l.files,c=>/^image\//.test(c.type)))(i)&&a.preventDefault()}),r.on("drop",a=>{if(a.isDefaultPrevented())return;const i=ex(r,a);if(Ht(i))return;const l=Gk(a.dataTransfer),c=ka(l,Vu());if((!Yk(l)||(f=>{const b=f["text/plain"];return!!b&&b.indexOf("file://")===0})(l))&&Xk(r,a,i))return;const d=l[Vu()],u=d||l["text/html"]||l["text/plain"],m=((f,b,p,y)=>{const w=f.getParent(p,S=>_e(b,S));if(!Le(f.getParent(p,"summary")))return!0;if(w&&Bt(y,"text/html")){const S=new DOMParser().parseFromString(y["text/html"],"text/html").body;return!Le(S.querySelector(w.nodeName.toLowerCase()))}return!1})(r.dom,r.schema,i.startContainer,l),h=s.get();h&&!m||u&&(a.preventDefault(),$o.setEditorTimeout(r,()=>{r.undoManager.transact(()=>{(d||h&&m)&&r.execCommand("Delete"),nx(r,i);const f=qk(u);l["text/html"]?qu(r,f,c,!0):Yp(r,f,!0)})}))}),r.on("dragstart",a=>{s.set(!0)}),r.on("dragover dragend",a=>{Td(r)&&!s.get()&&(a.preventDefault(),nx(r,ex(r,a))),a.type==="dragend"&&s.set(!1)}),(a=>{a.on("input",i=>{const l=c=>Le(c.querySelector("summary"));if(i.inputType==="deleteByDrag"){const c=Ot(a.dom.select("details"),l);J(c,d=>{Ee(d.firstChild)&&d.firstChild.remove();const u=a.dom.create("summary");u.appendChild(Pi().dom),d.prepend(u)})}})})(r)})(t,e),oB(t,o,n)})},iB=Ee,rx=rt,lB=t=>me(t.dom),sx=t=>e=>ne(F(t),e),ax=(t,e)=>Zr(F(t),lB,sx(e)),ix=(t,e,n)=>{const o=new Ge(t,e),r=n?o.next.bind(o):o.prev.bind(o);let s=t;for(let a=n?t:r();a&&!iB(a);a=r())Dr(a)&&(s=a);return s},cB=t=>{const e=((n,o,r)=>{const s=X.fromRangeStart(n).getNode(),a=((d,u,m)=>Zr(F(d),h=>(f=>ro(f.dom))(h)||m.isBlock(Gt(h)),sx(u)).getOr(F(u)).dom)(s,o,r),i=ix(s,a,!1),l=ix(s,a,!0),c=document.createRange();return ax(i,a).fold(()=>{rx(i)?c.setStart(i,0):c.setStartBefore(i)},d=>c.setStartBefore(d.dom)),ax(l,a).fold(()=>{rx(l)?c.setEnd(l,l.data.length):c.setEndAfter(l)},d=>c.setEndAfter(d.dom)),c})(t.selection.getRng(),t.getBody(),t.schema);t.selection.setRng(sf(e))};var ll;(function(t){t.Before="before",t.After="after"})(ll||(ll={}));const dB=(t,e)=>Math.abs(t.left-e),uB=(t,e)=>Math.abs(t.right-e),mB=(t,e)=>(n=>en(n,(o,r)=>o.fold(()=>x.some(r),s=>{const a=Math.min(r.left,s.left),i=Math.min(r.top,s.top),l=Math.max(r.right,s.right),c=Math.max(r.bottom,s.bottom);return x.some({top:i,right:l,bottom:c,left:a,width:l-a,height:c-i})}),x.none()))(Ot(t,n=>{return(o=e)>=(r=n).top&&o<=r.bottom;var o,r})).fold(()=>[[],t],n=>{const{pass:o,fail:r}=Yo(t,s=>((a,i)=>{const l=((c,d)=>Math.max(0,Math.min(c.bottom,d.bottom)-Math.max(c.top,d.top)))(a,i)/Math.min(a.height,i.height);return((c,d)=>c.top<d.bottom&&c.bottom>d.top)(a,i)&&l>.5})(s,n));return[o,r]}),gB=(t,e,n)=>e>t.left&&e<t.right?0:Math.min(Math.abs(t.left-e),Math.abs(t.right-e)),Qp=(t,e,n,o)=>{const r=d=>Dr(d.node)?x.some(d):wt(d.node)?Qp(Oe(d.node.childNodes),e,n,!1):x.none(),s=(d,u)=>{const m=Yn(d,(h,f)=>u(h,e,n)-u(f,e,n));return Xn(m,r).map(h=>o&&!rt(h.node)&&m.length>1?((f,b,p)=>r(b).filter(y=>Math.abs(p(f,e,n)-p(y,e,n))<2&&rt(y.node)))(h,m[1],u).getOr(h):h)},[a,i]=mB(Lw(t),n),{pass:l,fail:c}=Yo(i,d=>d.top<n);return s(a,gB).orThunk(()=>s(c,rb)).orThunk(()=>s(l,rb))},lx=(t,e,n)=>((o,r,s)=>{const a=F(o),i=Ar(a),l=Po(i,r,s).filter(c=>Pn(a,c)).getOr(a);return((c,d,u,m)=>{const h=(f,b)=>{const p=Ot(f.dom.childNodes,De(y=>wt(y)&&y.classList.contains("mce-drag-container")));return b.fold(()=>Qp(p,u,m,!0),y=>{const w=Ot(p,S=>S!==y.dom);return Qp(w,u,m,!0)}).orThunk(()=>(ne(f,c)?x.none():Da(f)).bind(y=>h(y,x.some(f))))};return h(d,x.none())})(a,l,r,s)})(t,e,n).filter(o=>nc(o.node)).map(o=>((r,s)=>({node:r.node,position:dB(r,s)<uB(r,s)?ll.Before:ll.After}))(o,e)),cx=t=>{var e,n;const o=t.getBoundingClientRect(),r=t.ownerDocument,s=r.documentElement,a=r.defaultView;return{top:o.top+((e=a?.scrollY)!==null&&e!==void 0?e:0)-s.clientTop,left:o.left+((n=a?.scrollX)!==null&&n!==void 0?n:0)-s.clientLeft}},dx=t=>({target:t,srcElement:t}),fB=(t,e,n,o)=>{const r=((s,a)=>{const i=(l=>{const c=Vp(),d=(u=>{const m=u;return x.from(m[Hp])})(l);return jp(l),Dk(c),c.dropEffect=l.dropEffect,c.effectAllowed=l.effectAllowed,(u=>{const m=u;return x.from(m[Lk])})(l).each(u=>c.setDragImage(u.image,u.x,u.y)),J(l.types,u=>{u!=="Files"&&c.setData(u,l.getData(u))}),J(l.files,u=>c.items.add(u)),(u=>{const m=u;return x.from(m[$p])})(l).each(u=>{((m,h)=>{Hu(h)(m)})(c,u)}),d.each(u=>{Pk(l,u),Pk(c,u)}),c})(s);return a==="dragstart"?(Dk(i),Ik(i)):a==="drop"?(qO(i),jp(i)):(WO(i),GO(i)),i})(n,t);return tt(o)?((s,a,i)=>{const l=He("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:s,composedPath:l,initEvent:l,preventDefault:Dt,stopImmediatePropagation:Dt,stopPropagation:Dt,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,layerX:0,layerY:0,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:l,initMouseEvent:l,getModifierState:l,dataTransfer:i,...dx(a)}})(t,e,r):((s,a,i,l)=>({...a,dataTransfer:l,type:s,...dx(i)}))(t,o,e,r)},ux=me,pB=((...t)=>e=>{for(let n=0;n<t.length;n++)if(t[n](e))return!0;return!1})(ux,ro),hB=(t,e,n,o)=>{const r=t.dom,s=e.cloneNode(!0);r.setStyles(s,{width:n,height:o}),r.setAttrib(s,"data-mce-selected",null);const a=r.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return r.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),r.setStyles(s,{margin:0,boxSizing:"border-box"}),a.appendChild(s),a},Wu=(t,e)=>n=>()=>{const o=t==="left"?n.scrollX:n.scrollY;n.scroll({[t]:o+e,behavior:"smooth"})},mx=Wu("left",-32),gx=Wu("left",32),fx=Wu("top",-32),px=Wu("top",32),hx=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)},zc=(t,e,n,o,r)=>{e==="dragstart"&&Uk(o,t.dom.getOuterHTML(n));const s=fB(e,n,o,r);return t.dispatch(e,s)},bB=(t,e)=>{const n=yd((r,s)=>((a,i,l)=>{a._selectionOverrides.hideFakeCaret(),lx(a.getBody(),i,l).fold(()=>a.selection.placeCaretAt(i,l),c=>{const d=a._selectionOverrides.showCaret(1,c.node,c.position===ll.Before,!1);d?a.selection.setRng(d):a.selection.placeCaretAt(i,l)})})(e,r,s),0);e.on("remove",n.cancel);const o=t;return r=>t.on(s=>{const a=Math.max(Math.abs(r.screenX-s.screenX),Math.abs(r.screenY-s.screenY));if(!s.dragging&&a>10){const c=zc(e,"dragstart",s.element,s.dataTransfer,r);if(q(c.dataTransfer)&&(s.dataTransfer=c.dataTransfer),c.isDefaultPrevented())return;s.dragging=!0,e.focus()}if(s.dragging){const c=r.currentTarget===e.getDoc().documentElement,d=((u,m)=>({pageX:m.pageX-u.relX,pageY:m.pageY+5}))(s,((u,m)=>{return h=(p=>p.inline?cx(p.getBody()):{left:0,top:0})(u),f=(p=>{const y=p.getBody();return p.inline?{left:y.scrollLeft,top:y.scrollTop}:{left:0,top:0}})(u),b=((p,y)=>{if(y.target.ownerDocument!==p.getDoc()){const w=cx(p.getContentAreaContainer()),S=(N=>{const E=N.getBody(),R=N.getDoc().documentElement,I={left:E.scrollLeft,top:E.scrollTop},D={left:E.scrollLeft||R.scrollLeft,top:E.scrollTop||R.scrollTop};return N.inline?I:D})(p);return{left:y.pageX-w.left+S.left,top:y.pageY-w.top+S.top}}return{left:y.pageX,top:y.pageY}})(u,m),{pageX:b.left-h.left+f.left,pageY:b.top-h.top+f.top};var h,f,b})(e,r));i=s.ghost,l=e.getBody(),i.parentNode!==l&&l.appendChild(i),((u,m,h,f,b,p,y,w,S,N,E,R)=>{let I=0,D=0;u.style.left=m.pageX+"px",u.style.top=m.pageY+"px",m.pageX+h>b&&(I=m.pageX+h-b),m.pageY+f>p&&(D=m.pageY+f-p),u.style.width=h-I+"px",u.style.height=f-D+"px";const $=S.clientHeight,W=S.clientWidth,B=y+S.getBoundingClientRect().top,P=w+S.getBoundingClientRect().left;E.on(z=>{z.intervalId.clear(),z.dragging&&R&&(y+8>=$?z.intervalId.set(px(N)):y-8<=0?z.intervalId.set(fx(N)):w+8>=W?z.intervalId.set(gx(N)):w-8<=0?z.intervalId.set(mx(N)):B+16>=window.innerHeight?z.intervalId.set(px(window)):B-16<=0?z.intervalId.set(fx(window)):P+16>=window.innerWidth?z.intervalId.set(gx(window)):P-16<=0&&z.intervalId.set(mx(window)))})})(s.ghost,d,s.width,s.height,s.maxX,s.maxY,r.clientY,r.clientX,e.getContentAreaContainer(),e.getWin(),o,c),n.throttle(r.clientX,r.clientY)}var i,l})},bx=(t,e,n)=>{t.on(o=>{o.intervalId.clear(),o.dragging&&n.fold(()=>zc(e,"dragend",o.element,o.dataTransfer),r=>zc(e,"dragend",o.element,o.dataTransfer,r))}),vx(t)},vx=t=>{t.on(e=>{e.intervalId.clear(),hx(e.ghost)}),t.clear()},vB=t=>{const e=Or(),n=ye.DOM,o=document,r=((l,c)=>d=>{if((u=>u.button===0)(d)){const u=Te(c.dom.getParents(d.target),pB).getOr(null);if(q(u)&&((m,h,f)=>ux(f)&&f!==h&&m.isEditable(f.parentElement))(c.dom,c.getBody(),u)){const m=c.dom.getPos(u),h=c.getBody(),f=c.getDoc().documentElement;l.set({element:u,dataTransfer:Vp(),dragging:!1,screenX:d.screenX,screenY:d.screenY,maxX:(c.inline?h.scrollWidth:f.offsetWidth)-2,maxY:(c.inline?h.scrollHeight:f.offsetHeight)-2,relX:d.pageX-m.x,relY:d.pageY-m.y,width:u.offsetWidth,height:u.offsetHeight,ghost:hB(c,u,u.offsetWidth,u.offsetHeight),intervalId:fm(100)})}}})(e,t),s=bB(e,t),a=((l,c)=>d=>{l.on(u=>{var m;if(u.intervalId.clear(),u.dragging){if(((h,f,b)=>!Ht(f)&&f!==b&&!h.dom.isChildOf(f,b)&&h.dom.isEditable(f))(c,(h=>{const f=h.getSel();if(q(f)){const b=f.getRangeAt(0).startContainer;return rt(b)?b.parentNode:b}return null})(c.selection),u.element)){const h=(m=c.getDoc().elementFromPoint(d.clientX,d.clientY))!==null&&m!==void 0?m:c.getBody();zc(c,"drop",h,u.dataTransfer,d).isDefaultPrevented()||c.undoManager.transact(()=>{((f,b)=>{const p=f.getParent(b.parentNode,f.isBlock);hx(b),p&&p!==f.getRoot()&&f.isEmpty(p)&&ma(F(p))})(c.dom,u.element),(f=>{const b=f.getData("text/html");return b===""?x.none():x.some(b)})(u.dataTransfer).each(f=>c.insertContent(f)),c._selectionOverrides.hideFakeCaret()})}zc(c,"dragend",c.getBody(),u.dataTransfer,d)}}),vx(l)})(e,t),i=((l,c)=>d=>bx(l,c,x.some(d)))(e,t);t.on("mousedown",r),t.on("mousemove",s),t.on("mouseup",a),n.bind(o,"mousemove",s),n.bind(o,"mouseup",i),t.on("remove",()=>{n.unbind(o,"mousemove",s),n.unbind(o,"mouseup",i)}),t.on("keydown",l=>{l.keyCode===ht.ESC&&bx(e,t,x.none())})},$c=me,yx=(t,e)=>si(t.getBody(),e),yB=t=>{const e=t.selection,n=t.dom,o=t.getBody(),r=NN(t,o,n.isBlock,()=>Yi(t)),s="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=p=>p!==o&&($c(p)||ur(p))&&n.isChildOf(p,o)&&n.isEditable(p.parentNode),c=(p,y,w,S=!0)=>t.dispatch("ShowCaret",{target:y,direction:p,before:w}).isDefaultPrevented()?null:(S&&e.scrollIntoView(y,p===-1),r.show(w,y)),d=p=>Io(p)||Sd(p)||kd(p),u=p=>d(p.startContainer)||d(p.endContainer),m=p=>{const y=t.schema.getVoidElements(),w=n.createRng(),S=p.startContainer,N=p.startOffset,E=p.endContainer,R=p.endOffset;return Bt(y,S.nodeName.toLowerCase())?N===0?w.setStartBefore(S):w.setStartAfter(S):w.setStart(S,N),Bt(y,E.nodeName.toLowerCase())?R===0?w.setEndBefore(E):w.setEndAfter(E):w.setEnd(E,R),w},h=(p,y)=>{if(!p)return null;if(p.collapsed){if(!u(p)){const E=y?1:-1,R=ac(E,o,p),I=R.getNode(!y);if(q(I)){if(nc(I))return c(E,I,!!y&&!R.isAtEnd(),!1);if(ga(I)&&me(I.nextSibling)){const $=n.createRng();return $.setStart(I,0),$.setEnd(I,0),$}}const D=R.getNode(y);if(q(D)){if(nc(D))return c(E,D,!y&&!R.isAtEnd(),!1);if(ga(D)&&me(D.previousSibling)){const $=n.createRng();return $.setStart(D,1),$.setEnd(D,1),$}}}return null}let w=p.startContainer,S=p.startOffset;const N=p.endOffset;if(rt(w)&&S===0&&$c(w.parentNode)&&(w=w.parentNode,S=n.nodeIndex(w),w=w.parentNode),!wt(w))return null;if(N===S+1&&w===p.endContainer){const E=w.childNodes[S];if(l(E))return(R=>{const I=R.cloneNode(!0),D=t.dispatch("ObjectSelected",{target:R,targetClone:I});if(D.isDefaultPrevented())return null;const $=((B,P)=>{const z=F(t.getBody()),Q=t.getDoc(),at=wi(z,"#"+s).getOrThunk(()=>{const St=As('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',Q);return et(St,"id",s),Ie(z,St),St}),ot=n.createRng();la(at),Os(at,[Rs(ze,Q),F(P),Rs(ze,Q)]),ot.setStart(at.dom.firstChild,1),ot.setEnd(at.dom.lastChild,0),xi(at,{top:n.getPos(B,t.getBody()).y+"px"}),e0(at);const yt=e.getSel();return yt&&(yt.removeAllRanges(),yt.addRange(ot)),ot})(R,D.targetClone),W=F(R);return J(dn(F(t.getBody()),`*[${a}]`),B=>{ne(W,B)||C(B,a)}),n.getAttrib(R,a)||R.setAttribute(a,"1"),i=R,b(),$})(E)}return null},f=()=>{i&&i.removeAttribute(a),wi(F(t.getBody()),"#"+s).each(le),i=null},b=()=>{r.hide()};return ds(t)||(t.on("click",p=>{n.isEditable(p.target)||(p.preventDefault(),t.focus())}),t.on("blur NewBlock",f),t.on("ResizeWindow FullscreenStateChanged",r.reposition),t.on("tap",p=>{const y=p.target,w=yx(t,y);$c(w)?(p.preventDefault(),Ac(t,w).each(h)):l(y)&&Ac(t,y).each(h)},!0),t.on("mousedown",p=>{const y=p.target;if(y!==o&&y.nodeName!=="HTML"&&!n.isChildOf(y,o)||!((S,N,E)=>{const R=F(S.getBody()),I=S.inline?R:F(Ar(R).dom.documentElement),D=(($,W,B,P)=>{const z=(Q=>Q.dom.getBoundingClientRect())(W);return{x:B-($?z.left+W.dom.clientLeft+qR(W):0),y:P-($?z.top+W.dom.clientTop+VR(W):0)}})(S.inline,I,N,E);return(($,W,B)=>{const P=HR($),z=jR($);return W>=0&&B>=0&&W<=P&&B<=z})(I,D.x,D.y)})(t,p.clientX,p.clientY))return;f(),b();const w=yx(t,y);$c(w)?(p.preventDefault(),Ac(t,w).each(h)):lx(o,p.clientX,p.clientY).each(S=>{var N;p.preventDefault(),(N=c(1,S.node,S.position===ll.Before,!1))&&e.setRng(N),cr(w)?w.focus():t.getBody().focus()})}),t.on("keypress",p=>{ht.modifierPressed(p)||$c(e.getNode())&&p.preventDefault()}),t.on("GetSelectionRange",p=>{let y=p.range;if(i){if(!i.parentNode)return void(i=null);y=y.cloneRange(),y.selectNode(i),p.range=y}}),t.on("SetSelectionRange",p=>{p.range=m(p.range);const y=h(p.range,p.forward);y&&(p.range=y)}),t.on("AfterSetSelectionRange",p=>{const y=p.range,w=y.startContainer.parentElement;var S;u(y)||wt(S=w)&&S.id==="mcepastebin"||b(),(N=>q(N)&&n.hasClass(N,"mce-offscreen-selection"))(w)||f()}),(p=>{vB(p),j_(p)&&(y=>{const w=E=>{if(!E.isDefaultPrevented()){const R=E.dataTransfer;R&&(Xt(R.types,"Files")||R.files.length>0)&&(E.preventDefault(),E.type==="drop"&&vu(y,"Dropped file type is not supported"))}},S=E=>{Vd(y,E.target)&&w(E)},N=()=>{const E=ye.DOM,R=y.dom,I=document,D=y.inline?y.getBody():y.getDoc(),$=["drop","dragover"];J($,W=>{E.bind(I,W,S),R.bind(D,W,w)}),y.on("remove",()=>{J($,W=>{E.unbind(I,W,S),R.unbind(D,W,w)})})};y.on("init",()=>{$o.setEditorTimeout(y,N,0)})})(p)})(t),(p=>{const y=yd(()=>{if(!p.removed&&p.getBody().contains(document.activeElement)){const w=p.selection.getRng();if(w.collapsed){const S=Gf(p,w,!1);p.selection.setRng(S)}}},0);p.on("focus",()=>{y.throttle()}),p.on("blur",()=>{y.cancel()})})(t),(p=>{p.on("init",()=>{p.on("focusin",y=>{const w=y.target;if(ur(w)){const S=si(p.getBody(),w),N=me(S)?S:w;p.selection.getNode()!==N&&Ac(p,N).each(E=>p.selection.setRng(E))}})})})(t)),{showCaret:c,showBlockCaretContainer:p=>{p.hasAttribute("data-mce-caret")&&(Dm(p),e.scrollIntoView(p))},hideFakeCaret:b,destroy:()=>{r.destroy(),i=null}}},CB=(t,e)=>{let n=e;for(let o=t.previousSibling;rt(o);o=o.previousSibling)n+=o.data.length;return n},Cx=(t,e,n,o,r)=>{if(rt(n)&&(o<0||o>n.data.length))return[];const s=r&&rt(n)?[CB(n,o)]:[o];let a=n;for(;a!==e&&a.parentNode;)s.push(t.nodeIndex(a,r)),a=a.parentNode;return a===e?s.reverse():[]},Zp=(t,e,n,o,r,s,a=!1)=>({start:Cx(t,e,n,o,a),end:Cx(t,e,r,s,a)}),wx=(t,e)=>{const n=e.slice(),o=n.pop();return Ce(o)?en(n,(r,s)=>r.bind(a=>x.from(a.childNodes[s])),x.some(t)).bind(r=>rt(r)&&(o<0||o>r.data.length)?x.none():x.some({node:r,offset:o})):x.none()},Sx=(t,e)=>wx(t,e.start).bind(({node:n,offset:o})=>wx(t,e.end).map(({node:r,offset:s})=>{const a=document.createRange();return a.setStart(n,o),a.setEnd(r,s),a})),cl=(t,e,n)=>{if(e&&t.isEmpty(e)&&!n(e)){const o=e.parentNode;t.remove(e,rt(e.firstChild)&&Ps(e.firstChild.data)),cl(t,o,n)}},Ku=(t,e,n,o=!0)=>{const r=e.startContainer.parentNode,s=e.endContainer.parentNode;e.deleteContents(),o&&!n(e.startContainer)&&(rt(e.startContainer)&&e.startContainer.data.length===0&&t.remove(e.startContainer),rt(e.endContainer)&&e.endContainer.data.length===0&&t.remove(e.endContainer),cl(t,r,n),r!==s&&cl(t,s,n))},Gu=(t,e)=>x.from(t.dom.getParent(e.startContainer,t.dom.isBlock)),Jp=(t,e,n)=>{const o=t.dynamicPatternsLookup({text:n,block:e});return{...t,blockPatterns:Tb(o).concat(t.blockPatterns),inlinePatterns:Ob(o).concat(t.inlinePatterns)}},th=(t,e,n,o)=>{const r=t.createRng();return r.setStart(e,0),r.setEnd(n,o),r.toString()},kx=(t,e)=>t.create("span",{"data-mce-type":"bookmark",id:e}),Yu=(t,e)=>{const n=t.createRng();return n.setStartAfter(e.start),n.setEndBefore(e.end),n},xx=(t,e,n)=>{const o=Sx(t.getRoot(),n).getOrDie("Unable to resolve path range"),r=o.startContainer,s=o.endContainer,a=o.endOffset===0?s:s.splitText(o.endOffset),i=o.startOffset===0?r:r.splitText(o.startOffset),l=i.parentNode;return{prefix:e,end:a.parentNode.insertBefore(kx(t,e+"-end"),a),start:l.insertBefore(kx(t,e+"-start"),i)}},Ex=(t,e,n)=>{cl(t,t.get(e.prefix+"-end"),n),cl(t,t.get(e.prefix+"-start"),n)},eh=t=>t.start.length===0,_x=(t,e,n,o)=>{const r=e.start;var s;return yp(t,o.container,o.offset,(s=r,(a,i)=>{const l=a.data.substring(0,i),c=l.lastIndexOf(s.charAt(s.length-1)),d=l.lastIndexOf(s);return d!==-1?d+s.length:c!==-1?c+1:-1}),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(r))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+r.length){const d=t.createRng();return d.setStart(a.container,a.offset-r.length),d.setEnd(a.container,a.offset),x.some(d)}{const d=a.offset-r.length;return vp(a.container,d,n).map(u=>{const m=t.createRng();return m.setStart(u.container,u.offset),m.setEnd(a.container,a.offset),m}).filter(u=>u.toString()===r).orThunk(()=>_x(t,e,n,Mr(a.container,0)))}})},wB=(t,e,n,o)=>{const r=t.dom,s=r.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return vp(i,l-n.pattern.end.length,e).bind(c=>{const d=Zp(r,s,c.container,c.offset,i,l,o);if(eh(a))return x.some({matches:[{pattern:a,startRng:d,endRng:d}],position:c});{const u=Xu(t,n.remainingPatterns,c.container,c.offset,e,o),m=u.getOr({matches:[],position:c}),h=m.position;return((b,p,y,w,S,N=!1)=>{if(p.start.length===0&&!N){const E=b.createRng();return E.setStart(y,w),E.setEnd(y,w),x.some(E)}return bp(y,w,S).bind(E=>_x(b,p,S,E).bind(R=>{var I;return N&&(R.endContainer===E.container&&R.endOffset===E.offset||E.offset===0&&((I=R.endContainer.textContent)===null||I===void 0?void 0:I.length)===R.endOffset)?x.none():x.some(R)}))})(r,a,h.container,h.offset,e,u.isNone()).map(b=>{const p=((y,w,S,N=!1)=>Zp(y,w,S.startContainer,S.startOffset,S.endContainer,S.endOffset,N))(r,s,b,o);return{matches:m.matches.concat([{pattern:a,startRng:p,endRng:d}]),position:Mr(b.startContainer,b.startOffset)}})}})},Xu=(t,e,n,o,r,s)=>{const a=t.dom;return bp(n,o,a.getRoot()).bind(i=>{const l=th(a,r,n,o);for(let c=0;c<e.length;c++){const d=e[c];if(!Zn(l,d.end))continue;const u=e.slice();u.splice(c,1);const m=wB(t,r,{pattern:d,remainingPatterns:u,position:i},s);if(m.isNone()&&o>0)return Xu(t,e,n,o-1,r,s);if(m.isSome())return m}return x.none()})},Nx=(t,e,n)=>{t.selection.setRng(n),e.type==="inline-format"?J(e.format,o=>{t.formatter.apply(o)}):t.execCommand(e.cmd,!1,e.value)},Ax=(t,e,n,o,r,s)=>{var a;return((i,l)=>{const c=kn(i,d=>de(l,u=>d.pattern.start===u.pattern.start&&d.pattern.end===u.pattern.end));return i.length===l.length?c?i:l:i.length>l.length?i:l})(Xu(t,r.inlinePatterns,n,o,e,s).fold(()=>[],i=>i.matches),Xu(t,(a=r.inlinePatterns,Yn(a,(i,l)=>l.end.length-i.end.length)),n,o,e,s).fold(()=>[],i=>i.matches))},Rx=(t,e)=>{if(e.length===0)return;const n=t.dom,o=t.selection.getBookmark(),r=((s,a)=>{const i=Wl("mce_textpattern"),l=yr(a,(c,d)=>{const u=xx(s,i+`_end${c.length}`,d.endRng);return c.concat([{...d,endMarker:u}])},[]);return yr(l,(c,d)=>{const u=l.length-c.length-1,m=eh(d.pattern)?d.endMarker:xx(s,i+`_start${u}`,d.startRng);return c.concat([{...d,startMarker:m}])},[])})(n,e);J(r,s=>{const a=n.getParent(s.startMarker.start,n.isBlock),i=l=>l===a;eh(s.pattern)?((l,c,d,u)=>{const m=Yu(l.dom,d);Ku(l.dom,m,u),Nx(l,c,m)})(t,s.pattern,s.endMarker,i):((l,c,d,u,m)=>{const h=l.dom,f=Yu(h,u),b=Yu(h,d);Ku(h,b,m),Ku(h,f,m);const p={prefix:d.prefix,start:d.end,end:u.start},y=Yu(h,p);Nx(l,c,y)})(t,s.pattern,s.startMarker,s.endMarker,i),Ex(n,s.endMarker,i),Ex(n,s.startMarker,i)}),t.selection.moveToBookmark(o)},Tx=(t,e,n)=>((o,r,s)=>{if(rt(o)&&0>=o.length)return x.some(Mr(o,0));{const a=Wa(Au);return x.from(a.forwards(o,0,Ru(o),s)).map(i=>Mr(i.container,0))}})(e,0,e).map(o=>{const r=o.container;return PS(r,n.start.length,e).each(s=>{const a=t.createRng();a.setStart(r,0),a.setEnd(s.container,s.offset),Ku(t,a,i=>i===e)}),r}),Ox=t=>(e,n)=>{const o=e.dom,r=n.pattern,s=Sx(o.getRoot(),n.range).getOrDie("Unable to resolve path range");return Gu(e,s).each(a=>{r.type==="block-format"?((i,l)=>{const c=l.get(i);return Qt(c)&&We(c).exists(d=>Bt(d,"block"))})(r.format,e.formatter)&&e.undoManager.transact(()=>{t(e.dom,a,r),e.formatter.apply(r.format)}):r.type==="block-command"&&e.undoManager.transact(()=>{t(e.dom,a,r),e.execCommand(r.cmd,!1,r.value)})}),!0},Bx=t=>(e,n)=>{const o=(s=>Yn(s,(a,i)=>i.start.length-a.start.length))(e),r=n.replace(ze," ");return Te(o,s=>t(s,n,r))},Lx=(t,e)=>(n,o,r,s,a)=>{var i;a===void 0&&(a=(i=o.textContent)!==null&&i!==void 0?i:"");const l=n.dom,c=Nn(n);return l.is(o,c)?t(r.blockPatterns,a).map(d=>e&&st.trim(a).length===d.start.length?[]:[{pattern:d,range:Zp(l,l.getRoot(),o,0,o,0,s)}]).getOr([]):[]},SB=Ox((t,e,n)=>{Tx(t,e,n).each(o=>{const r=F(o),s=Kl(r);/^\s[^\s]/.test(s)&&Zh(r,s.slice(1))})}),kB=Bx((t,e,n)=>e.indexOf(t.start)===0||n.indexOf(t.start)===0),xB=Lx(kB,!0),EB=Ox(Tx),_B=Bx((t,e,n)=>e===t.start||n===t.start),NB=Lx(_B,!1),Dx=(t,e,n)=>{for(let o=0;o<t.length;o++)if(n(t[o],e))return!0;return!1},AB=t=>{const e=[",",".",";",":","!","?"],n=[32],o=()=>{return a=cN(t).filter(l=>l.type!=="inline-command"&&l.type!=="block-command"||t.queryCommandSupported(l.cmd)),i=dN(t),{inlinePatterns:Ob(a),blockPatterns:Tb(a),dynamicPatternsLookup:i};var a,i},r=()=>(a=>a.options.isSet("text_patterns_lookup"))(t);t.on("keydown",a=>{if(a.keyCode===13&&!ht.modifierPressed(a)&&t.selection.isCollapsed()&&t.selection.isEditable()){const i=Vm(o(),"enter");(i.inlinePatterns.length>0||i.blockPatterns.length>0||r())&&((l,c)=>((d,u)=>{const m=d.selection.getRng();return Gu(d,m).map(h=>{var f;const b=Math.max(0,m.startOffset),p=Jp(u,h,(f=h.textContent)!==null&&f!==void 0?f:"");return{inlineMatches:Ax(d,h,m.startContainer,b,p,!0),blockMatches:xB(d,h,p,!0)}}).filter(({inlineMatches:h,blockMatches:f})=>f.length>0||h.length>0)})(l,c).fold(te,({inlineMatches:d,blockMatches:u})=>(l.undoManager.add(),l.undoManager.extra(()=>{l.execCommand("mceInsertNewLine")},()=>{(f=>{f.insertContent(an,{preserve_zwsp:!0})})(l),Rx(l,d),((f,b)=>{if(b.length===0)return;const p=f.selection.getBookmark();J(b,y=>SB(f,y)),f.selection.moveToBookmark(p)})(l,u);const m=l.selection.getRng(),h=bp(m.startContainer,m.startOffset,l.dom.getRoot());l.execCommand("mceInsertNewLine"),h.each(f=>{const b=f.container;b.data.charAt(f.offset-1)===Ua&&(b.deleteData(f.offset-1,1),cl(l.dom,b.parentNode,p=>p===l.dom.getRoot()))})}),!0)))(t,i)&&a.preventDefault()}},!0),t.on("keydown",a=>{if(a.keyCode===32&&t.selection.isCollapsed()&&t.selection.isEditable()){const i=Vm(o(),"space");(i.blockPatterns.length>0||r())&&((l,c)=>((d,u)=>{const m=d.selection.getRng();return Gu(d,m).map(h=>{const f=Math.max(0,m.startOffset),b=th(d.dom,h,m.startContainer,f),p=Jp(u,h,b);return NB(d,h,p,!1,b)}).filter(h=>h.length>0)})(l,c).fold(te,d=>(l.undoManager.transact(()=>{((u,m)=>{J(m,h=>EB(u,h))})(l,d)}),!0)))(t,i)&&a.preventDefault()}},!0);const s=()=>{if(t.selection.isCollapsed()&&t.selection.isEditable()){const a=Vm(o(),"space");(a.inlinePatterns.length>0||r())&&((i,l)=>{const c=i.selection.getRng();Gu(i,c).map(d=>{const u=Math.max(0,c.startOffset-1),m=th(i.dom,d,c.startContainer,u),h=Jp(l,d,m),f=Ax(i,d,c.startContainer,u,h,!1);f.length>0&&i.undoManager.transact(()=>{Rx(i,f)})})})(t,a)}};t.on("keyup",a=>{Dx(n,a,(i,l)=>i===l.keyCode&&!ht.modifierPressed(l))&&s()}),t.on("keypress",a=>{Dx(e,a,(i,l)=>i.charCodeAt(0)===l.charCode)&&$o.setEditorTimeout(t,s)})},RB=t=>{const e=st.each,n=ht.BACKSPACE,o=ht.DELETE,r=t.dom,s=t.selection,a=t.parser,i=Kt.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),d=Kt.deviceType.isiPhone()||Kt.deviceType.isiPad(),u=Kt.os.isMacOS()||Kt.os.isiOS(),m=(B,P)=>{try{t.getDoc().execCommand(B,!1,String(P))}catch{}},h=B=>B.isDefaultPrevented(),f=()=>{t.shortcuts.add("meta+a",null,"SelectAll")},b=()=>{t.inline||r.bind(t.getDoc(),"mousedown mouseup",B=>{let P;if(B.target===t.getDoc().documentElement)if(P=s.getRng(),t.getBody().focus(),B.type==="mousedown"){if(Io(P.startContainer))return;s.placeCaretAt(B.clientX,B.clientY)}else s.setRng(P)})},p=()=>{Range.prototype.getClientRects||t.on("mousedown",B=>{if(!h(B)&&B.target.nodeName==="HTML"){const P=t.getBody();P.blur(),$o.setEditorTimeout(t,()=>{P.focus()})}})},y=()=>{const B=Jb(t);t.on("click",P=>{const z=P.target;/^(IMG|HR)$/.test(z.nodeName)&&r.isEditable(z)&&(P.preventDefault(),t.selection.select(z),t.nodeChanged()),z.nodeName==="A"&&r.hasClass(z,B)&&z.childNodes.length===0&&r.isEditable(z.parentNode)&&(P.preventDefault(),s.select(z))})},w=()=>{t.on("keydown",B=>{if(!h(B)&&B.keyCode===n&&s.isCollapsed()&&s.getRng().startOffset===0){const P=s.getNode().previousSibling;if(P&&P.nodeName&&P.nodeName.toLowerCase()==="table")return B.preventDefault(),!1}return!0})},S=()=>{Qb(t)||t.on("BeforeExecCommand mousedown",()=>{m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),Yb(t)||m("enableObjectResizing",!1)})},N=()=>{t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},E=()=>{t.inline||t.on("keydown",()=>{document.activeElement===document.body&&t.getWin().focus()})},R=()=>{t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",B=>{let P;B.target.nodeName==="HTML"&&(P=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(P),t.selection.normalize(),t.nodeChanged())}))},I=()=>{u&&t.on("keydown",B=>{!ht.metaKeyPressed(B)||B.shiftKey||B.keyCode!==37&&B.keyCode!==39||(B.preventDefault(),t.selection.getSel().modify("move",B.keyCode===37?"backward":"forward","lineboundary"))})},D=()=>{t.on("click",B=>{let P=B.target;do if(P.tagName==="A")return void B.preventDefault();while(P=P.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},$=()=>{t.on("init",()=>{t.dom.bind(t.getBody(),"submit",B=>{B.preventDefault()})})},W=Dt;return ds(t)?(c&&(b(),y(),$(),f(),d&&(E(),R(),D())),l&&(p(),S(),N(),I())):(t.on("keydown",B=>{if(h(B)||B.keyCode!==ht.BACKSPACE)return;let P=s.getRng();const z=P.startContainer,Q=P.startOffset,at=r.getRoot();let ot=z;if(P.collapsed&&Q===0){for(;ot.parentNode&&ot.parentNode.firstChild===ot&&ot.parentNode!==at;)ot=ot.parentNode;ot.nodeName==="BLOCKQUOTE"&&(t.formatter.toggle("blockquote",void 0,ot),P=r.createRng(),P.setStart(z,0),P.setEnd(z,0),s.setRng(P))}}),(()=>{const B=P=>{const z=r.create("body"),Q=P.cloneContents();return z.appendChild(Q),s.serializer.serialize(z,{format:"html"})};t.on("keydown",P=>{const z=P.keyCode;if(!h(P)&&(z===o||z===n)&&t.selection.isEditable()){const Q=t.selection.isCollapsed(),at=t.getBody();if(Q&&!mr(t.schema,at)||!Q&&!(ot=>{const yt=B(ot),St=r.createRng();return St.selectNode(t.getBody()),yt===B(St)})(t.selection.getRng()))return;P.preventDefault(),t.setContent(""),at.firstChild&&r.isBlock(at.firstChild)?t.selection.setCursorLocation(at.firstChild,0):t.selection.setCursorLocation(at,0),t.nodeChanged()}})})(),Kt.windowsPhone||t.on("keyup focusin mouseup",B=>{ht.modifierPressed(B)||(P=>{const z=P.getBody(),Q=P.selection.getRng();return Q.startContainer===Q.endContainer&&Q.startContainer===z&&Q.startOffset===0&&Q.endOffset===z.childNodes.length})(t)||s.normalize()},!0),c&&(b(),y(),t.on("init",()=>{m("DefaultParagraphSeparator",Nn(t))}),$(),w(),a.addNodeFilter("br",B=>{let P=B.length;for(;P--;)B[P].attr("class")==="Apple-interchange-newline"&&B[P].remove()}),d?(E(),R(),D()):f()),l&&(t.on("keydown",B=>{if(!h(B)&&B.keyCode===n){if(!t.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&s.getRng().startOffset===0){const P=s.getNode(),z=P.previousSibling;if(P.nodeName==="HR")return r.remove(P),void B.preventDefault();z&&z.nodeName&&z.nodeName.toLowerCase()==="hr"&&(r.remove(z),B.preventDefault())}}}),p(),(()=>{const B=()=>{const z=r.getAttribs(s.getStart().cloneNode(!1));return()=>{const Q=s.getStart();Q!==t.getBody()&&(r.setAttrib(Q,"style",null),e(z,at=>{Q.setAttributeNode(at.cloneNode(!0))}))}},P=()=>!s.isCollapsed()&&r.getParent(s.getStart(),r.isBlock)!==r.getParent(s.getEnd(),r.isBlock);t.on("keypress",z=>{let Q;return!(!(h(z)||z.keyCode!==8&&z.keyCode!==46)&&P()&&(Q=B(),t.getDoc().execCommand("delete",!1),Q(),z.preventDefault(),1))}),r.bind(t.getDoc(),"cut",z=>{if(!h(z)&&P()){const Q=B();$o.setEditorTimeout(t,()=>{Q()})}})})(),S(),t.on("SetContent ExecCommand",B=>{B.type!=="setcontent"&&B.command!=="mceInsertLink"||e(r.select("a:not([data-mce-block])"),P=>{var z;let Q=P.parentNode;const at=r.getRoot();if(Q?.lastChild===P){for(;Q&&!r.isBlock(Q);){if(((z=Q.parentNode)===null||z===void 0?void 0:z.lastChild)!==Q||Q===at)return;Q=Q.parentNode}r.add(Q,"br",{"data-mce-bogus":1})}})}),N(),I(),w())),{refreshContentEditable:W,isHidden:()=>{if(!l||t.removed)return!1;const B=t.selection.getSel();return!B||!B.rangeCount||B.rangeCount===0}}},nh=ye.DOM,TB=t=>t.inline?t.getElement().nodeName.toLowerCase():void 0,oh=t=>Ao(t,e=>tt(e)===!1),Px=t=>{const e=t.options.get,n=t.editorUpload.blobCache;return oh({allow_conditional_comments:e("allow_conditional_comments"),allow_html_data_urls:e("allow_html_data_urls"),allow_svg_data_urls:e("allow_svg_data_urls"),allow_html_in_named_anchor:e("allow_html_in_named_anchor"),allow_script_urls:e("allow_script_urls"),allow_mathml_annotation_encodings:e("allow_mathml_annotation_encodings"),allow_unsafe_link_target:e("allow_unsafe_link_target"),convert_unsafe_embeds:e("convert_unsafe_embeds"),convert_fonts_to_spans:e("convert_fonts_to_spans"),fix_list_elements:e("fix_list_elements"),font_size_legacy_values:e("font_size_legacy_values"),forced_root_block:e("forced_root_block"),forced_root_block_attrs:e("forced_root_block_attrs"),preserve_cdata:e("preserve_cdata"),inline_styles:e("inline_styles"),root_name:TB(t),sandbox_iframes:e("sandbox_iframes"),sandbox_iframes_exclusions:Xm(t),sanitize:e("xss_sanitization"),validate:!0,blob_cache:n,document:t.getDoc()})},Ix=t=>{const e=t.options.get;return oh({custom_elements:e("custom_elements"),extended_valid_elements:e("extended_valid_elements"),invalid_elements:e("invalid_elements"),invalid_styles:e("invalid_styles"),schema:e("schema"),valid_children:e("valid_children"),valid_classes:e("valid_classes"),valid_elements:e("valid_elements"),valid_styles:e("valid_styles"),verify_html:e("verify_html"),padd_empty_block_inline_children:e("format_empty_lines")})},rh=t=>t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader,Mx=t=>{const e=rh(t),n=Gb(t),o=t.contentCSS,r=()=>{e.unloadAll(o),t.inline||t.ui.styleSheetLoader.unloadAll(n)},s=()=>{t.removed?r():t.on("remove",r)};if(t.contentStyles.length>0){let l="";st.each(t.contentStyles,c=>{l+=c+`\r
`}),t.dom.addStyle(l)}const a=Promise.all(((l,c,d)=>{const{pass:u,fail:m}=Yo(c,b=>tinymce.Resource.has(jf(b))),h=u.map(b=>{const p=tinymce.Resource.get(jf(b));return vt(p)?Promise.resolve(rh(l).loadRawCss(b,p)):Promise.resolve()}),f=[...h,rh(l).loadAll(m)];return l.inline?f:f.concat([l.ui.styleSheetLoader.loadAll(d)])})(t,o,n)).then(s).catch(s),i=S_(t);return i&&((l,c)=>{const d=F(l.getBody()),u=vl(Qr(d)),m=xe("style");et(m,"type","text/css"),Ie(m,Rs(c)),Ie(u,m),l.on("remove",()=>{le(m)})})(t,i),a},sh=t=>{t.removed!==!0&&((e=>{ds(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})})(t),(e=>{e.bindPendingEventDelegates(),e.initialized=!0,(o=>{o.dispatch("Init")})(e),e.focus(!0),(o=>{const r=o.dom.getRoot();o.inline||Fd(o)&&o.selection.getStart(!0)!==r||An(r).each(s=>{const a=s.getNode(),i=dr(a)?An(a).getOr(s):s;o.selection.setRng(i.toRange())})})(e),e.nodeChanged({initial:!0});const n=K_(e);jt(n)&&n.call(e,e),(o=>{const r=Y_(o);r&&$o.setEditorTimeout(o,()=>{let s;s=r===!0?o:o.editorManager.get(r),s&&!s.destroyed&&(s.focus(),s.selection.scrollIntoView())},100)})(e),Hs(e)&&F1(e,!0)})(t))},Fx=t=>{const e=t.getElement();let n=t.getDoc();t.inline&&(nh.addClass(e,"mce-content-body"),t.contentDocument=n=document,t.contentWindow=window,t.bodyElement=e,t.contentAreaContainer=e);const o=t.getBody();o.disabled=!0,t.readonly=Qb(t),t._editableRoot=$_(t),!Od(t)&&t.hasEditableRoot()&&(t.inline&&nh.getStyle(o,"position",!0)==="static"&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,t.editorUpload=XR(t),t.schema=ua(Ix(t)),t.dom=ye(n,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,update_styles:!0,root_element:t.inline?t.getBody():null,collect:t.inline,schema:t.schema,contentCssCors:v_(t),referrerPolicy:Km(t),onSetAttrib:a=>{t.dispatch("SetAttrib",a)}}),t.parser=(a=>{const i=Qi(Px(a),a.schema);return i.addAttributeFilter("src,href,style,tabindex",(l,c)=>{const d=a.dom,u="data-mce-"+c;let m=l.length;for(;m--;){const h=l[m];let f=h.attr(c);if(f&&!h.attr(u)){if(f.indexOf("data:")===0||f.indexOf("blob:")===0)continue;c==="style"?(f=d.serializeStyle(d.parseStyle(f),h.name),f.length||(f=null),h.attr(u,f),h.attr(c,f)):c==="tabindex"?(h.attr(u,f),h.attr(c,null)):h.attr(u,a.convertURL(f,c,h.name))}}}),i.addNodeFilter("script",l=>{let c=l.length;for(;c--;){const d=l[c],u=d.attr("type")||"no/type";u.indexOf("mce-")!==0&&d.attr("type","mce-"+u)}}),gN(a)&&i.addNodeFilter("#cdata",l=>{var c;let d=l.length;for(;d--;){const u=l[d];u.type=8,u.name="#comment",u.value="[CDATA["+a.dom.encode((c=u.value)!==null&&c!==void 0?c:"")+"]]"}}),i.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",l=>{let c=l.length;const d=a.schema.getNonEmptyElements();for(;c--;){const u=l[c];u.isEmpty(d)&&u.getAll("br").length===0&&u.append(new Fn("br",1))}}),i})(t),t.serializer=_1((a=>{const i=a.options.get;return{...Px(a),...Ix(a),...oh({remove_trailing_brs:i("remove_trailing_brs"),pad_empty_with_br:i("pad_empty_with_br"),url_converter:i("url_converter"),url_converter_scope:i("url_converter_scope"),element_format:i("element_format"),entities:i("entities"),entity_encoding:i("entity_encoding"),indent:i("indent"),indent_after:i("indent_after"),indent_before:i("indent_before")})}})(t),t),t.selection=E1(t.dom,t.getWin(),t.serializer,t),t.annotator=Zv(t),t.formatter=W1(t),t.undoManager=G1(t),t._nodeChangeDispatcher=new VO(t),t._selectionOverrides=yB(t),(a=>{const i=Or(),l=Ye(!1),c=Rm(d=>{a.dispatch("longpress",{...d,type:"longpress"}),l.set(!0)},400);a.on("touchstart",d=>{sS(d).each(u=>{c.cancel();const m={x:u.clientX,y:u.clientY,target:d.target};c.throttle(d),l.set(!1),i.set(m)})},!0),a.on("touchmove",d=>{c.cancel(),sS(d).each(u=>{i.on(m=>{((h,f)=>{const b=Math.abs(h.clientX-f.x),p=Math.abs(h.clientY-f.y);return b>5||p>5})(u,m)&&(i.clear(),l.set(!1),a.dispatch("longpresscancel"))})})},!0),a.on("touchend touchcancel",d=>{c.cancel(),d.type!=="touchcancel"&&i.get().filter(u=>u.target.isEqualNode(d.target)).each(()=>{l.get()?d.preventDefault():a.dispatch("tap",{...d,type:"tap"})})},!0)})(t),(a=>{(i=>{i.on("click",l=>{i.dom.getParent(l.target,"details")&&l.preventDefault()})})(a),(i=>{i.parser.addNodeFilter("details",l=>{const c=bN(i);J(l,d=>{c==="expanded"?d.attr("open","open"):c==="collapsed"&&d.attr("open",null)})}),i.serializer.addNodeFilter("details",l=>{const c=vN(i);J(l,d=>{c==="expanded"?d.attr("open","open"):c==="collapsed"&&d.attr("open",null)})})})(a)})(t),(a=>{const i="contenteditable",l=" "+st.trim(uN(a))+" ",c=" "+st.trim(ev(a))+" ",d=iS(l),u=iS(c),m=mN(a);m.length>0&&a.on("BeforeSetContent",h=>{((f,b,p)=>{let y=b.length,w=p.content;if(p.format!=="raw"){for(;y--;)w=w.replace(b[y],IT(f,w,ev(f)));p.content=w}})(a,m,h)}),a.parser.addAttributeFilter("class",h=>{let f=h.length;for(;f--;){const b=h[f];d(b)?b.attr(i,"true"):u(b)&&b.attr(i,"false")}}),a.serializer.addAttributeFilter(i,h=>{let f=h.length;for(;f--;){const b=h[f];if(!d(b)&&!u(b))continue;const p=b.attr("data-mce-content");m.length>0&&p?MT(m,p)?(b.name="#text",b.type=3,b.raw=!0,b.value=p):b.remove():b.attr(i,null)}})})(t),ds(t)||((a=>{a.on("mousedown",i=>{i.detail>=3&&(i.preventDefault(),cB(a))})})(t),(a=>{AB(a)})(t));const r=jO(t);((a,i)=>{a.addCommand("delete",()=>{((l,c)=>{rS(l,c,!1).fold(()=>{l.selection.isEditable()&&(eu(l),qg(l))},Gn)})(a,i)}),a.addCommand("forwardDelete",()=>{((l,c)=>{rS(l,c,!0).fold(()=>{l.selection.isEditable()&&Cy(l)},Gn)})(a,i)})})(t,r),(a=>{a.on("NodeChange",()=>(i=>{const l=i.dom,c=i.selection,d=i.schema,u=d.getBlockElements(),m=c.getStart(),h=i.getBody();let f,b,p=null;const y=Nn(i);if(!m||!wt(m))return;const w=h.nodeName.toLowerCase();if(!d.isValidChild(w,y.toLowerCase())||((N,E,R)=>de(X0(F(R),F(E)),I=>gp(N,I.dom)))(u,h,m))return;if(h.firstChild===h.lastChild&&Ee(h.firstChild))return f=fp(i),f.appendChild(Pi().dom),h.replaceChild(f,h.firstChild),i.selection.setCursorLocation(f,0),void i.nodeChanged();let S=h.firstChild;for(;S;)if(wt(S)&&$t(d,S),DT(d,S)){if(PT(u,S)){b=S,S=S.nextSibling,l.remove(b);continue}if(!f){if(!p&&i.hasFocus()&&(p=uw(i.selection.getRng(),()=>document.createElement("span"))),!S.parentNode){S=null;break}f=fp(i),h.insertBefore(f,S)}b=S,S=S.nextSibling,f.appendChild(b)}else f=null,S=S.nextSibling;p&&(i.selection.setRng(mw(p)),i.nodeChanged())})(a))})(t),(a=>{var i;const l=a.dom,c=Nn(a),d=(i=__(a))!==null&&i!==void 0?i:"",u=(m,h)=>{if((p=>{if(X1(p)){const y=p.keyCode;return!Q1(p)&&(ht.metaKeyPressed(p)||p.altKey||y>=112&&y<=123||Xt(eT,y))}return!1})(m))return;const f=a.getBody(),b=!(p=>X1(p)&&!(Q1(p)||p.type==="keyup"&&p.keyCode===229))(m)&&((p,y,w)=>{if(p.isEmpty(y,void 0,{skipBogus:!1,includeZwsp:!0})){const S=y.firstElementChild;return!S||!p.getStyle(y.firstElementChild,"padding-left")&&!p.getStyle(y.firstElementChild,"padding-right")&&w===S.nodeName.toLowerCase()}return!1})(l,f,c);(l.getAttrib(f,Y1)!==""!==b||h)&&(l.setAttrib(f,Y1,b?d:null),((p,y)=>{p.dispatch("PlaceholderToggle",{state:y})})(a,b),a.on(b?"keydown":"keyup",u),a.off(b?"keyup":"keydown",u))};cn(d)&&a.on("init",m=>{u(m,!0),a.on("change SetContent ExecCommand",u),a.on("paste",h=>$o.setEditorTimeout(a,()=>u(h)))})})(t),aB(t);const s=(a=>{const i=a;return(l=>ee(l.plugins,"rtc").bind(c=>x.from(c.setup)))(a).fold(()=>(i.rtcInstance=y1(a),x.none()),l=>(i.rtcInstance=(()=>{const c=it(null),d=it("");return{init:{bindEvents:Dt},undoManager:{beforeChange:Dt,add:c,undo:c,redo:c,clear:Dt,reset:Dt,hasUndo:te,hasRedo:te,transact:c,ignore:Dt,extra:Dt},formatter:{match:te,matchAll:it([]),matchNode:it(void 0),canApply:te,closest:d,apply:Dt,remove:Dt,toggle:Dt,formatChanged:it({unbind:Dt})},editor:{getContent:d,setContent:it({content:"",html:""}),insertContent:it(""),addVisual:Dt},selection:{getContent:d},autocompleter:{addDecoration:Dt,removeDecoration:Dt},raw:{getModel:it(x.none())}}})(),x.some(()=>l().then(c=>(i.rtcInstance=(d=>{const u=S=>Re(S)?S:{},{init:m,undoManager:h,formatter:f,editor:b,selection:p,autocompleter:y,raw:w}=d;return{init:{bindEvents:m.bindEvents},undoManager:{beforeChange:h.beforeChange,add:h.add,undo:h.undo,redo:h.redo,clear:h.clear,reset:h.reset,hasUndo:h.hasUndo,hasRedo:h.hasRedo,transact:(S,N,E)=>h.transact(E),ignore:(S,N)=>h.ignore(N),extra:(S,N,E,R)=>h.extra(E,R)},formatter:{match:(S,N,E,R)=>f.match(S,u(N),R),matchAll:f.matchAll,matchNode:f.matchNode,canApply:S=>f.canApply(S),closest:S=>f.closest(S),apply:(S,N,E)=>f.apply(S,u(N)),remove:(S,N,E,R)=>f.remove(S,u(N)),toggle:(S,N,E)=>f.toggle(S,u(N)),formatChanged:(S,N,E,R,I)=>f.formatChanged(N,E,R,I)},editor:{getContent:S=>b.getContent(S),setContent:(S,N)=>({content:b.setContent(S,N),html:""}),insertContent:(S,N)=>(b.insertContent(S),""),addVisual:b.addVisual},selection:{getContent:(S,N)=>p.getContent(N)},autocompleter:{addDecoration:y.addDecoration,removeDecoration:y.removeDecoration},raw:{getModel:()=>x.some(w.getRawModel())}}})(c),c.rtc.isRemote)))))})(t);(a=>{const i=a.getDoc(),l=a.getBody();(u=>{u.dispatch("PreInit")})(a),X_(a)||(i.body.spellcheck=!1,nh.setAttrib(l,"spellcheck","false")),a.quirks=RB(a),(u=>{u.dispatch("PostRender")})(a);const c=k_(a);c!==void 0&&(l.dir=c);const d=Q_(a);d&&a.on("BeforeSetContent",u=>{st.each(d,m=>{u.content=u.content.replace(m,h=>"<!--mce:protected "+escape(h)+"-->")})}),a.on("SetContent",()=>{a.addVisual(a.getBody())}),a.on("compositionstart compositionend",u=>{a.composing=u.type==="compositionstart"})})(t),(a=>{const i=CN(a);vt(wN(a))||!tt(i)&&(l=>(c=>c.toLowerCase()==="gpl")(l)||(c=>c.length>=64&&c.length<=255)(l)?"VALID":"INVALID")(i)!=="INVALID"||console.warn("TinyMCE is running in evaluation mode. Provide a valid license key or add license_key: 'gpl' to the init config to agree to the open source license terms. Read more at https://www.tiny.cloud/license-key/")})(t),s.fold(()=>{const a=(i=>{let l=!1;const c=setTimeout(()=>{l||i.setProgressState(!0)},500);return()=>{clearTimeout(c),l=!0,i.setProgressState(!1)}})(t);Mx(t).then(()=>{sh(t),a()})},a=>{t.setProgressState(!0),Mx(t).then(()=>{a().then(i=>{t.setProgressState(!1),sh(t),C1(t)},i=>{t.notificationManager.open({type:"error",text:String(i)}),sh(t),C1(t)})})})},OB=ae,ah=ye.DOM,Ux=ye.DOM,zx=(t,e)=>({editorContainer:t,iframeContainer:e,api:{}}),$x=t=>{const e=t.getElement();return t.inline?zx(null):(n=>{const o=Ux.create("div");return Ux.insertAfter(o,n),zx(o,o)})(e)},BB=async t=>{t.dispatch("ScriptsLoaded"),(n=>{const o=st.trim(qb(n)),r=n.ui.registry.getAll().icons,s={...bu.get("default").icons,...bu.get(o).icons};re(s,(a,i)=>{Bt(r,i)||n.ui.registry.addIcon(i,a)})})(t),(n=>{const o=Ui(n);if(vt(o)){const r=li.get(o);n.theme=r(n,li.urls[o])||{},jt(n.theme.init)&&n.theme.init(n,li.urls[o]||n.documentBaseUrl.replace(/\/$/,""))}else n.theme={}})(t),(n=>{const o=Gm(n),r=Zi.get(o);n.model=r(n,Zi.urls[o])})(t),(n=>{const o=[];J(Rd(n),r=>{((s,a,i)=>{const l=Ji.get(i),c=Ji.urls[i]||s.documentBaseUrl.replace(/\/$/,"");if(i=st.trim(i),l&&st.inArray(a,i)===-1){if(s.plugins[i])return;try{const d=l(s,c)||{};s.plugins[i]=d,jt(d.init)&&(d.init(s,c),a.push(i))}catch(d){((u,m,h)=>{const f=Lr.translate(["Failed to initialize plugin: {0}",m]);Lb(u,"PluginLoadError",{message:f}),yu(f,h),vu(u,f)})(s,i,d)}}})(n,o,(s=>s.replace(/^\-/,""))(r))})})(t);const e=await(n=>{const o=n.getElement();return n.orgDisplay=o.style.display,vt(Ui(n))?(r=>{const s=r.theme.renderUI;return s?s():$x(r)})(n):jt(Ui(n))?(r=>{const s=r.getElement(),a=Ui(r)(r,s);return a.editorContainer.nodeType&&(a.editorContainer.id=a.editorContainer.id||r.id+"_parent"),a.iframeContainer&&a.iframeContainer.nodeType&&(a.iframeContainer.id=a.iframeContainer.id||r.id+"_iframecontainer"),a.height=a.iframeHeight?a.iframeHeight:s.offsetHeight,a})(n):$x(n)})(t);((n,o)=>{const r={show:x.from(o.show).getOr(Dt),hide:x.from(o.hide).getOr(Dt),isEnabled:x.from(o.isEnabled).getOr(ae),setEnabled:s=>{s&&(n.mode.get()==="readonly"||Hs(n))||x.from(o.setEnabled).each(a=>a(s))}};n.ui={...n.ui,...r}})(t,x.from(e.api).getOr({})),t.editorContainer=e.editorContainer,(n=>{n.contentCSS=n.contentCSS.concat((o=>z1(o,w_(o)))(n),(o=>z1(o,Gb(o)))(n))})(t),t.inline?Fx(t):((n,o)=>{((r,s)=>{const a=Kt.browser.isFirefox()?tv(r):"Rich Text Area",i=r.translate(a),l=se(F(r.getElement()),"tabindex").bind(Oo),c=((d,u,m,h)=>{const f=xe("iframe");return h.each(b=>et(f,"tabindex",b)),mt(f,m),mt(f,{id:d+"_ifr",frameBorder:"0",allowTransparency:"true",title:u}),Ue(f,"tox-edit-area__iframe"),f})(r.id,i,n_(r),l).dom;c.onload=()=>{c.onload=null,r.dispatch("load")},r.contentAreaContainer=s.iframeContainer,r.iframeElement=c,r.iframeHTML=(d=>{let u=o_(d)+"<html><head>";$b(d)!==d.documentBaseUrl&&(u+='<base href="'+d.documentBaseURI.getURI()+'" />'),u+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const m=r_(d),h=s_(d),f=d.translate(tv(d));return Hb(d)&&(u+='<meta http-equiv="Content-Security-Policy" content="'+Hb(d)+'" />'),u+=`</head><body id="${m}" class="mce-content-body ${h}" data-id="${d.id}" aria-label="${f}"><br></body></html>`,u})(r),ah.add(s.iframeContainer,c)})(n,o),o.editorContainer&&(o.editorContainer.style.display=n.orgDisplay,n.hidden=ah.isHidden(o.editorContainer)),n.getElement().style.display="none",ah.setAttrib(n.id,"aria-hidden","true"),n.getElement().style.visibility=n.orgVisibility,(r=>{const s=r.iframeElement,a=()=>{r.contentDocument=s.contentDocument,Fx(r)};if(pN(r)||Kt.browser.isFirefox()){const l=r.getDoc();l.open(),l.write(r.iframeHTML),l.close(),a()}else{const l=(i=F(s),od(i,"load",OB,()=>{l.unbind(),a()}));s.srcdoc=r.iframeHTML}var i})(n)})(t,{editorContainer:e.editorContainer,iframeContainer:e.iframeContainer})},gi=ye.DOM,Hx=t=>t.charAt(0)==="-",jx=(t,e,n)=>x.from(e).filter(o=>cn(o)&&!bu.has(o)).map(o=>({url:`${t.editorManager.baseURL}/icons/${o}/icons${n}.js`,name:x.some(o)})),LB=(t,e)=>{const n=Us.ScriptLoader,o=()=>{!t.removed&&(r=>{const s=Ui(r);return!vt(s)||q(li.get(s))})(t)&&(r=>{const s=Gm(r);return q(Zi.get(s))})(t)&&BB(t)};((r,s)=>{const a=Ui(r);if(vt(a)&&!Hx(a)&&!Bt(li.urls,a)){const i=A_(r),l=i?r.documentBaseURI.toAbsolute(i):`themes/${a}/theme${s}.js`;li.load(a,l).catch(()=>{((c,d,u)=>{_c(c,"ThemeLoadError",Nc("theme",d,u))})(r,l,a)})}})(t,e),((r,s)=>{const a=Gm(r);if(a!=="plugin"&&!Bt(Zi.urls,a)){const i=R_(r),l=vt(i)?r.documentBaseURI.toAbsolute(i):`models/${a}/model${s}.js`;Zi.load(a,l).catch(()=>{((c,d,u)=>{_c(c,"ModelLoadError",Nc("model",d,u))})(r,l,a)})}})(t,e),((r,s)=>{const a=Wb(s),i=y_(s);if(!Lr.hasCode(a)&&a!=="en"){const l=cn(i)?i:`${s.editorManager.baseURL}/langs/${a}.js`;r.add(l).catch(()=>{((c,d,u)=>{_c(c,"LanguageLoadError",Nc("language",d,u))})(s,l,a)})}})(n,t),((r,s,a)=>{const i=jx(s,"default",a),l=(c=>x.from(g_(c)).filter(cn).map(d=>({url:d,name:x.none()})))(s).orThunk(()=>jx(s,qb(s),""));J((c=>{const d=[],u=m=>{d.push(m)};for(let m=0;m<c.length;m++)c[m].each(u);return d})([i,l]),c=>{r.add(c.url).catch(()=>{((d,u,m)=>{_c(d,"IconsLoadError",Nc("icons",u,m))})(s,c.url,c.name.getOrUndefined())})})})(n,t,e),((r,s)=>{const a=(i,l)=>{Ji.load(i,l).catch(()=>{((c,d,u)=>{_c(c,"PluginLoadError",Nc("plugin",d,u))})(r,l,i)})};re(H_(r),(i,l)=>{a(l,i),r.options.set("plugins",Rd(r).concat(l))}),J(Rd(r),i=>{!(i=st.trim(i))||Ji.urls[i]||Hx(i)||a(i,`plugins/${i}/plugin${s}.js`)})})(t,e),n.loadQueue().then(o,o)},Vx=Ke().deviceType,qx=Vx.isPhone(),DB=Vx.isTablet(),Hc=t=>{if(Ht(t))return[];{const e=Qt(t)?t:t.split(/[ ,]/),n=qt(e,fn);return Ot(n,cn)}},PB=(t,e)=>{const n=(s=>{const a={},i={};return bs(s,(l,c)=>Xt(t,c),Jo(a),Jo(i)),{t:a,f:i}})(e);return o=n.t,r=n.f,{sections:it(o),options:it(r)};var o,r},ih=(t,e)=>Bt(t.sections(),e),IB=(t,e)=>({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:ee(t,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1,...e?{menubar:!1}:{}}),MB=(t,e)=>{var n;const o=(n=e.external_plugins)!==null&&n!==void 0?n:{};return t&&t.external_plugins?st.extend({},t.external_plugins,o):o},FB=(t,e,n,o,r)=>{var s;const a=t?{mobile:IB((s=r.mobile)!==null&&s!==void 0?s:{},e)}:{},i=PB(["mobile"],kp(a,r)),l=st.extend(n,o,i.options(),((c,d)=>c&&ih(d,"mobile"))(t,i)?((c,d,u={})=>{const m=c.sections(),h=ee(m,d).getOr({});return st.extend({},u,h)})(i,"mobile"):{},{external_plugins:MB(o,i.options())});return((c,d,u,m)=>{const h=Hc(u.forced_plugins),f=Hc(m.plugins),b=((w,S)=>ih(w,S)?w.sections()[S]:{})(d,"mobile"),p=((w,S,N,E)=>w&&ih(S,"mobile")?E:N)(c,d,f,b.plugins?Hc(b.plugins):f),y=((w,S)=>[...Hc(w),...Hc(S)])(h,p);return st.extend(m,{forced_plugins:h,plugins:y})})(t,i,o,l)},UB=t=>{(e=>{const n=o=>()=>{J("left,center,right,justify".split(","),r=>{o!==r&&e.formatter.remove("align"+r)}),o!=="none"&&(r=>{e.formatter.toggle(r,void 0),e.nodeChanged()})("align"+o)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})})(t),(e=>{const n=o=>()=>{const r=e.selection,s=r.isCollapsed()?[e.dom.getParent(r.getNode(),e.dom.isBlock)]:r.getSelectedBlocks();return de(s,a=>q(e.formatter.matchNode(a,o)))};e.editorCommands.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify")},"state")})(t)},zB=(t,e)=>{const n=t.selection,o=t.dom;return/^ | $/.test(e)?((r,s,a,i)=>{const l=F(r.getRoot());return a=pc(l,X.fromRangeStart(s),i)?a.replace(/^ /,"&nbsp;"):a.replace(/^&nbsp;/," "),hc(l,X.fromRangeEnd(s),i)?a.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):a.replace(/&nbsp;(<br( \/)?>)?$/," ")})(o,n.getRng(),e,t.schema):e},Qu=(t,e)=>{if(t.selection.isEditable()){const{content:n,details:o}=(r=>{if(typeof r!="string"){const s=st.extend({paste:r.paste,data:{paste:r.paste}},r);return{content:r.content,details:s}}return{content:r,details:{}}})(e);Lf(t,{...o,content:zB(t,n),format:"html",set:!1,selection:!0}).each(r=>{const s=((a,i,l)=>zf(a).editor.insertContent(i,l))(t,r.content,o);Df(t,s,r),t.addVisual()})}},$B={"font-size":"size","font-family":"face"},HB=j("font"),Wx=t=>(e,n)=>x.from(n).map(F).filter(on).bind(o=>((r,s,a)=>df(F(a),i=>(l=>Ei(l,r).orThunk(()=>HB(l)?ee($B,r).bind(c=>se(l,c)):x.none()))(i),i=>ne(F(s),i)))(t,e,o.dom).or(((r,s)=>x.from(ye.DOM.getStyle(s,r,!0)))(t,o.dom))).getOr(""),jB=Wx("font-size"),VB=qe(t=>t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),Wx("font-family")),qB=t=>An(t.getBody()).bind(e=>{const n=e.container();return x.from(rt(n)?n.parentNode:n)}),lh=(t,e)=>((n,o)=>(r=>x.from(r.selection.getRng()).bind(s=>{const a=r.getBody();return s.startContainer===a&&s.startOffset===0?x.none():x.from(r.selection.getStart(!0))}))(n).orThunk(ft(qB,n)).map(F).filter(on).bind(o))(t,Eo(x.some,e)),Kx=(t,e)=>{if(/^[0-9.]+$/.test(e)){const n=parseInt(e,10);if(n>=1&&n<=7){const o=(s=>st.explode(s.options.get("font_size_style_values")))(t),r=(s=>st.explode(s.options.get("font_size_classes")))(t);return r.length>0?r[n-1]||e:o[n-1]||e}return e}return e},WB=t=>{const e=t.split(/\s*,\s*/);return qt(e,n=>n.indexOf(" ")===-1||ie(n,'"')||ie(n,"'")?n:`'${n}'`).join(",")},Gx=(t,e)=>{if(t.mode.isReadOnly())return;const n=t.dom,o=t.selection.getRng(),r=e?t.selection.getStart():t.selection.getEnd(),s=e?o.startContainer:o.endContainer,a=Mc(n,s);if(!a||!a.isContentEditable)return;const i=e?hn:Co,l=Nn(t);((c,d,u,m)=>{const h=c.dom,f=p=>h.isBlock(p)&&p.parentElement===u,b=f(d)?d:h.getParent(m,f,u);return x.from(b).map(F)})(t,r,a,s).each(c=>{const d=uk(t,s,c.dom,a,!1,l);i(c,F(d)),t.selection.setCursorLocation(d,0),t.dispatch("NewBlock",{newBlock:d}),Ic(t,"insertParagraph")})},KB=t=>{UB(t),(e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":n=>{const o=e.getDoc();let r;try{o.execCommand(n)}catch{r=!0}if(n!=="paste"||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){let s=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Kt.os.isMacOS()||Kt.os.isiOS())&&(s=s.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:s,type:"error"})}}})})(t),(e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})})(t),(e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(n,o,r)=>{let s=0;e.dom.getParent(e.selection.getNode(),a=>!wt(a)||s++!==r||(e.selection.select(a),!1),e.getBody())},mceSelectNode:(n,o,r)=>{e.selection.select(r)},selectAll:()=>{const n=e.dom.getParent(e.selection.getStart(),ro);if(n){const o=e.dom.createRng();o.selectNodeContents(n),e.selection.setRng(o)}}})})(t),(e=>{e.editorCommands.addCommands({mceCleanup:()=>{const n=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(n)},insertImage:(n,o,r)=>{Qu(e,e.dom.createHTML("img",{src:r}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(n,o,r)=>{Qu(e,e.dom.encode(r))},insertHTML:(n,o,r)=>{Qu(e,r)},mceInsertContent:(n,o,r)=>{Qu(e,r)},mceSetContent:(n,o,r)=>{e.setContent(r)},mceReplaceContent:(n,o,r)=>{e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(eN(e))}})})(t),(e=>{const n=(o,r,s)=>{if(e.mode.isReadOnly())return;const a=vt(s)?{href:s}:s,i=e.dom.getParent(e.selection.getNode(),"a");Re(a)&&vt(a.href)&&(a.href=a.href.replace(/ /g,"%20"),i&&a.href||e.formatter.remove("link"),a.href&&e.formatter.apply("link",a,i))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){const o=e.dom.getParent(e.selection.getStart(),"a");return void(o&&e.dom.remove(o,!0))}e.formatter.remove("link")}},mceInsertLink:n,createLink:n})})(t),(e=>{e.editorCommands.addCommands({Indent:()=>{(n=>{eS(n,"indent")})(e)},Outdent:()=>{nS(e)}}),e.editorCommands.addCommands({Outdent:()=>Zw(e)},"state")})(t),(e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{(n=>{Gx(n,!0)})(e)},InsertNewBlockAfter:()=>{(n=>{Gx(n,!1)})(e)}})})(t),(e=>{e.editorCommands.addCommands({insertParagraph:()=>{$u(pk,e)},mceInsertNewLine:(n,o,r)=>{Sk(e,r)},InsertLineBreak:(n,o,r)=>{$u(vk,e)}})})(t),(e=>{(n=>{const o=(r,s)=>{n.formatter.toggle(r,s),n.nodeChanged()};n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>{o(r)},"ForeColor,HiliteColor":(r,s,a)=>{o(r,{value:a})},BackColor:(r,s,a)=>{o("hilitecolor",{value:a})},FontName:(r,s,a)=>{((i,l)=>{const c=Kx(i,l);i.formatter.toggle("fontname",{value:WB(c)}),i.nodeChanged()})(n,a)},FontSize:(r,s,a)=>{((i,l)=>{i.formatter.toggle("fontsize",{value:Kx(i,l)}),i.nodeChanged()})(n,a)},LineHeight:(r,s,a)=>{((i,l)=>{i.formatter.toggle("lineheight",{value:String(l)}),i.nodeChanged()})(n,a)},Lang:(r,s,a)=>{var i;o(r,{value:a.code,customValue:(i=a.customCode)!==null&&i!==void 0?i:null})},RemoveFormat:r=>{n.formatter.remove(r)},mceBlockQuote:()=>{o("blockquote")},FormatBlock:(r,s,a)=>{o(vt(a)?a:"p")},mceToggleFormat:(r,s,a)=>{o(a)}})})(e),(n=>{const o=r=>n.formatter.match(r);n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>o(r),mceBlockQuote:()=>o("blockquote")},"state"),n.editorCommands.addQueryValueHandler("FontName",()=>(r=>lh(r,s=>VB(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("FontSize",()=>(r=>lh(r,s=>jB(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("LineHeight",()=>(r=>lh(r,s=>{const a=F(r.getBody());return df(s,l=>Ei(l,"line-height"),ft(ne,a)).getOrThunk(()=>{const l=parseFloat(lr(s,"line-height")),c=parseFloat(lr(s,"font-size"));return String(l/c)})}).getOr(""))(n))})(e)})(t),(e=>{e.editorCommands.addCommands({mceRemoveNode:(n,o,r)=>{const s=r??e.selection.getNode();if(s!==e.getBody()){const a=e.selection.getBookmark();e.dom.remove(s,!0),e.selection.moveToBookmark(a)}},mcePrint:()=>{e.getWin().print()},mceFocus:(n,o,r)=>{((s,a)=>{s.removed||(a?_g(s):(i=>{const l=i.selection,c=i.getBody();let d=l.getRng();i.quirks.refreshContentEditable();const u=h=>{wg(h).each(f=>{h.selection.setRng(f),d=f})};!Yi(i)&&i.hasEditableRoot()&&u(i);const m=((h,f)=>h.dom.getParent(f,b=>h.dom.getContentEditable(b)==="true"))(i,l.getNode());if(m&&i.dom.isChildOf(m,c))return((h,f)=>h.dom.getParent(f,b=>h.dom.getContentEditable(b)==="false")!==null)(i,m)||qd(c),qd(m),i.hasEditableRoot()||u(i),l0(i,d),void _g(i);i.inline||(Kt.browser.isOpera()||qd(c),i.getWin().focus()),(Kt.browser.isFirefox()||i.inline)&&(qd(c),l0(i,d)),_g(i)})(s))})(e,r===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})})(t)},GB=["toggleview"],Yx=t=>Xt(GB,t.toLowerCase());class Xx{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,n=!1,o,r){const s=this.editor,a=e.toLowerCase(),i=r?.skip_focus;if(s.removed||(a!=="mcefocus"&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)||i?(c=>{wg(c).each(d=>c.selection.setRng(d))})(s):s.focus()),s.dispatch("BeforeExecCommand",{command:e,ui:n,value:o}).isDefaultPrevented()))return!1;const l=this.commands.exec[a];return!!jt(l)&&(l(a,n,o),s.dispatch("ExecCommand",{command:e,ui:n,value:o}),!0)}queryCommandState(e){if(!Yx(e)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=e.toLowerCase(),o=this.commands.state[n];return!!jt(o)&&o(n)}queryCommandValue(e){if(!Yx(e)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=e.toLowerCase(),o=this.commands.value[n];return jt(o)?o(n):""}addCommands(e,n="exec"){const o=this.commands;re(e,(r,s)=>{J(s.toLowerCase().split(","),a=>{o[n][a]=r})})}addCommand(e,n,o){const r=e.toLowerCase();this.commands.exec[r]=(s,a,i)=>n.call(o??this.editor,a,i)}queryCommandSupported(e){const n=e.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(e,n,o){this.commands.state[e.toLowerCase()]=()=>n.call(o??this.editor)}addQueryValueHandler(e,n,o){this.commands.value[e.toLowerCase()]=()=>n.call(o??this.editor)}}const YB=st.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class ch{static isNative(e){return!!YB[e.toLowerCase()]}constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||te}fire(e,n){return this.dispatch(e,n)}dispatch(e,n){const o=e.toLowerCase(),r=xm(o,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);const s=this.bindings[o];if(s)for(let a=0,i=s.length;a<i;a++){const l=s[a];if(!l.removed){if(l.once&&this.off(o,l.func),r.isImmediatePropagationStopped())return r;if(l.func.call(this.scope,r)===!1)return r.preventDefault(),r}}return r}on(e,n,o,r){if(n===!1&&(n=te),n){const s={func:n,removed:!1};r&&st.extend(s,r);const a=e.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),c=o?[s,...c]:[...c,s],this.bindings[l]=c}}return this}off(e,n){if(e){const o=e.toLowerCase().split(" ");let r=o.length;for(;r--;){const s=o[r];let a=this.bindings[s];if(!s)return re(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(n){const i=Yo(a,l=>l.func===n);a=i.fail,this.bindings[s]=a,J(i.pass,l=>{l.removed=!0})}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[s])}}}else re(this.bindings,(o,r)=>{this.toggleEvent(r,!1)}),this.bindings={};return this}once(e,n,o){return this.on(e,n,o,{once:!0})}has(e){e=e.toLowerCase();const n=this.bindings[e];return!(!n||n.length===0)}}const jc=t=>(t._eventDispatcher||(t._eventDispatcher=new ch({scope:t,toggleEvent:(e,n)=>{ch.isNative(e)&&t.toggleNativeEvent&&t.toggleNativeEvent(e,n)}})),t._eventDispatcher),dh={fire(t,e,n){return this.dispatch(t,e,n)},dispatch(t,e,n){const o=this;if(o.removed&&t!=="remove"&&t!=="detach")return xm(t.toLowerCase(),e??{},o);const r=jc(o).dispatch(t,e);if(n!==!1&&o.parent){let s=o.parent();for(;s&&!r.isPropagationStopped();)s.dispatch(t,r,!1),s=s.parent?s.parent():void 0}return r},on(t,e,n){return jc(this).on(t,e,n)},off(t,e){return jc(this).off(t,e)},once(t,e){return jc(this).once(t,e)},hasEventListeners(t){return jc(this).has(t)}},Zu=ye.DOM;let fi;const Ju=(t,e)=>{if(e==="selectionchange")return t.getDoc();if(!t.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(e))return t.getDoc().documentElement;const n=Xb(t);return n?(t.eventRoot||(t.eventRoot=Zu.select(n)[0]),t.eventRoot):t.getBody()},Qx=(t,e,n)=>{(o=>!o.hidden&&!Hs(o))(t)?t.dispatch(e,n):Hs(t)&&((o,r)=>{if((s=>s.type==="click")(r)&&!ht.metaKeyPressed(r)){const s=F(r.target);((a,i)=>Ts(i,"a",l=>ne(l,F(a.getBody()))).bind(l=>se(l,"href")))(o,s).each(a=>{if(r.preventDefault(),/^#/.test(a)){const i=o.dom.select(`${a},[name="${qr(a,"#")}"]`);i.length&&o.selection.scrollIntoView(i[0],!0)}else window.open(a,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else(s=>Xt(WR,s.type))(r)&&o.dispatch(r.type,r)})(t,n)},Zx=(t,e)=>{if(t.delegates||(t.delegates={}),t.delegates[e]||t.removed)return;const n=Ju(t,e);if(Xb(t)){if(fi||(fi={},t.editorManager.on("removeEditor",()=>{t.editorManager.activeEditor||fi&&(re(fi,(r,s)=>{t.dom.unbind(Ju(t,s))}),fi=null)})),fi[e])return;const o=r=>{const s=r.target,a=t.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===s||Zu.isChildOf(s,l))&&Qx(a[i],e,r)}};fi[e]=o,Zu.bind(n,e,o)}else{const o=r=>{Qx(t,e,r)};Zu.bind(n,e,o),t.delegates[e]=o}},Jx={...dh,bindPendingEventDelegates(){const t=this;st.each(t._pendingNativeEvents,e=>{Zx(t,e)})},toggleNativeEvent(t,e){const n=this;t!=="focus"&&t!=="blur"&&(n.removed||(e?n.initialized?Zx(n,t):n._pendingNativeEvents?n._pendingNativeEvents.push(t):n._pendingNativeEvents=[t]:n.initialized&&n.delegates&&(n.dom.unbind(Ju(n,t),t,n.delegates[t]),delete n.delegates[t])))},unbindAllNativeEvents(){const t=this,e=t.getBody(),n=t.dom;t.delegates&&(re(t.delegates,(o,r)=>{t.dom.unbind(Ju(t,r),r,o)}),delete t.delegates),!t.inline&&e&&n&&(e.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(e),n.unbind(t.getContainer()))}},XB=t=>vt(t)?{value:t.split(/[ ,]/),valid:!0}:$e(t,vt)?{value:t,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},tE=(t,e)=>t+(rr(e.message)?"":`. ${e.message}`),eE=t=>t.valid,uh=(t,e,n="")=>{const o=e(t);return Sn(o)?o?{value:t,valid:!0}:{valid:!1,message:n}:o},Vc=t=>t.readonly,QB=["design","readonly"],nE=(t,e,n,o)=>{const r=n[e.get()],s=n[o];try{s.activate()}catch(a){return void console.error(`problem while activating editor mode ${o}:`,a)}r.deactivate(),r.editorReadOnly!==s.editorReadOnly&&((a,i)=>{const l=F(a.getBody());i?(a.readonly=!0,a.hasEditableRoot()&&(l.dom.contentEditable="true"),I1(a)):(a.readonly=!1,M1(a))})(t,s.editorReadOnly),e.set(o),((a,i)=>{a.dispatch("SwitchMode",{mode:i})})(t,o)},ZB=t=>{const e=Ye("design"),n=Ye({design:{activate:Dt,deactivate:Dt,editorReadOnly:!1},readonly:{activate:Dt,deactivate:Dt,editorReadOnly:!0}});return(o=>{o.on("beforeinput paste cut dragend dragover draggesture dragdrop drop drag",r=>{Vc(o)&&r.preventDefault()}),o.on("BeforeExecCommand",r=>{r.command!=="Undo"&&r.command!=="Redo"||!Vc(o)||r.preventDefault()}),o.on("input",r=>{if(!r.isComposing&&Vc(o)){const s=o.undoManager.add();q(s)&&o.undoManager.undo()}}),o.on("compositionend",()=>{if(Vc(o)){const r=o.undoManager.add();q(r)&&o.undoManager.undo()}})})(t),(o=>{(r=>{r.serializer?U1(r):r.on("PreInit",()=>{U1(r)})})(o),(r=>{r.on("ShowCaret ObjectSelected",s=>{Hs(r)&&s.preventDefault()}),r.on("DisabledStateChange",s=>{s.isDefaultPrevented()||F1(r,s.state)})})(o)})(t),{isReadOnly:()=>Vc(t),set:o=>((r,s,a,i)=>{if(!(i===a.get()||r.initialized&&Hs(r))){if(!Bt(s,i))throw new Error(`Editor mode '${i}' is invalid`);r.initialized?nE(r,a,s,i):r.on("init",()=>nE(r,a,s,i))}})(t,n.get(),e,o),get:()=>e.get(),register:(o,r)=>{n.set(((s,a,i)=>{if(Xt(QB,a))throw new Error(`Cannot override default mode ${a}`);return{...s,[a]:{...i,deactivate:()=>{try{i.deactivate()}catch(l){console.error(`problem while deactivating editor mode ${a}:`,l)}}}}})(n.get(),o,r))}}},mh=st.each,gh=st.explode,JB={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},oE=st.makeMap("alt,ctrl,shift,meta,access"),tL=t=>{const e={},n=Kt.os.isMacOS()||Kt.os.isiOS();mh(gh(t.toLowerCase(),"+"),s=>{(a=>a in oE)(s)?e[s]=!0:/^[0-9]{2,}$/.test(s)?e.keyCode=parseInt(s,10):(e.charCode=s.charCodeAt(0),e.keyCode=JB[s]||s.toUpperCase().charCodeAt(0))});const o=[e.keyCode];let r;for(r in oE)e[r]?o.push(r):e[r]=!1;return e.id=o.join(","),e.access&&(e.alt=!0,n?e.ctrl=!0:e.shift=!0),e.meta&&(n?e.meta=!0:(e.ctrl=!0,e.meta=!1)),e};class rE{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;const n=this;e.on("keyup keypress keydown",o=>{!n.hasModifier(o)&&!n.isFunctionKey(o)||o.isDefaultPrevented()||(mh(n.shortcuts,r=>{n.matchShortcut(o,r)&&(n.pendingPatterns=r.subpatterns.slice(0),o.type==="keydown"&&n.executeShortcutAction(r))}),n.matchShortcut(o,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&o.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(e,n,o,r){const s=this,a=s.normalizeCommandFunc(o);return mh(gh(st.trim(e)),i=>{const l=s.createShortcut(i,n,a,r);s.shortcuts[l.id]=l}),!0}remove(e){const n=this.createShortcut(e);return!!this.shortcuts[n.id]&&(delete this.shortcuts[n.id],!0)}normalizeCommandFunc(e){const n=this,o=e;return typeof o=="string"?()=>{n.editor.execCommand(o,!1,null)}:st.isArray(o)?()=>{n.editor.execCommand(o[0],o[1],o[2])}:o}createShortcut(e,n,o,r){const s=st.map(gh(e,">"),tL);return s[s.length-1]=st.extend(s[s.length-1],{func:o,scope:r||this.editor}),st.extend(s[0],{desc:this.editor.translate(n),subpatterns:s.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return e.type==="keydown"&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,n){return!!n&&n.ctrl===e.ctrlKey&&n.meta===e.metaKey&&n.alt===e.altKey&&n.shift===e.shiftKey&&!!(e.keyCode===n.keyCode||e.charCode&&e.charCode===n.charCode)&&(e.preventDefault(),!0)}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}}const eL=()=>{const t=(()=>{const e={},n={},o={},r={},s={},a={},i={},l={},c={},d=(m,h)=>(f,b)=>{m[f.toLowerCase()]={...b,type:h}};return{addButton:d(e,"button"),addGroupToolbarButton:d(e,"grouptoolbarbutton"),addToggleButton:d(e,"togglebutton"),addMenuButton:d(e,"menubutton"),addSplitButton:d(e,"splitbutton"),addMenuItem:d(n,"menuitem"),addNestedMenuItem:d(n,"nestedmenuitem"),addToggleMenuItem:d(n,"togglemenuitem"),addAutocompleter:d(o,"autocompleter"),addContextMenu:d(s,"contextmenu"),addContextToolbar:d(a,"contexttoolbar"),addContextForm:(u=a,(m,h)=>{u[m.toLowerCase()]={type:"contextform",...h}}),addSidebar:d(l,"sidebar"),addView:d(c,"views"),addIcon:(m,h)=>r[m.toLowerCase()]=h,addContext:(m,h)=>i[m.toLowerCase()]=h,getAll:()=>({buttons:e,menuItems:n,icons:r,popups:o,contextMenus:s,contextToolbars:a,sidebars:l,views:c,contexts:i})};var u})();return{addAutocompleter:t.addAutocompleter,addButton:t.addButton,addContextForm:t.addContextForm,addContextMenu:t.addContextMenu,addContextToolbar:t.addContextToolbar,addIcon:t.addIcon,addMenuButton:t.addMenuButton,addMenuItem:t.addMenuItem,addNestedMenuItem:t.addNestedMenuItem,addSidebar:t.addSidebar,addSplitButton:t.addSplitButton,addToggleButton:t.addToggleButton,addGroupToolbarButton:t.addGroupToolbarButton,addToggleMenuItem:t.addToggleMenuItem,addView:t.addView,addContext:t.addContext,getAll:t.getAll}},pi=ye.DOM,sE=st.extend,nL=st.each;class tm{constructor(e,n,o){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=o,this.documentBaseUrl=o.documentBaseURL,sE(this,Jx);const r=this;this.id=e,this.hidden=!1;const s=((h,f)=>{const b=tO(f);return FB(qx||DB,qx,b,h,b)})(o.defaultOptions,n);this.options=((h,f,b=f)=>{const p={},y={},w=(N,E,R)=>{const I=uh(E,R);return eE(I)?(y[N]=I.value,!0):(console.warn(tE(`Invalid value passed for the ${N} option`,I)),!1)},S=N=>Bt(p,N);return{register:(N,E)=>{const R=(D=>vt(D.processor))(E)?(D=>{const $=(()=>{switch(D){case"array":return Qt;case"boolean":return Sn;case"function":return jt;case"number":return Ce;case"object":return Re;case"string":return vt;case"string[]":return XB;case"object[]":return W=>$e(W,Re);case"regexp":return W=>wn(W,RegExp);default:return ae}})();return W=>uh(W,$,`The value must be a ${D}.`)})(E.processor):E.processor,I=((D,$,W)=>{if(!tt($)){const B=uh($,W);if(eE(B))return B.value;console.error(tE(`Invalid default value passed for the "${D}" option`,B))}})(N,E.default,R);p[N]={...E,default:I,processor:R},ee(y,N).orThunk(()=>ee(f,N)).each(D=>w(N,D,R))},isRegistered:S,get:N=>ee(y,N).orThunk(()=>ee(p,N).map(E=>E.default)).getOrUndefined(),set:(N,E)=>{if(S(N)){const R=p[N];return R.immutable?(console.error(`"${N}" is an immutable option and cannot be updated`),!1):w(N,E,R.processor)}return console.warn(`"${N}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:N=>{const E=S(N);return E&&delete y[N],E},isSet:N=>Bt(y,N),debug:()=>{try{console.log(JSON.parse(JSON.stringify(b,(N,E)=>Sn(E)||Ce(E)||vt(E)||Le(E)||Qt(E)||Hn(E)?E:Object.prototype.toString.call(E))))}catch(N){console.error(N)}}}})(0,s,n),(h=>{const f=h.options.register;f("id",{processor:"string",default:h.id}),f("selector",{processor:"string"}),f("target",{processor:"object"}),f("suffix",{processor:"string"}),f("cache_suffix",{processor:"string"}),f("base_url",{processor:"string"}),f("referrer_policy",{processor:"string",default:""}),f("language_load",{processor:"boolean",default:!0}),f("inline",{processor:"boolean",default:!1}),f("iframe_attrs",{processor:"object",default:{}}),f("doctype",{processor:"string",default:"<!DOCTYPE html>"}),f("document_base_url",{processor:"string",default:h.documentBaseUrl}),f("body_id",{processor:zb(h,"tinymce"),default:"tinymce"}),f("body_class",{processor:zb(h),default:""}),f("content_security_policy",{processor:"string",default:""}),f("br_in_pre",{processor:"boolean",default:!0}),f("forced_root_block",{processor:b=>{const p=vt(b)&&cn(b);return p?{value:b,valid:p}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),f("forced_root_block_attrs",{processor:"object",default:{}}),f("newline_behavior",{processor:b=>{const p=Xt(["block","linebreak","invert","default"],b);return p?{value:b,valid:p}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),f("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),f("no_newline_selector",{processor:"string",default:""}),f("keep_styles",{processor:"boolean",default:!0}),f("end_container_on_empty_block",{processor:b=>Sn(b)||vt(b)?{valid:!0,value:b}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),f("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),f("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),f("font_size_classes",{processor:"string",default:""}),f("automatic_uploads",{processor:"boolean",default:!0}),f("images_reuse_filename",{processor:"boolean",default:!1}),f("images_replace_blob_uris",{processor:"boolean",default:!0}),f("icons",{processor:"string",default:""}),f("icons_url",{processor:"string",default:""}),f("images_upload_url",{processor:"string",default:""}),f("images_upload_base_path",{processor:"string",default:""}),f("images_upload_credentials",{processor:"boolean",default:!1}),f("images_upload_handler",{processor:"function"}),f("language",{processor:"string",default:"en"}),f("language_url",{processor:"string",default:""}),f("entity_encoding",{processor:"string",default:"named"}),f("indent",{processor:"boolean",default:!0}),f("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),f("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),f("indent_use_margin",{processor:"boolean",default:!1}),f("indentation",{processor:"string",default:"40px"}),f("content_css",{processor:b=>{const p=b===!1||vt(b)||$e(b,vt);return p?vt(b)?{value:qt(b.split(","),fn),valid:p}:Qt(b)?{value:b,valid:p}:b===!1?{value:[],valid:p}:{value:b,valid:p}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Ym(h)?[]:["default"]}),f("content_style",{processor:"string"}),f("content_css_cors",{processor:"boolean",default:!1}),f("font_css",{processor:b=>{const p=vt(b)||$e(b,vt);return p?{value:Qt(b)?b:qt(b.split(","),fn),valid:p}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),f("inline_boundaries",{processor:"boolean",default:!0}),f("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),f("object_resizing",{processor:b=>{const p=Sn(b)||vt(b);return p?b===!1||Wm.isiPhone()||Wm.isiPad()?{value:"",valid:p}:{value:b===!0?"table,img,figure.image,div,video,iframe":b,valid:p}:{valid:!1,message:"Must be boolean or a string"}},default:!t_}),f("resize_img_proportional",{processor:"boolean",default:!0}),f("event_root",{processor:"string"}),f("service_message",{processor:"string"}),f("theme",{processor:b=>b===!1||vt(b)||jt(b),default:"silver"}),f("theme_url",{processor:"string"}),f("formats",{processor:"object"}),f("format_empty_lines",{processor:"boolean",default:!1}),f("format_noneditable_selector",{processor:"string",default:""}),f("preview_styles",{processor:b=>{const p=b===!1||vt(b);return p?{value:b===!1?"":b,valid:p}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),f("custom_ui_selector",{processor:"string",default:""}),f("hidden_input",{processor:"boolean",default:!0}),f("submit_patch",{processor:"boolean",default:!0}),f("encoding",{processor:"string"}),f("add_form_submit_trigger",{processor:"boolean",default:!0}),f("add_unload_trigger",{processor:"boolean",default:!0}),f("custom_undo_redo_levels",{processor:"number",default:0}),f("disable_nodechange",{processor:"boolean",default:!1}),f("disabled",{processor:b=>Sn(b)?(h.initialized&&Od(h)!==b&&Promise.resolve().then(()=>{((p,y)=>{p.dispatch("DisabledStateChange",{state:y})})(h,b)}),{valid:!0,value:b}):{valid:!1,message:"The value must be a boolean."},default:!1}),f("readonly",{processor:"boolean",default:!1}),f("editable_root",{processor:"boolean",default:!0}),f("plugins",{processor:"string[]",default:[]}),f("external_plugins",{processor:"object"}),f("forced_plugins",{processor:"string[]"}),f("model",{processor:"string",default:h.hasPlugin("rtc")?"plugin":"dom"}),f("model_url",{processor:"string"}),f("block_unsupported_drop",{processor:"boolean",default:!0}),f("visual",{processor:"boolean",default:!0}),f("visual_table_class",{processor:"string",default:"mce-item-table"}),f("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),f("iframe_aria_text",{processor:"string",default:"Rich Text Area".concat(h.hasPlugin("help")?". Press ALT-0 for help.":"")}),f("setup",{processor:"function"}),f("init_instance_callback",{processor:"function"}),f("url_converter",{processor:"function",default:h.convertURL}),f("url_converter_scope",{processor:"object",default:h}),f("urlconverter_callback",{processor:"function"}),f("allow_conditional_comments",{processor:"boolean",default:!1}),f("allow_html_data_urls",{processor:"boolean",default:!1}),f("allow_svg_data_urls",{processor:"boolean"}),f("allow_html_in_named_anchor",{processor:"boolean",default:!1}),f("allow_script_urls",{processor:"boolean",default:!1}),f("allow_unsafe_link_target",{processor:"boolean",default:!1}),f("allow_mathml_annotation_encodings",{processor:b=>{const p=$e(b,vt);return p?{value:b,valid:p}:{valid:!1,message:"Must be an array of strings."}},default:[]}),f("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),f("fix_list_elements",{processor:"boolean",default:!1}),f("preserve_cdata",{processor:"boolean",default:!1}),f("remove_trailing_brs",{processor:"boolean",default:!0}),f("pad_empty_with_br",{processor:"boolean",default:!1}),f("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),f("element_format",{processor:"string",default:"html"}),f("entities",{processor:"string"}),f("schema",{processor:"string",default:"html5"}),f("convert_urls",{processor:"boolean",default:!0}),f("relative_urls",{processor:"boolean",default:!0}),f("remove_script_host",{processor:"boolean",default:!0}),f("custom_elements",{processor:Ad}),f("extended_valid_elements",{processor:"string"}),f("invalid_elements",{processor:"string"}),f("invalid_styles",{processor:Ad}),f("valid_children",{processor:"string"}),f("valid_classes",{processor:Ad}),f("valid_elements",{processor:"string"}),f("valid_styles",{processor:Ad}),f("verify_html",{processor:"boolean",default:!0}),f("auto_focus",{processor:b=>vt(b)||b===!0}),f("browser_spellcheck",{processor:"boolean",default:!1}),f("protect",{processor:"array"}),f("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),f("deprecation_warnings",{processor:"boolean",default:!0}),f("a11y_advanced_options",{processor:"boolean",default:!1}),f("api_key",{processor:"string"}),f("license_key",{processor:"string"}),f("paste_block_drop",{processor:"boolean",default:!1}),f("paste_data_images",{processor:"boolean",default:!0}),f("paste_preprocess",{processor:"function"}),f("paste_postprocess",{processor:"function"}),f("paste_webkit_styles",{processor:"string",default:"none"}),f("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),f("paste_merge_formats",{processor:"boolean",default:!0}),f("smart_paste",{processor:"boolean",default:!0}),f("paste_as_text",{processor:"boolean",default:!1}),f("paste_tab_spaces",{processor:"number",default:4}),f("text_patterns",{processor:b=>$e(b,Re)||b===!1?{value:Bb(b===!1?[]:b),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1",trigger:"space"},{start:"##",format:"h2",trigger:"space"},{start:"###",format:"h3",trigger:"space"},{start:"####",format:"h4",trigger:"space"},{start:"#####",format:"h5",trigger:"space"},{start:"######",format:"h6",trigger:"space"},{start:"1.",cmd:"InsertOrderedList",trigger:"space"},{start:"*",cmd:"InsertUnorderedList",trigger:"space"},{start:"-",cmd:"InsertUnorderedList",trigger:"space"},{start:">",cmd:"mceBlockQuote",trigger:"space"},{start:"---",cmd:"InsertHorizontalRule",trigger:"space"}]}),f("text_patterns_lookup",{processor:b=>{return jt(b)?{value:(p=b,y=>{const w=p(y);return Bb(w)}),valid:!0}:{valid:!1,message:"Must be a single function"};var p},default:b=>[]}),f("noneditable_class",{processor:"string",default:"mceNonEditable"}),f("editable_class",{processor:"string",default:"mceEditable"}),f("noneditable_regexp",{processor:b=>$e(b,Ub)?{value:b,valid:!0}:Ub(b)?{value:[b],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),f("table_tab_navigation",{processor:"boolean",default:!0}),f("highlight_on_focus",{processor:"boolean",default:!0}),f("xss_sanitization",{processor:"boolean",default:!0}),f("details_initial_state",{processor:b=>{const p=Xt(["inherited","collapsed","expanded"],b);return p?{value:b,valid:p}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),f("details_serialized_state",{processor:b=>{const p=Xt(["inherited","collapsed","expanded"],b);return p?{value:b,valid:p}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),f("init_content_sync",{processor:"boolean",default:!1}),f("newdocument_content",{processor:"string",default:""}),f("sandbox_iframes",{processor:"boolean",default:!0}),f("sandbox_iframes_exclusions",{processor:"string[]",default:["youtube.com","youtu.be","vimeo.com","player.vimeo.com","dailymotion.com","embed.music.apple.com","open.spotify.com","giphy.com","dai.ly","codepen.io"]}),f("convert_unsafe_embeds",{processor:"boolean",default:!0}),h.on("ScriptsLoaded",()=>{f("directionality",{processor:"string",default:Lr.isRtl()?"rtl":void 0}),f("placeholder",{processor:"string",default:e_.getAttrib(h.getElement(),"placeholder")})})})(r);const a=this.options.get;a("deprecation_warnings")&&((h,f)=>{((b,p)=>{const y=MR(b),w=UR(p),S=w.length>0,N=y.length>0,E=p.theme==="mobile";if(S||N||E){const R=`
- `,I=E?`

Themes:${R}mobile`:"",D=S?`

Plugins:${R}${w.join(R)}`:"",$=N?`

Options:${R}${y.join(R)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 7.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/7/migration-from-6x/ for more information."+I+D+$)}})(h,f),((b,p)=>{const y=FR(b),w=zR(p),S=w.length>0,N=y.length>0;if(S||N){const E=`
- `,R=S?`

Plugins:${E}${w.map($R).join(E)}`:"",I=N?`

Options:${E}${y.join(E)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+R+I)}})(h,f)})(n,s);const i=a("suffix");i&&(o.suffix=i),this.suffix=o.suffix;const l=a("base_url");l&&o._setBaseUrl(l),this.baseUri=o.baseURI;const c=Km(r);c&&(Us.ScriptLoader._setReferrerPolicy(c),ye.DOM.styleSheetLoader._setReferrerPolicy(c));const d=Zb(r);q(d)&&ye.DOM.styleSheetLoader._setContentCssCors(d),Mn.languageLoad=a("language_load"),Mn.baseURL=o.baseURL,this.setDirty(!1),this.documentBaseURI=new pr($b(r),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Ym(r),this.hasVisual=V_(r),this.shortcuts=new rE(this),this.editorCommands=new Xx(this),KB(this);const u=a("cache_suffix");u&&(Kt.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:eL(),styleSheetLoader:void 0,show:Dt,hide:Dt,setEnabled:Dt,isEnabled:ae},this.mode=ZB(r),o.dispatch("SetupEditor",{editor:this});const m=W_(r);jt(m)&&m.call(r,r)}render(){(e=>{const n=e.id;Lr.setCode(Wb(e));const o=()=>{gi.unbind(window,"ready",o),e.render()};if(!ja.Event.domLoaded)return void gi.bind(window,"ready",o);if(!e.getElement())return;const r=F(e.getElement()),s=A(r);e.on("remove",()=>{mn(r.dom.attributes,i=>C(r,i.name)),mt(r,s)}),e.ui.styleSheetLoader=((i,l)=>yh.forElement(i,{contentCssCors:Zb(l),referrerPolicy:Km(l)}))(r,e),Ym(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const a=e.getElement().form||gi.getParent(n,"form");a&&(e.formElement=a,P_(e)&&!Tl(e.getElement())&&(gi.insertAfter(gi.create("input",{type:"hidden",name:n}),n),e.hasHiddenInput=!0),e.formEventDelegate=i=>{e.dispatch(i.type,i)},gi.bind(a,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),!I_(e)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),a._mceOldSubmit(a)))),e.windowManager=L1(e),e.notificationManager=B1(e),(i=>i.options.get("encoding")==="xml")(e)&&e.on("GetContent",i=>{i.save&&(i.content=gi.encode(i.content))}),M_(e)&&e.on("submit",()=>{e.initialized&&e.save()}),F_(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),LB(e,e.suffix)})(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return Yi(this)}translate(e){return Lr.translate(e)}getParam(e,n,o){const r=this.options;return r.isRegistered(e)||(q(o)?r.register(e,{processor:o,default:n}):r.register(e,{processor:ae,default:n})),r.isSet(e)||tt(n)?r.get(e):n}hasPlugin(e,n){return!(!Xt(Rd(this),e)||n&&Ji.get(e)===void 0)}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,n,o){this.editorCommands.addCommand(e,n,o)}addQueryStateHandler(e,n,o){this.editorCommands.addQueryStateHandler(e,n,o)}addQueryValueHandler(e,n,o){this.editorCommands.addQueryValueHandler(e,n,o)}addShortcut(e,n,o,r){this.shortcuts.add(e,n,o,r)}execCommand(e,n,o,r){return this.editorCommands.execCommand(e,n,o,r)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){const e=this;e.hidden&&(e.hidden=!1,e.inline?e.getBody().contentEditable="true":(pi.show(e.getContainer()),pi.hide(e.id)),e.load(),e.dispatch("show"))}hide(){const e=this;e.hidden||(e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(pi.hide(e.getContainer()),pi.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,n){this.dispatch("ProgressState",{state:e,time:n})}load(e={}){const n=this,o=n.getElement();if(n.removed)return"";if(o){const r={...e,load:!0},s=Tl(o)?o.value:o.innerHTML,a=n.setContent(s,r);return r.no_events||n.dispatch("LoadContent",{...r,element:o}),a}return""}save(e={}){const n=this;let o=n.getElement();if(!o||!n.initialized||n.removed)return"";const r={...e,save:!0,element:o};let s=n.getContent(r);const a={...r,content:s};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),s=a.content,Tl(o))o.value=s;else{!e.is_removing&&n.inline||(o.innerHTML=s);const i=pi.getParent(n.id,"form");i&&nL(i.elements,l=>l.name!==n.id||(l.value=s,!1))}return a.element=r.element=o=null,a.set_dirty!==!1&&n.setDirty(!1),s}setContent(e,n){return $f(this,e,n)}getContent(e){return((n,o={})=>{const r=((s,a)=>({...s,format:a,get:!0,getInner:!0}))(o,o.format?o.format:"html");return i1(n,r).fold(Zt,s=>{const a=((i,l)=>zf(i).editor.getContent(l))(n,s);return l1(n,a,s)})})(this,e)}insertContent(e,n){n&&(e=sE({content:e},n)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){e===void 0?$f(this,this.startContent,{format:"raw"}):$f(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){const n=!this.isNotDirty;this.isNotDirty=!e,e&&e!==n&&this.dispatch("dirty")}getContainer(){const e=this;return e.container||(e.container=e.editorContainer||pi.get(e.id+"_parent")),e.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=pi.get(this.id)),this.targetElm}getWin(){const e=this;if(!e.contentWindow){const n=e.iframeElement;n&&(e.contentWindow=n.contentWindow)}return e.contentWindow}getDoc(){const e=this;if(!e.contentDocument){const n=e.getWin();n&&(e.contentDocument=n.document)}return e.contentDocument}getBody(){var e,n;const o=this.getDoc();return(n=(e=this.bodyElement)!==null&&e!==void 0?e:o?.body)!==null&&n!==void 0?n:null}convertURL(e,n,o){const r=this,s=r.options.get,a=G_(r);if(jt(a))return a.call(r,e,o,!0,n);if(!s("convert_urls")||o==="link"||Re(o)&&o.nodeName==="LINK"||e.indexOf("file:")===0||e.length===0)return e;const i=new pr(e);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?e:s("relative_urls")?r.documentBaseURI.toRelative(e):e=r.documentBaseURI.toAbsolute(e,s("remove_script_host"))}addVisual(e){((n,o)=>{((r,s)=>{Xe(r).editor.addVisual(s)})(n,o)})(this,e)}setEditableRoot(e){((n,o)=>{n._editableRoot!==o&&(n._editableRoot=o,Hs(n)||(n.getBody().contentEditable=String(n.hasEditableRoot()),n.nodeChanged()),((r,s)=>{r.dispatch("EditableRootStateChange",{state:s})})(n,o))})(this,e)}hasEditableRoot(){return this._editableRoot}remove(){(e=>{if(!e.removed){const{_selectionOverrides:n,editorUpload:o}=e,r=e.getBody(),s=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&q(s?.nextSibling)&&pu.remove(s.nextSibling),(a=>{a.dispatch("remove")})(e),e.editorManager.remove(e),!e.inline&&r&&(a=>{pu.setStyle(a.id,"display",a.orgDisplay)})(e),(a=>{a.dispatch("detach")})(e),pu.remove(e.getContainer()),hu(n),hu(o),e.destroy()}})(this)}destroy(e){((n,o)=>{const{selection:r,dom:s}=n;n.destroyed||(o||n.removed?(o||(n.editorManager.off("beforeunload",n._beforeUnload),n.theme&&n.theme.destroy&&n.theme.destroy(),hu(r),hu(s)),(a=>{const i=a.formElement;i&&(i._mceOldSubmit&&(i.submit=i._mceOldSubmit,delete i._mceOldSubmit),pu.unbind(i,"submit reset",a.formEventDelegate))})(n),(a=>{const i=a;i.contentAreaContainer=i.formElement=i.container=i.editorContainer=null,i.bodyElement=i.contentDocument=i.contentWindow=null,i.iframeElement=i.targetElm=null;const l=a.selection;if(l){const c=l.dom;i.selection=l.win=l.dom=c.doc=null}})(n),n.destroyed=!0):n.remove())})(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const dl=ye.DOM,em=st.each;let nm,aE=!1,Kn=[];const om=t=>{const e=t.type;em(xa.get(),n=>{switch(e){case"scroll":n.dispatch("ScrollWindow",t);break;case"resize":n.dispatch("ResizeWindow",t)}})},iE=t=>{if(t!==aE){const e=ye.DOM;t?(e.bind(window,"resize",om),e.bind(window,"scroll",om)):(e.unbind(window,"resize",om),e.unbind(window,"scroll",om)),aE=t}},lE=t=>{const e=Kn;return Kn=Ot(Kn,n=>t!==n),xa.activeEditor===t&&(xa.activeEditor=Kn.length>0?Kn[0]:null),xa.focusedEditor===t&&(xa.focusedEditor=null),e.length!==Kn.length},oL=document.compatMode!=="CSS1Compat",xa={...dh,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"7",minorVersion:"7.2",releaseDate:"2025-03-19",i18n:Lr,activeEditor:null,focusedEditor:null,setup(){const t=this;let e="",n="",o=pr.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/"));const r=window.tinymce||window.tinyMCEPreInit;if(r)e=r.base||r.baseURL,n=r.suffix;else{const a=document.getElementsByTagName("script");for(let i=0;i<a.length;i++){const l=a[i].src||"";if(l==="")continue;const c=l.substring(l.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(l)){c.indexOf(".min")!==-1&&(n=".min"),e=l.substring(0,l.lastIndexOf("/"));break}}if(!e&&document.currentScript){const i=document.currentScript.src;i.indexOf(".min")!==-1&&(n=".min"),e=i.substring(0,i.lastIndexOf("/"))}}var s;t.baseURL=new pr(o).toAbsolute(e),t.documentBaseURL=o,t.baseURI=new pr(t.baseURL),t.suffix=n,(s=t).on("AddEditor",ft(KN,s)),s.on("RemoveEditor",ft(GN,s))},overrideDefaults(t){const e=t.base_url;e&&this._setBaseUrl(e);const n=t.suffix;n&&(this.suffix=n),this.defaultOptions=t;const o=t.plugin_base_urls;o!==void 0&&re(o,(r,s)=>{Mn.PluginManager.urls[s]=r})},init(t){const e=this;let n;const o=st.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");let r=a=>{n=a};const s=()=>{let a=0;const i=[];let l;dl.unbind(window,"ready",s),(()=>{const c=t.onpageload;c&&c.apply(e,[])})(),l=Qn((c=>Kt.browser.isIE()||Kt.browser.isEdge()?(yu("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/7/support/#supportedwebbrowsers"),[]):oL?(yu("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):vt(c.selector)?dl.select(c.selector):q(c.target)?[c.target]:[])(t)),st.each(l,c=>{var d;(d=e.get(c.id))&&d.initialized&&!(d.getContainer()||d.getBody()).parentNode&&(lE(d),d.unbindAllNativeEvents(),d.destroy(!0),d.removed=!0)}),l=st.grep(l,c=>!e.get(c.id)),l.length===0?r([]):em(l,c=>{((d,u)=>d.inline&&u.tagName.toLowerCase()in o)(t,c)?yu("Could not initialize inline editor on invalid inline target element",c):((d,u,m)=>{const h=new tm(d,u,e);i.push(h),h.on("init",()=>{++a===l.length&&r(i)}),h.targetElm=h.targetElm||m,h.render()})((d=>{let u=d.id;return u||(u=ee(d,"name").filter(m=>!dl.get(m)).getOrThunk(dl.uniqueId),d.setAttribute("id",u)),u})(c),t,c)})};return dl.bind(window,"ready",s),new Promise(a=>{n?a(n):r=i=>{a(i)}})},get(t){return arguments.length===0?Kn.slice(0):vt(t)?Te(Kn,e=>e.id===t).getOr(null):Ce(t)&&Kn[t]?Kn[t]:null},add(t){const e=this,n=e.get(t.id);return n===t||(n===null&&Kn.push(t),iE(!0),e.activeEditor=t,e.dispatch("AddEditor",{editor:t}),nm||(nm=o=>{const r=e.dispatch("BeforeUnload");if(r.returnValue)return o.preventDefault(),o.returnValue=r.returnValue,r.returnValue},window.addEventListener("beforeunload",nm))),t},createEditor(t,e){return this.add(new tm(t,e,this))},remove(t){const e=this;let n;if(t){if(!vt(t))return n=t,Le(e.get(n.id))?null:(lE(n)&&e.dispatch("RemoveEditor",{editor:n}),Kn.length===0&&window.removeEventListener("beforeunload",nm),n.remove(),iE(Kn.length>0),n);em(dl.select(t),o=>{n=e.get(o.id),n&&e.remove(n)})}else for(let o=Kn.length-1;o>=0;o--)e.remove(Kn[o])},execCommand(t,e,n){var o;const r=this,s=Re(n)?(o=n.id)!==null&&o!==void 0?o:n.index:n;switch(t){case"mceAddEditor":if(!r.get(s)){const a=n.options;new tm(s,a,r).render()}return!0;case"mceRemoveEditor":{const a=r.get(s);return a&&a.remove(),!0}case"mceToggleEditor":{const a=r.get(s);return a?(a.isHidden()?a.show():a.hide(),!0):(r.execCommand("mceAddEditor",!1,n),!0)}}return!!r.activeEditor&&r.activeEditor.execCommand(t,e,n)},triggerSave:()=>{em(Kn,t=>{t.save()})},addI18n:(t,e)=>{Lr.add(t,e)},translate:t=>Lr.translate(t),setActive(t){const e=this.activeEditor;this.activeEditor!==t&&(e&&e.dispatch("deactivate",{relatedTarget:t}),t.dispatch("activate",{relatedTarget:e})),this.activeEditor=t},_setBaseUrl(t){this.baseURL=new pr(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new pr(this.baseURL)}};xa.setup();const rL=(()=>{const t=Or();return{FakeClipboardItem:e=>({items:e,types:je(e),getType:n=>ee(e,n).getOrUndefined()}),write:e=>{t.set(e)},read:()=>t.get().getOrUndefined(),clear:t.clear}})(),cE=Math.min,ul=Math.max,rm=Math.round,dE=(t,e,n)=>{let o=e.x,r=e.y;const s=t.w,a=t.h,i=e.w,l=e.h,c=(n||"").split("");return c[0]==="b"&&(r+=l),c[1]==="r"&&(o+=i),c[0]==="c"&&(r+=rm(l/2)),c[1]==="c"&&(o+=rm(i/2)),c[3]==="b"&&(r-=a),c[4]==="r"&&(o-=s),c[3]==="c"&&(r-=rm(a/2)),c[4]==="c"&&(o-=rm(s/2)),ml(o,r,s,a)},ml=(t,e,n,o)=>({x:t,y:e,w:n,h:o}),sL={inflate:(t,e,n)=>ml(t.x-e,t.y-n,t.w+2*e,t.h+2*n),relativePosition:dE,findBestRelativePosition:(t,e,n,o)=>{for(let r=0;r<o.length;r++){const s=dE(t,e,o[r]);if(s.x>=n.x&&s.x+s.w<=n.w+n.x&&s.y>=n.y&&s.y+s.h<=n.h+n.y)return o[r]}return null},intersect:(t,e)=>{const n=ul(t.x,e.x),o=ul(t.y,e.y),r=cE(t.x+t.w,e.x+e.w),s=cE(t.y+t.h,e.y+e.h);return r-n<0||s-o<0?null:ml(n,o,r-n,s-o)},clamp:(t,e,n)=>{let o=t.x,r=t.y,s=t.x+t.w,a=t.y+t.h;const i=e.x+e.w,l=e.y+e.h,c=ul(0,e.x-o),d=ul(0,e.y-r),u=ul(0,s-i),m=ul(0,a-l);return o+=c,r+=d,n&&(s+=c,a+=d,o-=u,r-=m),s-=u,a-=m,ml(o,r,s-o,a-r)},create:ml,fromClientRect:t=>ml(t.left,t.top,t.width,t.height)},aL=(()=>{const t={},e={},n={};return{load:(o,r)=>{const s=`Script at URL "${r}" failed to load`,a=`Script at URL "${r}" did not call \`tinymce.Resource.add('${o}', data)\` within 1 second`;if(t[o]!==void 0)return t[o];{const i=new Promise((l,c)=>{const d=((u,m,h=1e3)=>{let f=!1,b=null;const p=S=>(...N)=>{f||(f=!0,b!==null&&(clearTimeout(b),b=null),S.apply(null,N))},y=p(u),w=p(m);return{start:(...S)=>{f||b!==null||(b=setTimeout(()=>w.apply(null,S),h))},resolve:y,reject:w}})(l,c);e[o]=d.resolve,Us.ScriptLoader.loadScript(r).then(()=>d.start(a),()=>d.reject(s))});return t[o]=i,i}},add:(o,r)=>{e[o]!==void 0&&(e[o](r),delete e[o]),t[o]=Promise.resolve(r),n[o]=r},has:o=>o in n,get:o=>n[o],unload:o=>{delete t[o],delete n[o]}}})();let qc;try{const t="__storage_test__";qc=window.localStorage,qc.setItem(t,t),qc.removeItem(t)}catch{qc=(()=>{let e={},n=[];const o={getItem:r=>e[r]||null,setItem:(r,s)=>{n.push(r),e[r]=String(s)},key:r=>n[r],removeItem:r=>{n=n.filter(s=>s===r),delete e[r]},clear:()=>{n=[],e={}},length:0};return Object.defineProperty(o,"length",{get:()=>n.length,configurable:!1,enumerable:!1}),o})()}const iL={geom:{Rect:sL},util:{Delay:$o,Tools:st,VK:ht,URI:pr,EventDispatcher:ch,Observable:dh,I18n:Lr,LocalStorage:qc,ImageUploader:t=>{const e=$1(),n=j1(t,e);return{upload:(o,r=!0)=>n.upload(o,r?H1(t):void 0)}}},dom:{EventUtils:ja,TreeWalker:Ge,TextSeeker:Wa,DOMUtils:ye,ScriptLoader:Us,RangeUtils:ni,Serializer:_1,StyleSheetLoader:vh,ControlSelection:d0,BookmarkManager:dc,Selection:E1,Event:ja.Event},html:{Styles:km,Entities:Ha,Node:Fn,Schema:ua,DomParser:Qi,Writer:$0,Serializer:va},Env:Kt,AddOnManager:Mn,Annotator:Zv,Formatter:W1,UndoManager:G1,EditorCommands:Xx,WindowManager:L1,NotificationManager:B1,EditorObservable:Jx,Shortcuts:rE,Editor:tm,FocusManager:i0,EditorManager:xa,DOM:ye.DOM,ScriptLoader:Us.ScriptLoader,PluginManager:Ji,ThemeManager:li,ModelManager:Zi,IconManager:bu,Resource:aL,FakeClipboard:rL,trim:st.trim,isArray:st.isArray,is:st.is,toArray:st.toArray,makeMap:st.makeMap,each:st.each,map:st.map,grep:st.grep,inArray:st.inArray,extend:st.extend,walk:st.walk,resolve:st.resolve,explode:st.explode,_addCacheSuffix:st._addCacheSuffix},uE=st.extend(xa,iL);(t=>{window.tinymce=t,window.tinyMCE=t})(uE),(t=>{if(typeof module=="object")try{module.exports=t}catch{}})(uE)})(),function(){"use strict";const Ur=tt=>{let Ht=tt;return{get:()=>Ht,set:Ce=>{Ht=Ce}}};var xo=tinymce.util.Tools.resolve("tinymce.PluginManager"),$n=tinymce.util.Tools.resolve("tinymce.Env");const uo=tt=>tt.dispatch("ResizeEditor"),yn=tt=>Ht=>Ht.options.get(tt),mo=tt=>{const Ht=tt.options.register;Ht("autoresize_overflow_padding",{processor:"number",default:1}),Ht("autoresize_bottom_margin",{processor:"number",default:50})},Cn=yn("min_height"),br=yn("max_height"),Ae=yn("autoresize_overflow_padding"),Go=yn("autoresize_bottom_margin"),Ve=tt=>tt.plugins.fullscreen&&tt.plugins.fullscreen.isFullscreen(),wn=(tt,Ht)=>{const q=tt.getBody();q&&(q.style.overflowY=Ht?"":"hidden",Ht||(q.scrollTop=0))},vt=(tt,Ht,q,jt)=>{var Ce;const $e=parseInt((Ce=tt.getStyle(Ht,q,jt))!==null&&Ce!==void 0?Ce:"",10);return isNaN($e)?0:$e},Re=tt=>{if(tt?.type.toLowerCase()==="setcontent"){const Ht=tt;return Ht.selection===!0||Ht.paste===!0}else return!1},Hn=(tt,Ht,q,jt)=>{var Ce;const $e=tt.dom,Dt=tt.getDoc();if(!Dt)return;if(Ve(tt)){wn(tt,!0);return}const qe=Dt.documentElement,Eo=jt?jt():Ae(tt),it=(Ce=Cn(tt))!==null&&Ce!==void 0?Ce:tt.getElement().offsetHeight;let Zt=it;const On=vt($e,qe,"margin-top",!0),ft=vt($e,qe,"margin-bottom",!0);let De=qe.offsetHeight+On+ft+Eo;De<0&&(De=0);const He=tt.getContainer().offsetHeight,go=tt.getContentAreaContainer().offsetHeight,Gn=He-go;De+Gn>it&&(Zt=De+Gn);const te=br(tt);te&&Zt>te?(Zt=te,wn(tt,!0)):wn(tt,!1);const ae=Ht.get();if(ae.set&&(tt.dom.setStyles(tt.getDoc().documentElement,{"min-height":0}),tt.dom.setStyles(tt.getBody(),{"min-height":"inherit"})),Zt!==ae.totalHeight&&(De-Eo!==ae.contentHeight||!ae.set)){const x=Zt-ae.totalHeight;if($e.setStyle(tt.getContainer(),"height",Zt+"px"),Ht.set({totalHeight:Zt,contentHeight:De,set:!0}),uo(tt),$n.browser.isSafari()&&($n.os.isMacOS()||$n.os.isiOS())){const jn=tt.getWin();jn.scrollTo(jn.pageXOffset,jn.pageYOffset)}tt.hasFocus()&&Re(q)&&tt.selection.scrollIntoView(),($n.browser.isSafari()||$n.browser.isChromium())&&x<0&&Hn(tt,Ht,q,jt)}},Qt=(tt,Ht)=>{const q=()=>Go(tt);tt.on("init",jt=>{const Ce=Ae(tt),$e=tt.dom;$e.setStyles(tt.getDoc().documentElement,{height:"auto"}),$n.browser.isEdge()||$n.browser.isIE()?$e.setStyles(tt.getBody(),{paddingLeft:Ce,paddingRight:Ce,"min-height":0}):$e.setStyles(tt.getBody(),{paddingLeft:Ce,paddingRight:Ce}),Hn(tt,Ht,jt,q)}),tt.on("NodeChange SetContent keyup FullscreenStateChanged ResizeContent",jt=>{Hn(tt,Ht,jt,q)})},Le=(tt,Ht)=>{tt.addCommand("mceAutoResize",()=>{Hn(tt,Ht)})};var Sn=()=>{xo.add("autoresize",tt=>{if(mo(tt),tt.options.isSet("resize")||tt.options.set("resize",!1),!tt.inline){const Ht=Ur({totalHeight:0,contentHeight:0,set:!1});Le(tt,Ht),Qt(tt,Ht)}})};Sn()}(),function(){"use strict";var Ur=tinymce.util.Tools.resolve("tinymce.PluginManager");const xo=(_,T,j)=>{var Z;return j(_,T.prototype)?!0:((Z=_.constructor)===null||Z===void 0?void 0:Z.name)===T.name},$n=_=>{const T=typeof _;return _===null?"null":T==="object"&&Array.isArray(_)?"array":T==="object"&&xo(_,String,(j,Z)=>Z.isPrototypeOf(j))?"string":T},uo=_=>T=>$n(T)===_,yn=_=>T=>typeof T===_,mo=_=>T=>_===T,Cn=uo("string"),br=uo("object"),Ae=uo("array"),Go=mo(null),Ve=yn("boolean"),wn=_=>_==null,vt=_=>!wn(_),Re=yn("function"),Hn=(_,T)=>{if(Ae(_)){for(let j=0,Z=_.length;j<Z;++j)if(!T(_[j]))return!1;return!0}return!1},Qt=()=>{},Le=_=>()=>_,Sn=(_,T)=>_===T;class tt{constructor(T,j){this.tag=T,this.value=j}static some(T){return new tt(!0,T)}static none(){return tt.singletonNone}fold(T,j){return this.tag?j(this.value):T()}isSome(){return this.tag}isNone(){return!this.tag}map(T){return this.tag?tt.some(T(this.value)):tt.none()}bind(T){return this.tag?T(this.value):tt.none()}exists(T){return this.tag&&T(this.value)}forall(T){return!this.tag||T(this.value)}filter(T){return!this.tag||T(this.value)?this:tt.none()}getOr(T){return this.tag?this.value:T}or(T){return this.tag?this:T}getOrThunk(T){return this.tag?this.value:T()}orThunk(T){return this.tag?this:T()}getOrDie(T){if(this.tag)return this.value;throw new Error(T??"Called getOrDie on None")}static from(T){return vt(T)?tt.some(T):tt.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(T){this.tag&&T(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}tt.singletonNone=new tt(!1);const Ht=Array.prototype.indexOf,q=Array.prototype.push,jt=(_,T)=>Ht.call(_,T),Ce=(_,T)=>jt(_,T)>-1,$e=(_,T)=>{const j=_.length,Z=new Array(j);for(let et=0;et<j;et++){const mt=_[et];Z[et]=T(mt,et)}return Z},Dt=(_,T)=>{for(let j=0,Z=_.length;j<Z;j++){const et=_[j];T(et,j)}},qe=(_,T,j)=>(Dt(_,(Z,et)=>{j=T(j,Z,et)}),j),Eo=_=>{const T=[];for(let j=0,Z=_.length;j<Z;++j){if(!Ae(_[j]))throw new Error("Arr.flatten item "+j+" was not an array, input: "+_);q.apply(T,_[j])}return T},it=(_,T)=>Eo($e(_,T)),Zt=(_,T)=>{for(let j=0;j<_.length;j++){const Z=T(_[j],j);if(Z.isSome())return Z}return tt.none()},On=(_,T,j=Sn)=>_.exists(Z=>j(Z,T)),ft=_=>{const T=[],j=Z=>{T.push(Z)};for(let Z=0;Z<_.length;Z++)_[Z].each(j);return T},De=(_,T)=>_?tt.some(T):tt.none(),He=_=>T=>T.options.get(_),go=_=>{const T=_.options.register;T("link_assume_external_targets",{processor:j=>{const Z=Cn(j)||Ve(j);return Z?j===!0?{value:1,valid:Z}:j==="http"||j==="https"?{value:j,valid:Z}:{value:0,valid:Z}:{valid:!1,message:"Must be a string or a boolean."}},default:!1}),T("link_context_toolbar",{processor:"boolean",default:!1}),T("link_list",{processor:j=>Cn(j)||Re(j)||Hn(j,br)}),T("link_default_target",{processor:"string"}),T("link_default_protocol",{processor:"string",default:"https"}),T("link_target_list",{processor:j=>Ve(j)||Hn(j,br),default:!0}),T("link_rel_list",{processor:"object[]",default:[]}),T("link_class_list",{processor:"object[]",default:[]}),T("link_title",{processor:"boolean",default:!0}),T("allow_unsafe_link_target",{processor:"boolean",default:!1}),T("link_quicklink",{processor:"boolean",default:!1}),T("link_attributes_postprocess",{processor:"function"})},Gn=He("link_assume_external_targets"),te=He("link_context_toolbar"),ae=He("link_list"),x=He("link_default_target"),jn=He("link_default_protocol"),vr=He("link_target_list"),_o=He("link_rel_list"),Xs=He("link_class_list"),Xt=He("link_title"),de=He("allow_unsafe_link_target"),qt=He("link_quicklink"),J=He("link_attributes_postprocess"),mn=Object.keys,Yo=Object.hasOwnProperty,Ot=(_,T)=>{const j=mn(_);for(let Z=0,et=j.length;Z<et;Z++){const mt=j[Z],Pt=_[mt];T(Pt,mt)}},yr=_=>(T,j)=>{_[j]=T},en=(_,T,j,Z)=>{Ot(_,(et,mt)=>{(T(et,mt)?j:Z)(et,mt)})},Xo=(_,T)=>{const j={};return en(_,T,yr(j),Qt),j},Te=(_,T)=>Yo.call(_,T),oe=(_,T)=>Te(_,T)&&_[T]!==void 0&&_[T]!==null;var zr=tinymce.util.Tools.resolve("tinymce.util.URI"),Qe=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),kn=tinymce.util.Tools.resolve("tinymce.util.Tools");const No=_=>vt(_)&&_.nodeName.toLowerCase()==="a",Qo=_=>No(_)&&!!fo(_),$r=(_,T)=>{if(_.collapsed)return[];{const j=_.cloneContents(),Z=j.firstChild,et=new Qe(Z,j),mt=[];let Pt=Z;do T(Pt)&&mt.push(Pt);while(Pt=et.next());return mt}},Yn=_=>/^\w+:/i.test(_),fo=_=>{var T,j;return(j=(T=_.getAttribute("data-mce-href"))!==null&&T!==void 0?T:_.getAttribute("href"))!==null&&j!==void 0?j:""},We=(_,T)=>{const j=["noopener"],Z=_?_.split(/\s+/):[],et=Yt=>kn.trim(Yt.sort().join(" ")),mt=Yt=>(Yt=Pt(Yt),Yt.length>0?Yt.concat(j):j),Pt=Yt=>Yt.filter(C=>kn.inArray(j,C)===-1),se=T?mt(Z):Pt(Z);return se.length>0?et(se):""},Bn=_=>_.replace(/\uFEFF/g,""),Oe=(_,T)=>(T=T||je(_.selection.getRng())[0]||_.selection.getNode(),Jo(T)?tt.from(_.dom.select("a[href]",T)[0]):tt.from(_.dom.getParent(T,"a[href]"))),Xn=(_,T)=>Oe(_,T).isSome(),Qn=(_,T)=>{const j=T.fold(()=>_.getContent({format:"text"}),Z=>Z.innerText||Z.textContent||"");return Bn(j)},je=_=>$r(_,Qo),Cr=_=>kn.grep(_,Qo),re=_=>Cr(_).length>0,Zo=_=>je(_).length>0,nn=_=>{const T=_.schema.getTextInlineElements(),j=mt=>mt.nodeType===1&&!No(mt)&&!Te(T,mt.nodeName.toLowerCase());if(Oe(_).exists(mt=>mt.hasAttribute("data-mce-block")))return!1;const et=_.selection.getRng();return et.collapsed?!0:$r(et,j).length===0},Jo=_=>vt(_)&&_.nodeName==="FIGURE"&&/\bimage\b/i.test(_.className),bs=_=>qe(["title","rel","class","target"],(j,Z)=>(_[Z].each(et=>{j[Z]=et.length>0?et:null}),j),{href:_.href}),Ao=(_,T)=>(T==="http"||T==="https")&&!Yn(_)?T+"://"+_:_,xn=(_,T)=>{const j={...T};if(_o(_).length===0&&!de(_)){const Z=We(j.rel,j.target==="_blank");j.rel=Z||null}return tt.from(j.target).isNone()&&vr(_)===!1&&(j.target=x(_)),j.href=Ao(j.href,Gn(_)),j},Hr=(_,T,j,Z)=>{j.each(mt=>{Te(T,"innerText")?T.innerText=mt:T.textContent=mt}),_.dom.setAttribs(T,Z);const et=_.dom.createRng();et.setStartAfter(T),et.setEndAfter(T),_.selection.setRng(et)},ee=(_,T,j,Z)=>{const et=_.dom;Jo(T)?nr(et,T,Z):j.fold(()=>{_.execCommand("mceInsertLink",!1,Z);const mt=_.selection.getEnd(),Pt=et.createRng();Pt.setStartAfter(mt),Pt.setEndAfter(mt),_.selection.setRng(Pt)},mt=>{_.insertContent(et.createHTML("a",Z,et.encode(mt)))})},Bt=(_,T,j)=>{const Z=_.selection.getNode(),et=Oe(_,Z),mt=xn(_,bs(j)),Pt=J(_);vt(Pt)&&Pt(mt),_.undoManager.transact(()=>{j.href===T.href&&T.attach(),et.fold(()=>{ee(_,Z,j.text,mt)},se=>{_.focus(),Hr(_,se,j.text,mt)})})},Ro=_=>{const T=_.dom,j=_.selection,Z=j.getBookmark(),et=j.getRng().cloneRange(),mt=T.getParent(et.startContainer,"a[href]",_.getBody()),Pt=T.getParent(et.endContainer,"a[href]",_.getBody());mt&&et.setStartBefore(mt),Pt&&et.setEndAfter(Pt),j.setRng(et),_.execCommand("unlink"),j.moveToBookmark(Z)},wr=_=>{_.undoManager.transact(()=>{const T=_.selection.getNode();Jo(T)?er(_,T):Ro(_),_.focus()})},Sr=_=>{const{class:T,href:j,rel:Z,target:et,text:mt,title:Pt}=_;return Xo({class:T.getOrNull(),href:j,rel:Z.getOrNull(),target:et.getOrNull(),text:mt.getOrNull(),title:Pt.getOrNull()},(se,Yt)=>Go(se)===!1)},jr=(_,T)=>{const j=_.options.get,Z={allow_html_data_urls:j("allow_html_data_urls"),allow_script_urls:j("allow_script_urls"),allow_svg_data_urls:j("allow_svg_data_urls")},et=T.href;return{...T,href:zr.isDomSafe(et,"a",Z)?et:""}},tr=(_,T,j)=>{const Z=jr(_,j);_.hasPlugin("rtc",!0)?_.execCommand("createlink",!1,Sr(Z)):Bt(_,T,Z)},To=_=>{_.hasPlugin("rtc",!0)?_.execCommand("unlink"):wr(_)},er=(_,T)=>{var j;const Z=_.dom.select("img",T)[0];if(Z){const et=_.dom.getParents(Z,"a[href]",T)[0];et&&((j=et.parentNode)===null||j===void 0||j.insertBefore(Z,et),_.dom.remove(et))}},nr=(_,T,j)=>{var Z;const et=_.select("img",T)[0];if(et){const mt=_.create("a",j);(Z=et.parentNode)===null||Z===void 0||Z.insertBefore(mt,et),mt.appendChild(et)}},or=_=>Cn(_.value)?_.value:"",Vn=_=>Cn(_.text)?_.text:Cn(_.title)?_.title:"",ln=(_,T)=>{const j=[];return kn.each(_,Z=>{const et=Vn(Z);if(Z.menu!==void 0){const mt=ln(Z.menu,T);j.push({text:et,items:mt})}else{const mt=T(Z);j.push({text:et,value:mt})}}),j},vs=(_=or)=>T=>tt.from(T).map(j=>ln(j,_)),gn={sanitize:_=>vs(or)(_),sanitizeWith:vs,createUi:(_,T)=>j=>({name:_,type:"listbox",label:T,items:j}),getValue:or},Qs=_=>oe(_,"items"),qr=(_,T)=>Zt(T,j=>Qs(j)?qr(_,j.items):De(j.value===_,j)),Pe=(_,T,j,Z)=>{const et=Z[T],mt=_.length>0;return et!==void 0?qr(et,j).map(Pt=>({url:{value:Pt.value,meta:{text:mt?_:Pt.text,attach:Qt}},text:mt?_:Pt.text})):tt.none()},ie=(_,T)=>T==="link"?_.link:T==="anchor"?_.anchor:tt.none(),Cs={init:(_,T)=>{const j={text:_.text,title:_.title},Z=Yt=>{var C;return De(j.title.length<=0,tt.from((C=Yt.meta)===null||C===void 0?void 0:C.title).getOr(""))},et=Yt=>{var C;return De(j.text.length<=0,tt.from((C=Yt.meta)===null||C===void 0?void 0:C.text).getOr(Yt.value))},mt=Yt=>{const C=et(Yt.url),A=Z(Yt.url);return C.isSome()||A.isSome()?tt.some({...C.map(L=>({text:L})).getOr({}),...A.map(L=>({title:L})).getOr({})}):tt.none()},Pt=(Yt,C)=>{const A=ie(T,C).getOr([]);return Pe(j.text,C,A,Yt)};return{onChange:(Yt,C)=>{const A=C.name;return A==="url"?mt(Yt()):Ce(["anchor","link"],A)?Pt(Yt(),A):((A==="text"||A==="title")&&(j[A]=Yt()[A]),tt.none())}}},getDelta:Pe};var fn=tinymce.util.Tools.resolve("tinymce.util.Delay");const ws=(_,T,j)=>{const Z=_.selection.getRng();fn.setEditorTimeout(_,()=>{_.windowManager.confirm(T,et=>{_.selection.setRng(Z),j(et)})})},po=_=>{const T=_.href;return T.indexOf("@")>0&&T.indexOf("/")===-1&&T.indexOf("mailto:")===-1?tt.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:Z=>({...Z,href:"mailto:"+T})}):tt.none()},cn=(_,T)=>j=>{const Z=j.href;return _===1&&!Yn(Z)||_===0&&/^\s*www(\.|\d\.)/i.test(Z)?tt.some({message:`The URL you entered seems to be an external link. Do you want to add the required ${T}:// prefix?`,preprocess:mt=>({...mt,href:T+"://"+Z})}):tt.none()},Oo={preprocess:(_,T)=>Zt([po,cn(Gn(_),jn(_))],j=>j(T)).fold(()=>Promise.resolve(T),j=>new Promise(Z=>{ws(_,j.message,et=>{Z(et?j.preprocess(T):T)})}))},Jn={getAnchors:_=>{const T=_.dom.select("a:not([href])"),j=it(T,Z=>{const et=Z.name||Z.id;return et?[{text:et,value:"#"+et}]:[]});return j.length>0?tt.some([{text:"None",value:""}].concat(j)):tt.none()}},Aa={getClasses:_=>{const T=Xs(_);return T.length>0?gn.sanitize(T):tt.none()}},Js=_=>{try{return tt.some(JSON.parse(_))}catch{return tt.none()}},Ta={getLinks:_=>{const T=Z=>_.convertURL(Z.value||Z.url||"","href"),j=ae(_);return new Promise(Z=>{Cn(j)?fetch(j).then(et=>et.ok?et.text().then(Js):Promise.reject()).then(Z,()=>Z(tt.none())):Re(j)?j(et=>Z(tt.some(et))):Z(tt.from(j))}).then(Z=>Z.bind(gn.sanitizeWith(T)).map(et=>et.length>0?[{text:"None",value:""}].concat(et):et))}},sr={getRels:(_,T)=>{const j=_o(_);if(j.length>0){const Z=On(T,"_blank"),et=de(_)===!1,mt=se=>We(gn.getValue(se),Z);return(et?gn.sanitizeWith(mt):gn.sanitize)(j)}return tt.none()}},ks=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],ea={getTargets:_=>{const T=vr(_);return Ae(T)?gn.sanitize(T).orThunk(()=>tt.some(ks)):T===!1?tt.none():tt.some(ks)}},kr=(_,T,j)=>{const Z=_.getAttrib(T,j);return Z!==null&&Z.length>0?tt.some(Z):tt.none()},xr=(_,T)=>{const j=_.dom,et=nn(_)?tt.some(Qn(_.selection,T)):tt.none(),mt=T.bind(A=>tt.from(j.getAttrib(A,"href"))),Pt=T.bind(A=>tt.from(j.getAttrib(A,"target"))),se=T.bind(A=>kr(j,A,"rel")),Yt=T.bind(A=>kr(j,A,"class")),C=T.bind(A=>kr(j,A,"title"));return{url:mt,text:et,title:C,target:Pt,rel:se,linkClass:Yt}},xs={collect:(_,T)=>Ta.getLinks(_).then(j=>{const Z=xr(_,T);return{anchor:Z,catalogs:{targets:ea.getTargets(_),rels:sr.getRels(_,Z.target),classes:Aa.getClasses(_),anchor:Jn.getAnchors(_),link:j},optNode:T,flags:{titleEnabled:Xt(_)}}})},ar=(_,T)=>j=>{const Z=j.getData();if(!Z.url.value){To(_),j.close();return}const et=se=>tt.from(Z[se]).filter(Yt=>!On(T.anchor[se],Yt)),mt={href:Z.url.value,text:et("text"),target:et("target"),rel:et("rel"),class:et("linkClass"),title:et("title")},Pt={href:Z.url.value,attach:Z.url.meta!==void 0&&Z.url.meta.attach?Z.url.meta.attach:Qt};Oo.preprocess(_,mt).then(se=>{tr(_,Pt,se)}),j.close()},En=_=>{const T=Oe(_);return xs.collect(_,T)},Er=(_,T)=>{const j=_.anchor,Z=j.url.getOr("");return{url:{value:Z,meta:{original:{value:Z}}},text:j.text.getOr(""),title:j.title.getOr(""),anchor:Z,link:Z,rel:j.rel.getOr(""),target:j.target.or(T).getOr(""),linkClass:j.linkClass.getOr("")}},Fe=(_,T,j)=>{const Z=[{name:"url",type:"urlinput",filetype:"file",label:"URL",picker_text:"Browse links"}],et=_.anchor.text.map(()=>({name:"text",type:"input",label:"Text to display"})).toArray(),mt=_.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],Pt=tt.from(x(j)),se=Er(_,Pt),Yt=_.catalogs,C=Cs.init(se,Yt);return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:Eo([Z,et,mt,ft([Yt.anchor.map(gn.createUi("anchor","Anchors")),Yt.rels.map(gn.createUi("rel","Rel")),Yt.targets.map(gn.createUi("target","Open link in...")),Yt.link.map(gn.createUi("link","Link list")),Yt.classes.map(gn.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:se,onChange:(L,{name:K})=>{C.onChange(L.getData,{name:K}).each(bt=>{L.setData(bt)})},onSubmit:T}},Oa=_=>{En(_).then(j=>{const Z=ar(_,j);return Fe(j,Z,_)}).then(j=>{_.windowManager.open(j)})},na=_=>{_.addCommand("mceLink",(T,j)=>{j?.dialog===!0||!qt(_)?Oa(_):_.dispatch("contexttoolbar-show",{toolbarKey:"quicklink"})})},Kr=_=>{_.addShortcut("Meta+K","",()=>{_.execCommand("mceLink")})},oa=_=>{let T=_;return{get:()=>T,set:et=>{T=et}}},vi=_=>{const T=oa(tt.none()),j=()=>T.get().each(_);return{clear:()=>{j(),T.set(tt.none())},isSet:()=>T.get().isSome(),get:()=>T.get(),set:se=>{j(),T.set(tt.some(se))}}},Ke=()=>{const _=vi(Qt);return{..._,on:j=>_.get().each(j)}},yi=(_,T)=>_.substring(T),_r=(_,T,j)=>T===""||_.length>=T.length&&_.substr(j,j+T.length)===T,_n=(_,T)=>Dn(_,T)?yi(_,T.length):_,Dn=(_,T)=>_r(_,T,0);var ho=tinymce.util.Tools.resolve("tinymce.util.VK");const Bo=(_,T)=>{document.body.appendChild(_),_.dispatchEvent(T),document.body.removeChild(_)},Kt=_=>{const T=document.createElement("a");T.target="_blank",T.href=_,T.rel="noreferrer noopener";const j=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});document.dispatchEvent(j),Bo(T,j)},Es=_=>_.altKey===!0&&_.shiftKey===!1&&_.ctrlKey===!1&&_.metaKey===!1,Gr=(_,T)=>{if(T){const j=fo(T);if(/^#/.test(j)){const Z=_.dom.select(`${j},[name="${_n(j,"#")}"]`);Z.length&&_.selection.scrollIntoView(Z[0],!0)}else Kt(T.href)}},ra=_=>{const T=_.selection.getRng(),j=T.startContainer;return Qo(j)&&T.startContainer===T.endContainer&&_.dom.select("img",j).length===1},st=(_,T)=>{const j=Cr(_.dom.getParents(T));return De(j.length===1,j[0])},bo=_=>{const T=je(_.selection.getRng());return De(T.length>0,T[0]).or(st(_,_.selection.getNode()))},Yr=_=>_.selection.isCollapsed()||ra(_)?st(_,_.selection.getStart()):bo(_),ke=_=>{const T=Ke(),j=()=>T.get().or(Yr(_)),Z=()=>j().each(et=>Gr(_,et));return _.on("contextmenu",et=>{st(_,et.target).each(T.set)}),_.on("SelectionChange",()=>{T.isSet()||Yr(_).each(T.set)}),_.on("click",et=>{T.clear();const mt=Cr(_.dom.getParents(et.target));mt.length===1&&ho.metaKeyPressed(et)&&(et.preventDefault(),Gr(_,mt[0]))}),_.on("keydown",et=>{T.clear(),!et.isDefaultPrevented()&&et.keyCode===13&&Es(et)&&j().each(mt=>{et.preventDefault(),Gr(_,mt)})}),{gotoSelectedLink:Z}},Lo=_=>()=>{_.execCommand("mceLink",!1,{dialog:!0})},_s=(_,T)=>(_.on("NodeChange",T),()=>_.off("NodeChange",T)),Nr=_=>T=>{const j=()=>{T.setActive(!_.mode.isReadOnly()&&Xn(_,_.selection.getNode())),T.setEnabled(_.selection.isEditable())};return j(),_s(_,j)},Ba=_=>T=>{const j=()=>{T.setEnabled(_.selection.isEditable())};return j(),_s(_,j)},Xr=_=>T=>{const j=mt=>re(mt)||Zo(_.selection.getRng()),Z=_.dom.getParents(_.selection.getStart()),et=mt=>{T.setEnabled(j(mt)&&_.selection.isEditable())};return et(Z),_s(_,mt=>et(mt.parents))},Gt=(_,T)=>{_.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Meta+K",onAction:Lo(_),onSetup:Nr(_)}),_.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:T.gotoSelectedLink,onSetup:Xr(_)}),_.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:()=>To(_),onSetup:Xr(_)})},Ns=(_,T)=>{_.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:T.gotoSelectedLink,onSetup:Xr(_)}),_.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Lo(_),onSetup:Ba(_)}),_.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:()=>To(_),onSetup:Xr(_)})},Do=_=>{const T="link unlink openlink",j="link";_.ui.registry.addContextMenu("link",{update:Z=>_.dom.isEditable(Z)?re(_.dom.getParents(Z,"a"))?T:j:""})},ir=(_,T)=>{const j=mt=>{mt.selection.collapse(!1)},Z=mt=>{const Pt=_.selection.getNode();return mt.setEnabled(Xn(_,Pt)&&_.selection.isEditable()),Qt},et=mt=>{const Pt=Oe(_),se=nn(_);if(Pt.isNone()&&se){const Yt=Qn(_.selection,Pt);return De(Yt.length===0,mt)}else return tt.none()};_.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Nr(_)},label:"Link",predicate:mt=>te(_)&&Xn(_,mt),initValue:()=>Oe(_).fold(Le(""),fo),commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:mt=>{const Pt=_.selection.getNode();return mt.setActive(Xn(_,Pt)),Nr(_)(mt)},onAction:mt=>{const Pt=mt.getValue(),se=et(Pt);tr(_,{href:Pt,attach:Qt},{href:Pt,text:se,title:tt.none(),rel:tt.none(),target:tt.from(x(_)),class:tt.none()}),j(_),mt.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:Z,onAction:mt=>{To(_),mt.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:Z,onAction:mt=>{T.gotoSelectedLink(),mt.hide()}}]})},on=_=>{const T=ke(_);Gt(_,T),Ns(_,T),Do(_),ir(_,T)};var Be=()=>{Ur.add("link",_=>{go(_),na(_),on(_),Kr(_)})};Be()}(),function(){"use strict";var Ur=tinymce.util.Tools.resolve("tinymce.PluginManager");const xo=(g,v,k)=>{var O;return k(g,v.prototype)?!0:((O=g.constructor)===null||O===void 0?void 0:O.name)===v.name},$n=g=>{const v=typeof g;return g===null?"null":v==="object"&&Array.isArray(g)?"array":v==="object"&&xo(g,String,(k,O)=>O.isPrototypeOf(k))?"string":v},uo=g=>v=>$n(v)===g,yn=g=>v=>typeof v===g,mo=uo("string"),Cn=uo("object"),br=uo("array"),Ae=yn("boolean"),Go=g=>g==null,Ve=g=>!Go(g),wn=yn("function"),vt=yn("number"),Re=()=>{},Hn=(g,v)=>k=>g(v(k)),Qt=g=>()=>g,Le=(g,v)=>g===v;function Sn(g,...v){return(...k)=>{const O=v.concat(k);return g.apply(null,O)}}const tt=g=>v=>!g(v),Ht=Qt(!1);class q{constructor(v,k){this.tag=v,this.value=k}static some(v){return new q(!0,v)}static none(){return q.singletonNone}fold(v,k){return this.tag?k(this.value):v()}isSome(){return this.tag}isNone(){return!this.tag}map(v){return this.tag?q.some(v(this.value)):q.none()}bind(v){return this.tag?v(this.value):q.none()}exists(v){return this.tag&&v(this.value)}forall(v){return!this.tag||v(this.value)}filter(v){return!this.tag||v(this.value)?this:q.none()}getOr(v){return this.tag?this.value:v}or(v){return this.tag?this:v}getOrThunk(v){return this.tag?this.value:v()}orThunk(v){return this.tag?this:v()}getOrDie(v){if(this.tag)return this.value;throw new Error(v??"Called getOrDie on None")}static from(v){return Ve(v)?q.some(v):q.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(v){this.tag&&v(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}q.singletonNone=new q(!1);const jt=Array.prototype.slice,Ce=Array.prototype.indexOf,$e=Array.prototype.push,Dt=(g,v)=>Ce.call(g,v),qe=(g,v)=>Dt(g,v)>-1,Eo=(g,v)=>{for(let k=0,O=g.length;k<O;k++){const M=g[k];if(v(M,k))return!0}return!1},it=(g,v)=>{const k=g.length,O=new Array(k);for(let M=0;M<k;M++){const nt=g[M];O[M]=v(nt,M)}return O},Zt=(g,v)=>{for(let k=0,O=g.length;k<O;k++){const M=g[k];v(M,k)}},On=(g,v)=>{const k=[];for(let O=0,M=g.length;O<M;O++){const nt=g[O];v(nt,O)&&k.push(nt)}return k},ft=(g,v)=>{if(g.length===0)return[];{let k=v(g[0]);const O=[];let M=[];for(let nt=0,_t=g.length;nt<_t;nt++){const $t=g[nt],Mt=v($t);Mt!==k&&(O.push(M),M=[]),k=Mt,M.push($t)}return M.length!==0&&O.push(M),O}},De=(g,v,k)=>(Zt(g,(O,M)=>{k=v(k,O,M)}),k),He=(g,v,k)=>{for(let O=0,M=g.length;O<M;O++){const nt=g[O];if(v(nt,O))return q.some(nt);if(k(nt,O))break}return q.none()},go=(g,v)=>He(g,v,Ht),Gn=g=>{const v=[];for(let k=0,O=g.length;k<O;++k){if(!br(g[k]))throw new Error("Arr.flatten item "+k+" was not an array, input: "+g);$e.apply(v,g[k])}return v},te=(g,v)=>Gn(it(g,v)),ae=g=>{const v=jt.call(g,0);return v.reverse(),v},x=(g,v)=>v>=0&&v<g.length?q.some(g[v]):q.none(),jn=g=>x(g,0),vr=g=>x(g,g.length-1),_o=(g,v)=>{const k=[],O=wn(v)?M=>Eo(k,nt=>v(nt,M)):M=>qe(k,M);for(let M=0,nt=g.length;M<nt;M++){const _t=g[M];O(_t)||k.push(_t)}return k},Xs=(g,v,k=Le)=>g.exists(O=>k(O,v)),Xt=(g,v,k=Le)=>de(g,v,k).getOr(g.isNone()&&v.isNone()),de=(g,v,k)=>g.isSome()&&v.isSome()?q.some(k(g.getOrDie(),v.getOrDie())):q.none(),qt=8,J=11,mn=1,Yo=3,Ot=(g,v)=>{const O=(v||document).createElement("div");if(O.innerHTML=g,!O.hasChildNodes()||O.childNodes.length>1){const M="HTML does not have a single root node";throw console.error(M,g),new Error(M)}return Xo(O.childNodes[0])},yr=(g,v)=>{const O=(v||document).createElement(g);return Xo(O)},en=(g,v)=>{const O=(v||document).createTextNode(g);return Xo(O)},Xo=g=>{if(g==null)throw new Error("Node cannot be null or undefined");return{dom:g}},oe={fromHtml:Ot,fromTag:yr,fromText:en,fromDom:Xo,fromPoint:(g,v,k)=>q.from(g.dom.elementFromPoint(v,k)).map(Xo)},zr=(g,v)=>{const k=g.dom;if(k.nodeType!==mn)return!1;{const O=k;if(O.matches!==void 0)return O.matches(v);if(O.msMatchesSelector!==void 0)return O.msMatchesSelector(v);if(O.webkitMatchesSelector!==void 0)return O.webkitMatchesSelector(v);if(O.mozMatchesSelector!==void 0)return O.mozMatchesSelector(v);throw new Error("Browser lacks native selectors")}},Qe=(g,v)=>g.dom===v.dom,kn=(g,v)=>{const k=g.dom,O=v.dom;return k===O?!1:k.contains(O)},No=zr,Qo=typeof window<"u"?window:Function("return this;")(),$r=(g,v)=>{let k=v??Qo;for(let O=0;O<g.length&&k!==void 0&&k!==null;++O)k=k[g[O]];return k},Yn=(g,v)=>{const k=g.split(".");return $r(k,v)},fo=(g,v)=>Yn(g,v),We=(g,v)=>{const k=fo(g,v);if(k==null)throw new Error(g+" not available on this browser");return k},Bn=Object.getPrototypeOf,Oe=g=>We("HTMLElement",g),Xn=g=>{const v=Yn("ownerDocument.defaultView",g);return Cn(g)&&(Oe(v).prototype.isPrototypeOf(g)||/^HTML\w*Element$/.test(Bn(g).constructor.name))},Qn=g=>g.dom.nodeName.toLowerCase(),je=g=>g.dom.nodeType,Cr=g=>v=>je(v)===g,re=g=>je(g)===qt||Qn(g)==="#comment",Zo=g=>nn(g)&&Xn(g.dom),nn=Cr(mn),Jo=Cr(Yo),bs=Cr(J),Ao=g=>v=>nn(v)&&Qn(v)===g,xn=g=>q.from(g.dom.parentNode).map(oe.fromDom),Hr=g=>q.from(g.dom.parentElement).map(oe.fromDom),ee=g=>q.from(g.dom.nextSibling).map(oe.fromDom),Bt=g=>it(g.dom.childNodes,oe.fromDom),Ro=(g,v)=>{const k=g.dom.childNodes;return q.from(k[v]).map(oe.fromDom)},wr=g=>Ro(g,0),Sr=g=>Ro(g,g.dom.childNodes.length-1),jr=g=>bs(g)&&Ve(g.dom.host),tr=g=>oe.fromDom(g.dom.getRootNode()),To=g=>{const v=tr(g);return jr(v)?q.some(v):q.none()},er=g=>oe.fromDom(g.dom.host),nr=g=>{const v=Jo(g)?g.dom.parentNode:g.dom;if(v==null||v.ownerDocument===null)return!1;const k=v.ownerDocument;return To(oe.fromDom(v)).fold(()=>k.body.contains(v),Hn(nr,er))};var or=(g,v,k,O,M)=>g(k,O)?q.some(k):wn(M)&&M(k)?q.none():v(k,O,M);const Vn=(g,v,k)=>{let O=g.dom;const M=wn(k)?k:Ht;for(;O.parentNode;){O=O.parentNode;const nt=oe.fromDom(O);if(v(nt))return q.some(nt);if(M(nt))break}return q.none()},ln=(g,v,k)=>or((M,nt)=>nt(M),Vn,g,v,k),vs=(g,v,k)=>Vn(g,O=>zr(O,v),k),ys=(g,v,k)=>or((M,nt)=>zr(M,nt),vs,g,v,k),Vr=g=>ys(g,"[contenteditable]"),gn=(g,v=!1)=>nr(g)?g.dom.isContentEditable:Vr(g).fold(Qt(v),k=>Qs(k)==="true"),Qs=g=>g.dom.contentEditable,qr=(g,v)=>{xn(g).each(O=>{O.dom.insertBefore(v.dom,g.dom)})},Pe=(g,v)=>{ee(g).fold(()=>{xn(g).each(M=>{Zn(M,v)})},O=>{qr(O,v)})},ie=(g,v)=>{wr(g).fold(()=>{Zn(g,v)},O=>{g.dom.insertBefore(v.dom,O.dom)})},Zn=(g,v)=>{g.dom.appendChild(v.dom)},Cs=(g,v)=>{Zt(v,k=>{qr(g,k)})},fn=(g,v)=>{Zt(v,k=>{Zn(g,k)})},ws=g=>{g.dom.textContent="",Zt(Bt(g),v=>{po(v)})},po=g=>{const v=g.dom;v.parentNode!==null&&v.parentNode.removeChild(v)};var cn=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),rr=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Oo=tinymce.util.Tools.resolve("tinymce.util.VK");const Ss=g=>it(g,oe.fromDom),Jn=Object.keys,Zs=(g,v)=>{const k=Jn(g);for(let O=0,M=k.length;O<M;O++){const nt=k[O],_t=g[nt];v(_t,nt)}},Aa=g=>(v,k)=>{g[k]=v},Js=(g,v,k,O)=>{Zs(g,(M,nt)=>{(v(M,nt)?k:O)(M,nt)})},Ra=(g,v)=>{const k={};return Js(g,v,Aa(k),Re),k},Ta=(g,v,k)=>{if(mo(k)||Ae(k)||vt(k))g.setAttribute(v,k+"");else throw console.error("Invalid call to Attribute.set. Key ",v,":: Value ",k,":: Element ",g),new Error("Attribute value was not simple")},Wr=(g,v)=>{const k=g.dom;Zs(v,(O,M)=>{Ta(k,M,O)})},sr=g=>De(g.dom.attributes,(v,k)=>(v[k.name]=k.value,v),{}),ks=(g,v)=>oe.fromDom(g.dom.cloneNode(v)),ta=g=>ks(g,!0),ea=(g,v)=>{const k=oe.fromTag(v),O=sr(g);return Wr(k,O),k},kr=(g,v)=>{const k=ea(g,v);Pe(g,k);const O=Bt(g);return fn(k,O),po(g),k};var xr=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ln=tinymce.util.Tools.resolve("tinymce.util.Tools");const xs=g=>v=>Ve(v)&&v.nodeName.toLowerCase()===g,ar=g=>v=>Ve(v)&&g.test(v.nodeName),En=g=>Ve(g)&&g.nodeType===3,Er=g=>Ve(g)&&g.nodeType===1,Fe=ar(/^(OL|UL|DL)$/),Oa=ar(/^(OL|UL)$/),na=xs("ol"),Kr=ar(/^(LI|DT|DD)$/),oa=ar(/^(DT|DD)$/),vi=ar(/^(TH|TD)$/),Ke=xs("br"),yi=g=>{var v;return((v=g.parentNode)===null||v===void 0?void 0:v.firstChild)===g},_r=(g,v)=>Ve(v)&&v.nodeName in g.schema.getTextBlockElements(),_n=(g,v)=>Ve(g)&&g.nodeName in v,Dn=(g,v)=>Ve(v)&&v.nodeName in g.schema.getVoidElements(),ho=(g,v)=>Ke(v)?g.isBlock(v.nextSibling)&&!Ke(v.previousSibling):!1,Bo=(g,v,k)=>{const O=g.isEmpty(v);return k&&g.select("span[data-mce-type=bookmark]",v).length>0?!1:O},Kt=(g,v)=>g.isChildOf(v,g.getRoot()),Es=g=>v=>v.options.get(g),Gr=g=>{const v=g.options.register;v("lists_indent_on_tab",{processor:"boolean",default:!0})},ra=Es("lists_indent_on_tab"),st=Es("forced_root_block"),bo=Es("forced_root_block_attrs"),Yr=(g,v,k={})=>{const O=g.dom,M=g.schema.getBlockElements(),nt=O.createFragment(),_t=st(g),$t=bo(g);let Mt,xt,ve=!1;for(xt=O.create(_t,{...$t,...k.style?{style:k.style}:{}}),_n(v.firstChild,M)||nt.appendChild(xt);Mt=v.firstChild;){const _e=Mt.nodeName;!ve&&(_e!=="SPAN"||Mt.getAttribute("data-mce-type")!=="bookmark")&&(ve=!0),_n(Mt,M)?(nt.appendChild(Mt),xt=null):(xt||(xt=O.create(_t,$t),nt.appendChild(xt)),xt.appendChild(Mt))}return!ve&&xt&&xt.appendChild(O.create("br",{"data-mce-bogus":"1"})),nt},ke=xr.DOM,Lo=(g,v,k)=>{const O=xt=>{const ve=xt.parentNode;ve&&Ln.each(M,_e=>{ve.insertBefore(_e,k.parentNode)}),ke.remove(xt)},M=ke.select('span[data-mce-type="bookmark"]',v),nt=Yr(g,k),_t=ke.createRng();_t.setStartAfter(k),_t.setEndAfter(v);const $t=_t.extractContents();for(let xt=$t.firstChild;xt;xt=xt.firstChild)if(xt.nodeName==="LI"&&g.dom.isEmpty(xt)){ke.remove(xt);break}g.dom.isEmpty($t)||ke.insertAfter($t,v),ke.insertAfter(nt,v);const Mt=k.parentElement;Mt&&Bo(g.dom,Mt)&&O(Mt),ke.remove(k),Bo(g.dom,v)&&ke.remove(v)},_s=Ao("dd"),Nr=Ao("dt"),Ba=(g,v)=>{_s(v)?kr(v,"dt"):Nr(v)&&Hr(v).each(k=>Lo(g,k.dom,v.dom))},Xr=g=>{Nr(g)&&kr(g,"dd")},Gt=(g,v,k)=>{v==="Indent"?Zt(k,Xr):Zt(k,O=>Ba(g,O))},Ns=(g,v)=>{if(En(g))return{container:g,offset:v};const k=cn.getNode(g,v);return En(k)?{container:k,offset:v>=g.childNodes.length?k.data.length:0}:k.previousSibling&&En(k.previousSibling)?{container:k.previousSibling,offset:k.previousSibling.data.length}:k.nextSibling&&En(k.nextSibling)?{container:k.nextSibling,offset:0}:{container:g,offset:v}},Do=g=>{const v=g.cloneRange(),k=Ns(g.startContainer,g.startOffset);v.setStart(k.container,k.offset);const O=Ns(g.endContainer,g.endOffset);return v.setEnd(O.container,O.offset),v},ir=["OL","UL","DL"],on=ir.join(","),Be=(g,v)=>{const k=v||g.selection.getStart(!0);return g.dom.getParent(k,on,Yt(g,k))},_=(g,v)=>Ve(g)&&v.length===1&&v[0]===g,T=g=>On(g.querySelectorAll(on),Fe),j=g=>{const v=Be(g),k=g.selection.getSelectedBlocks();return _(v,k)?T(v):On(k,O=>Fe(O)&&v!==O)},Z=(g,v)=>{const k=Ln.map(v,O=>{const M=g.dom.getParent(O,"li,dd,dt",Yt(g,O));return M||O});return _o(k)},et=g=>{const v=g.selection.getSelectedBlocks();return On(Z(g,v),Kr)},mt=g=>On(et(g),oa),Pt=(g,v)=>{const k=g.dom.getParents(v,"TD,TH");return k.length>0?k[0]:g.getBody()},se=(g,v)=>!Fe(v)&&!Kr(v)&&Eo(ir,k=>g.isValidChild(v.nodeName,k)),Yt=(g,v)=>{const k=g.dom.getParents(v,g.dom.isBlock),O=nt=>nt.nodeName.toLowerCase()!==st(g);return go(k,nt=>O(nt)&&se(g.schema,nt)).getOr(g.getBody())},C=g=>xn(g).exists(v=>Kr(v.dom)&&wr(v).exists(k=>!Fe(k.dom))&&Sr(v).exists(k=>!Fe(k.dom))),A=(g,v)=>{const k=g.dom.getParents(v,"ol,ul",Yt(g,v));return vr(k)},L=g=>{const v=A(g,g.selection.getStart()),k=On(g.selection.getSelectedBlocks(),Oa);return v.toArray().concat(k)},K=g=>{const v=g.selection.getStart();return g.dom.getParents(v,"ol,ul",Yt(g,v))},bt=g=>{const v=L(g),k=K(g);return go(k,O=>C(oe.fromDom(O))).fold(()=>Wt(g,v),O=>[O])},Wt=(g,v)=>{const k=it(v,O=>A(g,O).getOr(O));return _o(k)},be=g=>/\btox\-/.test(g.className),Ue=(g,v)=>He(g,Fe,vi).exists(k=>k.nodeName===v&&!be(k)),vo=(g,v)=>v!==null&&!g.dom.isEditable(v),to=g=>{const v=Be(g);return vo(g,v)||!g.selection.isEditable()},Ze=(g,v)=>{const k=g.dom.getParent(v,"ol,ul,dl");return vo(g,k)||!g.selection.isEditable()},yo=(g,v)=>{const k=g.selection.getNode();return v({parents:g.dom.getParents(k),element:k}),g.on("NodeChange",v),()=>g.off("NodeChange",v)},As=(g,v)=>{const O=(v||document).createDocumentFragment();return Zt(g,M=>{O.appendChild(M.dom)}),oe.fromDom(O)},xe=(g,v,k)=>g.dispatch("ListMutation",{action:v,element:k}),F=(g=>v=>v.replace(g,""))(/^\s+|\s+$/g),Po=g=>g.length>0,Ci=g=>!Po(g),eo=g=>g.style!==void 0&&wn(g.style.getPropertyValue),Kc=(g,v,k)=>{if(!mo(k))throw console.error("Invalid call to CSS.set. Property ",v,":: Value ",k,":: Element ",g),new Error("CSS value must be a string: "+k);eo(g)&&g.style.setProperty(v,k)},ne=(g,v,k)=>{const O=g.dom;Kc(O,v,k)},Pn=g=>No(g,"OL,UL"),Gc=g=>No(g,"LI"),Ar=g=>wr(g).exists(Pn),La=g=>Sr(g).exists(Pn),pn=g=>"listAttributes"in g,Da=g=>"isComment"in g,Yc=g=>"isFragment"in g,Rr=g=>g.depth>0,Pa=g=>g.isSelected,Xc=g=>{const v=Bt(g),k=La(g)?v.slice(0,-1):v;return it(k,ta)},Qc=(g,v,k)=>xn(g).filter(nn).map(O=>({depth:v,dirty:!1,isSelected:k,content:Xc(g),itemAttributes:sr(g),listAttributes:sr(O),listType:Qn(O),isInPreviousLi:!1})),rn=(g,v)=>{Zn(g.item,v.list)},sa=g=>{for(let v=1;v<g.length;v++)rn(g[v-1],g[v])},fl=(g,v)=>{de(vr(g),jn(v),rn)},pl=(g,v)=>{const k={list:oe.fromTag(v,g),item:oe.fromTag("li",g)};return Zn(k.list,k.item),k},hl=(g,v,k)=>{const O=[];for(let M=0;M<k;M++)O.push(pl(g,pn(v)?v.listType:v.parentListType));return O},bl=(g,v)=>{for(let k=0;k<g.length-1;k++)ne(g[k].item,"list-style-type","none");vr(g).each(k=>{pn(v)&&(Wr(k.list,v.listAttributes),Wr(k.item,v.itemAttributes)),fn(k.item,v.content)})},Qr=(g,v)=>{Qn(g.list)!==v.listType&&(g.list=kr(g.list,v.listType)),Wr(g.list,v.listAttributes)},vl=(g,v,k)=>{const O=oe.fromTag("li",g);return Wr(O,v),fn(O,k),O},am=(g,v)=>{Zn(g.list,v),g.item=v},yl=(g,v,k)=>{const O=v.slice(0,k.depth);return vr(O).each(M=>{if(pn(k)){const nt=vl(g,k.itemAttributes,k.content);am(M,nt),Qr(M,k)}else if(Yc(k))fn(M.item,k.content);else{const nt=oe.fromHtml(`<!--${k.content}-->`);Zn(M.list,nt)}}),O},im=(g,v,k)=>{const O=hl(g,k,k.depth-v.length);return sa(O),bl(O,k),fl(v,O),v.concat(O)},aa=(g,v)=>{let k=q.none();const O=De(v,(M,nt,_t)=>Da(nt)?_t===0?(k=q.some(nt),M):yl(g,M,nt):nt.depth>M.length?im(g,M,nt):yl(g,M,nt),[]);return k.each(M=>{const nt=oe.fromHtml(`<!--${M.content}-->`);jn(O).each(_t=>{ie(_t.list,nt)})}),jn(O).map(M=>M.list)},Zc=(g,v)=>{switch(g){case"Indent":v.depth++;break;case"Outdent":v.depth--;break;case"Flatten":v.depth=0}v.dirty=!0},Tr=(g,v)=>{pn(g)&&pn(v)&&(g.listType=v.listType,g.listAttributes={...v.listAttributes})},Zr=g=>{g.listAttributes=Ra(g.listAttributes,(v,k)=>k!=="start")},Cl=(g,v)=>{const k=g[v].depth,O=nt=>nt.depth===k&&!nt.dirty,M=nt=>nt.depth<k;return He(ae(g.slice(0,v)),O,M).orThunk(()=>He(g.slice(v+1),O,M))},ia=g=>(Zt(g,(v,k)=>{Cl(g,k).fold(()=>{v.dirty&&pn(v)&&Zr(v)},O=>Tr(v,O))}),g),wi=g=>{let v=g;return{get:()=>v,set:M=>{v=M}}},Ts=(g,v,k,O)=>{var M;if(re(O))return[{depth:g+1,content:(M=O.dom.nodeValue)!==null&&M!==void 0?M:"",dirty:!1,isSelected:!1,isComment:!0}];v.each($t=>{Qe($t.start,O)&&k.set(!0)});const nt=Qc(O,g,k.get());v.each($t=>{Qe($t.end,O)&&k.set(!1)});const _t=Sr(O).filter(Pn).map($t=>Si(g,v,k,$t)).getOr([]);return nt.toArray().concat(_t)},Jr=(g,v,k,O)=>wr(O).filter(Pn).fold(()=>Ts(g,v,k,O),M=>{const nt=De(Bt(O),(_t,$t,Mt)=>{if(Mt===0)return _t;if(Gc($t))return _t.concat(Ts(g,v,k,$t));{const xt={isFragment:!0,depth:g,content:[$t],isSelected:!1,dirty:!1,parentListType:Qn(M)};return _t.concat(xt)}},[]);return Si(g,v,k,M).concat(nt)}),Si=(g,v,k,O)=>te(Bt(O),M=>{const nt=Pn(M)?Si:Jr,_t=g+1;return nt(_t,v,k,M)}),ki=(g,v)=>{const k=wi(!1),O=0;return it(g,M=>({sourceList:M,entries:Si(O,v,k,M)}))},Ia=(g,v)=>{const k=ia(v);return it(k,O=>{const M=Da(O)?As([oe.fromHtml(`<!--${O.content}-->`)]):As(O.content),nt=pn(O)?O.itemAttributes:{};return oe.fromDom(Yr(g,M.dom,nt))})},Jc=(g,v)=>{const k=ia(v);return aa(g.contentDocument,k).toArray()},td=(g,v)=>te(ft(v,Rr),k=>jn(k).exists(Rr)?Jc(g,k):Ia(g,k)),xi=(g,v)=>{Zt(On(g,Pa),k=>Zc(v,k))},lr=g=>{const v=it(et(g),oe.fromDom);return de(go(v,tt(Ar)),go(ae(v),tt(Ar)),(k,O)=>({start:k,end:O}))},ed=(g,v,k)=>{const O=ki(v,lr(g));Zt(O,M=>{xi(M.entries,k);const nt=td(g,M.entries);Zt(nt,_t=>{xe(g,k==="Indent"?"IndentList":"OutdentList",_t.dom)}),Cs(M.sourceList,nt),po(M.sourceList)})},Ei=(g,v)=>{const k=Ss(bt(g)),O=Ss(mt(g));let M=!1;if(k.length||O.length){const nt=g.selection.getBookmark();ed(g,k,v),Gt(g,v,O),g.selection.moveToBookmark(nt),g.selection.setRng(Do(g.selection.getRng())),g.nodeChanged(),M=!0}return M},Ma=(g,v)=>!to(g)&&Ei(g,v),wl=g=>Ma(g,"Indent"),hn=g=>Ma(g,"Outdent"),Co=g=>Ma(g,"Flatten"),Sl="\uFEFF",Ie=g=>g===Sl,nd=(g,v,k)=>Vn(g,v,k).isSome(),Os=(g,v)=>nd(g,Sn(Qe,v));var la=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const le=xr.DOM,no=g=>{const v={},k=O=>{let M=g[O?"startContainer":"endContainer"],nt=g[O?"startOffset":"endOffset"];if(Er(M)){const _t=le.create("span",{"data-mce-type":"bookmark"});M.hasChildNodes()?(nt=Math.min(nt,M.childNodes.length-1),O?M.insertBefore(_t,M.childNodes[nt]):le.insertAfter(_t,M.childNodes[nt])):M.appendChild(_t),M=_t,nt=0}v[O?"startContainer":"endContainer"]=M,v[O?"startOffset":"endOffset"]=nt};return k(!0),g.collapsed||k(),v},ts=g=>{const v=O=>{const M=$t=>{var Mt;let xt=(Mt=$t.parentNode)===null||Mt===void 0?void 0:Mt.firstChild,ve=0;for(;xt;){if(xt===$t)return ve;(!Er(xt)||xt.getAttribute("data-mce-type")!=="bookmark")&&ve++,xt=xt.nextSibling}return-1};let nt=g[O?"startContainer":"endContainer"],_t=g[O?"startOffset":"endOffset"];if(nt){if(Er(nt)&&nt.parentNode){const $t=nt;_t=M(nt),nt=nt.parentNode,le.remove($t),!nt.hasChildNodes()&&le.isBlock(nt)&&nt.appendChild(le.create("br"))}g[O?"startContainer":"endContainer"]=nt,g[O?"startOffset":"endOffset"]=_t}};v(!0),v();const k=le.createRng();return k.setStart(g.startContainer,g.startOffset),g.endContainer&&k.setEnd(g.endContainer,g.endOffset),Do(k)},Bs=g=>{switch(g){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},_i=(g,v,k)=>{const O=k["list-style-type"]?k["list-style-type"]:null;g.setStyle(v,"list-style-type",O)},od=(g,v)=>{Ln.each(v,(k,O)=>{g.setAttribute(O,k)})},lm=(g,v,k)=>{od(v,k["list-attributes"]),Ln.each(g.select("li",v),O=>{od(O,k["list-item-attributes"])})},Ls=(g,v,k)=>{_i(g,v,k),lm(g,v,k)},ca=(g,v,k)=>{Ln.each(k,O=>g.setStyle(v,O,""))},Ds=(g,v)=>Ve(v)&&!_n(v,g.schema.getBlockElements()),Fa=(g,v,k,O)=>{let M=v[k?"startContainer":"endContainer"];const nt=v[k?"startOffset":"endOffset"];Er(M)&&(M=M.childNodes[Math.min(nt,M.childNodes.length-1)]||M),!k&&Ke(M.nextSibling)&&(M=M.nextSibling);const _t=Mt=>{for(;!g.dom.isBlock(Mt)&&Mt.parentNode&&O!==Mt;)Mt=Mt.parentNode;return Mt},$t=(Mt,xt)=>{var ve;const _e=new rr(Mt,_t(Mt)),os=xt?"next":"prev";let In;for(;In=_e[os]();)if(!(Dn(g,In)||Ie(In.textContent)||((ve=In.textContent)===null||ve===void 0?void 0:ve.length)===0))return q.some(In);return q.none()};if(k&&En(M))if(Ie(M.textContent))M=$t(M,!1).getOr(M);else for(M.parentNode!==null&&Ds(g,M.parentNode)&&(M=M.parentNode);M.previousSibling!==null&&(Ds(g,M.previousSibling)||En(M.previousSibling));)M=M.previousSibling;if(!k&&En(M))if(Ie(M.textContent))M=$t(M,!0).getOr(M);else for(M.parentNode!==null&&Ds(g,M.parentNode)&&(M=M.parentNode);M.nextSibling!==null&&(Ds(g,M.nextSibling)||En(M.nextSibling));)M=M.nextSibling;for(;M.parentNode!==O;){const Mt=M.parentNode;if(_r(g,M)||/^(TD|TH)$/.test(Mt.nodeName))return M;M=Mt}return M},kl=(g,v,k)=>{const O=[],M=g.dom,nt=Fa(g,v,!0,k),_t=Fa(g,v,!1,k);let $t;const Mt=[];for(let xt=nt;xt&&(Mt.push(xt),xt!==_t);xt=xt.nextSibling);return Ln.each(Mt,xt=>{var ve;if(_r(g,xt)){O.push(xt),$t=null;return}if(M.isBlock(xt)||Ke(xt)){Ke(xt)&&M.remove(xt),$t=null;return}const _e=xt.nextSibling;if(la.isBookmarkNode(xt)&&(Fe(_e)||_r(g,_e)||!_e&&xt.parentNode===k)){$t=null;return}$t||($t=M.create("p"),(ve=xt.parentNode)===null||ve===void 0||ve.insertBefore($t,xt),O.push($t)),$t.appendChild(xt)}),O},rd=(g,v,k)=>{const O=g.getStyle(v,"list-style-type");let M=k?k["list-style-type"]:"";return M=M===null?"":M,O===M},sd=(g,v)=>{const k=g.selection.getStart(!0),O=Fa(g,v,!0,g.getBody());return Os(oe.fromDom(O),oe.fromDom(v.commonAncestorContainer))?v.commonAncestorContainer:k},Ni=(g,v,k)=>{const O=g.selection.getRng();let M="LI";const nt=Yt(g,sd(g,O)),_t=g.dom;if(_t.getContentEditable(g.selection.getNode())==="false")return;v=v.toUpperCase(),v==="DL"&&(M="DT");const $t=no(O),Mt=On(kl(g,O,nt),g.dom.isEditable);Ln.each(Mt,xt=>{let ve;const _e=xt.previousSibling,os=xt.parentNode;Kr(os)||(_e&&Fe(_e)&&_e.nodeName===v&&rd(_t,_e,k)?(ve=_e,xt=_t.rename(xt,M),_e.appendChild(xt)):(ve=_t.create(v),os.insertBefore(ve,xt),ve.appendChild(xt),xt=_t.rename(xt,M)),ca(_t,xt,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),Ls(_t,ve,k),El(g.dom,ve))}),g.selection.setRng(ts($t))},ad=(g,v)=>Fe(g)&&g.nodeName===v?.nodeName,id=(g,v,k)=>{const O=g.getStyle(v,"list-style-type",!0),M=g.getStyle(k,"list-style-type",!0);return O===M},dn=(g,v)=>g.className===v.className,xl=(g,v,k)=>ad(v,k)&&id(g,v,k)&&dn(v,k),El=(g,v)=>{let k,O=v.nextSibling;if(xl(g,v,O)){const M=O;for(;k=M.firstChild;)v.appendChild(k);g.remove(M)}if(O=v.previousSibling,xl(g,v,O)){const M=O;for(;k=M.lastChild;)v.insertBefore(k,v.firstChild);g.remove(M)}},_l=(g,v,k,O)=>{if(v.nodeName!==k){const M=g.dom.rename(v,k);Ls(g.dom,M,O),xe(g,Bs(k),M)}else Ls(g.dom,v,O),xe(g,Bs(k),v)},Ge=(g,v,k,O)=>{if(v.classList.forEach((M,nt,_t)=>{M.startsWith("tox-")&&(_t.remove(M),_t.length===0&&v.removeAttribute("class"))}),v.nodeName!==k){const M=g.dom.rename(v,k);Ls(g.dom,M,O),xe(g,Bs(k),M)}else Ls(g.dom,v,O),xe(g,Bs(k),v)},Ua=(g,v,k,O,M)=>{const nt=Fe(v);if(nt&&v.nodeName===O&&!ze(M)&&!be(v))Co(g);else{Ni(g,O,M);const _t=no(g.selection.getRng()),$t=nt?[v,...k]:k,Mt=nt&&be(v)?Ge:_l;Ln.each($t,xt=>{Mt(g,xt,O,M)}),g.selection.setRng(ts(_t))}},ze=g=>"list-style-type"in g,Nl=(g,v,k,O)=>{if(v!==g.getBody())if(v)if(v.nodeName===k&&!ze(O)&&!be(v))Co(g);else{const M=no(g.selection.getRng());be(v)&&v.classList.forEach((_t,$t,Mt)=>{_t.startsWith("tox-")&&(Mt.remove(_t),Mt.length===0&&v.removeAttribute("class"))}),Ls(g.dom,v,O);const nt=g.dom.rename(v,k);El(g.dom,nt),g.selection.setRng(ts(M)),Ni(g,k,O),xe(g,Bs(k),nt)}else Ni(g,k,O),xe(g,Bs(k),v)},Al=(g,v,k)=>{const O=Be(g);if(Ze(g,O))return;const M=j(g),nt=Cn(k)?k:{};M.length>0?Ua(g,O,M,v,nt):Nl(g,O,v,nt)},Ps=xr.DOM,ld=(g,v)=>{const k=v.parentElement;if(k&&k.nodeName==="LI"&&k.firstChild===v){const O=k.previousSibling;O&&O.nodeName==="LI"?(O.appendChild(v),Bo(g,k)&&Ps.remove(k)):Ps.setStyle(k,"listStyleType","none")}if(Fe(k)){const O=k.previousSibling;O&&O.nodeName==="LI"&&O.appendChild(v)}},Rl=(g,v)=>{const k=Ln.grep(g.select("ol,ul",v));Ln.each(k,O=>{ld(g,O)})},es=(g,v,k,O)=>{let M=v.startContainer;const nt=v.startOffset;if(En(M)&&(k?nt<M.data.length:nt>0))return M;const _t=g.schema.getNonEmptyElements();Er(M)&&(M=cn.getNode(M,nt));const $t=new rr(M,O);k&&ho(g.dom,M)&&$t.next();const Mt=k?$t.next.bind($t):$t.prev2.bind($t);for(;M=Mt();)if(M.nodeName==="LI"&&!M.hasChildNodes()||_t[M.nodeName]||En(M)&&M.data.length>0)return M;return null},za=(g,v)=>{const k=v.childNodes;return k.length===1&&!Fe(k[0])&&g.isBlock(k[0])},wt=g=>q.from(g).map(oe.fromDom).filter(Zo).exists(v=>gn(v)&&!qe(["details"],Qn(v))),cr=(g,v)=>{za(g,v)&&wt(v.firstChild)&&g.remove(v.firstChild,!0)},da=(g,v,k)=>{let O;const M=za(g,k)?k.firstChild:k;if(cr(g,v),!Bo(g,v,!0))for(;O=v.firstChild;)M.appendChild(O)},oo=(g,v,k)=>{let O;const M=v.parentNode;if(!Kt(g,v)||!Kt(g,k))return;Fe(k.lastChild)&&(O=k.lastChild),M===k.lastChild&&Ke(M.previousSibling)&&g.remove(M.previousSibling);const nt=k.lastChild;nt&&Ke(nt)&&v.hasChildNodes()&&g.remove(nt),Bo(g,k,!0)&&ws(oe.fromDom(k)),da(g,v,k),O&&k.appendChild(O);const $t=kn(oe.fromDom(k),oe.fromDom(v))?g.getParents(v,Fe,k):[];g.remove(v),Zt($t,Mt=>{Bo(g,Mt)&&Mt!==g.getRoot()&&g.remove(Mt)})},Ai=(g,v,k)=>{ws(oe.fromDom(k)),oo(g.dom,v,k),g.selection.setCursorLocation(k,0)},Is=(g,v,k,O)=>{const M=g.dom;if(M.isEmpty(O))Ai(g,k,O);else{const nt=no(v);oo(M,k,O),g.selection.setRng(ts(nt))}},dr=(g,v,k,O)=>{const M=no(v);oo(g.dom,k,O);const nt=ts(M);g.selection.setRng(nt)},cd=(g,v)=>{const k=g.dom,O=g.selection,M=O.getStart(),nt=Pt(g,M),_t=k.getParent(O.getStart(),"LI",nt);if(_t){const $t=_t.parentElement;if($t===g.getBody()&&Bo(k,$t))return!0;const Mt=Do(O.getRng()),xt=k.getParent(es(g,Mt,v,nt),"LI",nt),ve=xt&&(v?k.isChildOf(_t,xt):k.isChildOf(xt,_t));if(xt&&xt!==_t&&!ve)return g.undoManager.transact(()=>{v?Is(g,Mt,xt,_t):yi(_t)?hn(g):dr(g,Mt,_t,xt)}),!0;if(ve&&!v&&xt!==_t){const _e=Mt.commonAncestorContainer.parentElement;return!_e||k.isChildOf(xt,_e)?!1:(g.undoManager.transact(()=>{const os=no(Mt);da(k,_e,xt),_e.remove();const In=ts(os);g.selection.setRng(In)}),!0)}else if(!xt&&!v&&Mt.startOffset===0&&Mt.endOffset===0)return g.undoManager.transact(()=>{Co(g)}),!0}return!1},Tl=(g,v,k)=>{const O=g.getParent(v.parentNode,g.isBlock,k);g.remove(v),O&&g.isEmpty(O)&&g.remove(O)},rt=(g,v)=>{const k=g.dom,O=g.selection.getStart(),M=Pt(g,O),nt=k.getParent(O,k.isBlock,M);if(nt&&k.isEmpty(nt,void 0,{checkRootAsContent:!0})){const _t=Do(g.selection.getRng()),$t=es(g,_t,v,M),Mt=k.getParent($t,"LI",M);if($t&&Mt){const xt=In=>qe(["td","th","caption"],Qn(In)),ve=In=>In.dom===M,_e=ln(oe.fromDom(Mt),xt,ve),os=ln(oe.fromDom(_t.startContainer),xt,ve);return Xt(_e,os,Qe)?(g.undoManager.transact(()=>{const In=Mt.parentNode;Tl(k,nt,M),El(k,In),g.selection.select($t,!0),g.selection.collapse(v)}),!0):!1}}return!1},cm=(g,v)=>cd(g,v)||rt(g,v),dd=g=>{const v=g.selection.getStart(),k=Pt(g,v);return g.dom.getParent(v,"LI,DT,DD",k)||et(g).length>0},ns=g=>dd(g)?(g.undoManager.transact(()=>{let v=!0;const k=()=>v=!1;g.on("input",k),g.execCommand("Delete"),g.off("input",k),v&&g.dispatch("input"),Rl(g.dom,g.getBody())}),!0):!1,Ms=(g,v)=>{const k=g.selection;return!Ze(g,k.getNode())&&(k.isCollapsed()?cm(g,v):ns(g))},Ol=g=>{g.on("ExecCommand",v=>{const k=v.command.toLowerCase();(k==="delete"||k==="forwarddelete")&&dd(g)&&Rl(g.dom,g.getBody())}),g.on("keydown",v=>{v.keyCode===Oo.BACKSPACE?Ms(g,!1)&&v.preventDefault():v.keyCode===Oo.DELETE&&Ms(g,!0)&&v.preventDefault()})},Ee=g=>({backspaceDelete:v=>{Ms(g,v)}}),ud=(g,v)=>{const k=Be(g);k===null||Ze(g,k)||g.undoManager.transact(()=>{Cn(v.styles)&&g.dom.setStyles(k,v.styles),Cn(v.attrs)&&Zs(v.attrs,(O,M)=>g.dom.setAttrib(k,M,O))})},ro=g=>{const v=ae(F(g).split("")),k=it(v,(O,M)=>{const nt=O.toUpperCase().charCodeAt(0)-65+1;return Math.pow(26,M)*nt});return De(k,(O,M)=>O+M,0)},me=g=>{if(g--,g<0)return"";{const v=g%26,k=Math.floor(g/26),O=me(k),M=String.fromCharCode(65+v);return O+M}},Bl=g=>/^[A-Z]+$/.test(g),Ri=g=>/^[a-z]+$/.test(g),dm=g=>/^[0-9]+$/.test(g),ur=g=>dm(g)?2:Bl(g)?0:Ri(g)?1:Ci(g)?3:4,um=g=>{switch(ur(g)){case 2:return q.some({listStyleType:q.none(),start:g});case 0:return q.some({listStyleType:q.some("upper-alpha"),start:ro(g).toString()});case 1:return q.some({listStyleType:q.some("lower-alpha"),start:ro(g).toString()});case 3:return q.some({listStyleType:q.none(),start:""});case 4:return q.none()}},Ll=g=>{const v=parseInt(g.start,10);return Xs(g.listStyleType,"upper-alpha")?me(v):Xs(g.listStyleType,"lower-alpha")?me(v).toLowerCase():g.start},mm=g=>{const v=Be(g);!na(v)||Ze(g,v)||g.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:Ll({start:g.dom.getAttrib(v,"start","1"),listStyleType:q.from(g.dom.getStyle(v,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:k=>{const O=k.getData();um(O.start).each(M=>{g.execCommand("mceListUpdate",!1,{attrs:{start:M.start==="1"?"":M.start},styles:{"list-style-type":M.listStyleType.getOr("")}})}),k.close()}})},Ti=(g,v)=>()=>{const k=Be(g);return Ve(k)&&k.nodeName===v},md=g=>{g.addCommand("mceListProps",()=>{mm(g)})},gm=g=>{g.on("BeforeExecCommand",v=>{const k=v.command.toLowerCase();k==="indent"?wl(g):k==="outdent"&&hn(g)}),g.addCommand("InsertUnorderedList",(v,k)=>{Al(g,"UL",k)}),g.addCommand("InsertOrderedList",(v,k)=>{Al(g,"OL",k)}),g.addCommand("InsertDefinitionList",(v,k)=>{Al(g,"DL",k)}),g.addCommand("RemoveList",()=>{Co(g)}),md(g),g.addCommand("mceListUpdate",(v,k)=>{Cn(k)&&ud(g,k)}),g.addQueryStateHandler("InsertUnorderedList",Ti(g,"UL")),g.addQueryStateHandler("InsertOrderedList",Ti(g,"OL")),g.addQueryStateHandler("InsertDefinitionList",Ti(g,"DL"))};var Dl=tinymce.util.Tools.resolve("tinymce.html.Node");const mr=g=>g.type===3,sn=g=>g.length===0,gd=g=>{const v=(M,nt)=>{const _t=Dl.create("li");Zt(M,$t=>_t.append($t)),nt?g.insert(_t,nt,!0):g.append(_t)},k=(M,nt)=>mr(nt)?[...M,nt]:!sn(M)&&!mr(nt)?(v(M,nt),[]):M,O=De(g.children(),k,[]);sn(O)||v(O)},Ye=g=>{g.on("PreInit",()=>{const{parser:v}=g;v.addNodeFilter("ul,ol",k=>Zt(k,gd))})},fm=g=>{g.on("keydown",v=>{v.keyCode!==Oo.TAB||Oo.metaKeyPressed(v)||g.undoManager.transact(()=>{(v.shiftKey?hn(g):wl(g))&&v.preventDefault()})})},Or=g=>{ra(g)&&fm(g),Ol(g)},Pl=(g,v)=>k=>{const O=M=>{k.setActive(Ue(M.parents,v)),k.setEnabled(!Ze(g,M.element)&&g.selection.isEditable())};return k.setEnabled(g.selection.isEditable()),yo(g,O)},Fs=g=>{const v=k=>()=>g.execCommand(k);g.hasPlugin("advlist")||(g.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:v("InsertOrderedList"),onSetup:Pl(g,"OL")}),g.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:v("InsertUnorderedList"),onSetup:Pl(g,"UL")}))},Il=(g,v)=>k=>yo(g,M=>k.setEnabled(Ue(M.parents,v)&&!Ze(g,M.element))),fd=g=>{const v={text:"List properties...",icon:"ordered-list",onAction:()=>g.execCommand("mceListProps"),onSetup:Il(g,"OL")};g.ui.registry.addMenuItem("listprops",v),g.ui.registry.addContextMenu("lists",{update:k=>{const O=Be(g,k);return na(O)?["listprops"]:[]}})};var pm=()=>{Ur.add("lists",g=>(Gr(g),Ye(g),g.hasPlugin("rtc",!0)?md(g):(Or(g),gm(g)),Fs(g),fd(g),Ee(g)))};pm()}(),function(){"use strict";var Ur=tinymce.util.Tools.resolve("tinymce.PluginManager");const xo=Object.getPrototypeOf,$n=(C,A,L)=>{var K;return L(C,A.prototype)?!0:((K=C.constructor)===null||K===void 0?void 0:K.name)===A.name},uo=C=>{const A=typeof C;return C===null?"null":A==="object"&&Array.isArray(C)?"array":A==="object"&&$n(C,String,(L,K)=>K.isPrototypeOf(L))?"string":A},yn=C=>A=>uo(A)===C,mo=C=>A=>typeof A===C,Cn=C=>A=>C===A,br=(C,A)=>Go(C)&&$n(C,A,(L,K)=>xo(L)===K),Ae=yn("string"),Go=yn("object"),Ve=C=>br(C,Object),wn=yn("array"),vt=Cn(null),Re=mo("boolean"),Hn=C=>C==null,Qt=C=>!Hn(C),Le=mo("function"),Sn=mo("number"),tt=(C,A)=>{if(wn(C)){for(let L=0,K=C.length;L<K;++L)if(!A(C[L]))return!1;return!0}return!1},Ht=()=>{};class q{constructor(A,L){this.tag=A,this.value=L}static some(A){return new q(!0,A)}static none(){return q.singletonNone}fold(A,L){return this.tag?L(this.value):A()}isSome(){return this.tag}isNone(){return!this.tag}map(A){return this.tag?q.some(A(this.value)):q.none()}bind(A){return this.tag?A(this.value):q.none()}exists(A){return this.tag&&A(this.value)}forall(A){return!this.tag||A(this.value)}filter(A){return!this.tag||A(this.value)?this:q.none()}getOr(A){return this.tag?this.value:A}or(A){return this.tag?this:A}getOrThunk(A){return this.tag?this.value:A()}orThunk(A){return this.tag?this:A()}getOrDie(A){if(this.tag)return this.value;throw new Error(A??"Called getOrDie on None")}static from(A){return Qt(A)?q.some(A):q.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(A){this.tag&&A(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}q.singletonNone=new q(!1);const jt=Object.keys,Ce=Object.hasOwnProperty,$e=(C,A)=>{const L=jt(C);for(let K=0,bt=L.length;K<bt;K++){const Wt=L[K],be=C[Wt];A(be,Wt)}},Dt=C=>(A,L)=>{C[L]=A},qe=(C,A,L,K)=>{$e(C,(bt,Wt)=>{(A(bt,Wt)?L:K)(bt,Wt)})},Eo=(C,A)=>{const L={};return qe(C,A,Dt(L),Ht),L},it=(C,A)=>Ce.call(C,A),Zt=(C,A)=>it(C,A)&&C[A]!==void 0&&C[A]!==null,On=Array.prototype.push,ft=C=>{const A=[];for(let L=0,K=C.length;L<K;++L){if(!wn(C[L]))throw new Error("Arr.flatten item "+L+" was not an array, input: "+C);On.apply(A,C[L])}return A},De=(C,A)=>A>=0&&A<C.length?q.some(C[A]):q.none(),He=C=>De(C,0),go=(C,A)=>{for(let L=0;L<C.length;L++){const K=A(C[L],L);if(K.isSome())return K}return q.none()};typeof window<"u"||Function("return this;")();const Gn=(C,A,L)=>{if(Ae(L)||Re(L)||Sn(L))C.setAttribute(A,L+"");else throw console.error("Invalid call to Attribute.set. Key ",A,":: Value ",L,":: Element ",C),new Error("Attribute value was not simple")},te=(C,A,L)=>{Gn(C.dom,A,L)},ae=(C,A)=>{C.dom.removeAttribute(A)},x=(C,A)=>{const K=(A||document).createElement("div");if(K.innerHTML=C,!K.hasChildNodes()||K.childNodes.length>1){const bt="HTML does not have a single root node";throw console.error(bt,C),new Error(bt)}return _o(K.childNodes[0])},jn=(C,A)=>{const K=(A||document).createElement(C);return _o(K)},vr=(C,A)=>{const K=(A||document).createTextNode(C);return _o(K)},_o=C=>{if(C==null)throw new Error("Node cannot be null or undefined");return{dom:C}},Xt={fromHtml:x,fromTag:jn,fromText:vr,fromDom:_o,fromPoint:(C,A,L)=>q.from(C.dom.elementFromPoint(A,L)).map(_o)};var de=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),qt=tinymce.util.Tools.resolve("tinymce.util.URI");const J=C=>C.length>0,mn=C=>A=>A.options.get(C),Yo=C=>{const A=C.options.register;A("image_dimensions",{processor:"boolean",default:!0}),A("image_advtab",{processor:"boolean",default:!1}),A("image_uploadtab",{processor:"boolean",default:!0}),A("image_prepend_url",{processor:"string",default:""}),A("image_class_list",{processor:"object[]"}),A("image_description",{processor:"boolean",default:!0}),A("image_title",{processor:"boolean",default:!1}),A("image_caption",{processor:"boolean",default:!1}),A("image_list",{processor:L=>{const K=L===!1||Ae(L)||tt(L,Go)||Le(L);return K?{value:L,valid:K}:{valid:!1,message:"Must be false, a string, an array or a function."}},default:!1})},Ot=mn("image_dimensions"),yr=mn("image_advtab"),en=mn("image_uploadtab"),Xo=mn("image_prepend_url"),Te=mn("image_class_list"),oe=mn("image_description"),zr=mn("image_title"),Qe=mn("image_caption"),kn=mn("image_list"),No=mn("a11y_advanced_options"),Qo=mn("automatic_uploads"),$r=C=>J(C.options.get("images_upload_url")),Yn=C=>Qt(C.options.get("images_upload_handler")),fo=(C,A)=>Math.max(parseInt(C,10),parseInt(A,10)),We=C=>new Promise(A=>{const L=document.createElement("img"),K=Wt=>{L.parentNode&&L.parentNode.removeChild(L),A(Wt)};L.addEventListener("load",()=>{const Wt=fo(L.width,L.clientWidth),be=fo(L.height,L.clientHeight),Ue={width:Wt,height:be};K(Promise.resolve(Ue))}),L.addEventListener("error",()=>{K(Promise.reject(`Failed to get image dimensions for: ${C}`))});const bt=L.style;bt.visibility="hidden",bt.position="fixed",bt.bottom=bt.left="0px",bt.width=bt.height="auto",document.body.appendChild(L),L.src=C}),Bn=C=>(C&&(C=C.replace(/px$/,"")),C),Oe=C=>(C.length>0&&/^[0-9]+$/.test(C)&&(C+="px"),C),Xn=C=>{if(C.margin){const A=String(C.margin).split(" ");switch(A.length){case 1:C["margin-top"]=C["margin-top"]||A[0],C["margin-right"]=C["margin-right"]||A[0],C["margin-bottom"]=C["margin-bottom"]||A[0],C["margin-left"]=C["margin-left"]||A[0];break;case 2:C["margin-top"]=C["margin-top"]||A[0],C["margin-right"]=C["margin-right"]||A[1],C["margin-bottom"]=C["margin-bottom"]||A[0],C["margin-left"]=C["margin-left"]||A[1];break;case 3:C["margin-top"]=C["margin-top"]||A[0],C["margin-right"]=C["margin-right"]||A[1],C["margin-bottom"]=C["margin-bottom"]||A[2],C["margin-left"]=C["margin-left"]||A[1];break;case 4:C["margin-top"]=C["margin-top"]||A[0],C["margin-right"]=C["margin-right"]||A[1],C["margin-bottom"]=C["margin-bottom"]||A[2],C["margin-left"]=C["margin-left"]||A[3]}delete C.margin}return C},Qn=(C,A)=>{const L=kn(C);Ae(L)?fetch(L).then(K=>{K.ok&&K.json().then(A)}):Le(L)?L(A):A(L)},je=(C,A,L)=>{const K=()=>{L.onload=L.onerror=null,C.selection&&(C.selection.select(L),C.nodeChanged())};L.onload=()=>{!A.width&&!A.height&&Ot(C)&&C.dom.setAttribs(L,{width:String(L.clientWidth),height:String(L.clientHeight)}),K()},L.onerror=K},Cr=C=>new Promise((A,L)=>{const K=new FileReader;K.onload=()=>{A(K.result)},K.onerror=()=>{var bt;L((bt=K.error)===null||bt===void 0?void 0:bt.message)},K.readAsDataURL(C)}),re=C=>C.nodeName==="IMG"&&(C.hasAttribute("data-mce-object")||C.hasAttribute("data-mce-placeholder")),Zo=(C,A)=>{const L=C.options.get;return qt.isDomSafe(A,"img",{allow_html_data_urls:L("allow_html_data_urls"),allow_script_urls:L("allow_script_urls"),allow_svg_data_urls:L("allow_svg_data_urls")})},nn=de.DOM,Jo=C=>C.style.marginLeft&&C.style.marginRight&&C.style.marginLeft===C.style.marginRight?Bn(C.style.marginLeft):"",bs=C=>C.style.marginTop&&C.style.marginBottom&&C.style.marginTop===C.style.marginBottom?Bn(C.style.marginTop):"",Ao=C=>C.style.borderWidth?Bn(C.style.borderWidth):"",xn=(C,A)=>{var L;return C.hasAttribute(A)&&(L=C.getAttribute(A))!==null&&L!==void 0?L:""},Hr=C=>C.parentNode!==null&&C.parentNode.nodeName==="FIGURE",ee=(C,A,L)=>{L===""||L===null?C.removeAttribute(A):C.setAttribute(A,L)},Bt=C=>{const A=nn.create("figure",{class:"image"});nn.insertAfter(A,C),A.appendChild(C),A.appendChild(nn.create("figcaption",{contentEditable:"true"},"Caption")),A.contentEditable="false"},Ro=C=>{const A=C.parentNode;Qt(A)&&(nn.insertAfter(C,A),nn.remove(A))},wr=C=>{Hr(C)?Ro(C):Bt(C)},Sr=(C,A)=>{const L=C.getAttribute("style"),K=A(L!==null?L:"");K.length>0?(C.setAttribute("style",K),C.setAttribute("data-mce-style",K)):C.removeAttribute("style")},jr=(C,A)=>(L,K,bt)=>{const Wt=L.style;Wt[K]?(Wt[K]=Oe(bt),Sr(L,A)):ee(L,K,bt)},tr=(C,A)=>C.style[A]?Bn(C.style[A]):xn(C,A),To=(C,A)=>{const L=Oe(A);C.style.marginLeft=L,C.style.marginRight=L},er=(C,A)=>{const L=Oe(A);C.style.marginTop=L,C.style.marginBottom=L},nr=(C,A)=>{const L=Oe(A);C.style.borderWidth=L},or=(C,A)=>{C.style.borderStyle=A},Vn=C=>{var A;return(A=C.style.borderStyle)!==null&&A!==void 0?A:""},ln=C=>Qt(C)&&C.nodeName==="FIGURE",vs=C=>C.nodeName==="IMG",ys=C=>nn.getAttrib(C,"alt").length===0&&nn.getAttrib(C,"role")==="presentation",Vr=C=>ys(C)?"":xn(C,"alt"),gn=()=>({src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}),Qs=(C,A)=>{var L;const K=document.createElement("img");return ee(K,"style",A.style),(Jo(K)||A.hspace!=="")&&To(K,A.hspace),(bs(K)||A.vspace!=="")&&er(K,A.vspace),(Ao(K)||A.border!=="")&&nr(K,A.border),(Vn(K)||A.borderStyle!=="")&&or(K,A.borderStyle),C((L=K.getAttribute("style"))!==null&&L!==void 0?L:"")},qr=(C,A)=>{const L=document.createElement("img");if(ws(C,{...A,caption:!1},L),Zn(L,A.alt,A.isDecorative),A.caption){const K=nn.create("figure",{class:"image"});return K.appendChild(L),K.appendChild(nn.create("figcaption",{contentEditable:"true"},"Caption")),K.contentEditable="false",K}else return L},Pe=(C,A)=>({src:xn(A,"src"),alt:Vr(A),title:xn(A,"title"),width:tr(A,"width"),height:tr(A,"height"),class:xn(A,"class"),style:C(xn(A,"style")),caption:Hr(A),hspace:Jo(A),vspace:bs(A),border:Ao(A),borderStyle:Vn(A),isDecorative:ys(A)}),ie=(C,A,L,K,bt)=>{L[K]!==A[K]&&bt(C,K,String(L[K]))},Zn=(C,A,L)=>{if(L){nn.setAttrib(C,"role","presentation");const K=Xt.fromDom(C);te(K,"alt","")}else{if(vt(A)){const K=Xt.fromDom(C);ae(K,"alt")}else{const K=Xt.fromDom(C);te(K,"alt",A)}nn.getAttrib(C,"role")==="presentation"&&nn.setAttrib(C,"role","")}},Cs=(C,A,L)=>{(L.alt!==A.alt||L.isDecorative!==A.isDecorative)&&Zn(C,L.alt,L.isDecorative)},fn=(C,A)=>(L,K,bt)=>{C(L,bt),Sr(L,A)},ws=(C,A,L)=>{const K=Pe(C,L);ie(L,K,A,"caption",(bt,Wt,be)=>wr(bt)),ie(L,K,A,"src",ee),ie(L,K,A,"title",ee),ie(L,K,A,"width",jr("width",C)),ie(L,K,A,"height",jr("height",C)),ie(L,K,A,"class",ee),ie(L,K,A,"style",fn((bt,Wt)=>ee(bt,"style",Wt),C)),ie(L,K,A,"hspace",fn(To,C)),ie(L,K,A,"vspace",fn(er,C)),ie(L,K,A,"border",fn(nr,C)),ie(L,K,A,"borderStyle",fn(or,C)),Cs(L,K,A)},po=(C,A)=>{const L=C.dom.styles.parse(A),K=Xn(L),bt=C.dom.styles.parse(C.dom.styles.serialize(K));return C.dom.styles.serialize(bt)},cn=C=>{const A=C.selection.getNode(),L=C.dom.getParent(A,"figure.image");return L?C.dom.select("img",L)[0]:A&&(A.nodeName!=="IMG"||re(A))?null:A},rr=(C,A)=>{var L;const K=C.dom,bt=Eo(C.schema.getTextBlockElements(),(be,Ue)=>!C.schema.isValidChild(Ue,"figure")),Wt=K.getParent(A.parentNode,be=>Zt(bt,be.nodeName),C.getBody());return Wt&&(L=K.split(Wt,A))!==null&&L!==void 0?L:A},Oo=C=>{const A=cn(C);return A?Pe(L=>po(C,L),A):gn()},Ss=(C,A)=>{const L=qr(bt=>po(C,bt),A);C.dom.setAttrib(L,"data-mce-id","__mcenew"),C.focus(),C.selection.setContent(L.outerHTML);const K=C.dom.select('*[data-mce-id="__mcenew"]')[0];if(C.dom.setAttrib(K,"data-mce-id",null),ln(K)){const bt=rr(C,K);C.selection.select(bt)}else C.selection.select(K)},Jn=(C,A)=>{C.dom.setAttrib(A,"src",A.getAttribute("src"))},Zs=(C,A)=>{if(A){const L=C.dom.is(A.parentNode,"figure.image")?A.parentNode:A;C.dom.remove(L),C.focus(),C.nodeChanged(),C.dom.isEmpty(C.getBody())&&(C.setContent(""),C.selection.setCursorLocation())}},Aa=(C,A)=>{const L=cn(C);if(L)if(ws(K=>po(C,K),A,L),Jn(C,L),ln(L.parentNode)){C.dom.setStyle(L,"float","");const K=L.parentNode;rr(C,K),C.selection.select(L.parentNode)}else C.selection.select(L),je(C,A,L)},Js=(C,A)=>{const L=A.src;return{...A,src:Zo(C,L)?L:""}},Ra=(C,A)=>{const L=cn(C);if(L){const bt={...Pe(be=>po(C,be),L),...A},Wt=Js(C,bt);bt.src?Aa(C,Wt):Zs(C,L)}else A.src&&Ss(C,{...gn(),...A})},sr=(C=>(...A)=>{if(A.length===0)throw new Error("Can't merge zero objects");const L={};for(let K=0;K<A.length;K++){const bt=A[K];for(const Wt in bt)it(bt,Wt)&&(L[Wt]=C(L[Wt],bt[Wt]))}return L})((C,A)=>Ve(C)&&Ve(A)?sr(C,A):A);var ks=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),ta=tinymce.util.Tools.resolve("tinymce.util.Tools");const ea=C=>Ae(C.value)?C.value:"",kr=C=>Ae(C.text)?C.text:Ae(C.title)?C.title:"",xr=(C,A)=>{const L=[];return ta.each(C,K=>{const bt=kr(K);if(K.menu!==void 0){const Wt=xr(K.menu,A);L.push({text:bt,items:Wt})}else{const Wt=A(K);L.push({text:bt,value:Wt})}}),L},Ln=(C=ea)=>A=>A?q.from(A).map(L=>xr(L,C)):q.none(),xs=C=>Ln(ea)(C),ar=C=>it(C,"items"),En=(C,A)=>go(C,L=>ar(L)?En(L.items,A):L.value===A?q.some(L):q.none()),Fe={sanitizer:Ln,sanitize:xs,findEntry:(C,A)=>C.bind(L=>En(L,A))},na={makeTab:C=>({title:"Advanced",name:"advanced",items:[{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]})},Kr=C=>{const A=Fe.sanitizer(Po=>C.convertURL(Po.value||Po.url||"","src")),L=new Promise(Po=>{Qn(C,Ci=>{Po(A(Ci).map(eo=>ft([[{text:"None",value:""}],eo])))})}),K=Fe.sanitize(Te(C)),bt=yr(C),Wt=en(C),be=$r(C),Ue=Yn(C),vo=Oo(C),to=oe(C),Ze=zr(C),yo=Ot(C),As=Qe(C),xe=No(C),Rs=Qo(C),F=q.some(Xo(C)).filter(Po=>Ae(Po)&&Po.length>0);return L.then(Po=>({image:vo,imageList:Po,classList:K,hasAdvTab:bt,hasUploadTab:Wt,hasUploadUrl:be,hasUploadHandler:Ue,hasDescription:to,hasImageTitle:Ze,hasDimensions:yo,hasImageCaption:As,prependURL:F,hasAccessibilityOptions:xe,automaticUploads:Rs}))},oa=C=>{const A={name:"src",type:"urlinput",filetype:"image",label:"Source",picker_text:"Browse files"},L=C.imageList.map(Ze=>({name:"images",type:"listbox",label:"Image list",items:Ze})),K={name:"alt",type:"input",label:"Alternative description",enabled:!(C.hasAccessibilityOptions&&C.image.isDecorative)},bt={name:"title",type:"input",label:"Image title"},Wt={name:"dimensions",type:"sizeinput"},be={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},Ue=C.classList.map(Ze=>({name:"classes",type:"listbox",label:"Class",items:Ze})),vo={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},to=Ze=>Ze?{type:"grid",columns:2}:{type:"panel"};return ft([[A],L.toArray(),C.hasAccessibilityOptions&&C.hasDescription?[be]:[],C.hasDescription?[K]:[],C.hasImageTitle?[bt]:[],C.hasDimensions?[Wt]:[],[{...to(C.classList.isSome()&&C.hasImageCaption),items:ft([Ue.toArray(),C.hasImageCaption?[vo]:[]])}]])},Ke={makeTab:C=>({title:"General",name:"general",items:oa(C)}),makeItems:oa},_r={makeTab:C=>({title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]})},_n=C=>({prevImage:Fe.findEntry(C.imageList,C.image.src),prevAlt:C.image.alt,open:!0}),Dn=C=>({src:{value:C.src,meta:{}},images:C.src,alt:C.alt,title:C.title,dimensions:{width:C.width,height:C.height},classes:C.class,caption:C.caption,style:C.style,vspace:C.vspace,border:C.border,hspace:C.hspace,borderstyle:C.borderStyle,fileinput:[],isDecorative:C.isDecorative}),ho=(C,A)=>({src:C.src.value,alt:(C.alt===null||C.alt.length===0)&&A?null:C.alt,title:C.title,width:C.dimensions.width,height:C.dimensions.height,class:C.classes,style:C.style,caption:C.caption,hspace:C.hspace,vspace:C.vspace,border:C.border,borderStyle:C.borderstyle,isDecorative:C.isDecorative}),Bo=(C,A)=>/^(?:[a-zA-Z]+:)?\/\//.test(A)?q.none():C.prependURL.bind(L=>A.substring(0,L.length)!==L?q.some(L+A):q.none()),Kt=(C,A)=>{const L=A.getData();Bo(C,L.src.value).each(K=>{A.setData({src:{value:K,meta:L.src.meta}})})},Es=(C,A,L)=>{C.hasDescription&&Ae(L.alt)&&(A.alt=L.alt),C.hasAccessibilityOptions&&(A.isDecorative=L.isDecorative||A.isDecorative||!1),C.hasImageTitle&&Ae(L.title)&&(A.title=L.title),C.hasDimensions&&(Ae(L.width)&&(A.dimensions.width=L.width),Ae(L.height)&&(A.dimensions.height=L.height)),Ae(L.class)&&Fe.findEntry(C.classList,L.class).each(K=>{A.classes=K.value}),C.hasImageCaption&&Re(L.caption)&&(A.caption=L.caption),C.hasAdvTab&&(Ae(L.style)&&(A.style=L.style),Ae(L.vspace)&&(A.vspace=L.vspace),Ae(L.border)&&(A.border=L.border),Ae(L.hspace)&&(A.hspace=L.hspace),Ae(L.borderstyle)&&(A.borderstyle=L.borderstyle))},Gr=(C,A)=>{const L=A.getData(),K=L.src.meta;if(K!==void 0){const bt=sr({},L);Es(C,bt,K),A.setData(bt)}},ra=(C,A,L,K)=>{const bt=K.getData(),Wt=bt.src.value,be=bt.src.meta||{};!be.width&&!be.height&&A.hasDimensions&&(J(Wt)?C.imageSize(Wt).then(Ue=>{L.open&&K.setData({dimensions:Ue})}).catch(Ue=>console.error(Ue)):K.setData({dimensions:{width:"",height:""}}))},st=(C,A,L)=>{const K=L.getData(),bt=Fe.findEntry(C.imageList,K.src.value);A.prevImage=bt,L.setData({images:bt.map(Wt=>Wt.value).getOr("")})},bo=(C,A,L,K)=>{Kt(A,K),Gr(A,K),ra(C,A,L,K),st(A,L,K)},Yr=(C,A,L,K)=>{const bt=K.getData(),Wt=Fe.findEntry(A.imageList,bt.images);Wt.each(be=>{bt.alt===""||L.prevImage.map(vo=>vo.text===bt.alt).getOr(!1)?be.value===""?K.setData({src:be,alt:L.prevAlt}):K.setData({src:be,alt:be.text}):K.setData({src:be})}),L.prevImage=Wt,bo(C,A,L,K)},ke=(C,A,L,K)=>{const bt=K.getData();K.block("Uploading image"),He(bt.fileinput).fold(()=>{K.unblock()},Wt=>{const be=URL.createObjectURL(Wt),Ue=()=>{K.unblock(),URL.revokeObjectURL(be)},vo=to=>{K.setData({src:{value:to,meta:{}}}),K.showTab("general"),bo(C,A,L,K),K.focus("src")};Cr(Wt).then(to=>{const Ze=C.createBlobCache(Wt,be,to);A.automaticUploads?C.uploadImage(Ze).then(yo=>{vo(yo.url),Ue()}).catch(yo=>{Ue(),C.alertErr(yo,()=>{K.focus("fileinput")})}):(C.addToBlobCache(Ze),vo(Ze.blobUri()),K.unblock())})})},Lo=(C,A,L)=>(K,bt)=>{bt.name==="src"?bo(C,A,L,K):bt.name==="images"?Yr(C,A,L,K):bt.name==="alt"?L.prevAlt=K.getData().alt:bt.name==="fileinput"?ke(C,A,L,K):bt.name==="isDecorative"&&K.setEnabled("alt",!K.getData().isDecorative)},_s=C=>()=>{C.open=!1},Nr=C=>C.hasAdvTab||C.hasUploadUrl||C.hasUploadHandler?{type:"tabpanel",tabs:ft([[Ke.makeTab(C)],C.hasAdvTab?[na.makeTab(C)]:[],C.hasUploadTab&&(C.hasUploadUrl||C.hasUploadHandler)?[_r.makeTab(C)]:[]])}:{type:"panel",items:Ke.makeItems(C)},Ba=(C,A,L)=>K=>{const bt=sr(Dn(A.image),K.getData()),Wt={...bt,style:Qs(L.normalizeCss,ho(bt,!1))};C.execCommand("mceUpdateImage",!1,ho(Wt,A.hasAccessibilityOptions)),C.editorUpload.uploadImagesAuto(),K.close()},Xr=C=>A=>Zo(C,A)?We(C.documentBaseURI.toAbsolute(A)).then(L=>({width:String(L.width),height:String(L.height)})):Promise.resolve({width:"",height:""}),Gt=C=>(A,L,K)=>{var bt;return C.editorUpload.blobCache.create({blob:A,blobUri:L,name:(bt=A.name)===null||bt===void 0?void 0:bt.replace(/\.[^\.]+$/,""),filename:A.name,base64:K.split(",")[1]})},Ns=C=>A=>{C.editorUpload.blobCache.add(A)},Do=C=>(A,L)=>{C.windowManager.alert(A,L)},ir=C=>A=>po(C,A),on=C=>A=>C.dom.parseStyle(A),Be=C=>(A,L)=>C.dom.serializeStyle(A,L),_=C=>A=>ks(C).upload([A],!1).then(L=>{var K;return L.length===0?Promise.reject("Failed to upload image"):L[0].status===!1?Promise.reject((K=L[0].error)===null||K===void 0?void 0:K.message):L[0]}),T=C=>{const A={imageSize:Xr(C),addToBlobCache:Ns(C),createBlobCache:Gt(C),alertErr:Do(C),normalizeCss:ir(C),parseStyle:on(C),serializeStyle:Be(C),uploadImage:_(C)};return{open:()=>{Kr(C).then(K=>{const bt=_n(K);return{title:"Insert/Edit Image",size:"normal",body:Nr(K),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Dn(K.image),onSubmit:Ba(C,K,A),onChange:Lo(A,K,bt),onClose:_s(bt)}}).then(C.windowManager.open)}}},j=C=>{C.addCommand("mceImage",T(C).open),C.addCommand("mceUpdateImage",(A,L)=>{C.undoManager.transact(()=>Ra(C,L))})},Z=C=>{const A=C.attr("class");return Qt(A)&&/\bimage\b/.test(A)},et=C=>A=>{let L=A.length;const K=bt=>{bt.attr("contenteditable",C?"true":null)};for(;L--;){const bt=A[L];Z(bt)&&(bt.attr("contenteditable",C?"false":null),ta.each(bt.getAll("figcaption"),K))}},mt=C=>{C.on("PreInit",()=>{C.parser.addNodeFilter("figure",et(!0)),C.serializer.addNodeFilter("figure",et(!1))})},Pt=C=>A=>{const L=()=>{A.setEnabled(C.selection.isEditable())};return C.on("NodeChange",L),L(),()=>{C.off("NodeChange",L)}},se=C=>{C.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:T(C).open,onSetup:A=>{A.setActive(Qt(cn(C)));const L=C.selection.selectorChangedWithUnbind("img:not([data-mce-object]):not([data-mce-placeholder]),figure.image",A.setActive).unbind,K=Pt(C)(A);return()=>{L(),K()}}}),C.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:T(C).open,onSetup:Pt(C)}),C.ui.registry.addContextMenu("image",{update:A=>C.selection.isEditable()&&(ln(A)||vs(A)&&!re(A))?["image"]:[]})};var Yt=()=>{Ur.add("image",C=>{Yo(C),mt(C),se(C),j(C)})};Yt()}();
